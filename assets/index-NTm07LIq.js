(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function Am(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function U_(l){if(Object.prototype.hasOwnProperty.call(l,"__esModule"))return l;var e=l.default;if(typeof e=="function"){var t=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(l).forEach(function(n){var s=Object.getOwnPropertyDescriptor(l,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return l[n]}})}),t}var Gf={exports:{}},vl={},Yf={exports:{}},Wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g0;function H_(){if(g0)return Wt;g0=1;var l=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.iterator;function N(be){return be===null||typeof be!="object"?null:(be=E&&be[E]||be["@@iterator"],typeof be=="function"?be:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q=Object.assign,W={};function ee(be,Fe,yt){this.props=be,this.context=Fe,this.refs=W,this.updater=yt||O}ee.prototype.isReactComponent={},ee.prototype.setState=function(be,Fe){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Fe,"setState")},ee.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function K(){}K.prototype=ee.prototype;function ae(be,Fe,yt){this.props=be,this.context=Fe,this.refs=W,this.updater=yt||O}var le=ae.prototype=new K;le.constructor=ae,Q(le,ee.prototype),le.isPureReactComponent=!0;var ve=Array.isArray,we=Object.prototype.hasOwnProperty,F={current:null},ze={key:!0,ref:!0,__self:!0,__source:!0};function He(be,Fe,yt){var Ct,pt={},Mt=null,zt=null;if(Fe!=null)for(Ct in Fe.ref!==void 0&&(zt=Fe.ref),Fe.key!==void 0&&(Mt=""+Fe.key),Fe)we.call(Fe,Ct)&&!ze.hasOwnProperty(Ct)&&(pt[Ct]=Fe[Ct]);var Ut=arguments.length-2;if(Ut===1)pt.children=yt;else if(1<Ut){for(var _t=Array(Ut),At=0;At<Ut;At++)_t[At]=arguments[At+2];pt.children=_t}if(be&&be.defaultProps)for(Ct in Ut=be.defaultProps,Ut)pt[Ct]===void 0&&(pt[Ct]=Ut[Ct]);return{$$typeof:l,type:be,key:Mt,ref:zt,props:pt,_owner:F.current}}function Je(be,Fe){return{$$typeof:l,type:be.type,key:Fe,ref:be.ref,props:be.props,_owner:be._owner}}function ut(be){return typeof be=="object"&&be!==null&&be.$$typeof===l}function Ie(be){var Fe={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(yt){return Fe[yt]})}var Ke=/\/+/g;function dt(be,Fe){return typeof be=="object"&&be!==null&&be.key!=null?Ie(""+be.key):Fe.toString(36)}function Ve(be,Fe,yt,Ct,pt){var Mt=typeof be;(Mt==="undefined"||Mt==="boolean")&&(be=null);var zt=!1;if(be===null)zt=!0;else switch(Mt){case"string":case"number":zt=!0;break;case"object":switch(be.$$typeof){case l:case e:zt=!0}}if(zt)return zt=be,pt=pt(zt),be=Ct===""?"."+dt(zt,0):Ct,ve(pt)?(yt="",be!=null&&(yt=be.replace(Ke,"$&/")+"/"),Ve(pt,Fe,yt,"",function(At){return At})):pt!=null&&(ut(pt)&&(pt=Je(pt,yt+(!pt.key||zt&&zt.key===pt.key?"":(""+pt.key).replace(Ke,"$&/")+"/")+be)),Fe.push(pt)),1;if(zt=0,Ct=Ct===""?".":Ct+":",ve(be))for(var Ut=0;Ut<be.length;Ut++){Mt=be[Ut];var _t=Ct+dt(Mt,Ut);zt+=Ve(Mt,Fe,yt,_t,pt)}else if(_t=N(be),typeof _t=="function")for(be=_t.call(be),Ut=0;!(Mt=be.next()).done;)Mt=Mt.value,_t=Ct+dt(Mt,Ut++),zt+=Ve(Mt,Fe,yt,_t,pt);else if(Mt==="object")throw Fe=String(be),Error("Objects are not valid as a React child (found: "+(Fe==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Fe)+"). If you meant to render a collection of children, use an array instead.");return zt}function Bt(be,Fe,yt){if(be==null)return be;var Ct=[],pt=0;return Ve(be,Ct,"","",function(Mt){return Fe.call(yt,Mt,pt++)}),Ct}function Le(be){if(be._status===-1){var Fe=be._result;Fe=Fe(),Fe.then(function(yt){(be._status===0||be._status===-1)&&(be._status=1,be._result=yt)},function(yt){(be._status===0||be._status===-1)&&(be._status=2,be._result=yt)}),be._status===-1&&(be._status=0,be._result=Fe)}if(be._status===1)return be._result.default;throw be._result}var wt={current:null},Be={transition:null},Xe={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:Be,ReactCurrentOwner:F};function Ze(){throw Error("act(...) is not supported in production builds of React.")}return Wt.Children={map:Bt,forEach:function(be,Fe,yt){Bt(be,function(){Fe.apply(this,arguments)},yt)},count:function(be){var Fe=0;return Bt(be,function(){Fe++}),Fe},toArray:function(be){return Bt(be,function(Fe){return Fe})||[]},only:function(be){if(!ut(be))throw Error("React.Children.only expected to receive a single React element child.");return be}},Wt.Component=ee,Wt.Fragment=t,Wt.Profiler=s,Wt.PureComponent=ae,Wt.StrictMode=n,Wt.Suspense=v,Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xe,Wt.act=Ze,Wt.cloneElement=function(be,Fe,yt){if(be==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+be+".");var Ct=Q({},be.props),pt=be.key,Mt=be.ref,zt=be._owner;if(Fe!=null){if(Fe.ref!==void 0&&(Mt=Fe.ref,zt=F.current),Fe.key!==void 0&&(pt=""+Fe.key),be.type&&be.type.defaultProps)var Ut=be.type.defaultProps;for(_t in Fe)we.call(Fe,_t)&&!ze.hasOwnProperty(_t)&&(Ct[_t]=Fe[_t]===void 0&&Ut!==void 0?Ut[_t]:Fe[_t])}var _t=arguments.length-2;if(_t===1)Ct.children=yt;else if(1<_t){Ut=Array(_t);for(var At=0;At<_t;At++)Ut[At]=arguments[At+2];Ct.children=Ut}return{$$typeof:l,type:be.type,key:pt,ref:Mt,props:Ct,_owner:zt}},Wt.createContext=function(be){return be={$$typeof:h,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},be.Provider={$$typeof:a,_context:be},be.Consumer=be},Wt.createElement=He,Wt.createFactory=function(be){var Fe=He.bind(null,be);return Fe.type=be,Fe},Wt.createRef=function(){return{current:null}},Wt.forwardRef=function(be){return{$$typeof:p,render:be}},Wt.isValidElement=ut,Wt.lazy=function(be){return{$$typeof:b,_payload:{_status:-1,_result:be},_init:Le}},Wt.memo=function(be,Fe){return{$$typeof:_,type:be,compare:Fe===void 0?null:Fe}},Wt.startTransition=function(be){var Fe=Be.transition;Be.transition={};try{be()}finally{Be.transition=Fe}},Wt.unstable_act=Ze,Wt.useCallback=function(be,Fe){return wt.current.useCallback(be,Fe)},Wt.useContext=function(be){return wt.current.useContext(be)},Wt.useDebugValue=function(){},Wt.useDeferredValue=function(be){return wt.current.useDeferredValue(be)},Wt.useEffect=function(be,Fe){return wt.current.useEffect(be,Fe)},Wt.useId=function(){return wt.current.useId()},Wt.useImperativeHandle=function(be,Fe,yt){return wt.current.useImperativeHandle(be,Fe,yt)},Wt.useInsertionEffect=function(be,Fe){return wt.current.useInsertionEffect(be,Fe)},Wt.useLayoutEffect=function(be,Fe){return wt.current.useLayoutEffect(be,Fe)},Wt.useMemo=function(be,Fe){return wt.current.useMemo(be,Fe)},Wt.useReducer=function(be,Fe,yt){return wt.current.useReducer(be,Fe,yt)},Wt.useRef=function(be){return wt.current.useRef(be)},Wt.useState=function(be){return wt.current.useState(be)},Wt.useSyncExternalStore=function(be,Fe,yt){return wt.current.useSyncExternalStore(be,Fe,yt)},Wt.useTransition=function(){return wt.current.useTransition()},Wt.version="18.3.1",Wt}var m0;function Fd(){return m0||(m0=1,Yf.exports=H_()),Yf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v0;function X_(){if(v0)return vl;v0=1;var l=Fd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function h(p,v,_){var b,E={},N=null,O=null;_!==void 0&&(N=""+_),v.key!==void 0&&(N=""+v.key),v.ref!==void 0&&(O=v.ref);for(b in v)n.call(v,b)&&!a.hasOwnProperty(b)&&(E[b]=v[b]);if(p&&p.defaultProps)for(b in v=p.defaultProps,v)E[b]===void 0&&(E[b]=v[b]);return{$$typeof:e,type:p,key:N,ref:O,props:E,_owner:s.current}}return vl.Fragment=t,vl.jsx=h,vl.jsxs=h,vl}var y0;function G_(){return y0||(y0=1,Gf.exports=X_()),Gf.exports}var Z=G_(),Te=Fd();const To=Am(Te);var gc={},qf={exports:{}},Ar={},Kf={exports:{}},Zf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _0;function Y_(){return _0||(_0=1,(function(l){function e(Be,Xe){var Ze=Be.length;Be.push(Xe);e:for(;0<Ze;){var be=Ze-1>>>1,Fe=Be[be];if(0<s(Fe,Xe))Be[be]=Xe,Be[Ze]=Fe,Ze=be;else break e}}function t(Be){return Be.length===0?null:Be[0]}function n(Be){if(Be.length===0)return null;var Xe=Be[0],Ze=Be.pop();if(Ze!==Xe){Be[0]=Ze;e:for(var be=0,Fe=Be.length,yt=Fe>>>1;be<yt;){var Ct=2*(be+1)-1,pt=Be[Ct],Mt=Ct+1,zt=Be[Mt];if(0>s(pt,Ze))Mt<Fe&&0>s(zt,pt)?(Be[be]=zt,Be[Mt]=Ze,be=Mt):(Be[be]=pt,Be[Ct]=Ze,be=Ct);else if(Mt<Fe&&0>s(zt,Ze))Be[be]=zt,Be[Mt]=Ze,be=Mt;else break e}}return Xe}function s(Be,Xe){var Ze=Be.sortIndex-Xe.sortIndex;return Ze!==0?Ze:Be.id-Xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;l.unstable_now=function(){return a.now()}}else{var h=Date,p=h.now();l.unstable_now=function(){return h.now()-p}}var v=[],_=[],b=1,E=null,N=3,O=!1,Q=!1,W=!1,ee=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function le(Be){for(var Xe=t(_);Xe!==null;){if(Xe.callback===null)n(_);else if(Xe.startTime<=Be)n(_),Xe.sortIndex=Xe.expirationTime,e(v,Xe);else break;Xe=t(_)}}function ve(Be){if(W=!1,le(Be),!Q)if(t(v)!==null)Q=!0,Le(we);else{var Xe=t(_);Xe!==null&&wt(ve,Xe.startTime-Be)}}function we(Be,Xe){Q=!1,W&&(W=!1,K(He),He=-1),O=!0;var Ze=N;try{for(le(Xe),E=t(v);E!==null&&(!(E.expirationTime>Xe)||Be&&!Ie());){var be=E.callback;if(typeof be=="function"){E.callback=null,N=E.priorityLevel;var Fe=be(E.expirationTime<=Xe);Xe=l.unstable_now(),typeof Fe=="function"?E.callback=Fe:E===t(v)&&n(v),le(Xe)}else n(v);E=t(v)}if(E!==null)var yt=!0;else{var Ct=t(_);Ct!==null&&wt(ve,Ct.startTime-Xe),yt=!1}return yt}finally{E=null,N=Ze,O=!1}}var F=!1,ze=null,He=-1,Je=5,ut=-1;function Ie(){return!(l.unstable_now()-ut<Je)}function Ke(){if(ze!==null){var Be=l.unstable_now();ut=Be;var Xe=!0;try{Xe=ze(!0,Be)}finally{Xe?dt():(F=!1,ze=null)}}else F=!1}var dt;if(typeof ae=="function")dt=function(){ae(Ke)};else if(typeof MessageChannel<"u"){var Ve=new MessageChannel,Bt=Ve.port2;Ve.port1.onmessage=Ke,dt=function(){Bt.postMessage(null)}}else dt=function(){ee(Ke,0)};function Le(Be){ze=Be,F||(F=!0,dt())}function wt(Be,Xe){He=ee(function(){Be(l.unstable_now())},Xe)}l.unstable_IdlePriority=5,l.unstable_ImmediatePriority=1,l.unstable_LowPriority=4,l.unstable_NormalPriority=3,l.unstable_Profiling=null,l.unstable_UserBlockingPriority=2,l.unstable_cancelCallback=function(Be){Be.callback=null},l.unstable_continueExecution=function(){Q||O||(Q=!0,Le(we))},l.unstable_forceFrameRate=function(Be){0>Be||125<Be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Je=0<Be?Math.floor(1e3/Be):5},l.unstable_getCurrentPriorityLevel=function(){return N},l.unstable_getFirstCallbackNode=function(){return t(v)},l.unstable_next=function(Be){switch(N){case 1:case 2:case 3:var Xe=3;break;default:Xe=N}var Ze=N;N=Xe;try{return Be()}finally{N=Ze}},l.unstable_pauseExecution=function(){},l.unstable_requestPaint=function(){},l.unstable_runWithPriority=function(Be,Xe){switch(Be){case 1:case 2:case 3:case 4:case 5:break;default:Be=3}var Ze=N;N=Be;try{return Xe()}finally{N=Ze}},l.unstable_scheduleCallback=function(Be,Xe,Ze){var be=l.unstable_now();switch(typeof Ze=="object"&&Ze!==null?(Ze=Ze.delay,Ze=typeof Ze=="number"&&0<Ze?be+Ze:be):Ze=be,Be){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=Ze+Fe,Be={id:b++,callback:Xe,priorityLevel:Be,startTime:Ze,expirationTime:Fe,sortIndex:-1},Ze>be?(Be.sortIndex=Ze,e(_,Be),t(v)===null&&Be===t(_)&&(W?(K(He),He=-1):W=!0,wt(ve,Ze-be))):(Be.sortIndex=Fe,e(v,Be),Q||O||(Q=!0,Le(we))),Be},l.unstable_shouldYield=Ie,l.unstable_wrapCallback=function(Be){var Xe=N;return function(){var Ze=N;N=Xe;try{return Be.apply(this,arguments)}finally{N=Ze}}}})(Zf)),Zf}var x0;function q_(){return x0||(x0=1,Kf.exports=Y_()),Kf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w0;function K_(){if(w0)return Ar;w0=1;var l=Fd(),e=q_();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,d=1;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(i,o){h(i,o),h(i+"Capture",o)}function h(i,o){for(s[i]=o,i=0;i<o.length;i++)n.add(o[i])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b={},E={};function N(i){return v.call(E,i)?!0:v.call(b,i)?!1:_.test(i)?E[i]=!0:(b[i]=!0,!1)}function O(i,o,d,y){if(d!==null&&d.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function Q(i,o,d,y){if(o===null||typeof o>"u"||O(i,o,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function W(i,o,d,y,k,M,$){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=y,this.attributeNamespace=k,this.mustUseProperty=d,this.propertyName=i,this.type=o,this.sanitizeURL=M,this.removeEmptyString=$}var ee={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){ee[i]=new W(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];ee[o]=new W(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){ee[i]=new W(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){ee[i]=new W(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){ee[i]=new W(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){ee[i]=new W(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){ee[i]=new W(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){ee[i]=new W(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){ee[i]=new W(i,5,!1,i.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function ae(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(K,ae);ee[o]=new W(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(K,ae);ee[o]=new W(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(K,ae);ee[o]=new W(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){ee[i]=new W(i,1,!1,i.toLowerCase(),null,!1,!1)}),ee.xlinkHref=new W("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){ee[i]=new W(i,1,!1,i.toLowerCase(),null,!0,!0)});function le(i,o,d,y){var k=ee.hasOwnProperty(o)?ee[o]:null;(k!==null?k.type!==0:y||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(Q(o,d,k,y)&&(d=null),y||k===null?N(o)&&(d===null?i.removeAttribute(o):i.setAttribute(o,""+d)):k.mustUseProperty?i[k.propertyName]=d===null?k.type===3?!1:"":d:(o=k.attributeName,y=k.attributeNamespace,d===null?i.removeAttribute(o):(k=k.type,d=k===3||k===4&&d===!0?"":""+d,y?i.setAttributeNS(y,o,d):i.setAttribute(o,d))))}var ve=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,we=Symbol.for("react.element"),F=Symbol.for("react.portal"),ze=Symbol.for("react.fragment"),He=Symbol.for("react.strict_mode"),Je=Symbol.for("react.profiler"),ut=Symbol.for("react.provider"),Ie=Symbol.for("react.context"),Ke=Symbol.for("react.forward_ref"),dt=Symbol.for("react.suspense"),Ve=Symbol.for("react.suspense_list"),Bt=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),wt=Symbol.for("react.offscreen"),Be=Symbol.iterator;function Xe(i){return i===null||typeof i!="object"?null:(i=Be&&i[Be]||i["@@iterator"],typeof i=="function"?i:null)}var Ze=Object.assign,be;function Fe(i){if(be===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);be=o&&o[1]||""}return`
`+be+i}var yt=!1;function Ct(i,o){if(!i||yt)return"";yt=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ae){var y=Ae}Reflect.construct(i,[],o)}else{try{o.call()}catch(Ae){y=Ae}i.call(o.prototype)}else{try{throw Error()}catch(Ae){y=Ae}i()}}catch(Ae){if(Ae&&y&&typeof Ae.stack=="string"){for(var k=Ae.stack.split(`
`),M=y.stack.split(`
`),$=k.length-1,ue=M.length-1;1<=$&&0<=ue&&k[$]!==M[ue];)ue--;for(;1<=$&&0<=ue;$--,ue--)if(k[$]!==M[ue]){if($!==1||ue!==1)do if($--,ue--,0>ue||k[$]!==M[ue]){var me=`
`+k[$].replace(" at new "," at ");return i.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",i.displayName)),me}while(1<=$&&0<=ue);break}}}finally{yt=!1,Error.prepareStackTrace=d}return(i=i?i.displayName||i.name:"")?Fe(i):""}function pt(i){switch(i.tag){case 5:return Fe(i.type);case 16:return Fe("Lazy");case 13:return Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 2:case 15:return i=Ct(i.type,!1),i;case 11:return i=Ct(i.type.render,!1),i;case 1:return i=Ct(i.type,!0),i;default:return""}}function Mt(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ze:return"Fragment";case F:return"Portal";case Je:return"Profiler";case He:return"StrictMode";case dt:return"Suspense";case Ve:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Ie:return(i.displayName||"Context")+".Consumer";case ut:return(i._context.displayName||"Context")+".Provider";case Ke:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Bt:return o=i.displayName||null,o!==null?o:Mt(i.type)||"Memo";case Le:o=i._payload,i=i._init;try{return Mt(i(o))}catch{}}return null}function zt(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mt(o);case 8:return o===He?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ut(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function _t(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function At(i){var o=_t(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),y=""+i[o];if(!i.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var k=d.get,M=d.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return k.call(this)},set:function($){y=""+$,M.call(this,$)}}),Object.defineProperty(i,o,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function($){y=""+$},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function en(i){i._valueTracker||(i._valueTracker=At(i))}function oa(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var d=o.getValue(),y="";return i&&(y=_t(i)?i.checked?"true":"false":i.value),i=y,i!==d?(o.setValue(i),!0):!1}function Rr(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Es(i,o){var d=o.checked;return Ze({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??i._wrapperState.initialChecked})}function Di(i,o){var d=o.defaultValue==null?"":o.defaultValue,y=o.checked!=null?o.checked:o.defaultChecked;d=Ut(o.value!=null?o.value:d),i._wrapperState={initialChecked:y,initialValue:d,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function la(i,o){o=o.checked,o!=null&&le(i,"checked",o,!1)}function Fr(i,o){la(i,o);var d=Ut(o.value),y=o.type;if(d!=null)y==="number"?(d===0&&i.value===""||i.value!=d)&&(i.value=""+d):i.value!==""+d&&(i.value=""+d);else if(y==="submit"||y==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?Fi(i,o.type,d):o.hasOwnProperty("defaultValue")&&Fi(i,o.type,Ut(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Ri(i,o,d){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var y=o.type;if(!(y!=="submit"&&y!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,d||o===i.value||(i.value=o),i.defaultValue=o}d=i.name,d!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,d!==""&&(i.name=d)}function Fi(i,o,d){(o!=="number"||Rr(i.ownerDocument)!==i)&&(d==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+d&&(i.defaultValue=""+d))}var qr=Array.isArray;function tn(i,o,d,y){if(i=i.options,o){o={};for(var k=0;k<d.length;k++)o["$"+d[k]]=!0;for(d=0;d<i.length;d++)k=o.hasOwnProperty("$"+i[d].value),i[d].selected!==k&&(i[d].selected=k),k&&y&&(i[d].defaultSelected=!0)}else{for(d=""+Ut(d),o=null,k=0;k<i.length;k++){if(i[k].value===d){i[k].selected=!0,y&&(i[k].defaultSelected=!0);return}o!==null||i[k].disabled||(o=i[k])}o!==null&&(o.selected=!0)}}function fi(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return Ze({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Gt(i,o){var d=o.value;if(d==null){if(d=o.children,o=o.defaultValue,d!=null){if(o!=null)throw Error(t(92));if(qr(d)){if(1<d.length)throw Error(t(93));d=d[0]}o=d}o==null&&(o=""),d=o}i._wrapperState={initialValue:Ut(d)}}function Os(i,o){var d=Ut(o.value),y=Ut(o.defaultValue);d!=null&&(d=""+d,d!==i.value&&(i.value=d),o.defaultValue==null&&i.defaultValue!==d&&(i.defaultValue=d)),y!=null&&(i.defaultValue=""+y)}function Ft(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function r(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function u(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?r(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var f,g=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,d,y,k){MSApp.execUnsafeLocalFunction(function(){return i(o,d,y,k)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(f=f||document.createElement("div"),f.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=f.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function m(i,o){if(o){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=o;return}}i.textContent=o}var w={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S=["Webkit","ms","Moz","O"];Object.keys(w).forEach(function(i){S.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),w[o]=w[i]})});function C(i,o,d){return o==null||typeof o=="boolean"||o===""?"":d||typeof o!="number"||o===0||w.hasOwnProperty(i)&&w[i]?(""+o).trim():o+"px"}function T(i,o){i=i.style;for(var d in o)if(o.hasOwnProperty(d)){var y=d.indexOf("--")===0,k=C(d,o[d],y);d==="float"&&(d="cssFloat"),y?i.setProperty(d,k):i[d]=k}}var P=Ze({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function R(i,o){if(o){if(P[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function B(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var j=null;function I(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Y=null,z=null,H=null;function L(i){if(i=nl(i)){if(typeof Y!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Au(o),Y(i.stateNode,i.type,o))}}function U(i){z?H?H.push(i):H=[i]:z=i}function A(){if(z){var i=z,o=H;if(H=z=null,L(i),o)for(i=0;i<o.length;i++)L(o[i])}}function V(i,o){return i(o)}function q(){}var J=!1;function X(i,o,d){if(J)return i(o,d);J=!0;try{return V(i,o,d)}finally{J=!1,(z!==null||H!==null)&&(q(),A())}}function te(i,o){var d=i.stateNode;if(d===null)return null;var y=Au(d);if(y===null)return null;d=y[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(i=i.type,y=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!y;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(t(231,o,typeof d));return d}var ie=!1;if(p)try{var se={};Object.defineProperty(se,"passive",{get:function(){ie=!0}}),window.addEventListener("test",se,se),window.removeEventListener("test",se,se)}catch{ie=!1}function he(i,o,d,y,k,M,$,ue,me){var Ae=Array.prototype.slice.call(arguments,3);try{o.apply(d,Ae)}catch(Ye){this.onError(Ye)}}var ne=!1,ce=null,fe=!1,ye=null,xe={onError:function(i){ne=!0,ce=i}};function Ee(i,o,d,y,k,M,$,ue,me){ne=!1,ce=null,he.apply(xe,arguments)}function Ne(i,o,d,y,k,M,$,ue,me){if(Ee.apply(this,arguments),ne){if(ne){var Ae=ce;ne=!1,ce=null}else throw Error(t(198));fe||(fe=!0,ye=Ae)}}function We(i){var o=i,d=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(d=o.return),i=o.return;while(i)}return o.tag===3?d:null}function $e(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function it(i){if(We(i)!==i)throw Error(t(188))}function je(i){var o=i.alternate;if(!o){if(o=We(i),o===null)throw Error(t(188));return o!==i?null:i}for(var d=i,y=o;;){var k=d.return;if(k===null)break;var M=k.alternate;if(M===null){if(y=k.return,y!==null){d=y;continue}break}if(k.child===M.child){for(M=k.child;M;){if(M===d)return it(k),i;if(M===y)return it(k),o;M=M.sibling}throw Error(t(188))}if(d.return!==y.return)d=k,y=M;else{for(var $=!1,ue=k.child;ue;){if(ue===d){$=!0,d=k,y=M;break}if(ue===y){$=!0,y=k,d=M;break}ue=ue.sibling}if(!$){for(ue=M.child;ue;){if(ue===d){$=!0,d=M,y=k;break}if(ue===y){$=!0,y=M,d=k;break}ue=ue.sibling}if(!$)throw Error(t(189))}}if(d.alternate!==y)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?i:o}function De(i){return i=je(i),i!==null?tt(i):null}function tt(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=tt(i);if(o!==null)return o;i=i.sibling}return null}var at=e.unstable_scheduleCallback,st=e.unstable_cancelCallback,xt=e.unstable_shouldYield,vt=e.unstable_requestPaint,ot=e.unstable_now,Lt=e.unstable_getCurrentPriorityLevel,bt=e.unstable_ImmediatePriority,pn=e.unstable_UserBlockingPriority,sn=e.unstable_NormalPriority,Sn=e.unstable_LowPriority,ln=e.unstable_IdlePriority,qe=null,Ht=null;function an(i){if(Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(qe,i,void 0,(i.current.flags&128)===128)}catch{}}var qt=Math.clz32?Math.clz32:hr,er=Math.log,Nr=Math.LN2;function hr(i){return i>>>=0,i===0?32:31-(er(i)/Nr|0)|0}var Wn=64,Cn=4194304;function On(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function tr(i,o){var d=i.pendingLanes;if(d===0)return 0;var y=0,k=i.suspendedLanes,M=i.pingedLanes,$=d&268435455;if($!==0){var ue=$&~k;ue!==0?y=On(ue):(M&=$,M!==0&&(y=On(M)))}else $=d&~k,$!==0?y=On($):M!==0&&(y=On(M));if(y===0)return 0;if(o!==0&&o!==y&&(o&k)===0&&(k=y&-y,M=o&-o,k>=M||k===16&&(M&4194240)!==0))return o;if((y&4)!==0&&(y|=d&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=y;0<o;)d=31-qt(o),k=1<<d,y|=i[d],o&=~k;return y}function vn(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nn(i,o){for(var d=i.suspendedLanes,y=i.pingedLanes,k=i.expirationTimes,M=i.pendingLanes;0<M;){var $=31-qt(M),ue=1<<$,me=k[$];me===-1?((ue&d)===0||(ue&y)!==0)&&(k[$]=vn(ue,o)):me<=o&&(i.expiredLanes|=ue),M&=~ue}}function Ps(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function As(){var i=Wn;return Wn<<=1,(Wn&4194240)===0&&(Wn=64),i}function Ms(i){for(var o=[],d=0;31>d;d++)o.push(i);return o}function Ni(i,o,d){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-qt(o),i[o]=d}function qa(i,o){var d=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var y=i.eventTimes;for(i=i.expirationTimes;0<d;){var k=31-qt(d),M=1<<k;o[k]=0,y[k]=-1,i[k]=-1,d&=~M}}function Bi(i,o){var d=i.entangledLanes|=o;for(i=i.entanglements;d;){var y=31-qt(d),k=1<<y;k&o|i[y]&o&&(i[y]|=o),d&=~k}}var Vt=0;function zi(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Vi,Br,fr,Pt,nr,rr=!1,Un=[],Hn=null,Sr=null,Cr=null,di=new Map,c=new Map,x=[],D="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G(i,o){switch(i){case"focusin":case"focusout":Hn=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":Cr=null;break;case"pointerover":case"pointerout":di.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":c.delete(o.pointerId)}}function re(i,o,d,y,k,M){return i===null||i.nativeEvent!==M?(i={blockedOn:o,domEventName:d,eventSystemFlags:y,nativeEvent:M,targetContainers:[k]},o!==null&&(o=nl(o),o!==null&&Br(o)),i):(i.eventSystemFlags|=y,o=i.targetContainers,k!==null&&o.indexOf(k)===-1&&o.push(k),i)}function Se(i,o,d,y,k){switch(o){case"focusin":return Hn=re(Hn,i,o,d,y,k),!0;case"dragenter":return Sr=re(Sr,i,o,d,y,k),!0;case"mouseover":return Cr=re(Cr,i,o,d,y,k),!0;case"pointerover":var M=k.pointerId;return di.set(M,re(di.get(M)||null,i,o,d,y,k)),!0;case"gotpointercapture":return M=k.pointerId,c.set(M,re(c.get(M)||null,i,o,d,y,k)),!0}return!1}function Oe(i){var o=_a(i.target);if(o!==null){var d=We(o);if(d!==null){if(o=d.tag,o===13){if(o=$e(d),o!==null){i.blockedOn=o,nr(i.priority,function(){fr(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ge(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var d=Ka(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(d===null){d=i.nativeEvent;var y=new d.constructor(d.type,d);j=y,d.target.dispatchEvent(y),j=null}else return o=nl(d),o!==null&&Br(o),i.blockedOn=d,!1;o.shift()}return!0}function rt(i,o,d){Ge(i)&&d.delete(o)}function Ot(){rr=!1,Hn!==null&&Ge(Hn)&&(Hn=null),Sr!==null&&Ge(Sr)&&(Sr=null),Cr!==null&&Ge(Cr)&&(Cr=null),di.forEach(rt),c.forEach(rt)}function It(i,o){i.blockedOn===o&&(i.blockedOn=null,rr||(rr=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ot)))}function Kt(i){function o(k){return It(k,i)}if(0<Un.length){It(Un[0],i);for(var d=1;d<Un.length;d++){var y=Un[d];y.blockedOn===i&&(y.blockedOn=null)}}for(Hn!==null&&It(Hn,i),Sr!==null&&It(Sr,i),Cr!==null&&It(Cr,i),di.forEach(o),c.forEach(o),d=0;d<x.length;d++)y=x[d],y.blockedOn===i&&(y.blockedOn=null);for(;0<x.length&&(d=x[0],d.blockedOn===null);)Oe(d),d.blockedOn===null&&x.shift()}var cn=ve.ReactCurrentBatchConfig,Kr=!0;function pi(i,o,d,y){var k=Vt,M=cn.transition;cn.transition=null;try{Vt=1,Qr(i,o,d,y)}finally{Vt=k,cn.transition=M}}function Zr(i,o,d,y){var k=Vt,M=cn.transition;cn.transition=null;try{Vt=4,Qr(i,o,d,y)}finally{Vt=k,cn.transition=M}}function Qr(i,o,d,y){if(Kr){var k=Ka(i,o,d,y);if(k===null)Dh(i,o,y,zr,d),G(i,y);else if(Se(k,i,o,d,y))y.stopPropagation();else if(G(i,y),o&4&&-1<D.indexOf(i)){for(;k!==null;){var M=nl(k);if(M!==null&&Vi(M),M=Ka(i,o,d,y),M===null&&Dh(i,o,y,zr,d),M===k)break;k=M}k!==null&&y.stopPropagation()}else Dh(i,o,y,null,d)}}var zr=null;function Ka(i,o,d,y){if(zr=null,i=I(y),i=_a(i),i!==null)if(o=We(i),o===null)i=null;else if(d=o.tag,d===13){if(i=$e(o),i!==null)return i;i=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return zr=i,null}function ua(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lt()){case bt:return 1;case pn:return 4;case sn:case Sn:return 16;case ln:return 536870912;default:return 16}default:return 16}}var Wi=null,Ho=null,ca=null;function hu(){if(ca)return ca;var i,o=Ho,d=o.length,y,k="value"in Wi?Wi.value:Wi.textContent,M=k.length;for(i=0;i<d&&o[i]===k[i];i++);var $=d-i;for(y=1;y<=$&&o[d-y]===k[M-y];y++);return ca=k.slice(i,1<y?1-y:void 0)}function ha(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Za(){return!0}function fa(){return!1}function In(i){function o(d,y,k,M,$){this._reactName=d,this._targetInst=k,this.type=y,this.nativeEvent=M,this.target=$,this.currentTarget=null;for(var ue in i)i.hasOwnProperty(ue)&&(d=i[ue],this[ue]=d?d(M):M[ue]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Za:fa,this.isPropagationStopped=fa,this}return Ze(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Za)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Za)},persist:function(){},isPersistent:Za}),o}var gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qa=In(gi),Vr=Ze({},gi,{view:0,detail:0}),fu=In(Vr),kn,Xo,os,mi=Ze({},Vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Yo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==os&&(os&&i.type==="mousemove"?(kn=i.screenX-os.screenX,Xo=i.screenY-os.screenY):Xo=kn=0,os=i),kn)},movementY:function(i){return"movementY"in i?i.movementY:Xo}}),du=In(mi),_h=Ze({},mi,{dataTransfer:0}),xh=In(_h),wh=Ze({},Vr,{relatedTarget:0}),Go=In(wh),bh=Ze({},gi,{animationName:0,elapsedTime:0,pseudoElement:0}),Sh=In(bh),Ch=Ze({},gi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),kh=In(Ch),ls=Ze({},gi,{data:0}),Pn=In(ls),pu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},da={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Th={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gu(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Th[i])?!!o[i]:!1}function Yo(){return gu}var Ja=Ze({},Vr,{key:function(i){if(i.key){var o=pu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=ha(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?da[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Yo,charCode:function(i){return i.type==="keypress"?ha(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ha(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Is=In(Ja),mu=Ze({},mi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qo=In(mu),Xt=Ze({},Vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Yo}),Ko=In(Xt),vu=Ze({},gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),yu=In(vu),Bn=Ze({},mi,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ui=In(Bn),Nt=[9,13,27,32],pa=p&&"CompositionEvent"in window,rn=null;p&&"documentMode"in document&&(rn=document.documentMode);var $a=p&&"TextEvent"in window&&!rn,Hi=p&&(!pa||rn&&8<rn&&11>=rn),yn=" ",Jr=!1;function ga(i,o){switch(i){case"keyup":return Nt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _u(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Xi=!1;function Eh(i,o){switch(i){case"compositionend":return _u(o);case"keypress":return o.which!==32?null:(Jr=!0,yn);case"textInput":return i=o.data,i===yn&&Jr?null:i;default:return null}}function Wr(i,o){if(Xi)return i==="compositionend"||!pa&&ga(i,o)?(i=hu(),ca=Ho=Wi=null,Xi=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Hi&&o.locale!=="ko"?null:o.data;default:return null}}var ma={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function js(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!ma[i.type]:o==="textarea"}function eo(i,o,d,y){U(y),o=Eu(o,"onChange"),0<o.length&&(d=new Qa("onChange","change",null,d,y),i.push({event:d,listeners:o}))}var Ls=null,Ds=null;function Xn(i){Mp(i,0)}function Rs(i){var o=so(i);if(oa(o))return i}function Oh(i,o){if(i==="change")return o}var xu=!1;if(p){var va;if(p){var ya="oninput"in document;if(!ya){var wu=document.createElement("div");wu.setAttribute("oninput","return;"),ya=typeof wu.oninput=="function"}va=ya}else va=!1;xu=va&&(!document.documentMode||9<document.documentMode)}function Fs(){Ls&&(Ls.detachEvent("onpropertychange",to),Ds=Ls=null)}function to(i){if(i.propertyName==="value"&&Rs(Ds)){var o=[];eo(o,Ds,i,I(i)),X(Xn,o)}}function Ph(i,o,d){i==="focusin"?(Fs(),Ls=o,Ds=d,Ls.attachEvent("onpropertychange",to)):i==="focusout"&&Fs()}function Ah(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Rs(Ds)}function bu(i,o){if(i==="click")return Rs(o)}function Zo(i,o){if(i==="input"||i==="change")return Rs(o)}function Qo(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var jn=typeof Object.is=="function"?Object.is:Qo;function oe(i,o){if(jn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var d=Object.keys(i),y=Object.keys(o);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var k=d[y];if(!v.call(o,k)||!jn(i[k],o[k]))return!1}return!0}function pe(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Me(i,o){var d=pe(i);i=0;for(var y;d;){if(d.nodeType===3){if(y=i+d.textContent.length,i<=o&&y>=o)return{node:d,offset:o-i};i=y}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=pe(d)}}function Re(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Re(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function St(){for(var i=window,o=Rr();o instanceof i.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)i=o.contentWindow;else break;o=Rr(i.document)}return o}function kt(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function jt(i){var o=St(),d=i.focusedElem,y=i.selectionRange;if(o!==d&&d&&d.ownerDocument&&Re(d.ownerDocument.documentElement,d)){if(y!==null&&kt(d)){if(o=y.start,i=y.end,i===void 0&&(i=o),"selectionStart"in d)d.selectionStart=o,d.selectionEnd=Math.min(i,d.value.length);else if(i=(o=d.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var k=d.textContent.length,M=Math.min(y.start,k);y=y.end===void 0?M:Math.min(y.end,k),!i.extend&&M>y&&(k=y,y=M,M=k),k=Me(d,M);var $=Me(d,y);k&&$&&(i.rangeCount!==1||i.anchorNode!==k.node||i.anchorOffset!==k.offset||i.focusNode!==$.node||i.focusOffset!==$.offset)&&(o=o.createRange(),o.setStart(k.node,k.offset),i.removeAllRanges(),M>y?(i.addRange(o),i.extend($.node,$.offset)):(o.setEnd($.node,$.offset),i.addRange(o)))}}for(o=[],i=d;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<o.length;d++)i=o[d],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Zt=p&&"documentMode"in document&&11>=document.documentMode,Gn=null,vi=null,us=null,Ns=!1;function Su(i,o,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ns||Gn==null||Gn!==Rr(y)||(y=Gn,"selectionStart"in y&&kt(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),us&&oe(us,y)||(us=y,y=Eu(vi,"onSelect"),0<y.length&&(o=new Qa("onSelect","select",null,o,d),i.push({event:o,listeners:y}),o.target=Gn)))}function Cu(i,o){var d={};return d[i.toLowerCase()]=o.toLowerCase(),d["Webkit"+i]="webkit"+o,d["Moz"+i]="moz"+o,d}var no={animationend:Cu("Animation","AnimationEnd"),animationiteration:Cu("Animation","AnimationIteration"),animationstart:Cu("Animation","AnimationStart"),transitionend:Cu("Transition","TransitionEnd")},Mh={},Sp={};p&&(Sp=document.createElement("div").style,"AnimationEvent"in window||(delete no.animationend.animation,delete no.animationiteration.animation,delete no.animationstart.animation),"TransitionEvent"in window||delete no.transitionend.transition);function ku(i){if(Mh[i])return Mh[i];if(!no[i])return i;var o=no[i],d;for(d in o)if(o.hasOwnProperty(d)&&d in Sp)return Mh[i]=o[d];return i}var Cp=ku("animationend"),kp=ku("animationiteration"),Tp=ku("animationstart"),Ep=ku("transitionend"),Op=new Map,Pp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bs(i,o){Op.set(i,o),a(o,[i])}for(var Ih=0;Ih<Pp.length;Ih++){var jh=Pp[Ih],Jy=jh.toLowerCase(),$y=jh[0].toUpperCase()+jh.slice(1);Bs(Jy,"on"+$y)}Bs(Cp,"onAnimationEnd"),Bs(kp,"onAnimationIteration"),Bs(Tp,"onAnimationStart"),Bs("dblclick","onDoubleClick"),Bs("focusin","onFocus"),Bs("focusout","onBlur"),Bs(Ep,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jo));function Ap(i,o,d){var y=i.type||"unknown-event";i.currentTarget=d,Ne(y,o,void 0,i),i.currentTarget=null}function Mp(i,o){o=(o&4)!==0;for(var d=0;d<i.length;d++){var y=i[d],k=y.event;y=y.listeners;e:{var M=void 0;if(o)for(var $=y.length-1;0<=$;$--){var ue=y[$],me=ue.instance,Ae=ue.currentTarget;if(ue=ue.listener,me!==M&&k.isPropagationStopped())break e;Ap(k,ue,Ae),M=me}else for($=0;$<y.length;$++){if(ue=y[$],me=ue.instance,Ae=ue.currentTarget,ue=ue.listener,me!==M&&k.isPropagationStopped())break e;Ap(k,ue,Ae),M=me}}}if(fe)throw i=ye,fe=!1,ye=null,i}function hn(i,o){var d=o[Vh];d===void 0&&(d=o[Vh]=new Set);var y=i+"__bubble";d.has(y)||(Ip(o,i,2,!1),d.add(y))}function Lh(i,o,d){var y=0;o&&(y|=4),Ip(d,i,y,o)}var Tu="_reactListening"+Math.random().toString(36).slice(2);function $o(i){if(!i[Tu]){i[Tu]=!0,n.forEach(function(d){d!=="selectionchange"&&(e_.has(d)||Lh(d,!1,i),Lh(d,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Tu]||(o[Tu]=!0,Lh("selectionchange",!1,o))}}function Ip(i,o,d,y){switch(ua(o)){case 1:var k=pi;break;case 4:k=Zr;break;default:k=Qr}d=k.bind(null,o,d,i),k=void 0,!ie||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(k=!0),y?k!==void 0?i.addEventListener(o,d,{capture:!0,passive:k}):i.addEventListener(o,d,!0):k!==void 0?i.addEventListener(o,d,{passive:k}):i.addEventListener(o,d,!1)}function Dh(i,o,d,y,k){var M=y;if((o&1)===0&&(o&2)===0&&y!==null)e:for(;;){if(y===null)return;var $=y.tag;if($===3||$===4){var ue=y.stateNode.containerInfo;if(ue===k||ue.nodeType===8&&ue.parentNode===k)break;if($===4)for($=y.return;$!==null;){var me=$.tag;if((me===3||me===4)&&(me=$.stateNode.containerInfo,me===k||me.nodeType===8&&me.parentNode===k))return;$=$.return}for(;ue!==null;){if($=_a(ue),$===null)return;if(me=$.tag,me===5||me===6){y=M=$;continue e}ue=ue.parentNode}}y=y.return}X(function(){var Ae=M,Ye=I(d),Qe=[];e:{var Ue=Op.get(i);if(Ue!==void 0){var lt=Qa,ft=i;switch(i){case"keypress":if(ha(d)===0)break e;case"keydown":case"keyup":lt=Is;break;case"focusin":ft="focus",lt=Go;break;case"focusout":ft="blur",lt=Go;break;case"beforeblur":case"afterblur":lt=Go;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=du;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=xh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=Ko;break;case Cp:case kp:case Tp:lt=Sh;break;case Ep:lt=yu;break;case"scroll":lt=fu;break;case"wheel":lt=Ui;break;case"copy":case"cut":case"paste":lt=kh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=qo}var gt=(o&4)!==0,An=!gt&&i==="scroll",ke=gt?Ue!==null?Ue+"Capture":null:Ue;gt=[];for(var _e=Ae,Pe;_e!==null;){Pe=_e;var nt=Pe.stateNode;if(Pe.tag===5&&nt!==null&&(Pe=nt,ke!==null&&(nt=te(_e,ke),nt!=null&&gt.push(el(_e,nt,Pe)))),An)break;_e=_e.return}0<gt.length&&(Ue=new lt(Ue,ft,null,d,Ye),Qe.push({event:Ue,listeners:gt}))}}if((o&7)===0){e:{if(Ue=i==="mouseover"||i==="pointerover",lt=i==="mouseout"||i==="pointerout",Ue&&d!==j&&(ft=d.relatedTarget||d.fromElement)&&(_a(ft)||ft[cs]))break e;if((lt||Ue)&&(Ue=Ye.window===Ye?Ye:(Ue=Ye.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,lt?(ft=d.relatedTarget||d.toElement,lt=Ae,ft=ft?_a(ft):null,ft!==null&&(An=We(ft),ft!==An||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(lt=null,ft=Ae),lt!==ft)){if(gt=du,nt="onMouseLeave",ke="onMouseEnter",_e="mouse",(i==="pointerout"||i==="pointerover")&&(gt=qo,nt="onPointerLeave",ke="onPointerEnter",_e="pointer"),An=lt==null?Ue:so(lt),Pe=ft==null?Ue:so(ft),Ue=new gt(nt,_e+"leave",lt,d,Ye),Ue.target=An,Ue.relatedTarget=Pe,nt=null,_a(Ye)===Ae&&(gt=new gt(ke,_e+"enter",ft,d,Ye),gt.target=Pe,gt.relatedTarget=An,nt=gt),An=nt,lt&&ft)t:{for(gt=lt,ke=ft,_e=0,Pe=gt;Pe;Pe=ro(Pe))_e++;for(Pe=0,nt=ke;nt;nt=ro(nt))Pe++;for(;0<_e-Pe;)gt=ro(gt),_e--;for(;0<Pe-_e;)ke=ro(ke),Pe--;for(;_e--;){if(gt===ke||ke!==null&&gt===ke.alternate)break t;gt=ro(gt),ke=ro(ke)}gt=null}else gt=null;lt!==null&&jp(Qe,Ue,lt,gt,!1),ft!==null&&An!==null&&jp(Qe,An,ft,gt,!0)}}e:{if(Ue=Ae?so(Ae):window,lt=Ue.nodeName&&Ue.nodeName.toLowerCase(),lt==="select"||lt==="input"&&Ue.type==="file")var mt=Oh;else if(js(Ue))if(xu)mt=Zo;else{mt=Ah;var Tt=Ph}else(lt=Ue.nodeName)&&lt.toLowerCase()==="input"&&(Ue.type==="checkbox"||Ue.type==="radio")&&(mt=bu);if(mt&&(mt=mt(i,Ae))){eo(Qe,mt,d,Ye);break e}Tt&&Tt(i,Ue,Ae),i==="focusout"&&(Tt=Ue._wrapperState)&&Tt.controlled&&Ue.type==="number"&&Fi(Ue,"number",Ue.value)}switch(Tt=Ae?so(Ae):window,i){case"focusin":(js(Tt)||Tt.contentEditable==="true")&&(Gn=Tt,vi=Ae,us=null);break;case"focusout":us=vi=Gn=null;break;case"mousedown":Ns=!0;break;case"contextmenu":case"mouseup":case"dragend":Ns=!1,Su(Qe,d,Ye);break;case"selectionchange":if(Zt)break;case"keydown":case"keyup":Su(Qe,d,Ye)}var Et;if(pa)e:{switch(i){case"compositionstart":var Dt="onCompositionStart";break e;case"compositionend":Dt="onCompositionEnd";break e;case"compositionupdate":Dt="onCompositionUpdate";break e}Dt=void 0}else Xi?ga(i,d)&&(Dt="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(Dt="onCompositionStart");Dt&&(Hi&&d.locale!=="ko"&&(Xi||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&Xi&&(Et=hu()):(Wi=Ye,Ho="value"in Wi?Wi.value:Wi.textContent,Xi=!0)),Tt=Eu(Ae,Dt),0<Tt.length&&(Dt=new Pn(Dt,i,null,d,Ye),Qe.push({event:Dt,listeners:Tt}),Et?Dt.data=Et:(Et=_u(d),Et!==null&&(Dt.data=Et)))),(Et=$a?Eh(i,d):Wr(i,d))&&(Ae=Eu(Ae,"onBeforeInput"),0<Ae.length&&(Ye=new Pn("onBeforeInput","beforeinput",null,d,Ye),Qe.push({event:Ye,listeners:Ae}),Ye.data=Et))}Mp(Qe,o)})}function el(i,o,d){return{instance:i,listener:o,currentTarget:d}}function Eu(i,o){for(var d=o+"Capture",y=[];i!==null;){var k=i,M=k.stateNode;k.tag===5&&M!==null&&(k=M,M=te(i,d),M!=null&&y.unshift(el(i,M,k)),M=te(i,o),M!=null&&y.push(el(i,M,k))),i=i.return}return y}function ro(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function jp(i,o,d,y,k){for(var M=o._reactName,$=[];d!==null&&d!==y;){var ue=d,me=ue.alternate,Ae=ue.stateNode;if(me!==null&&me===y)break;ue.tag===5&&Ae!==null&&(ue=Ae,k?(me=te(d,M),me!=null&&$.unshift(el(d,me,ue))):k||(me=te(d,M),me!=null&&$.push(el(d,me,ue)))),d=d.return}$.length!==0&&i.push({event:o,listeners:$})}var t_=/\r\n?/g,n_=/\u0000|\uFFFD/g;function Lp(i){return(typeof i=="string"?i:""+i).replace(t_,`
`).replace(n_,"")}function Ou(i,o,d){if(o=Lp(o),Lp(i)!==o&&d)throw Error(t(425))}function Pu(){}var Rh=null,Fh=null;function Nh(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Bh=typeof setTimeout=="function"?setTimeout:void 0,r_=typeof clearTimeout=="function"?clearTimeout:void 0,Dp=typeof Promise=="function"?Promise:void 0,i_=typeof queueMicrotask=="function"?queueMicrotask:typeof Dp<"u"?function(i){return Dp.resolve(null).then(i).catch(s_)}:Bh;function s_(i){setTimeout(function(){throw i})}function zh(i,o){var d=o,y=0;do{var k=d.nextSibling;if(i.removeChild(d),k&&k.nodeType===8)if(d=k.data,d==="/$"){if(y===0){i.removeChild(k),Kt(o);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=k}while(d);Kt(o)}function zs(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Rp(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return i;o--}else d==="/$"&&o++}i=i.previousSibling}return null}var io=Math.random().toString(36).slice(2),Gi="__reactFiber$"+io,tl="__reactProps$"+io,cs="__reactContainer$"+io,Vh="__reactEvents$"+io,a_="__reactListeners$"+io,o_="__reactHandles$"+io;function _a(i){var o=i[Gi];if(o)return o;for(var d=i.parentNode;d;){if(o=d[cs]||d[Gi]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(i=Rp(i);i!==null;){if(d=i[Gi])return d;i=Rp(i)}return o}i=d,d=i.parentNode}return null}function nl(i){return i=i[Gi]||i[cs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function so(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Au(i){return i[tl]||null}var Wh=[],ao=-1;function Vs(i){return{current:i}}function fn(i){0>ao||(i.current=Wh[ao],Wh[ao]=null,ao--)}function un(i,o){ao++,Wh[ao]=i.current,i.current=o}var Ws={},ir=Vs(Ws),kr=Vs(!1),xa=Ws;function oo(i,o){var d=i.type.contextTypes;if(!d)return Ws;var y=i.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===o)return y.__reactInternalMemoizedMaskedChildContext;var k={},M;for(M in d)k[M]=o[M];return y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=k),k}function Tr(i){return i=i.childContextTypes,i!=null}function Mu(){fn(kr),fn(ir)}function Fp(i,o,d){if(ir.current!==Ws)throw Error(t(168));un(ir,o),un(kr,d)}function Np(i,o,d){var y=i.stateNode;if(o=o.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var k in y)if(!(k in o))throw Error(t(108,zt(i)||"Unknown",k));return Ze({},d,y)}function Iu(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ws,xa=ir.current,un(ir,i),un(kr,kr.current),!0}function Bp(i,o,d){var y=i.stateNode;if(!y)throw Error(t(169));d?(i=Np(i,o,xa),y.__reactInternalMemoizedMergedChildContext=i,fn(kr),fn(ir),un(ir,i)):fn(kr),un(kr,d)}var hs=null,ju=!1,Uh=!1;function zp(i){hs===null?hs=[i]:hs.push(i)}function l_(i){ju=!0,zp(i)}function Us(){if(!Uh&&hs!==null){Uh=!0;var i=0,o=Vt;try{var d=hs;for(Vt=1;i<d.length;i++){var y=d[i];do y=y(!0);while(y!==null)}hs=null,ju=!1}catch(k){throw hs!==null&&(hs=hs.slice(i+1)),at(bt,Us),k}finally{Vt=o,Uh=!1}}return null}var lo=[],uo=0,Lu=null,Du=0,$r=[],ei=0,wa=null,fs=1,ds="";function ba(i,o){lo[uo++]=Du,lo[uo++]=Lu,Lu=i,Du=o}function Vp(i,o,d){$r[ei++]=fs,$r[ei++]=ds,$r[ei++]=wa,wa=i;var y=fs;i=ds;var k=32-qt(y)-1;y&=~(1<<k),d+=1;var M=32-qt(o)+k;if(30<M){var $=k-k%5;M=(y&(1<<$)-1).toString(32),y>>=$,k-=$,fs=1<<32-qt(o)+k|d<<k|y,ds=M+i}else fs=1<<M|d<<k|y,ds=i}function Hh(i){i.return!==null&&(ba(i,1),Vp(i,1,0))}function Xh(i){for(;i===Lu;)Lu=lo[--uo],lo[uo]=null,Du=lo[--uo],lo[uo]=null;for(;i===wa;)wa=$r[--ei],$r[ei]=null,ds=$r[--ei],$r[ei]=null,fs=$r[--ei],$r[ei]=null}var Ur=null,Hr=null,gn=!1,yi=null;function Wp(i,o){var d=ii(5,null,null,0);d.elementType="DELETED",d.stateNode=o,d.return=i,o=i.deletions,o===null?(i.deletions=[d],i.flags|=16):o.push(d)}function Up(i,o){switch(i.tag){case 5:var d=i.type;return o=o.nodeType!==1||d.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Ur=i,Hr=zs(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Ur=i,Hr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(d=wa!==null?{id:fs,overflow:ds}:null,i.memoizedState={dehydrated:o,treeContext:d,retryLane:1073741824},d=ii(18,null,null,0),d.stateNode=o,d.return=i,i.child=d,Ur=i,Hr=null,!0):!1;default:return!1}}function Gh(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Yh(i){if(gn){var o=Hr;if(o){var d=o;if(!Up(i,o)){if(Gh(i))throw Error(t(418));o=zs(d.nextSibling);var y=Ur;o&&Up(i,o)?Wp(y,d):(i.flags=i.flags&-4097|2,gn=!1,Ur=i)}}else{if(Gh(i))throw Error(t(418));i.flags=i.flags&-4097|2,gn=!1,Ur=i}}}function Hp(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Ur=i}function Ru(i){if(i!==Ur)return!1;if(!gn)return Hp(i),gn=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Nh(i.type,i.memoizedProps)),o&&(o=Hr)){if(Gh(i))throw Xp(),Error(t(418));for(;o;)Wp(i,o),o=zs(o.nextSibling)}if(Hp(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"){if(o===0){Hr=zs(i.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++}i=i.nextSibling}Hr=null}}else Hr=Ur?zs(i.stateNode.nextSibling):null;return!0}function Xp(){for(var i=Hr;i;)i=zs(i.nextSibling)}function co(){Hr=Ur=null,gn=!1}function qh(i){yi===null?yi=[i]:yi.push(i)}var u_=ve.ReactCurrentBatchConfig;function rl(i,o,d){if(i=d.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var y=d.stateNode}if(!y)throw Error(t(147,i));var k=y,M=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===M?o.ref:(o=function($){var ue=k.refs;$===null?delete ue[M]:ue[M]=$},o._stringRef=M,o)}if(typeof i!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,i))}return i}function Fu(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Gp(i){var o=i._init;return o(i._payload)}function Yp(i){function o(ke,_e){if(i){var Pe=ke.deletions;Pe===null?(ke.deletions=[_e],ke.flags|=16):Pe.push(_e)}}function d(ke,_e){if(!i)return null;for(;_e!==null;)o(ke,_e),_e=_e.sibling;return null}function y(ke,_e){for(ke=new Map;_e!==null;)_e.key!==null?ke.set(_e.key,_e):ke.set(_e.index,_e),_e=_e.sibling;return ke}function k(ke,_e){return ke=Qs(ke,_e),ke.index=0,ke.sibling=null,ke}function M(ke,_e,Pe){return ke.index=Pe,i?(Pe=ke.alternate,Pe!==null?(Pe=Pe.index,Pe<_e?(ke.flags|=2,_e):Pe):(ke.flags|=2,_e)):(ke.flags|=1048576,_e)}function $(ke){return i&&ke.alternate===null&&(ke.flags|=2),ke}function ue(ke,_e,Pe,nt){return _e===null||_e.tag!==6?(_e=zf(Pe,ke.mode,nt),_e.return=ke,_e):(_e=k(_e,Pe),_e.return=ke,_e)}function me(ke,_e,Pe,nt){var mt=Pe.type;return mt===ze?Ye(ke,_e,Pe.props.children,nt,Pe.key):_e!==null&&(_e.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===Le&&Gp(mt)===_e.type)?(nt=k(_e,Pe.props),nt.ref=rl(ke,_e,Pe),nt.return=ke,nt):(nt=oc(Pe.type,Pe.key,Pe.props,null,ke.mode,nt),nt.ref=rl(ke,_e,Pe),nt.return=ke,nt)}function Ae(ke,_e,Pe,nt){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==Pe.containerInfo||_e.stateNode.implementation!==Pe.implementation?(_e=Vf(Pe,ke.mode,nt),_e.return=ke,_e):(_e=k(_e,Pe.children||[]),_e.return=ke,_e)}function Ye(ke,_e,Pe,nt,mt){return _e===null||_e.tag!==7?(_e=Aa(Pe,ke.mode,nt,mt),_e.return=ke,_e):(_e=k(_e,Pe),_e.return=ke,_e)}function Qe(ke,_e,Pe){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return _e=zf(""+_e,ke.mode,Pe),_e.return=ke,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case we:return Pe=oc(_e.type,_e.key,_e.props,null,ke.mode,Pe),Pe.ref=rl(ke,null,_e),Pe.return=ke,Pe;case F:return _e=Vf(_e,ke.mode,Pe),_e.return=ke,_e;case Le:var nt=_e._init;return Qe(ke,nt(_e._payload),Pe)}if(qr(_e)||Xe(_e))return _e=Aa(_e,ke.mode,Pe,null),_e.return=ke,_e;Fu(ke,_e)}return null}function Ue(ke,_e,Pe,nt){var mt=_e!==null?_e.key:null;if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return mt!==null?null:ue(ke,_e,""+Pe,nt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case we:return Pe.key===mt?me(ke,_e,Pe,nt):null;case F:return Pe.key===mt?Ae(ke,_e,Pe,nt):null;case Le:return mt=Pe._init,Ue(ke,_e,mt(Pe._payload),nt)}if(qr(Pe)||Xe(Pe))return mt!==null?null:Ye(ke,_e,Pe,nt,null);Fu(ke,Pe)}return null}function lt(ke,_e,Pe,nt,mt){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return ke=ke.get(Pe)||null,ue(_e,ke,""+nt,mt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case we:return ke=ke.get(nt.key===null?Pe:nt.key)||null,me(_e,ke,nt,mt);case F:return ke=ke.get(nt.key===null?Pe:nt.key)||null,Ae(_e,ke,nt,mt);case Le:var Tt=nt._init;return lt(ke,_e,Pe,Tt(nt._payload),mt)}if(qr(nt)||Xe(nt))return ke=ke.get(Pe)||null,Ye(_e,ke,nt,mt,null);Fu(_e,nt)}return null}function ft(ke,_e,Pe,nt){for(var mt=null,Tt=null,Et=_e,Dt=_e=0,Kn=null;Et!==null&&Dt<Pe.length;Dt++){Et.index>Dt?(Kn=Et,Et=null):Kn=Et.sibling;var Jt=Ue(ke,Et,Pe[Dt],nt);if(Jt===null){Et===null&&(Et=Kn);break}i&&Et&&Jt.alternate===null&&o(ke,Et),_e=M(Jt,_e,Dt),Tt===null?mt=Jt:Tt.sibling=Jt,Tt=Jt,Et=Kn}if(Dt===Pe.length)return d(ke,Et),gn&&ba(ke,Dt),mt;if(Et===null){for(;Dt<Pe.length;Dt++)Et=Qe(ke,Pe[Dt],nt),Et!==null&&(_e=M(Et,_e,Dt),Tt===null?mt=Et:Tt.sibling=Et,Tt=Et);return gn&&ba(ke,Dt),mt}for(Et=y(ke,Et);Dt<Pe.length;Dt++)Kn=lt(Et,ke,Dt,Pe[Dt],nt),Kn!==null&&(i&&Kn.alternate!==null&&Et.delete(Kn.key===null?Dt:Kn.key),_e=M(Kn,_e,Dt),Tt===null?mt=Kn:Tt.sibling=Kn,Tt=Kn);return i&&Et.forEach(function(Js){return o(ke,Js)}),gn&&ba(ke,Dt),mt}function gt(ke,_e,Pe,nt){var mt=Xe(Pe);if(typeof mt!="function")throw Error(t(150));if(Pe=mt.call(Pe),Pe==null)throw Error(t(151));for(var Tt=mt=null,Et=_e,Dt=_e=0,Kn=null,Jt=Pe.next();Et!==null&&!Jt.done;Dt++,Jt=Pe.next()){Et.index>Dt?(Kn=Et,Et=null):Kn=Et.sibling;var Js=Ue(ke,Et,Jt.value,nt);if(Js===null){Et===null&&(Et=Kn);break}i&&Et&&Js.alternate===null&&o(ke,Et),_e=M(Js,_e,Dt),Tt===null?mt=Js:Tt.sibling=Js,Tt=Js,Et=Kn}if(Jt.done)return d(ke,Et),gn&&ba(ke,Dt),mt;if(Et===null){for(;!Jt.done;Dt++,Jt=Pe.next())Jt=Qe(ke,Jt.value,nt),Jt!==null&&(_e=M(Jt,_e,Dt),Tt===null?mt=Jt:Tt.sibling=Jt,Tt=Jt);return gn&&ba(ke,Dt),mt}for(Et=y(ke,Et);!Jt.done;Dt++,Jt=Pe.next())Jt=lt(Et,ke,Dt,Jt.value,nt),Jt!==null&&(i&&Jt.alternate!==null&&Et.delete(Jt.key===null?Dt:Jt.key),_e=M(Jt,_e,Dt),Tt===null?mt=Jt:Tt.sibling=Jt,Tt=Jt);return i&&Et.forEach(function(W_){return o(ke,W_)}),gn&&ba(ke,Dt),mt}function An(ke,_e,Pe,nt){if(typeof Pe=="object"&&Pe!==null&&Pe.type===ze&&Pe.key===null&&(Pe=Pe.props.children),typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case we:e:{for(var mt=Pe.key,Tt=_e;Tt!==null;){if(Tt.key===mt){if(mt=Pe.type,mt===ze){if(Tt.tag===7){d(ke,Tt.sibling),_e=k(Tt,Pe.props.children),_e.return=ke,ke=_e;break e}}else if(Tt.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===Le&&Gp(mt)===Tt.type){d(ke,Tt.sibling),_e=k(Tt,Pe.props),_e.ref=rl(ke,Tt,Pe),_e.return=ke,ke=_e;break e}d(ke,Tt);break}else o(ke,Tt);Tt=Tt.sibling}Pe.type===ze?(_e=Aa(Pe.props.children,ke.mode,nt,Pe.key),_e.return=ke,ke=_e):(nt=oc(Pe.type,Pe.key,Pe.props,null,ke.mode,nt),nt.ref=rl(ke,_e,Pe),nt.return=ke,ke=nt)}return $(ke);case F:e:{for(Tt=Pe.key;_e!==null;){if(_e.key===Tt)if(_e.tag===4&&_e.stateNode.containerInfo===Pe.containerInfo&&_e.stateNode.implementation===Pe.implementation){d(ke,_e.sibling),_e=k(_e,Pe.children||[]),_e.return=ke,ke=_e;break e}else{d(ke,_e);break}else o(ke,_e);_e=_e.sibling}_e=Vf(Pe,ke.mode,nt),_e.return=ke,ke=_e}return $(ke);case Le:return Tt=Pe._init,An(ke,_e,Tt(Pe._payload),nt)}if(qr(Pe))return ft(ke,_e,Pe,nt);if(Xe(Pe))return gt(ke,_e,Pe,nt);Fu(ke,Pe)}return typeof Pe=="string"&&Pe!==""||typeof Pe=="number"?(Pe=""+Pe,_e!==null&&_e.tag===6?(d(ke,_e.sibling),_e=k(_e,Pe),_e.return=ke,ke=_e):(d(ke,_e),_e=zf(Pe,ke.mode,nt),_e.return=ke,ke=_e),$(ke)):d(ke,_e)}return An}var ho=Yp(!0),qp=Yp(!1),Nu=Vs(null),Bu=null,fo=null,Kh=null;function Zh(){Kh=fo=Bu=null}function Qh(i){var o=Nu.current;fn(Nu),i._currentValue=o}function Jh(i,o,d){for(;i!==null;){var y=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,y!==null&&(y.childLanes|=o)):y!==null&&(y.childLanes&o)!==o&&(y.childLanes|=o),i===d)break;i=i.return}}function po(i,o){Bu=i,Kh=fo=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Er=!0),i.firstContext=null)}function ti(i){var o=i._currentValue;if(Kh!==i)if(i={context:i,memoizedValue:o,next:null},fo===null){if(Bu===null)throw Error(t(308));fo=i,Bu.dependencies={lanes:0,firstContext:i}}else fo=fo.next=i;return o}var Sa=null;function $h(i){Sa===null?Sa=[i]:Sa.push(i)}function Kp(i,o,d,y){var k=o.interleaved;return k===null?(d.next=d,$h(o)):(d.next=k.next,k.next=d),o.interleaved=d,ps(i,y)}function ps(i,o){i.lanes|=o;var d=i.alternate;for(d!==null&&(d.lanes|=o),d=i,i=i.return;i!==null;)i.childLanes|=o,d=i.alternate,d!==null&&(d.childLanes|=o),d=i,i=i.return;return d.tag===3?d.stateNode:null}var Hs=!1;function ef(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zp(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function gs(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Xs(i,o,d){var y=i.updateQueue;if(y===null)return null;if(y=y.shared,(Qt&2)!==0){var k=y.pending;return k===null?o.next=o:(o.next=k.next,k.next=o),y.pending=o,ps(i,d)}return k=y.interleaved,k===null?(o.next=o,$h(y)):(o.next=k.next,k.next=o),y.interleaved=o,ps(i,d)}function zu(i,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194240)!==0)){var y=o.lanes;y&=i.pendingLanes,d|=y,o.lanes=d,Bi(i,d)}}function Qp(i,o){var d=i.updateQueue,y=i.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var k=null,M=null;if(d=d.firstBaseUpdate,d!==null){do{var $={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};M===null?k=M=$:M=M.next=$,d=d.next}while(d!==null);M===null?k=M=o:M=M.next=o}else k=M=o;d={baseState:y.baseState,firstBaseUpdate:k,lastBaseUpdate:M,shared:y.shared,effects:y.effects},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=o:i.next=o,d.lastBaseUpdate=o}function Vu(i,o,d,y){var k=i.updateQueue;Hs=!1;var M=k.firstBaseUpdate,$=k.lastBaseUpdate,ue=k.shared.pending;if(ue!==null){k.shared.pending=null;var me=ue,Ae=me.next;me.next=null,$===null?M=Ae:$.next=Ae,$=me;var Ye=i.alternate;Ye!==null&&(Ye=Ye.updateQueue,ue=Ye.lastBaseUpdate,ue!==$&&(ue===null?Ye.firstBaseUpdate=Ae:ue.next=Ae,Ye.lastBaseUpdate=me))}if(M!==null){var Qe=k.baseState;$=0,Ye=Ae=me=null,ue=M;do{var Ue=ue.lane,lt=ue.eventTime;if((y&Ue)===Ue){Ye!==null&&(Ye=Ye.next={eventTime:lt,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var ft=i,gt=ue;switch(Ue=o,lt=d,gt.tag){case 1:if(ft=gt.payload,typeof ft=="function"){Qe=ft.call(lt,Qe,Ue);break e}Qe=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=gt.payload,Ue=typeof ft=="function"?ft.call(lt,Qe,Ue):ft,Ue==null)break e;Qe=Ze({},Qe,Ue);break e;case 2:Hs=!0}}ue.callback!==null&&ue.lane!==0&&(i.flags|=64,Ue=k.effects,Ue===null?k.effects=[ue]:Ue.push(ue))}else lt={eventTime:lt,lane:Ue,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Ye===null?(Ae=Ye=lt,me=Qe):Ye=Ye.next=lt,$|=Ue;if(ue=ue.next,ue===null){if(ue=k.shared.pending,ue===null)break;Ue=ue,ue=Ue.next,Ue.next=null,k.lastBaseUpdate=Ue,k.shared.pending=null}}while(!0);if(Ye===null&&(me=Qe),k.baseState=me,k.firstBaseUpdate=Ae,k.lastBaseUpdate=Ye,o=k.shared.interleaved,o!==null){k=o;do $|=k.lane,k=k.next;while(k!==o)}else M===null&&(k.shared.lanes=0);Ta|=$,i.lanes=$,i.memoizedState=Qe}}function Jp(i,o,d){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var y=i[o],k=y.callback;if(k!==null){if(y.callback=null,y=d,typeof k!="function")throw Error(t(191,k));k.call(y)}}}var il={},Yi=Vs(il),sl=Vs(il),al=Vs(il);function Ca(i){if(i===il)throw Error(t(174));return i}function tf(i,o){switch(un(al,o),un(sl,i),un(Yi,il),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:u(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=u(o,i)}fn(Yi),un(Yi,o)}function go(){fn(Yi),fn(sl),fn(al)}function $p(i){Ca(al.current);var o=Ca(Yi.current),d=u(o,i.type);o!==d&&(un(sl,i),un(Yi,d))}function nf(i){sl.current===i&&(fn(Yi),fn(sl))}var _n=Vs(0);function Wu(i){for(var o=i;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var rf=[];function sf(){for(var i=0;i<rf.length;i++)rf[i]._workInProgressVersionPrimary=null;rf.length=0}var Uu=ve.ReactCurrentDispatcher,af=ve.ReactCurrentBatchConfig,ka=0,xn=null,zn=null,Yn=null,Hu=!1,ol=!1,ll=0,c_=0;function sr(){throw Error(t(321))}function of(i,o){if(o===null)return!1;for(var d=0;d<o.length&&d<i.length;d++)if(!jn(i[d],o[d]))return!1;return!0}function lf(i,o,d,y,k,M){if(ka=M,xn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Uu.current=i===null||i.memoizedState===null?p_:g_,i=d(y,k),ol){M=0;do{if(ol=!1,ll=0,25<=M)throw Error(t(301));M+=1,Yn=zn=null,o.updateQueue=null,Uu.current=m_,i=d(y,k)}while(ol)}if(Uu.current=Yu,o=zn!==null&&zn.next!==null,ka=0,Yn=zn=xn=null,Hu=!1,o)throw Error(t(300));return i}function uf(){var i=ll!==0;return ll=0,i}function qi(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?xn.memoizedState=Yn=i:Yn=Yn.next=i,Yn}function ni(){if(zn===null){var i=xn.alternate;i=i!==null?i.memoizedState:null}else i=zn.next;var o=Yn===null?xn.memoizedState:Yn.next;if(o!==null)Yn=o,zn=i;else{if(i===null)throw Error(t(310));zn=i,i={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},Yn===null?xn.memoizedState=Yn=i:Yn=Yn.next=i}return Yn}function ul(i,o){return typeof o=="function"?o(i):o}function cf(i){var o=ni(),d=o.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=i;var y=zn,k=y.baseQueue,M=d.pending;if(M!==null){if(k!==null){var $=k.next;k.next=M.next,M.next=$}y.baseQueue=k=M,d.pending=null}if(k!==null){M=k.next,y=y.baseState;var ue=$=null,me=null,Ae=M;do{var Ye=Ae.lane;if((ka&Ye)===Ye)me!==null&&(me=me.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),y=Ae.hasEagerState?Ae.eagerState:i(y,Ae.action);else{var Qe={lane:Ye,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};me===null?(ue=me=Qe,$=y):me=me.next=Qe,xn.lanes|=Ye,Ta|=Ye}Ae=Ae.next}while(Ae!==null&&Ae!==M);me===null?$=y:me.next=ue,jn(y,o.memoizedState)||(Er=!0),o.memoizedState=y,o.baseState=$,o.baseQueue=me,d.lastRenderedState=y}if(i=d.interleaved,i!==null){k=i;do M=k.lane,xn.lanes|=M,Ta|=M,k=k.next;while(k!==i)}else k===null&&(d.lanes=0);return[o.memoizedState,d.dispatch]}function hf(i){var o=ni(),d=o.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=i;var y=d.dispatch,k=d.pending,M=o.memoizedState;if(k!==null){d.pending=null;var $=k=k.next;do M=i(M,$.action),$=$.next;while($!==k);jn(M,o.memoizedState)||(Er=!0),o.memoizedState=M,o.baseQueue===null&&(o.baseState=M),d.lastRenderedState=M}return[M,y]}function eg(){}function tg(i,o){var d=xn,y=ni(),k=o(),M=!jn(y.memoizedState,k);if(M&&(y.memoizedState=k,Er=!0),y=y.queue,ff(ig.bind(null,d,y,i),[i]),y.getSnapshot!==o||M||Yn!==null&&Yn.memoizedState.tag&1){if(d.flags|=2048,cl(9,rg.bind(null,d,y,k,o),void 0,null),qn===null)throw Error(t(349));(ka&30)!==0||ng(d,o,k)}return k}function ng(i,o,d){i.flags|=16384,i={getSnapshot:o,value:d},o=xn.updateQueue,o===null?(o={lastEffect:null,stores:null},xn.updateQueue=o,o.stores=[i]):(d=o.stores,d===null?o.stores=[i]:d.push(i))}function rg(i,o,d,y){o.value=d,o.getSnapshot=y,sg(o)&&ag(i)}function ig(i,o,d){return d(function(){sg(o)&&ag(i)})}function sg(i){var o=i.getSnapshot;i=i.value;try{var d=o();return!jn(i,d)}catch{return!0}}function ag(i){var o=ps(i,1);o!==null&&bi(o,i,1,-1)}function og(i){var o=qi();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ul,lastRenderedState:i},o.queue=i,i=i.dispatch=d_.bind(null,xn,i),[o.memoizedState,i]}function cl(i,o,d,y){return i={tag:i,create:o,destroy:d,deps:y,next:null},o=xn.updateQueue,o===null?(o={lastEffect:null,stores:null},xn.updateQueue=o,o.lastEffect=i.next=i):(d=o.lastEffect,d===null?o.lastEffect=i.next=i:(y=d.next,d.next=i,i.next=y,o.lastEffect=i)),i}function lg(){return ni().memoizedState}function Xu(i,o,d,y){var k=qi();xn.flags|=i,k.memoizedState=cl(1|o,d,void 0,y===void 0?null:y)}function Gu(i,o,d,y){var k=ni();y=y===void 0?null:y;var M=void 0;if(zn!==null){var $=zn.memoizedState;if(M=$.destroy,y!==null&&of(y,$.deps)){k.memoizedState=cl(o,d,M,y);return}}xn.flags|=i,k.memoizedState=cl(1|o,d,M,y)}function ug(i,o){return Xu(8390656,8,i,o)}function ff(i,o){return Gu(2048,8,i,o)}function cg(i,o){return Gu(4,2,i,o)}function hg(i,o){return Gu(4,4,i,o)}function fg(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function dg(i,o,d){return d=d!=null?d.concat([i]):null,Gu(4,4,fg.bind(null,o,i),d)}function df(){}function pg(i,o){var d=ni();o=o===void 0?null:o;var y=d.memoizedState;return y!==null&&o!==null&&of(o,y[1])?y[0]:(d.memoizedState=[i,o],i)}function gg(i,o){var d=ni();o=o===void 0?null:o;var y=d.memoizedState;return y!==null&&o!==null&&of(o,y[1])?y[0]:(i=i(),d.memoizedState=[i,o],i)}function mg(i,o,d){return(ka&21)===0?(i.baseState&&(i.baseState=!1,Er=!0),i.memoizedState=d):(jn(d,o)||(d=As(),xn.lanes|=d,Ta|=d,i.baseState=!0),o)}function h_(i,o){var d=Vt;Vt=d!==0&&4>d?d:4,i(!0);var y=af.transition;af.transition={};try{i(!1),o()}finally{Vt=d,af.transition=y}}function vg(){return ni().memoizedState}function f_(i,o,d){var y=Ks(i);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},yg(i))_g(o,d);else if(d=Kp(i,o,d,y),d!==null){var k=pr();bi(d,i,y,k),xg(d,o,y)}}function d_(i,o,d){var y=Ks(i),k={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(yg(i))_g(o,k);else{var M=i.alternate;if(i.lanes===0&&(M===null||M.lanes===0)&&(M=o.lastRenderedReducer,M!==null))try{var $=o.lastRenderedState,ue=M($,d);if(k.hasEagerState=!0,k.eagerState=ue,jn(ue,$)){var me=o.interleaved;me===null?(k.next=k,$h(o)):(k.next=me.next,me.next=k),o.interleaved=k;return}}catch{}finally{}d=Kp(i,o,k,y),d!==null&&(k=pr(),bi(d,i,y,k),xg(d,o,y))}}function yg(i){var o=i.alternate;return i===xn||o!==null&&o===xn}function _g(i,o){ol=Hu=!0;var d=i.pending;d===null?o.next=o:(o.next=d.next,d.next=o),i.pending=o}function xg(i,o,d){if((d&4194240)!==0){var y=o.lanes;y&=i.pendingLanes,d|=y,o.lanes=d,Bi(i,d)}}var Yu={readContext:ti,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useInsertionEffect:sr,useLayoutEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useMutableSource:sr,useSyncExternalStore:sr,useId:sr,unstable_isNewReconciler:!1},p_={readContext:ti,useCallback:function(i,o){return qi().memoizedState=[i,o===void 0?null:o],i},useContext:ti,useEffect:ug,useImperativeHandle:function(i,o,d){return d=d!=null?d.concat([i]):null,Xu(4194308,4,fg.bind(null,o,i),d)},useLayoutEffect:function(i,o){return Xu(4194308,4,i,o)},useInsertionEffect:function(i,o){return Xu(4,2,i,o)},useMemo:function(i,o){var d=qi();return o=o===void 0?null:o,i=i(),d.memoizedState=[i,o],i},useReducer:function(i,o,d){var y=qi();return o=d!==void 0?d(o):o,y.memoizedState=y.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},y.queue=i,i=i.dispatch=f_.bind(null,xn,i),[y.memoizedState,i]},useRef:function(i){var o=qi();return i={current:i},o.memoizedState=i},useState:og,useDebugValue:df,useDeferredValue:function(i){return qi().memoizedState=i},useTransition:function(){var i=og(!1),o=i[0];return i=h_.bind(null,i[1]),qi().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,d){var y=xn,k=qi();if(gn){if(d===void 0)throw Error(t(407));d=d()}else{if(d=o(),qn===null)throw Error(t(349));(ka&30)!==0||ng(y,o,d)}k.memoizedState=d;var M={value:d,getSnapshot:o};return k.queue=M,ug(ig.bind(null,y,M,i),[i]),y.flags|=2048,cl(9,rg.bind(null,y,M,d,o),void 0,null),d},useId:function(){var i=qi(),o=qn.identifierPrefix;if(gn){var d=ds,y=fs;d=(y&~(1<<32-qt(y)-1)).toString(32)+d,o=":"+o+"R"+d,d=ll++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=c_++,o=":"+o+"r"+d.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},g_={readContext:ti,useCallback:pg,useContext:ti,useEffect:ff,useImperativeHandle:dg,useInsertionEffect:cg,useLayoutEffect:hg,useMemo:gg,useReducer:cf,useRef:lg,useState:function(){return cf(ul)},useDebugValue:df,useDeferredValue:function(i){var o=ni();return mg(o,zn.memoizedState,i)},useTransition:function(){var i=cf(ul)[0],o=ni().memoizedState;return[i,o]},useMutableSource:eg,useSyncExternalStore:tg,useId:vg,unstable_isNewReconciler:!1},m_={readContext:ti,useCallback:pg,useContext:ti,useEffect:ff,useImperativeHandle:dg,useInsertionEffect:cg,useLayoutEffect:hg,useMemo:gg,useReducer:hf,useRef:lg,useState:function(){return hf(ul)},useDebugValue:df,useDeferredValue:function(i){var o=ni();return zn===null?o.memoizedState=i:mg(o,zn.memoizedState,i)},useTransition:function(){var i=hf(ul)[0],o=ni().memoizedState;return[i,o]},useMutableSource:eg,useSyncExternalStore:tg,useId:vg,unstable_isNewReconciler:!1};function _i(i,o){if(i&&i.defaultProps){o=Ze({},o),i=i.defaultProps;for(var d in i)o[d]===void 0&&(o[d]=i[d]);return o}return o}function pf(i,o,d,y){o=i.memoizedState,d=d(y,o),d=d==null?o:Ze({},o,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var qu={isMounted:function(i){return(i=i._reactInternals)?We(i)===i:!1},enqueueSetState:function(i,o,d){i=i._reactInternals;var y=pr(),k=Ks(i),M=gs(y,k);M.payload=o,d!=null&&(M.callback=d),o=Xs(i,M,k),o!==null&&(bi(o,i,k,y),zu(o,i,k))},enqueueReplaceState:function(i,o,d){i=i._reactInternals;var y=pr(),k=Ks(i),M=gs(y,k);M.tag=1,M.payload=o,d!=null&&(M.callback=d),o=Xs(i,M,k),o!==null&&(bi(o,i,k,y),zu(o,i,k))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var d=pr(),y=Ks(i),k=gs(d,y);k.tag=2,o!=null&&(k.callback=o),o=Xs(i,k,y),o!==null&&(bi(o,i,y,d),zu(o,i,y))}};function wg(i,o,d,y,k,M,$){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(y,M,$):o.prototype&&o.prototype.isPureReactComponent?!oe(d,y)||!oe(k,M):!0}function bg(i,o,d){var y=!1,k=Ws,M=o.contextType;return typeof M=="object"&&M!==null?M=ti(M):(k=Tr(o)?xa:ir.current,y=o.contextTypes,M=(y=y!=null)?oo(i,k):Ws),o=new o(d,M),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=qu,i.stateNode=o,o._reactInternals=i,y&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=k,i.__reactInternalMemoizedMaskedChildContext=M),o}function Sg(i,o,d,y){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,y),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,y),o.state!==i&&qu.enqueueReplaceState(o,o.state,null)}function gf(i,o,d,y){var k=i.stateNode;k.props=d,k.state=i.memoizedState,k.refs={},ef(i);var M=o.contextType;typeof M=="object"&&M!==null?k.context=ti(M):(M=Tr(o)?xa:ir.current,k.context=oo(i,M)),k.state=i.memoizedState,M=o.getDerivedStateFromProps,typeof M=="function"&&(pf(i,o,M,d),k.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(o=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),o!==k.state&&qu.enqueueReplaceState(k,k.state,null),Vu(i,d,k,y),k.state=i.memoizedState),typeof k.componentDidMount=="function"&&(i.flags|=4194308)}function mo(i,o){try{var d="",y=o;do d+=pt(y),y=y.return;while(y);var k=d}catch(M){k=`
Error generating stack: `+M.message+`
`+M.stack}return{value:i,source:o,stack:k,digest:null}}function mf(i,o,d){return{value:i,source:null,stack:d??null,digest:o??null}}function vf(i,o){try{console.error(o.value)}catch(d){setTimeout(function(){throw d})}}var v_=typeof WeakMap=="function"?WeakMap:Map;function Cg(i,o,d){d=gs(-1,d),d.tag=3,d.payload={element:null};var y=o.value;return d.callback=function(){tc||(tc=!0,If=y),vf(i,o)},d}function kg(i,o,d){d=gs(-1,d),d.tag=3;var y=i.type.getDerivedStateFromError;if(typeof y=="function"){var k=o.value;d.payload=function(){return y(k)},d.callback=function(){vf(i,o)}}var M=i.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(d.callback=function(){vf(i,o),typeof y!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var $=o.stack;this.componentDidCatch(o.value,{componentStack:$!==null?$:""})}),d}function Tg(i,o,d){var y=i.pingCache;if(y===null){y=i.pingCache=new v_;var k=new Set;y.set(o,k)}else k=y.get(o),k===void 0&&(k=new Set,y.set(o,k));k.has(d)||(k.add(d),i=M_.bind(null,i,o,d),o.then(i,i))}function Eg(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Og(i,o,d,y,k){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(o=gs(-1,1),o.tag=2,Xs(d,o,1))),d.lanes|=1),i):(i.flags|=65536,i.lanes=k,i)}var y_=ve.ReactCurrentOwner,Er=!1;function dr(i,o,d,y){o.child=i===null?qp(o,null,d,y):ho(o,i.child,d,y)}function Pg(i,o,d,y,k){d=d.render;var M=o.ref;return po(o,k),y=lf(i,o,d,y,M,k),d=uf(),i!==null&&!Er?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~k,ms(i,o,k)):(gn&&d&&Hh(o),o.flags|=1,dr(i,o,y,k),o.child)}function Ag(i,o,d,y,k){if(i===null){var M=d.type;return typeof M=="function"&&!Bf(M)&&M.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(o.tag=15,o.type=M,Mg(i,o,M,y,k)):(i=oc(d.type,null,y,o,o.mode,k),i.ref=o.ref,i.return=o,o.child=i)}if(M=i.child,(i.lanes&k)===0){var $=M.memoizedProps;if(d=d.compare,d=d!==null?d:oe,d($,y)&&i.ref===o.ref)return ms(i,o,k)}return o.flags|=1,i=Qs(M,y),i.ref=o.ref,i.return=o,o.child=i}function Mg(i,o,d,y,k){if(i!==null){var M=i.memoizedProps;if(oe(M,y)&&i.ref===o.ref)if(Er=!1,o.pendingProps=y=M,(i.lanes&k)!==0)(i.flags&131072)!==0&&(Er=!0);else return o.lanes=i.lanes,ms(i,o,k)}return yf(i,o,d,y,k)}function Ig(i,o,d){var y=o.pendingProps,k=y.children,M=i!==null?i.memoizedState:null;if(y.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(yo,Xr),Xr|=d;else{if((d&1073741824)===0)return i=M!==null?M.baseLanes|d:d,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,un(yo,Xr),Xr|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=M!==null?M.baseLanes:d,un(yo,Xr),Xr|=y}else M!==null?(y=M.baseLanes|d,o.memoizedState=null):y=d,un(yo,Xr),Xr|=y;return dr(i,o,k,d),o.child}function jg(i,o){var d=o.ref;(i===null&&d!==null||i!==null&&i.ref!==d)&&(o.flags|=512,o.flags|=2097152)}function yf(i,o,d,y,k){var M=Tr(d)?xa:ir.current;return M=oo(o,M),po(o,k),d=lf(i,o,d,y,M,k),y=uf(),i!==null&&!Er?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~k,ms(i,o,k)):(gn&&y&&Hh(o),o.flags|=1,dr(i,o,d,k),o.child)}function Lg(i,o,d,y,k){if(Tr(d)){var M=!0;Iu(o)}else M=!1;if(po(o,k),o.stateNode===null)Zu(i,o),bg(o,d,y),gf(o,d,y,k),y=!0;else if(i===null){var $=o.stateNode,ue=o.memoizedProps;$.props=ue;var me=$.context,Ae=d.contextType;typeof Ae=="object"&&Ae!==null?Ae=ti(Ae):(Ae=Tr(d)?xa:ir.current,Ae=oo(o,Ae));var Ye=d.getDerivedStateFromProps,Qe=typeof Ye=="function"||typeof $.getSnapshotBeforeUpdate=="function";Qe||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==y||me!==Ae)&&Sg(o,$,y,Ae),Hs=!1;var Ue=o.memoizedState;$.state=Ue,Vu(o,y,$,k),me=o.memoizedState,ue!==y||Ue!==me||kr.current||Hs?(typeof Ye=="function"&&(pf(o,d,Ye,y),me=o.memoizedState),(ue=Hs||wg(o,d,ue,y,Ue,me,Ae))?(Qe||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(o.flags|=4194308)):(typeof $.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=y,o.memoizedState=me),$.props=y,$.state=me,$.context=Ae,y=ue):(typeof $.componentDidMount=="function"&&(o.flags|=4194308),y=!1)}else{$=o.stateNode,Zp(i,o),ue=o.memoizedProps,Ae=o.type===o.elementType?ue:_i(o.type,ue),$.props=Ae,Qe=o.pendingProps,Ue=$.context,me=d.contextType,typeof me=="object"&&me!==null?me=ti(me):(me=Tr(d)?xa:ir.current,me=oo(o,me));var lt=d.getDerivedStateFromProps;(Ye=typeof lt=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==Qe||Ue!==me)&&Sg(o,$,y,me),Hs=!1,Ue=o.memoizedState,$.state=Ue,Vu(o,y,$,k);var ft=o.memoizedState;ue!==Qe||Ue!==ft||kr.current||Hs?(typeof lt=="function"&&(pf(o,d,lt,y),ft=o.memoizedState),(Ae=Hs||wg(o,d,Ae,y,Ue,ft,me)||!1)?(Ye||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(y,ft,me),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(y,ft,me)),typeof $.componentDidUpdate=="function"&&(o.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof $.componentDidUpdate!="function"||ue===i.memoizedProps&&Ue===i.memoizedState||(o.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===i.memoizedProps&&Ue===i.memoizedState||(o.flags|=1024),o.memoizedProps=y,o.memoizedState=ft),$.props=y,$.state=ft,$.context=me,y=Ae):(typeof $.componentDidUpdate!="function"||ue===i.memoizedProps&&Ue===i.memoizedState||(o.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===i.memoizedProps&&Ue===i.memoizedState||(o.flags|=1024),y=!1)}return _f(i,o,d,y,M,k)}function _f(i,o,d,y,k,M){jg(i,o);var $=(o.flags&128)!==0;if(!y&&!$)return k&&Bp(o,d,!1),ms(i,o,M);y=o.stateNode,y_.current=o;var ue=$&&typeof d.getDerivedStateFromError!="function"?null:y.render();return o.flags|=1,i!==null&&$?(o.child=ho(o,i.child,null,M),o.child=ho(o,null,ue,M)):dr(i,o,ue,M),o.memoizedState=y.state,k&&Bp(o,d,!0),o.child}function Dg(i){var o=i.stateNode;o.pendingContext?Fp(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Fp(i,o.context,!1),tf(i,o.containerInfo)}function Rg(i,o,d,y,k){return co(),qh(k),o.flags|=256,dr(i,o,d,y),o.child}var xf={dehydrated:null,treeContext:null,retryLane:0};function wf(i){return{baseLanes:i,cachePool:null,transitions:null}}function Fg(i,o,d){var y=o.pendingProps,k=_n.current,M=!1,$=(o.flags&128)!==0,ue;if((ue=$)||(ue=i!==null&&i.memoizedState===null?!1:(k&2)!==0),ue?(M=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(k|=1),un(_n,k&1),i===null)return Yh(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):($=y.children,i=y.fallback,M?(y=o.mode,M=o.child,$={mode:"hidden",children:$},(y&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=$):M=lc($,y,0,null),i=Aa(i,y,d,null),M.return=o,i.return=o,M.sibling=i,o.child=M,o.child.memoizedState=wf(d),o.memoizedState=xf,i):bf(o,$));if(k=i.memoizedState,k!==null&&(ue=k.dehydrated,ue!==null))return __(i,o,$,y,ue,k,d);if(M){M=y.fallback,$=o.mode,k=i.child,ue=k.sibling;var me={mode:"hidden",children:y.children};return($&1)===0&&o.child!==k?(y=o.child,y.childLanes=0,y.pendingProps=me,o.deletions=null):(y=Qs(k,me),y.subtreeFlags=k.subtreeFlags&14680064),ue!==null?M=Qs(ue,M):(M=Aa(M,$,d,null),M.flags|=2),M.return=o,y.return=o,y.sibling=M,o.child=y,y=M,M=o.child,$=i.child.memoizedState,$=$===null?wf(d):{baseLanes:$.baseLanes|d,cachePool:null,transitions:$.transitions},M.memoizedState=$,M.childLanes=i.childLanes&~d,o.memoizedState=xf,y}return M=i.child,i=M.sibling,y=Qs(M,{mode:"visible",children:y.children}),(o.mode&1)===0&&(y.lanes=d),y.return=o,y.sibling=null,i!==null&&(d=o.deletions,d===null?(o.deletions=[i],o.flags|=16):d.push(i)),o.child=y,o.memoizedState=null,y}function bf(i,o){return o=lc({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Ku(i,o,d,y){return y!==null&&qh(y),ho(o,i.child,null,d),i=bf(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function __(i,o,d,y,k,M,$){if(d)return o.flags&256?(o.flags&=-257,y=mf(Error(t(422))),Ku(i,o,$,y)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(M=y.fallback,k=o.mode,y=lc({mode:"visible",children:y.children},k,0,null),M=Aa(M,k,$,null),M.flags|=2,y.return=o,M.return=o,y.sibling=M,o.child=y,(o.mode&1)!==0&&ho(o,i.child,null,$),o.child.memoizedState=wf($),o.memoizedState=xf,M);if((o.mode&1)===0)return Ku(i,o,$,null);if(k.data==="$!"){if(y=k.nextSibling&&k.nextSibling.dataset,y)var ue=y.dgst;return y=ue,M=Error(t(419)),y=mf(M,y,void 0),Ku(i,o,$,y)}if(ue=($&i.childLanes)!==0,Er||ue){if(y=qn,y!==null){switch($&-$){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(y.suspendedLanes|$))!==0?0:k,k!==0&&k!==M.retryLane&&(M.retryLane=k,ps(i,k),bi(y,i,k,-1))}return Nf(),y=mf(Error(t(421))),Ku(i,o,$,y)}return k.data==="$?"?(o.flags|=128,o.child=i.child,o=I_.bind(null,i),k._reactRetry=o,null):(i=M.treeContext,Hr=zs(k.nextSibling),Ur=o,gn=!0,yi=null,i!==null&&($r[ei++]=fs,$r[ei++]=ds,$r[ei++]=wa,fs=i.id,ds=i.overflow,wa=o),o=bf(o,y.children),o.flags|=4096,o)}function Ng(i,o,d){i.lanes|=o;var y=i.alternate;y!==null&&(y.lanes|=o),Jh(i.return,o,d)}function Sf(i,o,d,y,k){var M=i.memoizedState;M===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:k}:(M.isBackwards=o,M.rendering=null,M.renderingStartTime=0,M.last=y,M.tail=d,M.tailMode=k)}function Bg(i,o,d){var y=o.pendingProps,k=y.revealOrder,M=y.tail;if(dr(i,o,y.children,d),y=_n.current,(y&2)!==0)y=y&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ng(i,d,o);else if(i.tag===19)Ng(i,d,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}y&=1}if(un(_n,y),(o.mode&1)===0)o.memoizedState=null;else switch(k){case"forwards":for(d=o.child,k=null;d!==null;)i=d.alternate,i!==null&&Wu(i)===null&&(k=d),d=d.sibling;d=k,d===null?(k=o.child,o.child=null):(k=d.sibling,d.sibling=null),Sf(o,!1,k,d,M);break;case"backwards":for(d=null,k=o.child,o.child=null;k!==null;){if(i=k.alternate,i!==null&&Wu(i)===null){o.child=k;break}i=k.sibling,k.sibling=d,d=k,k=i}Sf(o,!0,d,null,M);break;case"together":Sf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Zu(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function ms(i,o,d){if(i!==null&&(o.dependencies=i.dependencies),Ta|=o.lanes,(d&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,d=Qs(i,i.pendingProps),o.child=d,d.return=o;i.sibling!==null;)i=i.sibling,d=d.sibling=Qs(i,i.pendingProps),d.return=o;d.sibling=null}return o.child}function x_(i,o,d){switch(o.tag){case 3:Dg(o),co();break;case 5:$p(o);break;case 1:Tr(o.type)&&Iu(o);break;case 4:tf(o,o.stateNode.containerInfo);break;case 10:var y=o.type._context,k=o.memoizedProps.value;un(Nu,y._currentValue),y._currentValue=k;break;case 13:if(y=o.memoizedState,y!==null)return y.dehydrated!==null?(un(_n,_n.current&1),o.flags|=128,null):(d&o.child.childLanes)!==0?Fg(i,o,d):(un(_n,_n.current&1),i=ms(i,o,d),i!==null?i.sibling:null);un(_n,_n.current&1);break;case 19:if(y=(d&o.childLanes)!==0,(i.flags&128)!==0){if(y)return Bg(i,o,d);o.flags|=128}if(k=o.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),un(_n,_n.current),y)break;return null;case 22:case 23:return o.lanes=0,Ig(i,o,d)}return ms(i,o,d)}var zg,Cf,Vg,Wg;zg=function(i,o){for(var d=o.child;d!==null;){if(d.tag===5||d.tag===6)i.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Cf=function(){},Vg=function(i,o,d,y){var k=i.memoizedProps;if(k!==y){i=o.stateNode,Ca(Yi.current);var M=null;switch(d){case"input":k=Es(i,k),y=Es(i,y),M=[];break;case"select":k=Ze({},k,{value:void 0}),y=Ze({},y,{value:void 0}),M=[];break;case"textarea":k=fi(i,k),y=fi(i,y),M=[];break;default:typeof k.onClick!="function"&&typeof y.onClick=="function"&&(i.onclick=Pu)}R(d,y);var $;d=null;for(Ae in k)if(!y.hasOwnProperty(Ae)&&k.hasOwnProperty(Ae)&&k[Ae]!=null)if(Ae==="style"){var ue=k[Ae];for($ in ue)ue.hasOwnProperty($)&&(d||(d={}),d[$]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(s.hasOwnProperty(Ae)?M||(M=[]):(M=M||[]).push(Ae,null));for(Ae in y){var me=y[Ae];if(ue=k?.[Ae],y.hasOwnProperty(Ae)&&me!==ue&&(me!=null||ue!=null))if(Ae==="style")if(ue){for($ in ue)!ue.hasOwnProperty($)||me&&me.hasOwnProperty($)||(d||(d={}),d[$]="");for($ in me)me.hasOwnProperty($)&&ue[$]!==me[$]&&(d||(d={}),d[$]=me[$])}else d||(M||(M=[]),M.push(Ae,d)),d=me;else Ae==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,ue=ue?ue.__html:void 0,me!=null&&ue!==me&&(M=M||[]).push(Ae,me)):Ae==="children"?typeof me!="string"&&typeof me!="number"||(M=M||[]).push(Ae,""+me):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ae)?(me!=null&&Ae==="onScroll"&&hn("scroll",i),M||ue===me||(M=[])):(M=M||[]).push(Ae,me))}d&&(M=M||[]).push("style",d);var Ae=M;(o.updateQueue=Ae)&&(o.flags|=4)}},Wg=function(i,o,d,y){d!==y&&(o.flags|=4)};function hl(i,o){if(!gn)switch(i.tailMode){case"hidden":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:y.sibling=null}}function ar(i){var o=i.alternate!==null&&i.alternate.child===i.child,d=0,y=0;if(o)for(var k=i.child;k!==null;)d|=k.lanes|k.childLanes,y|=k.subtreeFlags&14680064,y|=k.flags&14680064,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)d|=k.lanes|k.childLanes,y|=k.subtreeFlags,y|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=y,i.childLanes=d,o}function w_(i,o,d){var y=o.pendingProps;switch(Xh(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ar(o),null;case 1:return Tr(o.type)&&Mu(),ar(o),null;case 3:return y=o.stateNode,go(),fn(kr),fn(ir),sf(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(i===null||i.child===null)&&(Ru(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,yi!==null&&(Df(yi),yi=null))),Cf(i,o),ar(o),null;case 5:nf(o);var k=Ca(al.current);if(d=o.type,i!==null&&o.stateNode!=null)Vg(i,o,d,y,k),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!y){if(o.stateNode===null)throw Error(t(166));return ar(o),null}if(i=Ca(Yi.current),Ru(o)){y=o.stateNode,d=o.type;var M=o.memoizedProps;switch(y[Gi]=o,y[tl]=M,i=(o.mode&1)!==0,d){case"dialog":hn("cancel",y),hn("close",y);break;case"iframe":case"object":case"embed":hn("load",y);break;case"video":case"audio":for(k=0;k<Jo.length;k++)hn(Jo[k],y);break;case"source":hn("error",y);break;case"img":case"image":case"link":hn("error",y),hn("load",y);break;case"details":hn("toggle",y);break;case"input":Di(y,M),hn("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!M.multiple},hn("invalid",y);break;case"textarea":Gt(y,M),hn("invalid",y)}R(d,M),k=null;for(var $ in M)if(M.hasOwnProperty($)){var ue=M[$];$==="children"?typeof ue=="string"?y.textContent!==ue&&(M.suppressHydrationWarning!==!0&&Ou(y.textContent,ue,i),k=["children",ue]):typeof ue=="number"&&y.textContent!==""+ue&&(M.suppressHydrationWarning!==!0&&Ou(y.textContent,ue,i),k=["children",""+ue]):s.hasOwnProperty($)&&ue!=null&&$==="onScroll"&&hn("scroll",y)}switch(d){case"input":en(y),Ri(y,M,!0);break;case"textarea":en(y),Ft(y);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(y.onclick=Pu)}y=k,o.updateQueue=y,y!==null&&(o.flags|=4)}else{$=k.nodeType===9?k:k.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=r(d)),i==="http://www.w3.org/1999/xhtml"?d==="script"?(i=$.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof y.is=="string"?i=$.createElement(d,{is:y.is}):(i=$.createElement(d),d==="select"&&($=i,y.multiple?$.multiple=!0:y.size&&($.size=y.size))):i=$.createElementNS(i,d),i[Gi]=o,i[tl]=y,zg(i,o,!1,!1),o.stateNode=i;e:{switch($=B(d,y),d){case"dialog":hn("cancel",i),hn("close",i),k=y;break;case"iframe":case"object":case"embed":hn("load",i),k=y;break;case"video":case"audio":for(k=0;k<Jo.length;k++)hn(Jo[k],i);k=y;break;case"source":hn("error",i),k=y;break;case"img":case"image":case"link":hn("error",i),hn("load",i),k=y;break;case"details":hn("toggle",i),k=y;break;case"input":Di(i,y),k=Es(i,y),hn("invalid",i);break;case"option":k=y;break;case"select":i._wrapperState={wasMultiple:!!y.multiple},k=Ze({},y,{value:void 0}),hn("invalid",i);break;case"textarea":Gt(i,y),k=fi(i,y),hn("invalid",i);break;default:k=y}R(d,k),ue=k;for(M in ue)if(ue.hasOwnProperty(M)){var me=ue[M];M==="style"?T(i,me):M==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&g(i,me)):M==="children"?typeof me=="string"?(d!=="textarea"||me!=="")&&m(i,me):typeof me=="number"&&m(i,""+me):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(s.hasOwnProperty(M)?me!=null&&M==="onScroll"&&hn("scroll",i):me!=null&&le(i,M,me,$))}switch(d){case"input":en(i),Ri(i,y,!1);break;case"textarea":en(i),Ft(i);break;case"option":y.value!=null&&i.setAttribute("value",""+Ut(y.value));break;case"select":i.multiple=!!y.multiple,M=y.value,M!=null?tn(i,!!y.multiple,M,!1):y.defaultValue!=null&&tn(i,!!y.multiple,y.defaultValue,!0);break;default:typeof k.onClick=="function"&&(i.onclick=Pu)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return ar(o),null;case 6:if(i&&o.stateNode!=null)Wg(i,o,i.memoizedProps,y);else{if(typeof y!="string"&&o.stateNode===null)throw Error(t(166));if(d=Ca(al.current),Ca(Yi.current),Ru(o)){if(y=o.stateNode,d=o.memoizedProps,y[Gi]=o,(M=y.nodeValue!==d)&&(i=Ur,i!==null))switch(i.tag){case 3:Ou(y.nodeValue,d,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Ou(y.nodeValue,d,(i.mode&1)!==0)}M&&(o.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[Gi]=o,o.stateNode=y}return ar(o),null;case 13:if(fn(_n),y=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(gn&&Hr!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Xp(),co(),o.flags|=98560,M=!1;else if(M=Ru(o),y!==null&&y.dehydrated!==null){if(i===null){if(!M)throw Error(t(318));if(M=o.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(t(317));M[Gi]=o}else co(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ar(o),M=!1}else yi!==null&&(Df(yi),yi=null),M=!0;if(!M)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=d,o):(y=y!==null,y!==(i!==null&&i.memoizedState!==null)&&y&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(_n.current&1)!==0?Vn===0&&(Vn=3):Nf())),o.updateQueue!==null&&(o.flags|=4),ar(o),null);case 4:return go(),Cf(i,o),i===null&&$o(o.stateNode.containerInfo),ar(o),null;case 10:return Qh(o.type._context),ar(o),null;case 17:return Tr(o.type)&&Mu(),ar(o),null;case 19:if(fn(_n),M=o.memoizedState,M===null)return ar(o),null;if(y=(o.flags&128)!==0,$=M.rendering,$===null)if(y)hl(M,!1);else{if(Vn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if($=Wu(i),$!==null){for(o.flags|=128,hl(M,!1),y=$.updateQueue,y!==null&&(o.updateQueue=y,o.flags|=4),o.subtreeFlags=0,y=d,d=o.child;d!==null;)M=d,i=y,M.flags&=14680066,$=M.alternate,$===null?(M.childLanes=0,M.lanes=i,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=$.childLanes,M.lanes=$.lanes,M.child=$.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=$.memoizedProps,M.memoizedState=$.memoizedState,M.updateQueue=$.updateQueue,M.type=$.type,i=$.dependencies,M.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),d=d.sibling;return un(_n,_n.current&1|2),o.child}i=i.sibling}M.tail!==null&&ot()>_o&&(o.flags|=128,y=!0,hl(M,!1),o.lanes=4194304)}else{if(!y)if(i=Wu($),i!==null){if(o.flags|=128,y=!0,d=i.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),hl(M,!0),M.tail===null&&M.tailMode==="hidden"&&!$.alternate&&!gn)return ar(o),null}else 2*ot()-M.renderingStartTime>_o&&d!==1073741824&&(o.flags|=128,y=!0,hl(M,!1),o.lanes=4194304);M.isBackwards?($.sibling=o.child,o.child=$):(d=M.last,d!==null?d.sibling=$:o.child=$,M.last=$)}return M.tail!==null?(o=M.tail,M.rendering=o,M.tail=o.sibling,M.renderingStartTime=ot(),o.sibling=null,d=_n.current,un(_n,y?d&1|2:d&1),o):(ar(o),null);case 22:case 23:return Ff(),y=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==y&&(o.flags|=8192),y&&(o.mode&1)!==0?(Xr&1073741824)!==0&&(ar(o),o.subtreeFlags&6&&(o.flags|=8192)):ar(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function b_(i,o){switch(Xh(o),o.tag){case 1:return Tr(o.type)&&Mu(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return go(),fn(kr),fn(ir),sf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return nf(o),null;case 13:if(fn(_n),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));co()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return fn(_n),null;case 4:return go(),null;case 10:return Qh(o.type._context),null;case 22:case 23:return Ff(),null;case 24:return null;default:return null}}var Qu=!1,or=!1,S_=typeof WeakSet=="function"?WeakSet:Set,ht=null;function vo(i,o){var d=i.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){Tn(i,o,y)}else d.current=null}function kf(i,o,d){try{d()}catch(y){Tn(i,o,y)}}var Ug=!1;function C_(i,o){if(Rh=Kr,i=St(),kt(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var k=y.anchorOffset,M=y.focusNode;y=y.focusOffset;try{d.nodeType,M.nodeType}catch{d=null;break e}var $=0,ue=-1,me=-1,Ae=0,Ye=0,Qe=i,Ue=null;t:for(;;){for(var lt;Qe!==d||k!==0&&Qe.nodeType!==3||(ue=$+k),Qe!==M||y!==0&&Qe.nodeType!==3||(me=$+y),Qe.nodeType===3&&($+=Qe.nodeValue.length),(lt=Qe.firstChild)!==null;)Ue=Qe,Qe=lt;for(;;){if(Qe===i)break t;if(Ue===d&&++Ae===k&&(ue=$),Ue===M&&++Ye===y&&(me=$),(lt=Qe.nextSibling)!==null)break;Qe=Ue,Ue=Qe.parentNode}Qe=lt}d=ue===-1||me===-1?null:{start:ue,end:me}}else d=null}d=d||{start:0,end:0}}else d=null;for(Fh={focusedElem:i,selectionRange:d},Kr=!1,ht=o;ht!==null;)if(o=ht,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,ht=i;else for(;ht!==null;){o=ht;try{var ft=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var gt=ft.memoizedProps,An=ft.memoizedState,ke=o.stateNode,_e=ke.getSnapshotBeforeUpdate(o.elementType===o.type?gt:_i(o.type,gt),An);ke.__reactInternalSnapshotBeforeUpdate=_e}break;case 3:var Pe=o.stateNode.containerInfo;Pe.nodeType===1?Pe.textContent="":Pe.nodeType===9&&Pe.documentElement&&Pe.removeChild(Pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(nt){Tn(o,o.return,nt)}if(i=o.sibling,i!==null){i.return=o.return,ht=i;break}ht=o.return}return ft=Ug,Ug=!1,ft}function fl(i,o,d){var y=o.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var k=y=y.next;do{if((k.tag&i)===i){var M=k.destroy;k.destroy=void 0,M!==void 0&&kf(o,d,M)}k=k.next}while(k!==y)}}function Ju(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&i)===i){var y=d.create;d.destroy=y()}d=d.next}while(d!==o)}}function Tf(i){var o=i.ref;if(o!==null){var d=i.stateNode;switch(i.tag){case 5:i=d;break;default:i=d}typeof o=="function"?o(i):o.current=i}}function Hg(i){var o=i.alternate;o!==null&&(i.alternate=null,Hg(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Gi],delete o[tl],delete o[Vh],delete o[a_],delete o[o_])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Xg(i){return i.tag===5||i.tag===3||i.tag===4}function Gg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Xg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Ef(i,o,d){var y=i.tag;if(y===5||y===6)i=i.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(i,o):d.insertBefore(i,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(i,d)):(o=d,o.appendChild(i)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=Pu));else if(y!==4&&(i=i.child,i!==null))for(Ef(i,o,d),i=i.sibling;i!==null;)Ef(i,o,d),i=i.sibling}function Of(i,o,d){var y=i.tag;if(y===5||y===6)i=i.stateNode,o?d.insertBefore(i,o):d.appendChild(i);else if(y!==4&&(i=i.child,i!==null))for(Of(i,o,d),i=i.sibling;i!==null;)Of(i,o,d),i=i.sibling}var Qn=null,xi=!1;function Gs(i,o,d){for(d=d.child;d!==null;)Yg(i,o,d),d=d.sibling}function Yg(i,o,d){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(qe,d)}catch{}switch(d.tag){case 5:or||vo(d,o);case 6:var y=Qn,k=xi;Qn=null,Gs(i,o,d),Qn=y,xi=k,Qn!==null&&(xi?(i=Qn,d=d.stateNode,i.nodeType===8?i.parentNode.removeChild(d):i.removeChild(d)):Qn.removeChild(d.stateNode));break;case 18:Qn!==null&&(xi?(i=Qn,d=d.stateNode,i.nodeType===8?zh(i.parentNode,d):i.nodeType===1&&zh(i,d),Kt(i)):zh(Qn,d.stateNode));break;case 4:y=Qn,k=xi,Qn=d.stateNode.containerInfo,xi=!0,Gs(i,o,d),Qn=y,xi=k;break;case 0:case 11:case 14:case 15:if(!or&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){k=y=y.next;do{var M=k,$=M.destroy;M=M.tag,$!==void 0&&((M&2)!==0||(M&4)!==0)&&kf(d,o,$),k=k.next}while(k!==y)}Gs(i,o,d);break;case 1:if(!or&&(vo(d,o),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(ue){Tn(d,o,ue)}Gs(i,o,d);break;case 21:Gs(i,o,d);break;case 22:d.mode&1?(or=(y=or)||d.memoizedState!==null,Gs(i,o,d),or=y):Gs(i,o,d);break;default:Gs(i,o,d)}}function qg(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var d=i.stateNode;d===null&&(d=i.stateNode=new S_),o.forEach(function(y){var k=j_.bind(null,i,y);d.has(y)||(d.add(y),y.then(k,k))})}}function wi(i,o){var d=o.deletions;if(d!==null)for(var y=0;y<d.length;y++){var k=d[y];try{var M=i,$=o,ue=$;e:for(;ue!==null;){switch(ue.tag){case 5:Qn=ue.stateNode,xi=!1;break e;case 3:Qn=ue.stateNode.containerInfo,xi=!0;break e;case 4:Qn=ue.stateNode.containerInfo,xi=!0;break e}ue=ue.return}if(Qn===null)throw Error(t(160));Yg(M,$,k),Qn=null,xi=!1;var me=k.alternate;me!==null&&(me.return=null),k.return=null}catch(Ae){Tn(k,o,Ae)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Kg(o,i),o=o.sibling}function Kg(i,o){var d=i.alternate,y=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(wi(o,i),Ki(i),y&4){try{fl(3,i,i.return),Ju(3,i)}catch(gt){Tn(i,i.return,gt)}try{fl(5,i,i.return)}catch(gt){Tn(i,i.return,gt)}}break;case 1:wi(o,i),Ki(i),y&512&&d!==null&&vo(d,d.return);break;case 5:if(wi(o,i),Ki(i),y&512&&d!==null&&vo(d,d.return),i.flags&32){var k=i.stateNode;try{m(k,"")}catch(gt){Tn(i,i.return,gt)}}if(y&4&&(k=i.stateNode,k!=null)){var M=i.memoizedProps,$=d!==null?d.memoizedProps:M,ue=i.type,me=i.updateQueue;if(i.updateQueue=null,me!==null)try{ue==="input"&&M.type==="radio"&&M.name!=null&&la(k,M),B(ue,$);var Ae=B(ue,M);for($=0;$<me.length;$+=2){var Ye=me[$],Qe=me[$+1];Ye==="style"?T(k,Qe):Ye==="dangerouslySetInnerHTML"?g(k,Qe):Ye==="children"?m(k,Qe):le(k,Ye,Qe,Ae)}switch(ue){case"input":Fr(k,M);break;case"textarea":Os(k,M);break;case"select":var Ue=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!M.multiple;var lt=M.value;lt!=null?tn(k,!!M.multiple,lt,!1):Ue!==!!M.multiple&&(M.defaultValue!=null?tn(k,!!M.multiple,M.defaultValue,!0):tn(k,!!M.multiple,M.multiple?[]:"",!1))}k[tl]=M}catch(gt){Tn(i,i.return,gt)}}break;case 6:if(wi(o,i),Ki(i),y&4){if(i.stateNode===null)throw Error(t(162));k=i.stateNode,M=i.memoizedProps;try{k.nodeValue=M}catch(gt){Tn(i,i.return,gt)}}break;case 3:if(wi(o,i),Ki(i),y&4&&d!==null&&d.memoizedState.isDehydrated)try{Kt(o.containerInfo)}catch(gt){Tn(i,i.return,gt)}break;case 4:wi(o,i),Ki(i);break;case 13:wi(o,i),Ki(i),k=i.child,k.flags&8192&&(M=k.memoizedState!==null,k.stateNode.isHidden=M,!M||k.alternate!==null&&k.alternate.memoizedState!==null||(Mf=ot())),y&4&&qg(i);break;case 22:if(Ye=d!==null&&d.memoizedState!==null,i.mode&1?(or=(Ae=or)||Ye,wi(o,i),or=Ae):wi(o,i),Ki(i),y&8192){if(Ae=i.memoizedState!==null,(i.stateNode.isHidden=Ae)&&!Ye&&(i.mode&1)!==0)for(ht=i,Ye=i.child;Ye!==null;){for(Qe=ht=Ye;ht!==null;){switch(Ue=ht,lt=Ue.child,Ue.tag){case 0:case 11:case 14:case 15:fl(4,Ue,Ue.return);break;case 1:vo(Ue,Ue.return);var ft=Ue.stateNode;if(typeof ft.componentWillUnmount=="function"){y=Ue,d=Ue.return;try{o=y,ft.props=o.memoizedProps,ft.state=o.memoizedState,ft.componentWillUnmount()}catch(gt){Tn(y,d,gt)}}break;case 5:vo(Ue,Ue.return);break;case 22:if(Ue.memoizedState!==null){Jg(Qe);continue}}lt!==null?(lt.return=Ue,ht=lt):Jg(Qe)}Ye=Ye.sibling}e:for(Ye=null,Qe=i;;){if(Qe.tag===5){if(Ye===null){Ye=Qe;try{k=Qe.stateNode,Ae?(M=k.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(ue=Qe.stateNode,me=Qe.memoizedProps.style,$=me!=null&&me.hasOwnProperty("display")?me.display:null,ue.style.display=C("display",$))}catch(gt){Tn(i,i.return,gt)}}}else if(Qe.tag===6){if(Ye===null)try{Qe.stateNode.nodeValue=Ae?"":Qe.memoizedProps}catch(gt){Tn(i,i.return,gt)}}else if((Qe.tag!==22&&Qe.tag!==23||Qe.memoizedState===null||Qe===i)&&Qe.child!==null){Qe.child.return=Qe,Qe=Qe.child;continue}if(Qe===i)break e;for(;Qe.sibling===null;){if(Qe.return===null||Qe.return===i)break e;Ye===Qe&&(Ye=null),Qe=Qe.return}Ye===Qe&&(Ye=null),Qe.sibling.return=Qe.return,Qe=Qe.sibling}}break;case 19:wi(o,i),Ki(i),y&4&&qg(i);break;case 21:break;default:wi(o,i),Ki(i)}}function Ki(i){var o=i.flags;if(o&2){try{e:{for(var d=i.return;d!==null;){if(Xg(d)){var y=d;break e}d=d.return}throw Error(t(160))}switch(y.tag){case 5:var k=y.stateNode;y.flags&32&&(m(k,""),y.flags&=-33);var M=Gg(i);Of(i,M,k);break;case 3:case 4:var $=y.stateNode.containerInfo,ue=Gg(i);Ef(i,ue,$);break;default:throw Error(t(161))}}catch(me){Tn(i,i.return,me)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function k_(i,o,d){ht=i,Zg(i)}function Zg(i,o,d){for(var y=(i.mode&1)!==0;ht!==null;){var k=ht,M=k.child;if(k.tag===22&&y){var $=k.memoizedState!==null||Qu;if(!$){var ue=k.alternate,me=ue!==null&&ue.memoizedState!==null||or;ue=Qu;var Ae=or;if(Qu=$,(or=me)&&!Ae)for(ht=k;ht!==null;)$=ht,me=$.child,$.tag===22&&$.memoizedState!==null?$g(k):me!==null?(me.return=$,ht=me):$g(k);for(;M!==null;)ht=M,Zg(M),M=M.sibling;ht=k,Qu=ue,or=Ae}Qg(i)}else(k.subtreeFlags&8772)!==0&&M!==null?(M.return=k,ht=M):Qg(i)}}function Qg(i){for(;ht!==null;){var o=ht;if((o.flags&8772)!==0){var d=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:or||Ju(5,o);break;case 1:var y=o.stateNode;if(o.flags&4&&!or)if(d===null)y.componentDidMount();else{var k=o.elementType===o.type?d.memoizedProps:_i(o.type,d.memoizedProps);y.componentDidUpdate(k,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var M=o.updateQueue;M!==null&&Jp(o,M,y);break;case 3:var $=o.updateQueue;if($!==null){if(d=null,o.child!==null)switch(o.child.tag){case 5:d=o.child.stateNode;break;case 1:d=o.child.stateNode}Jp(o,$,d)}break;case 5:var ue=o.stateNode;if(d===null&&o.flags&4){d=ue;var me=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&d.focus();break;case"img":me.src&&(d.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ae=o.alternate;if(Ae!==null){var Ye=Ae.memoizedState;if(Ye!==null){var Qe=Ye.dehydrated;Qe!==null&&Kt(Qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}or||o.flags&512&&Tf(o)}catch(Ue){Tn(o,o.return,Ue)}}if(o===i){ht=null;break}if(d=o.sibling,d!==null){d.return=o.return,ht=d;break}ht=o.return}}function Jg(i){for(;ht!==null;){var o=ht;if(o===i){ht=null;break}var d=o.sibling;if(d!==null){d.return=o.return,ht=d;break}ht=o.return}}function $g(i){for(;ht!==null;){var o=ht;try{switch(o.tag){case 0:case 11:case 15:var d=o.return;try{Ju(4,o)}catch(me){Tn(o,d,me)}break;case 1:var y=o.stateNode;if(typeof y.componentDidMount=="function"){var k=o.return;try{y.componentDidMount()}catch(me){Tn(o,k,me)}}var M=o.return;try{Tf(o)}catch(me){Tn(o,M,me)}break;case 5:var $=o.return;try{Tf(o)}catch(me){Tn(o,$,me)}}}catch(me){Tn(o,o.return,me)}if(o===i){ht=null;break}var ue=o.sibling;if(ue!==null){ue.return=o.return,ht=ue;break}ht=o.return}}var T_=Math.ceil,$u=ve.ReactCurrentDispatcher,Pf=ve.ReactCurrentOwner,ri=ve.ReactCurrentBatchConfig,Qt=0,qn=null,Ln=null,Jn=0,Xr=0,yo=Vs(0),Vn=0,dl=null,Ta=0,ec=0,Af=0,pl=null,Or=null,Mf=0,_o=1/0,vs=null,tc=!1,If=null,Ys=null,nc=!1,qs=null,rc=0,gl=0,jf=null,ic=-1,sc=0;function pr(){return(Qt&6)!==0?ot():ic!==-1?ic:ic=ot()}function Ks(i){return(i.mode&1)===0?1:(Qt&2)!==0&&Jn!==0?Jn&-Jn:u_.transition!==null?(sc===0&&(sc=As()),sc):(i=Vt,i!==0||(i=window.event,i=i===void 0?16:ua(i.type)),i)}function bi(i,o,d,y){if(50<gl)throw gl=0,jf=null,Error(t(185));Ni(i,d,y),((Qt&2)===0||i!==qn)&&(i===qn&&((Qt&2)===0&&(ec|=d),Vn===4&&Zs(i,Jn)),Pr(i,y),d===1&&Qt===0&&(o.mode&1)===0&&(_o=ot()+500,ju&&Us()))}function Pr(i,o){var d=i.callbackNode;Nn(i,o);var y=tr(i,i===qn?Jn:0);if(y===0)d!==null&&st(d),i.callbackNode=null,i.callbackPriority=0;else if(o=y&-y,i.callbackPriority!==o){if(d!=null&&st(d),o===1)i.tag===0?l_(t0.bind(null,i)):zp(t0.bind(null,i)),i_(function(){(Qt&6)===0&&Us()}),d=null;else{switch(zi(y)){case 1:d=bt;break;case 4:d=pn;break;case 16:d=sn;break;case 536870912:d=ln;break;default:d=sn}d=u0(d,e0.bind(null,i))}i.callbackPriority=o,i.callbackNode=d}}function e0(i,o){if(ic=-1,sc=0,(Qt&6)!==0)throw Error(t(327));var d=i.callbackNode;if(xo()&&i.callbackNode!==d)return null;var y=tr(i,i===qn?Jn:0);if(y===0)return null;if((y&30)!==0||(y&i.expiredLanes)!==0||o)o=ac(i,y);else{o=y;var k=Qt;Qt|=2;var M=r0();(qn!==i||Jn!==o)&&(vs=null,_o=ot()+500,Oa(i,o));do try{P_();break}catch(ue){n0(i,ue)}while(!0);Zh(),$u.current=M,Qt=k,Ln!==null?o=0:(qn=null,Jn=0,o=Vn)}if(o!==0){if(o===2&&(k=Ps(i),k!==0&&(y=k,o=Lf(i,k))),o===1)throw d=dl,Oa(i,0),Zs(i,y),Pr(i,ot()),d;if(o===6)Zs(i,y);else{if(k=i.current.alternate,(y&30)===0&&!E_(k)&&(o=ac(i,y),o===2&&(M=Ps(i),M!==0&&(y=M,o=Lf(i,M))),o===1))throw d=dl,Oa(i,0),Zs(i,y),Pr(i,ot()),d;switch(i.finishedWork=k,i.finishedLanes=y,o){case 0:case 1:throw Error(t(345));case 2:Pa(i,Or,vs);break;case 3:if(Zs(i,y),(y&130023424)===y&&(o=Mf+500-ot(),10<o)){if(tr(i,0)!==0)break;if(k=i.suspendedLanes,(k&y)!==y){pr(),i.pingedLanes|=i.suspendedLanes&k;break}i.timeoutHandle=Bh(Pa.bind(null,i,Or,vs),o);break}Pa(i,Or,vs);break;case 4:if(Zs(i,y),(y&4194240)===y)break;for(o=i.eventTimes,k=-1;0<y;){var $=31-qt(y);M=1<<$,$=o[$],$>k&&(k=$),y&=~M}if(y=k,y=ot()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*T_(y/1960))-y,10<y){i.timeoutHandle=Bh(Pa.bind(null,i,Or,vs),y);break}Pa(i,Or,vs);break;case 5:Pa(i,Or,vs);break;default:throw Error(t(329))}}}return Pr(i,ot()),i.callbackNode===d?e0.bind(null,i):null}function Lf(i,o){var d=pl;return i.current.memoizedState.isDehydrated&&(Oa(i,o).flags|=256),i=ac(i,o),i!==2&&(o=Or,Or=d,o!==null&&Df(o)),i}function Df(i){Or===null?Or=i:Or.push.apply(Or,i)}function E_(i){for(var o=i;;){if(o.flags&16384){var d=o.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var k=d[y],M=k.getSnapshot;k=k.value;try{if(!jn(M(),k))return!1}catch{return!1}}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Zs(i,o){for(o&=~Af,o&=~ec,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var d=31-qt(o),y=1<<d;i[d]=-1,o&=~y}}function t0(i){if((Qt&6)!==0)throw Error(t(327));xo();var o=tr(i,0);if((o&1)===0)return Pr(i,ot()),null;var d=ac(i,o);if(i.tag!==0&&d===2){var y=Ps(i);y!==0&&(o=y,d=Lf(i,y))}if(d===1)throw d=dl,Oa(i,0),Zs(i,o),Pr(i,ot()),d;if(d===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Pa(i,Or,vs),Pr(i,ot()),null}function Rf(i,o){var d=Qt;Qt|=1;try{return i(o)}finally{Qt=d,Qt===0&&(_o=ot()+500,ju&&Us())}}function Ea(i){qs!==null&&qs.tag===0&&(Qt&6)===0&&xo();var o=Qt;Qt|=1;var d=ri.transition,y=Vt;try{if(ri.transition=null,Vt=1,i)return i()}finally{Vt=y,ri.transition=d,Qt=o,(Qt&6)===0&&Us()}}function Ff(){Xr=yo.current,fn(yo)}function Oa(i,o){i.finishedWork=null,i.finishedLanes=0;var d=i.timeoutHandle;if(d!==-1&&(i.timeoutHandle=-1,r_(d)),Ln!==null)for(d=Ln.return;d!==null;){var y=d;switch(Xh(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Mu();break;case 3:go(),fn(kr),fn(ir),sf();break;case 5:nf(y);break;case 4:go();break;case 13:fn(_n);break;case 19:fn(_n);break;case 10:Qh(y.type._context);break;case 22:case 23:Ff()}d=d.return}if(qn=i,Ln=i=Qs(i.current,null),Jn=Xr=o,Vn=0,dl=null,Af=ec=Ta=0,Or=pl=null,Sa!==null){for(o=0;o<Sa.length;o++)if(d=Sa[o],y=d.interleaved,y!==null){d.interleaved=null;var k=y.next,M=d.pending;if(M!==null){var $=M.next;M.next=k,y.next=$}d.pending=y}Sa=null}return i}function n0(i,o){do{var d=Ln;try{if(Zh(),Uu.current=Yu,Hu){for(var y=xn.memoizedState;y!==null;){var k=y.queue;k!==null&&(k.pending=null),y=y.next}Hu=!1}if(ka=0,Yn=zn=xn=null,ol=!1,ll=0,Pf.current=null,d===null||d.return===null){Vn=1,dl=o,Ln=null;break}e:{var M=i,$=d.return,ue=d,me=o;if(o=Jn,ue.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var Ae=me,Ye=ue,Qe=Ye.tag;if((Ye.mode&1)===0&&(Qe===0||Qe===11||Qe===15)){var Ue=Ye.alternate;Ue?(Ye.updateQueue=Ue.updateQueue,Ye.memoizedState=Ue.memoizedState,Ye.lanes=Ue.lanes):(Ye.updateQueue=null,Ye.memoizedState=null)}var lt=Eg($);if(lt!==null){lt.flags&=-257,Og(lt,$,ue,M,o),lt.mode&1&&Tg(M,Ae,o),o=lt,me=Ae;var ft=o.updateQueue;if(ft===null){var gt=new Set;gt.add(me),o.updateQueue=gt}else ft.add(me);break e}else{if((o&1)===0){Tg(M,Ae,o),Nf();break e}me=Error(t(426))}}else if(gn&&ue.mode&1){var An=Eg($);if(An!==null){(An.flags&65536)===0&&(An.flags|=256),Og(An,$,ue,M,o),qh(mo(me,ue));break e}}M=me=mo(me,ue),Vn!==4&&(Vn=2),pl===null?pl=[M]:pl.push(M),M=$;do{switch(M.tag){case 3:M.flags|=65536,o&=-o,M.lanes|=o;var ke=Cg(M,me,o);Qp(M,ke);break e;case 1:ue=me;var _e=M.type,Pe=M.stateNode;if((M.flags&128)===0&&(typeof _e.getDerivedStateFromError=="function"||Pe!==null&&typeof Pe.componentDidCatch=="function"&&(Ys===null||!Ys.has(Pe)))){M.flags|=65536,o&=-o,M.lanes|=o;var nt=kg(M,ue,o);Qp(M,nt);break e}}M=M.return}while(M!==null)}s0(d)}catch(mt){o=mt,Ln===d&&d!==null&&(Ln=d=d.return);continue}break}while(!0)}function r0(){var i=$u.current;return $u.current=Yu,i===null?Yu:i}function Nf(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),qn===null||(Ta&268435455)===0&&(ec&268435455)===0||Zs(qn,Jn)}function ac(i,o){var d=Qt;Qt|=2;var y=r0();(qn!==i||Jn!==o)&&(vs=null,Oa(i,o));do try{O_();break}catch(k){n0(i,k)}while(!0);if(Zh(),Qt=d,$u.current=y,Ln!==null)throw Error(t(261));return qn=null,Jn=0,Vn}function O_(){for(;Ln!==null;)i0(Ln)}function P_(){for(;Ln!==null&&!xt();)i0(Ln)}function i0(i){var o=l0(i.alternate,i,Xr);i.memoizedProps=i.pendingProps,o===null?s0(i):Ln=o,Pf.current=null}function s0(i){var o=i;do{var d=o.alternate;if(i=o.return,(o.flags&32768)===0){if(d=w_(d,o,Xr),d!==null){Ln=d;return}}else{if(d=b_(d,o),d!==null){d.flags&=32767,Ln=d;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Vn=6,Ln=null;return}}if(o=o.sibling,o!==null){Ln=o;return}Ln=o=i}while(o!==null);Vn===0&&(Vn=5)}function Pa(i,o,d){var y=Vt,k=ri.transition;try{ri.transition=null,Vt=1,A_(i,o,d,y)}finally{ri.transition=k,Vt=y}return null}function A_(i,o,d,y){do xo();while(qs!==null);if((Qt&6)!==0)throw Error(t(327));d=i.finishedWork;var k=i.finishedLanes;if(d===null)return null;if(i.finishedWork=null,i.finishedLanes=0,d===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var M=d.lanes|d.childLanes;if(qa(i,M),i===qn&&(Ln=qn=null,Jn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||nc||(nc=!0,u0(sn,function(){return xo(),null})),M=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||M){M=ri.transition,ri.transition=null;var $=Vt;Vt=1;var ue=Qt;Qt|=4,Pf.current=null,C_(i,d),Kg(d,i),jt(Fh),Kr=!!Rh,Fh=Rh=null,i.current=d,k_(d),vt(),Qt=ue,Vt=$,ri.transition=M}else i.current=d;if(nc&&(nc=!1,qs=i,rc=k),M=i.pendingLanes,M===0&&(Ys=null),an(d.stateNode),Pr(i,ot()),o!==null)for(y=i.onRecoverableError,d=0;d<o.length;d++)k=o[d],y(k.value,{componentStack:k.stack,digest:k.digest});if(tc)throw tc=!1,i=If,If=null,i;return(rc&1)!==0&&i.tag!==0&&xo(),M=i.pendingLanes,(M&1)!==0?i===jf?gl++:(gl=0,jf=i):gl=0,Us(),null}function xo(){if(qs!==null){var i=zi(rc),o=ri.transition,d=Vt;try{if(ri.transition=null,Vt=16>i?16:i,qs===null)var y=!1;else{if(i=qs,qs=null,rc=0,(Qt&6)!==0)throw Error(t(331));var k=Qt;for(Qt|=4,ht=i.current;ht!==null;){var M=ht,$=M.child;if((ht.flags&16)!==0){var ue=M.deletions;if(ue!==null){for(var me=0;me<ue.length;me++){var Ae=ue[me];for(ht=Ae;ht!==null;){var Ye=ht;switch(Ye.tag){case 0:case 11:case 15:fl(8,Ye,M)}var Qe=Ye.child;if(Qe!==null)Qe.return=Ye,ht=Qe;else for(;ht!==null;){Ye=ht;var Ue=Ye.sibling,lt=Ye.return;if(Hg(Ye),Ye===Ae){ht=null;break}if(Ue!==null){Ue.return=lt,ht=Ue;break}ht=lt}}}var ft=M.alternate;if(ft!==null){var gt=ft.child;if(gt!==null){ft.child=null;do{var An=gt.sibling;gt.sibling=null,gt=An}while(gt!==null)}}ht=M}}if((M.subtreeFlags&2064)!==0&&$!==null)$.return=M,ht=$;else e:for(;ht!==null;){if(M=ht,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:fl(9,M,M.return)}var ke=M.sibling;if(ke!==null){ke.return=M.return,ht=ke;break e}ht=M.return}}var _e=i.current;for(ht=_e;ht!==null;){$=ht;var Pe=$.child;if(($.subtreeFlags&2064)!==0&&Pe!==null)Pe.return=$,ht=Pe;else e:for($=_e;ht!==null;){if(ue=ht,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:Ju(9,ue)}}catch(mt){Tn(ue,ue.return,mt)}if(ue===$){ht=null;break e}var nt=ue.sibling;if(nt!==null){nt.return=ue.return,ht=nt;break e}ht=ue.return}}if(Qt=k,Us(),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(qe,i)}catch{}y=!0}return y}finally{Vt=d,ri.transition=o}}return!1}function a0(i,o,d){o=mo(d,o),o=Cg(i,o,1),i=Xs(i,o,1),o=pr(),i!==null&&(Ni(i,1,o),Pr(i,o))}function Tn(i,o,d){if(i.tag===3)a0(i,i,d);else for(;o!==null;){if(o.tag===3){a0(o,i,d);break}else if(o.tag===1){var y=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Ys===null||!Ys.has(y))){i=mo(d,i),i=kg(o,i,1),o=Xs(o,i,1),i=pr(),o!==null&&(Ni(o,1,i),Pr(o,i));break}}o=o.return}}function M_(i,o,d){var y=i.pingCache;y!==null&&y.delete(o),o=pr(),i.pingedLanes|=i.suspendedLanes&d,qn===i&&(Jn&d)===d&&(Vn===4||Vn===3&&(Jn&130023424)===Jn&&500>ot()-Mf?Oa(i,0):Af|=d),Pr(i,o)}function o0(i,o){o===0&&((i.mode&1)===0?o=1:(o=Cn,Cn<<=1,(Cn&130023424)===0&&(Cn=4194304)));var d=pr();i=ps(i,o),i!==null&&(Ni(i,o,d),Pr(i,d))}function I_(i){var o=i.memoizedState,d=0;o!==null&&(d=o.retryLane),o0(i,d)}function j_(i,o){var d=0;switch(i.tag){case 13:var y=i.stateNode,k=i.memoizedState;k!==null&&(d=k.retryLane);break;case 19:y=i.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(o),o0(i,d)}var l0;l0=function(i,o,d){if(i!==null)if(i.memoizedProps!==o.pendingProps||kr.current)Er=!0;else{if((i.lanes&d)===0&&(o.flags&128)===0)return Er=!1,x_(i,o,d);Er=(i.flags&131072)!==0}else Er=!1,gn&&(o.flags&1048576)!==0&&Vp(o,Du,o.index);switch(o.lanes=0,o.tag){case 2:var y=o.type;Zu(i,o),i=o.pendingProps;var k=oo(o,ir.current);po(o,d),k=lf(null,o,y,i,k,d);var M=uf();return o.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Tr(y)?(M=!0,Iu(o)):M=!1,o.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,ef(o),k.updater=qu,o.stateNode=k,k._reactInternals=o,gf(o,y,i,d),o=_f(null,o,y,!0,M,d)):(o.tag=0,gn&&M&&Hh(o),dr(null,o,k,d),o=o.child),o;case 16:y=o.elementType;e:{switch(Zu(i,o),i=o.pendingProps,k=y._init,y=k(y._payload),o.type=y,k=o.tag=D_(y),i=_i(y,i),k){case 0:o=yf(null,o,y,i,d);break e;case 1:o=Lg(null,o,y,i,d);break e;case 11:o=Pg(null,o,y,i,d);break e;case 14:o=Ag(null,o,y,_i(y.type,i),d);break e}throw Error(t(306,y,""))}return o;case 0:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:_i(y,k),yf(i,o,y,k,d);case 1:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:_i(y,k),Lg(i,o,y,k,d);case 3:e:{if(Dg(o),i===null)throw Error(t(387));y=o.pendingProps,M=o.memoizedState,k=M.element,Zp(i,o),Vu(o,y,null,d);var $=o.memoizedState;if(y=$.element,M.isDehydrated)if(M={element:y,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},o.updateQueue.baseState=M,o.memoizedState=M,o.flags&256){k=mo(Error(t(423)),o),o=Rg(i,o,y,d,k);break e}else if(y!==k){k=mo(Error(t(424)),o),o=Rg(i,o,y,d,k);break e}else for(Hr=zs(o.stateNode.containerInfo.firstChild),Ur=o,gn=!0,yi=null,d=qp(o,null,y,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(co(),y===k){o=ms(i,o,d);break e}dr(i,o,y,d)}o=o.child}return o;case 5:return $p(o),i===null&&Yh(o),y=o.type,k=o.pendingProps,M=i!==null?i.memoizedProps:null,$=k.children,Nh(y,k)?$=null:M!==null&&Nh(y,M)&&(o.flags|=32),jg(i,o),dr(i,o,$,d),o.child;case 6:return i===null&&Yh(o),null;case 13:return Fg(i,o,d);case 4:return tf(o,o.stateNode.containerInfo),y=o.pendingProps,i===null?o.child=ho(o,null,y,d):dr(i,o,y,d),o.child;case 11:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:_i(y,k),Pg(i,o,y,k,d);case 7:return dr(i,o,o.pendingProps,d),o.child;case 8:return dr(i,o,o.pendingProps.children,d),o.child;case 12:return dr(i,o,o.pendingProps.children,d),o.child;case 10:e:{if(y=o.type._context,k=o.pendingProps,M=o.memoizedProps,$=k.value,un(Nu,y._currentValue),y._currentValue=$,M!==null)if(jn(M.value,$)){if(M.children===k.children&&!kr.current){o=ms(i,o,d);break e}}else for(M=o.child,M!==null&&(M.return=o);M!==null;){var ue=M.dependencies;if(ue!==null){$=M.child;for(var me=ue.firstContext;me!==null;){if(me.context===y){if(M.tag===1){me=gs(-1,d&-d),me.tag=2;var Ae=M.updateQueue;if(Ae!==null){Ae=Ae.shared;var Ye=Ae.pending;Ye===null?me.next=me:(me.next=Ye.next,Ye.next=me),Ae.pending=me}}M.lanes|=d,me=M.alternate,me!==null&&(me.lanes|=d),Jh(M.return,d,o),ue.lanes|=d;break}me=me.next}}else if(M.tag===10)$=M.type===o.type?null:M.child;else if(M.tag===18){if($=M.return,$===null)throw Error(t(341));$.lanes|=d,ue=$.alternate,ue!==null&&(ue.lanes|=d),Jh($,d,o),$=M.sibling}else $=M.child;if($!==null)$.return=M;else for($=M;$!==null;){if($===o){$=null;break}if(M=$.sibling,M!==null){M.return=$.return,$=M;break}$=$.return}M=$}dr(i,o,k.children,d),o=o.child}return o;case 9:return k=o.type,y=o.pendingProps.children,po(o,d),k=ti(k),y=y(k),o.flags|=1,dr(i,o,y,d),o.child;case 14:return y=o.type,k=_i(y,o.pendingProps),k=_i(y.type,k),Ag(i,o,y,k,d);case 15:return Mg(i,o,o.type,o.pendingProps,d);case 17:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:_i(y,k),Zu(i,o),o.tag=1,Tr(y)?(i=!0,Iu(o)):i=!1,po(o,d),bg(o,y,k),gf(o,y,k,d),_f(null,o,y,!0,i,d);case 19:return Bg(i,o,d);case 22:return Ig(i,o,d)}throw Error(t(156,o.tag))};function u0(i,o){return at(i,o)}function L_(i,o,d,y){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(i,o,d,y){return new L_(i,o,d,y)}function Bf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function D_(i){if(typeof i=="function")return Bf(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Ke)return 11;if(i===Bt)return 14}return 2}function Qs(i,o){var d=i.alternate;return d===null?(d=ii(i.tag,o,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=o,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&14680064,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,o=i.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d}function oc(i,o,d,y,k,M){var $=2;if(y=i,typeof i=="function")Bf(i)&&($=1);else if(typeof i=="string")$=5;else e:switch(i){case ze:return Aa(d.children,k,M,o);case He:$=8,k|=8;break;case Je:return i=ii(12,d,o,k|2),i.elementType=Je,i.lanes=M,i;case dt:return i=ii(13,d,o,k),i.elementType=dt,i.lanes=M,i;case Ve:return i=ii(19,d,o,k),i.elementType=Ve,i.lanes=M,i;case wt:return lc(d,k,M,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ut:$=10;break e;case Ie:$=9;break e;case Ke:$=11;break e;case Bt:$=14;break e;case Le:$=16,y=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=ii($,d,o,k),o.elementType=i,o.type=y,o.lanes=M,o}function Aa(i,o,d,y){return i=ii(7,i,y,o),i.lanes=d,i}function lc(i,o,d,y){return i=ii(22,i,y,o),i.elementType=wt,i.lanes=d,i.stateNode={isHidden:!1},i}function zf(i,o,d){return i=ii(6,i,null,o),i.lanes=d,i}function Vf(i,o,d){return o=ii(4,i.children!==null?i.children:[],i.key,o),o.lanes=d,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function R_(i,o,d,y,k){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ms(0),this.expirationTimes=Ms(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ms(0),this.identifierPrefix=y,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Wf(i,o,d,y,k,M,$,ue,me){return i=new R_(i,o,d,ue,me),o===1?(o=1,M===!0&&(o|=8)):o=0,M=ii(3,null,null,o),i.current=M,M.stateNode=i,M.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},ef(M),i}function F_(i,o,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:y==null?null:""+y,children:i,containerInfo:o,implementation:d}}function c0(i){if(!i)return Ws;i=i._reactInternals;e:{if(We(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Tr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var d=i.type;if(Tr(d))return Np(i,d,o)}return o}function h0(i,o,d,y,k,M,$,ue,me){return i=Wf(d,y,!0,i,k,M,$,ue,me),i.context=c0(null),d=i.current,y=pr(),k=Ks(d),M=gs(y,k),M.callback=o??null,Xs(d,M,k),i.current.lanes=k,Ni(i,k,y),Pr(i,y),i}function uc(i,o,d,y){var k=o.current,M=pr(),$=Ks(k);return d=c0(d),o.context===null?o.context=d:o.pendingContext=d,o=gs(M,$),o.payload={element:i},y=y===void 0?null:y,y!==null&&(o.callback=y),i=Xs(k,o,$),i!==null&&(bi(i,k,$,M),zu(i,k,$)),$}function cc(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function f0(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<o?d:o}}function Uf(i,o){f0(i,o),(i=i.alternate)&&f0(i,o)}function N_(){return null}var d0=typeof reportError=="function"?reportError:function(i){console.error(i)};function Hf(i){this._internalRoot=i}hc.prototype.render=Hf.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));uc(i,o,null,null)},hc.prototype.unmount=Hf.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Ea(function(){uc(null,i,null,null)}),o[cs]=null}};function hc(i){this._internalRoot=i}hc.prototype.unstable_scheduleHydration=function(i){if(i){var o=Pt();i={blockedOn:null,target:i,priority:o};for(var d=0;d<x.length&&o!==0&&o<x[d].priority;d++);x.splice(d,0,i),d===0&&Oe(i)}};function Xf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function fc(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function p0(){}function B_(i,o,d,y,k){if(k){if(typeof y=="function"){var M=y;y=function(){var Ae=cc($);M.call(Ae)}}var $=h0(o,y,i,0,null,!1,!1,"",p0);return i._reactRootContainer=$,i[cs]=$.current,$o(i.nodeType===8?i.parentNode:i),Ea(),$}for(;k=i.lastChild;)i.removeChild(k);if(typeof y=="function"){var ue=y;y=function(){var Ae=cc(me);ue.call(Ae)}}var me=Wf(i,0,!1,null,null,!1,!1,"",p0);return i._reactRootContainer=me,i[cs]=me.current,$o(i.nodeType===8?i.parentNode:i),Ea(function(){uc(o,me,d,y)}),me}function dc(i,o,d,y,k){var M=d._reactRootContainer;if(M){var $=M;if(typeof k=="function"){var ue=k;k=function(){var me=cc($);ue.call(me)}}uc(o,$,i,k)}else $=B_(d,o,i,k,y);return cc($)}Vi=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var d=On(o.pendingLanes);d!==0&&(Bi(o,d|1),Pr(o,ot()),(Qt&6)===0&&(_o=ot()+500,Us()))}break;case 13:Ea(function(){var y=ps(i,1);if(y!==null){var k=pr();bi(y,i,1,k)}}),Uf(i,1)}},Br=function(i){if(i.tag===13){var o=ps(i,134217728);if(o!==null){var d=pr();bi(o,i,134217728,d)}Uf(i,134217728)}},fr=function(i){if(i.tag===13){var o=Ks(i),d=ps(i,o);if(d!==null){var y=pr();bi(d,i,o,y)}Uf(i,o)}},Pt=function(){return Vt},nr=function(i,o){var d=Vt;try{return Vt=i,o()}finally{Vt=d}},Y=function(i,o,d){switch(o){case"input":if(Fr(i,d),o=d.name,d.type==="radio"&&o!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<d.length;o++){var y=d[o];if(y!==i&&y.form===i.form){var k=Au(y);if(!k)throw Error(t(90));oa(y),Fr(y,k)}}}break;case"textarea":Os(i,d);break;case"select":o=d.value,o!=null&&tn(i,!!d.multiple,o,!1)}},V=Rf,q=Ea;var z_={usingClientEntryPoint:!1,Events:[nl,so,Au,U,A,Rf]},ml={findFiberByHostInstance:_a,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},V_={bundleType:ml.bundleType,version:ml.version,rendererPackageName:ml.rendererPackageName,rendererConfig:ml.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ve.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=De(i),i===null?null:i.stateNode},findFiberByHostInstance:ml.findFiberByHostInstance||N_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pc.isDisabled&&pc.supportsFiber)try{qe=pc.inject(V_),Ht=pc}catch{}}return Ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z_,Ar.createPortal=function(i,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xf(o))throw Error(t(200));return F_(i,o,null,d)},Ar.createRoot=function(i,o){if(!Xf(i))throw Error(t(299));var d=!1,y="",k=d0;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(k=o.onRecoverableError)),o=Wf(i,1,!1,null,null,d,!1,y,k),i[cs]=o.current,$o(i.nodeType===8?i.parentNode:i),new Hf(o)},Ar.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=De(o),i=i===null?null:i.stateNode,i},Ar.flushSync=function(i){return Ea(i)},Ar.hydrate=function(i,o,d){if(!fc(o))throw Error(t(200));return dc(null,i,o,!0,d)},Ar.hydrateRoot=function(i,o,d){if(!Xf(i))throw Error(t(405));var y=d!=null&&d.hydratedSources||null,k=!1,M="",$=d0;if(d!=null&&(d.unstable_strictMode===!0&&(k=!0),d.identifierPrefix!==void 0&&(M=d.identifierPrefix),d.onRecoverableError!==void 0&&($=d.onRecoverableError)),o=h0(o,null,i,1,d??null,k,!1,M,$),i[cs]=o.current,$o(i),y)for(i=0;i<y.length;i++)d=y[i],k=d._getVersion,k=k(d._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[d,k]:o.mutableSourceEagerHydrationData.push(d,k);return new hc(o)},Ar.render=function(i,o,d){if(!fc(o))throw Error(t(200));return dc(null,i,o,!1,d)},Ar.unmountComponentAtNode=function(i){if(!fc(i))throw Error(t(40));return i._reactRootContainer?(Ea(function(){dc(null,null,i,!1,function(){i._reactRootContainer=null,i[cs]=null})}),!0):!1},Ar.unstable_batchedUpdates=Rf,Ar.unstable_renderSubtreeIntoContainer=function(i,o,d,y){if(!fc(d))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return dc(i,o,d,!1,y)},Ar.version="18.3.1-next-f1338f8080-20240426",Ar}var b0;function Mm(){if(b0)return qf.exports;b0=1;function l(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l)}catch(e){console.error(e)}}return l(),qf.exports=K_(),qf.exports}var S0;function Z_(){if(S0)return gc;S0=1;var l=Mm();return gc.createRoot=l.createRoot,gc.hydrateRoot=l.hydrateRoot,gc}var Q_=Z_();/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var C0="popstate";function J_(l={}){function e(n,s){let{pathname:a,search:h,hash:p}=n.location;return pd("",{pathname:a,search:h,hash:p},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:ql(s)}return e1(e,t,null,l)}function bn(l,e){if(l===!1||l===null||typeof l>"u")throw new Error(e)}function Mi(l,e){if(!l){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $_(){return Math.random().toString(36).substring(2,10)}function k0(l,e){return{usr:l.state,key:l.key,idx:e}}function pd(l,e,t=null,n){return{pathname:typeof l=="string"?l:l.pathname,search:"",hash:"",...typeof e=="string"?No(e):e,state:t,key:e&&e.key||n||$_()}}function ql({pathname:l="/",search:e="",hash:t=""}){return e&&e!=="?"&&(l+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(l+=t.charAt(0)==="#"?t:"#"+t),l}function No(l){let e={};if(l){let t=l.indexOf("#");t>=0&&(e.hash=l.substring(t),l=l.substring(0,t));let n=l.indexOf("?");n>=0&&(e.search=l.substring(n),l=l.substring(0,n)),l&&(e.pathname=l)}return e}function e1(l,e,t,n={}){let{window:s=document.defaultView,v5Compat:a=!1}=n,h=s.history,p="POP",v=null,_=b();_==null&&(_=0,h.replaceState({...h.state,idx:_},""));function b(){return(h.state||{idx:null}).idx}function E(){p="POP";let ee=b(),K=ee==null?null:ee-_;_=ee,v&&v({action:p,location:W.location,delta:K})}function N(ee,K){p="PUSH";let ae=pd(W.location,ee,K);_=b()+1;let le=k0(ae,_),ve=W.createHref(ae);try{h.pushState(le,"",ve)}catch(we){if(we instanceof DOMException&&we.name==="DataCloneError")throw we;s.location.assign(ve)}a&&v&&v({action:p,location:W.location,delta:1})}function O(ee,K){p="REPLACE";let ae=pd(W.location,ee,K);_=b();let le=k0(ae,_),ve=W.createHref(ae);h.replaceState(le,"",ve),a&&v&&v({action:p,location:W.location,delta:0})}function Q(ee){return t1(ee)}let W={get action(){return p},get location(){return l(s,h)},listen(ee){if(v)throw new Error("A history only accepts one active listener");return s.addEventListener(C0,E),v=ee,()=>{s.removeEventListener(C0,E),v=null}},createHref(ee){return e(s,ee)},createURL:Q,encodeLocation(ee){let K=Q(ee);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:N,replace:O,go(ee){return h.go(ee)}};return W}function t1(l,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),bn(t,"No window.location.(origin|href) available to create URL");let n=typeof l=="string"?l:ql(l);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Im(l,e,t="/"){return n1(l,e,t,!1)}function n1(l,e,t,n){let s=typeof e=="string"?No(e):e,a=bs(s.pathname||"/",t);if(a==null)return null;let h=jm(l);r1(h);let p=null;for(let v=0;p==null&&v<h.length;++v){let _=p1(a);p=f1(h[v],_,n)}return p}function jm(l,e=[],t=[],n="",s=!1){let a=(h,p,v=s,_)=>{let b={relativePath:_===void 0?h.path||"":_,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(n)&&v)return;bn(b.relativePath.startsWith(n),`Absolute route path "${b.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(n.length)}let E=xs([n,b.relativePath]),N=t.concat(b);h.children&&h.children.length>0&&(bn(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),jm(h.children,e,N,E,v)),!(h.path==null&&!h.index)&&e.push({path:E,score:c1(E,h.index),routesMeta:N})};return l.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))a(h,p);else for(let v of Lm(h.path))a(h,p,!0,v)}),e}function Lm(l){let e=l.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let h=Lm(n.join("/")),p=[];return p.push(...h.map(v=>v===""?a:[a,v].join("/"))),s&&p.push(...h),p.map(v=>l.startsWith("/")&&v===""?"/":v)}function r1(l){l.sort((e,t)=>e.score!==t.score?t.score-e.score:h1(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var i1=/^:[\w-]+$/,s1=3,a1=2,o1=1,l1=10,u1=-2,T0=l=>l==="*";function c1(l,e){let t=l.split("/"),n=t.length;return t.some(T0)&&(n+=u1),e&&(n+=a1),t.filter(s=>!T0(s)).reduce((s,a)=>s+(i1.test(a)?s1:a===""?o1:l1),n)}function h1(l,e){return l.length===e.length&&l.slice(0,-1).every((n,s)=>n===e[s])?l[l.length-1]-e[e.length-1]:0}function f1(l,e,t=!1){let{routesMeta:n}=l,s={},a="/",h=[];for(let p=0;p<n.length;++p){let v=n[p],_=p===n.length-1,b=a==="/"?e:e.slice(a.length)||"/",E=Fc({path:v.relativePath,caseSensitive:v.caseSensitive,end:_},b),N=v.route;if(!E&&_&&t&&!n[n.length-1].route.index&&(E=Fc({path:v.relativePath,caseSensitive:v.caseSensitive,end:!1},b)),!E)return null;Object.assign(s,E.params),h.push({params:s,pathname:xs([a,E.pathname]),pathnameBase:y1(xs([a,E.pathnameBase])),route:N}),E.pathnameBase!=="/"&&(a=xs([a,E.pathnameBase]))}return h}function Fc(l,e){typeof l=="string"&&(l={path:l,caseSensitive:!1,end:!0});let[t,n]=d1(l.path,l.caseSensitive,l.end),s=e.match(t);if(!s)return null;let a=s[0],h=a.replace(/(.)\/+$/,"$1"),p=s.slice(1);return{params:n.reduce((_,{paramName:b,isOptional:E},N)=>{if(b==="*"){let Q=p[N]||"";h=a.slice(0,a.length-Q.length).replace(/(.)\/+$/,"$1")}const O=p[N];return E&&!O?_[b]=void 0:_[b]=(O||"").replace(/%2F/g,"/"),_},{}),pathname:a,pathnameBase:h,pattern:l}}function d1(l,e=!1,t=!0){Mi(l==="*"||!l.endsWith("*")||l.endsWith("/*"),`Route path "${l}" will be treated as if it were "${l.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${l.replace(/\*$/,"/*")}".`);let n=[],s="^"+l.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,v)=>(n.push({paramName:p,isOptional:v!=null}),v?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return l.endsWith("*")?(n.push({paramName:"*"}),s+=l==="*"||l==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":l!==""&&l!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function p1(l){try{return l.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mi(!1,`The URL path "${l}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),l}}function bs(l,e){if(e==="/")return l;if(!l.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=l.charAt(t);return n&&n!=="/"?null:l.slice(t)||"/"}var Dm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,g1=l=>Dm.test(l);function m1(l,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof l=="string"?No(l):l,a;if(t)if(g1(t))a=t;else{if(t.includes("//")){let h=t;t=t.replace(/\/\/+/g,"/"),Mi(!1,`Pathnames cannot have embedded double slashes - normalizing ${h} -> ${t}`)}t.startsWith("/")?a=E0(t.substring(1),"/"):a=E0(t,e)}else a=e;return{pathname:a,search:_1(n),hash:x1(s)}}function E0(l,e){let t=e.replace(/\/+$/,"").split("/");return l.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Qf(l,e,t,n){return`Cannot include a '${l}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function v1(l){return l.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Rm(l){let e=v1(l);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Fm(l,e,t,n=!1){let s;typeof l=="string"?s=No(l):(s={...l},bn(!s.pathname||!s.pathname.includes("?"),Qf("?","pathname","search",s)),bn(!s.pathname||!s.pathname.includes("#"),Qf("#","pathname","hash",s)),bn(!s.search||!s.search.includes("#"),Qf("#","search","hash",s)));let a=l===""||s.pathname==="",h=a?"/":s.pathname,p;if(h==null)p=t;else{let E=e.length-1;if(!n&&h.startsWith("..")){let N=h.split("/");for(;N[0]==="..";)N.shift(),E-=1;s.pathname=N.join("/")}p=E>=0?e[E]:"/"}let v=m1(s,p),_=h&&h!=="/"&&h.endsWith("/"),b=(a||h===".")&&t.endsWith("/");return!v.pathname.endsWith("/")&&(_||b)&&(v.pathname+="/"),v}var xs=l=>l.join("/").replace(/\/\/+/g,"/"),y1=l=>l.replace(/\/+$/,"").replace(/^\/*/,"/"),_1=l=>!l||l==="?"?"":l.startsWith("?")?l:"?"+l,x1=l=>!l||l==="#"?"":l.startsWith("#")?l:"#"+l,w1=class{constructor(l,e,t,n=!1){this.status=l,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function b1(l){return l!=null&&typeof l.status=="number"&&typeof l.statusText=="string"&&typeof l.internal=="boolean"&&"data"in l}function S1(l){return l.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Nm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Bm(l,e){let t=l;if(typeof t!="string"||!Dm.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,s=!1;if(Nm)try{let a=new URL(window.location.href),h=t.startsWith("//")?new URL(a.protocol+t):new URL(t),p=bs(h.pathname,e);h.origin===a.origin&&p!=null?t=p+h.search+h.hash:s=!0}catch{Mi(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:s,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var zm=["POST","PUT","PATCH","DELETE"];new Set(zm);var C1=["GET",...zm];new Set(C1);var Bo=Te.createContext(null);Bo.displayName="DataRouter";var th=Te.createContext(null);th.displayName="DataRouterState";var k1=Te.createContext(!1),Vm=Te.createContext({isTransitioning:!1});Vm.displayName="ViewTransition";var T1=Te.createContext(new Map);T1.displayName="Fetchers";var E1=Te.createContext(null);E1.displayName="Await";var hi=Te.createContext(null);hi.displayName="Navigation";var ru=Te.createContext(null);ru.displayName="Location";var ks=Te.createContext({outlet:null,matches:[],isDataRoute:!1});ks.displayName="Route";var Nd=Te.createContext(null);Nd.displayName="RouteError";var Wm="REACT_ROUTER_ERROR",O1="REDIRECT",P1="ROUTE_ERROR_RESPONSE";function A1(l){if(l.startsWith(`${Wm}:${O1}:{`))try{let e=JSON.parse(l.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function M1(l){if(l.startsWith(`${Wm}:${P1}:{`))try{let e=JSON.parse(l.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new w1(e.status,e.statusText,e.data)}catch{}}function I1(l,{relative:e}={}){bn(iu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=Te.useContext(hi),{hash:s,pathname:a,search:h}=su(l,{relative:e}),p=a;return t!=="/"&&(p=a==="/"?t:xs([t,a])),n.createHref({pathname:p,search:h,hash:s})}function iu(){return Te.useContext(ru)!=null}function Wa(){return bn(iu(),"useLocation() may be used only in the context of a <Router> component."),Te.useContext(ru).location}var Um="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Hm(l){Te.useContext(hi).static||Te.useLayoutEffect(l)}function Bd(){let{isDataRoute:l}=Te.useContext(ks);return l?X1():j1()}function j1(){bn(iu(),"useNavigate() may be used only in the context of a <Router> component.");let l=Te.useContext(Bo),{basename:e,navigator:t}=Te.useContext(hi),{matches:n}=Te.useContext(ks),{pathname:s}=Wa(),a=JSON.stringify(Rm(n)),h=Te.useRef(!1);return Hm(()=>{h.current=!0}),Te.useCallback((v,_={})=>{if(Mi(h.current,Um),!h.current)return;if(typeof v=="number"){t.go(v);return}let b=Fm(v,JSON.parse(a),s,_.relative==="path");l==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:xs([e,b.pathname])),(_.replace?t.replace:t.push)(b,_.state,_)},[e,t,a,s,l])}Te.createContext(null);function su(l,{relative:e}={}){let{matches:t}=Te.useContext(ks),{pathname:n}=Wa(),s=JSON.stringify(Rm(t));return Te.useMemo(()=>Fm(l,JSON.parse(s),n,e==="path"),[l,s,n,e])}function L1(l,e){return Xm(l,e)}function Xm(l,e,t,n,s){bn(iu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=Te.useContext(hi),{matches:h}=Te.useContext(ks),p=h[h.length-1],v=p?p.params:{},_=p?p.pathname:"/",b=p?p.pathnameBase:"/",E=p&&p.route;{let ae=E&&E.path||"";Ym(_,!E||ae.endsWith("*")||ae.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${ae}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ae}"> to <Route path="${ae==="/"?"*":`${ae}/*`}">.`)}let N=Wa(),O;if(e){let ae=typeof e=="string"?No(e):e;bn(b==="/"||ae.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${ae.pathname}" was given in the \`location\` prop.`),O=ae}else O=N;let Q=O.pathname||"/",W=Q;if(b!=="/"){let ae=b.replace(/^\//,"").split("/");W="/"+Q.replace(/^\//,"").split("/").slice(ae.length).join("/")}let ee=Im(l,{pathname:W});Mi(E||ee!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),Mi(ee==null||ee[ee.length-1].route.element!==void 0||ee[ee.length-1].route.Component!==void 0||ee[ee.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=B1(ee&&ee.map(ae=>Object.assign({},ae,{params:Object.assign({},v,ae.params),pathname:xs([b,a.encodeLocation?a.encodeLocation(ae.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathname]),pathnameBase:ae.pathnameBase==="/"?b:xs([b,a.encodeLocation?a.encodeLocation(ae.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathnameBase])})),h,t,n,s);return e&&K?Te.createElement(ru.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},K):K}function D1(){let l=H1(),e=b1(l)?`${l.status} ${l.statusText}`:l instanceof Error?l.message:JSON.stringify(l),t=l instanceof Error?l.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},h=null;return console.error("Error handled by React Router default ErrorBoundary:",l),h=Te.createElement(Te.Fragment,null,Te.createElement("p",null," Hey developer "),Te.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Te.createElement("code",{style:a},"ErrorBoundary")," or"," ",Te.createElement("code",{style:a},"errorElement")," prop on your route.")),Te.createElement(Te.Fragment,null,Te.createElement("h2",null,"Unexpected Application Error!"),Te.createElement("h3",{style:{fontStyle:"italic"}},e),t?Te.createElement("pre",{style:s},t):null,h)}var R1=Te.createElement(D1,null),Gm=class extends Te.Component{constructor(l){super(l),this.state={location:l.location,revalidation:l.revalidation,error:l.error}}static getDerivedStateFromError(l){return{error:l}}static getDerivedStateFromProps(l,e){return e.location!==l.location||e.revalidation!=="idle"&&l.revalidation==="idle"?{error:l.error,location:l.location,revalidation:l.revalidation}:{error:l.error!==void 0?l.error:e.error,location:e.location,revalidation:l.revalidation||e.revalidation}}componentDidCatch(l,e){this.props.onError?this.props.onError(l,e):console.error("React Router caught the following error during render",l)}render(){let l=this.state.error;if(this.context&&typeof l=="object"&&l&&"digest"in l&&typeof l.digest=="string"){const t=M1(l.digest);t&&(l=t)}let e=l!==void 0?Te.createElement(ks.Provider,{value:this.props.routeContext},Te.createElement(Nd.Provider,{value:l,children:this.props.component})):this.props.children;return this.context?Te.createElement(F1,{error:l},e):e}};Gm.contextType=k1;var Jf=new WeakMap;function F1({children:l,error:e}){let{basename:t}=Te.useContext(hi);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=A1(e.digest);if(n){let s=Jf.get(e);if(s)throw s;let a=Bm(n.location,t);if(Nm&&!Jf.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw Jf.set(e,h),h}return Te.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return l}function N1({routeContext:l,match:e,children:t}){let n=Te.useContext(Bo);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),Te.createElement(ks.Provider,{value:l},t)}function B1(l,e=[],t=null,n=null,s=null){if(l==null){if(!t)return null;if(t.errors)l=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)l=t.matches;else return null}let a=l,h=t?.errors;if(h!=null){let b=a.findIndex(E=>E.route.id&&h?.[E.route.id]!==void 0);bn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),a=a.slice(0,Math.min(a.length,b+1))}let p=!1,v=-1;if(t)for(let b=0;b<a.length;b++){let E=a[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(v=b),E.route.id){let{loaderData:N,errors:O}=t,Q=E.route.loader&&!N.hasOwnProperty(E.route.id)&&(!O||O[E.route.id]===void 0);if(E.route.lazy||Q){p=!0,v>=0?a=a.slice(0,v+1):a=[a[0]];break}}}let _=t&&n?(b,E)=>{n(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:S1(t.matches),errorInfo:E})}:void 0;return a.reduceRight((b,E,N)=>{let O,Q=!1,W=null,ee=null;t&&(O=h&&E.route.id?h[E.route.id]:void 0,W=E.route.errorElement||R1,p&&(v<0&&N===0?(Ym("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Q=!0,ee=null):v===N&&(Q=!0,ee=E.route.hydrateFallbackElement||null)));let K=e.concat(a.slice(0,N+1)),ae=()=>{let le;return O?le=W:Q?le=ee:E.route.Component?le=Te.createElement(E.route.Component,null):E.route.element?le=E.route.element:le=b,Te.createElement(N1,{match:E,routeContext:{outlet:b,matches:K,isDataRoute:t!=null},children:le})};return t&&(E.route.ErrorBoundary||E.route.errorElement||N===0)?Te.createElement(Gm,{location:t.location,revalidation:t.revalidation,component:W,error:O,children:ae(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:_}):ae()},null)}function zd(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function z1(l){let e=Te.useContext(Bo);return bn(e,zd(l)),e}function V1(l){let e=Te.useContext(th);return bn(e,zd(l)),e}function W1(l){let e=Te.useContext(ks);return bn(e,zd(l)),e}function Vd(l){let e=W1(l),t=e.matches[e.matches.length-1];return bn(t.route.id,`${l} can only be used on routes that contain a unique "id"`),t.route.id}function U1(){return Vd("useRouteId")}function H1(){let l=Te.useContext(Nd),e=V1("useRouteError"),t=Vd("useRouteError");return l!==void 0?l:e.errors?.[t]}function X1(){let{router:l}=z1("useNavigate"),e=Vd("useNavigate"),t=Te.useRef(!1);return Hm(()=>{t.current=!0}),Te.useCallback(async(s,a={})=>{Mi(t.current,Um),t.current&&(typeof s=="number"?await l.navigate(s):await l.navigate(s,{fromRouteId:e,...a}))},[l,e])}var O0={};function Ym(l,e,t){!e&&!O0[l]&&(O0[l]=!0,Mi(!1,t))}Te.memo(G1);function G1({routes:l,future:e,state:t,onError:n}){return Xm(l,void 0,t,n,e)}function Co(l){bn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Y1({basename:l="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:a=!1,unstable_useTransitions:h}){bn(!iu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=l.replace(/^\/*/,"/"),v=Te.useMemo(()=>({basename:p,navigator:s,static:a,unstable_useTransitions:h,future:{}}),[p,s,a,h]);typeof t=="string"&&(t=No(t));let{pathname:_="/",search:b="",hash:E="",state:N=null,key:O="default"}=t,Q=Te.useMemo(()=>{let W=bs(_,p);return W==null?null:{location:{pathname:W,search:b,hash:E,state:N,key:O},navigationType:n}},[p,_,b,E,N,O,n]);return Mi(Q!=null,`<Router basename="${p}"> is not able to match the URL "${_}${b}${E}" because it does not start with the basename, so the <Router> won't render anything.`),Q==null?null:Te.createElement(hi.Provider,{value:v},Te.createElement(ru.Provider,{children:e,value:Q}))}function q1({children:l,location:e}){return L1(gd(l),e)}function gd(l,e=[]){let t=[];return Te.Children.forEach(l,(n,s)=>{if(!Te.isValidElement(n))return;let a=[...e,s];if(n.type===Te.Fragment){t.push.apply(t,gd(n.props.children,a));return}bn(n.type===Co,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bn(!n.props.index||!n.props.children,"An index route cannot have child routes.");let h={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=gd(n.props.children,a)),t.push(h)}),t}var Ec="get",Oc="application/x-www-form-urlencoded";function nh(l){return typeof HTMLElement<"u"&&l instanceof HTMLElement}function K1(l){return nh(l)&&l.tagName.toLowerCase()==="button"}function Z1(l){return nh(l)&&l.tagName.toLowerCase()==="form"}function Q1(l){return nh(l)&&l.tagName.toLowerCase()==="input"}function J1(l){return!!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)}function $1(l,e){return l.button===0&&(!e||e==="_self")&&!J1(l)}var mc=null;function ex(){if(mc===null)try{new FormData(document.createElement("form"),0),mc=!1}catch{mc=!0}return mc}var tx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $f(l){return l!=null&&!tx.has(l)?(Mi(!1,`"${l}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Oc}"`),null):l}function nx(l,e){let t,n,s,a,h;if(Z1(l)){let p=l.getAttribute("action");n=p?bs(p,e):null,t=l.getAttribute("method")||Ec,s=$f(l.getAttribute("enctype"))||Oc,a=new FormData(l)}else if(K1(l)||Q1(l)&&(l.type==="submit"||l.type==="image")){let p=l.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let v=l.getAttribute("formaction")||p.getAttribute("action");if(n=v?bs(v,e):null,t=l.getAttribute("formmethod")||p.getAttribute("method")||Ec,s=$f(l.getAttribute("formenctype"))||$f(p.getAttribute("enctype"))||Oc,a=new FormData(p,l),!ex()){let{name:_,type:b,value:E}=l;if(b==="image"){let N=_?`${_}.`:"";a.append(`${N}x`,"0"),a.append(`${N}y`,"0")}else _&&a.append(_,E)}}else{if(nh(l))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ec,n=null,s=Oc,h=l}return a&&s==="text/plain"&&(h=a,a=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:a,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Wd(l,e){if(l===!1||l===null||typeof l>"u")throw new Error(e)}function rx(l,e,t){let n=typeof l=="string"?new URL(l,typeof window>"u"?"server://singlefetch/":window.location.origin):l;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&bs(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function ix(l,e){if(l.id in e)return e[l.id];try{let t=await import(l.module);return e[l.id]=t,t}catch(t){return console.error(`Error loading route module \`${l.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sx(l){return l==null?!1:l.href==null?l.rel==="preload"&&typeof l.imageSrcSet=="string"&&typeof l.imageSizes=="string":typeof l.rel=="string"&&typeof l.href=="string"}async function ax(l,e,t){let n=await Promise.all(l.map(async s=>{let a=e.routes[s.route.id];if(a){let h=await ix(a,t);return h.links?h.links():[]}return[]}));return cx(n.flat(1).filter(sx).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function P0(l,e,t,n,s,a){let h=(v,_)=>t[_]?v.route.id!==t[_].route.id:!0,p=(v,_)=>t[_].pathname!==v.pathname||t[_].route.path?.endsWith("*")&&t[_].params["*"]!==v.params["*"];return a==="assets"?e.filter((v,_)=>h(v,_)||p(v,_)):a==="data"?e.filter((v,_)=>{let b=n.routes[v.route.id];if(!b||!b.hasLoader)return!1;if(h(v,_)||p(v,_))return!0;if(v.route.shouldRevalidate){let E=v.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(l,window.origin),nextParams:v.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function ox(l,e,{includeHydrateFallback:t}={}){return lx(l.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function lx(l){return[...new Set(l)]}function ux(l){let e={},t=Object.keys(l).sort();for(let n of t)e[n]=l[n];return e}function cx(l,e){let t=new Set;return new Set(e),l.reduce((n,s)=>{let a=JSON.stringify(ux(s));return t.has(a)||(t.add(a),n.push({key:a,link:s})),n},[])}function qm(){let l=Te.useContext(Bo);return Wd(l,"You must render this element inside a <DataRouterContext.Provider> element"),l}function hx(){let l=Te.useContext(th);return Wd(l,"You must render this element inside a <DataRouterStateContext.Provider> element"),l}var Ud=Te.createContext(void 0);Ud.displayName="FrameworkContext";function Km(){let l=Te.useContext(Ud);return Wd(l,"You must render this element inside a <HydratedRouter> element"),l}function fx(l,e){let t=Te.useContext(Ud),[n,s]=Te.useState(!1),[a,h]=Te.useState(!1),{onFocus:p,onBlur:v,onMouseEnter:_,onMouseLeave:b,onTouchStart:E}=e,N=Te.useRef(null);Te.useEffect(()=>{if(l==="render"&&h(!0),l==="viewport"){let W=K=>{K.forEach(ae=>{h(ae.isIntersecting)})},ee=new IntersectionObserver(W,{threshold:.5});return N.current&&ee.observe(N.current),()=>{ee.disconnect()}}},[l]),Te.useEffect(()=>{if(n){let W=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(W)}}},[n]);let O=()=>{s(!0)},Q=()=>{s(!1),h(!1)};return t?l!=="intent"?[a,N,{}]:[a,N,{onFocus:yl(p,O),onBlur:yl(v,Q),onMouseEnter:yl(_,O),onMouseLeave:yl(b,Q),onTouchStart:yl(E,O)}]:[!1,N,{}]}function yl(l,e){return t=>{l&&l(t),t.defaultPrevented||e(t)}}function dx({page:l,...e}){let{router:t}=qm(),n=Te.useMemo(()=>Im(t.routes,l,t.basename),[t.routes,l,t.basename]);return n?Te.createElement(gx,{page:l,matches:n,...e}):null}function px(l){let{manifest:e,routeModules:t}=Km(),[n,s]=Te.useState([]);return Te.useEffect(()=>{let a=!1;return ax(l,e,t).then(h=>{a||s(h)}),()=>{a=!0}},[l,e,t]),n}function gx({page:l,matches:e,...t}){let n=Wa(),{manifest:s,routeModules:a}=Km(),{basename:h}=qm(),{loaderData:p,matches:v}=hx(),_=Te.useMemo(()=>P0(l,e,v,s,n,"data"),[l,e,v,s,n]),b=Te.useMemo(()=>P0(l,e,v,s,n,"assets"),[l,e,v,s,n]),E=Te.useMemo(()=>{if(l===n.pathname+n.search+n.hash)return[];let Q=new Set,W=!1;if(e.forEach(K=>{let ae=s.routes[K.route.id];!ae||!ae.hasLoader||(!_.some(le=>le.route.id===K.route.id)&&K.route.id in p&&a[K.route.id]?.shouldRevalidate||ae.hasClientLoader?W=!0:Q.add(K.route.id))}),Q.size===0)return[];let ee=rx(l,h,"data");return W&&Q.size>0&&ee.searchParams.set("_routes",e.filter(K=>Q.has(K.route.id)).map(K=>K.route.id).join(",")),[ee.pathname+ee.search]},[h,p,n,s,_,e,l,a]),N=Te.useMemo(()=>ox(b,s),[b,s]),O=px(b);return Te.createElement(Te.Fragment,null,E.map(Q=>Te.createElement("link",{key:Q,rel:"prefetch",as:"fetch",href:Q,...t})),N.map(Q=>Te.createElement("link",{key:Q,rel:"modulepreload",href:Q,...t})),O.map(({key:Q,link:W})=>Te.createElement("link",{key:Q,nonce:t.nonce,...W})))}function mx(...l){return e=>{l.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var vx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vx&&(window.__reactRouterVersion="7.11.0")}catch{}function yx({basename:l,children:e,unstable_useTransitions:t,window:n}){let s=Te.useRef();s.current==null&&(s.current=J_({window:n,v5Compat:!0}));let a=s.current,[h,p]=Te.useState({action:a.action,location:a.location}),v=Te.useCallback(_=>{t===!1?p(_):Te.startTransition(()=>p(_))},[t]);return Te.useLayoutEffect(()=>a.listen(v),[a,v]),Te.createElement(Y1,{basename:l,children:e,location:h.location,navigationType:h.action,navigator:a,unstable_useTransitions:t})}var Zm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hd=Te.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:a,replace:h,state:p,target:v,to:_,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:N,...O},Q){let{basename:W,unstable_useTransitions:ee}=Te.useContext(hi),K=typeof _=="string"&&Zm.test(_),ae=Bm(_,W);_=ae.to;let le=I1(_,{relative:s}),[ve,we,F]=fx(n,O),ze=bx(_,{replace:h,state:p,target:v,preventScrollReset:b,relative:s,viewTransition:E,unstable_defaultShouldRevalidate:N,unstable_useTransitions:ee});function He(ut){e&&e(ut),ut.defaultPrevented||ze(ut)}let Je=Te.createElement("a",{...O,...F,href:ae.absoluteURL||le,onClick:ae.isExternal||a?e:He,ref:mx(Q,we),target:v,"data-discover":!K&&t==="render"?"true":void 0});return ve&&!K?Te.createElement(Te.Fragment,null,Je,Te.createElement(dx,{page:le})):Je});Hd.displayName="Link";var _x=Te.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:a,to:h,viewTransition:p,children:v,..._},b){let E=su(h,{relative:_.relative}),N=Wa(),O=Te.useContext(th),{navigator:Q,basename:W}=Te.useContext(hi),ee=O!=null&&Ex(E)&&p===!0,K=Q.encodeLocation?Q.encodeLocation(E).pathname:E.pathname,ae=N.pathname,le=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(ae=ae.toLowerCase(),le=le?le.toLowerCase():null,K=K.toLowerCase()),le&&W&&(le=bs(le,W)||le);const ve=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let we=ae===K||!s&&ae.startsWith(K)&&ae.charAt(ve)==="/",F=le!=null&&(le===K||!s&&le.startsWith(K)&&le.charAt(K.length)==="/"),ze={isActive:we,isPending:F,isTransitioning:ee},He=we?e:void 0,Je;typeof n=="function"?Je=n(ze):Je=[n,we?"active":null,F?"pending":null,ee?"transitioning":null].filter(Boolean).join(" ");let ut=typeof a=="function"?a(ze):a;return Te.createElement(Hd,{..._,"aria-current":He,className:Je,ref:b,style:ut,to:h,viewTransition:p},typeof v=="function"?v(ze):v)});_x.displayName="NavLink";var xx=Te.forwardRef(({discover:l="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:a,method:h=Ec,action:p,onSubmit:v,relative:_,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:N,...O},Q)=>{let{unstable_useTransitions:W}=Te.useContext(hi),ee=kx(),K=Tx(p,{relative:_}),ae=h.toLowerCase()==="get"?"get":"post",le=typeof p=="string"&&Zm.test(p),ve=we=>{if(v&&v(we),we.defaultPrevented)return;we.preventDefault();let F=we.nativeEvent.submitter,ze=F?.getAttribute("formmethod")||h,He=()=>ee(F||we.currentTarget,{fetcherKey:e,method:ze,navigate:t,replace:s,state:a,relative:_,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:N});W&&t!==!1?Te.startTransition(()=>He()):He()};return Te.createElement("form",{ref:Q,method:ae,action:K,onSubmit:n?v:ve,...O,"data-discover":!le&&l==="render"?"true":void 0})});xx.displayName="Form";function wx(l){return`${l} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Qm(l){let e=Te.useContext(Bo);return bn(e,wx(l)),e}function bx(l,{target:e,replace:t,state:n,preventScrollReset:s,relative:a,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:v}={}){let _=Bd(),b=Wa(),E=su(l,{relative:a});return Te.useCallback(N=>{if($1(N,e)){N.preventDefault();let O=t!==void 0?t:ql(b)===ql(E),Q=()=>_(l,{replace:O,state:n,preventScrollReset:s,relative:a,viewTransition:h,unstable_defaultShouldRevalidate:p});v?Te.startTransition(()=>Q()):Q()}},[b,_,E,t,n,e,l,s,a,h,p,v])}var Sx=0,Cx=()=>`__${String(++Sx)}__`;function kx(){let{router:l}=Qm("useSubmit"),{basename:e}=Te.useContext(hi),t=U1(),n=l.fetch,s=l.navigate;return Te.useCallback(async(a,h={})=>{let{action:p,method:v,encType:_,formData:b,body:E}=nx(a,e);if(h.navigate===!1){let N=h.fetcherKey||Cx();await n(N,t,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||v,formEncType:h.encType||_,flushSync:h.flushSync})}else await s(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||v,formEncType:h.encType||_,replace:h.replace,state:h.state,fromRouteId:t,flushSync:h.flushSync,viewTransition:h.viewTransition})},[n,s,e,t])}function Tx(l,{relative:e}={}){let{basename:t}=Te.useContext(hi),n=Te.useContext(ks);bn(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),a={...su(l||".",{relative:e})},h=Wa();if(l==null){a.search=h.search;let p=new URLSearchParams(a.search),v=p.getAll("index");if(v.some(b=>b==="")){p.delete("index"),v.filter(E=>E).forEach(E=>p.append("index",E));let b=p.toString();a.search=b?`?${b}`:""}}return(!l||l===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:xs([t,a.pathname])),ql(a)}function Ex(l,{relative:e}={}){let t=Te.useContext(Vm);bn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Qm("useViewTransitionState"),s=su(l,{relative:e});if(!t.isTransitioning)return!1;let a=bs(t.currentLocation.pathname,n)||t.currentLocation.pathname,h=bs(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Fc(s.pathname,h)!=null||Fc(s.pathname,a)!=null}var Jm=Mm();const Ox=({header:l,leftSidebar:e,undoRedoSidebar:t,canvasBoard:n,rightSidebar:s,footer:a})=>Z.jsxs("div",{className:"flex flex-col w-full h-screen bg-stone-300",children:[l&&Z.jsx("div",{className:"flex-none",children:l}),Z.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e&&Z.jsx("div",{className:"flex-none",children:e}),t&&Z.jsx("div",{className:"flex-none",children:t}),Z.jsx("div",{className:"flex-1 flex justify-center items-center",children:n}),s&&Z.jsx("div",{className:"flex-none",children:s})]}),a&&Z.jsx("div",{className:"flex-none",children:a})]});function de(l,e,t){return(e=(function(n){var s=(function(a,h){if(typeof a!="object"||!a)return a;var p=a[Symbol.toPrimitive];if(p!==void 0){var v=p.call(a,h);if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(h==="string"?String:Number)(a)})(n,"string");return typeof s=="symbol"?s:s+""})(e))in l?Object.defineProperty(l,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):l[e]=t,l}function A0(l,e){var t=Object.keys(l);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(l);e&&(n=n.filter((function(s){return Object.getOwnPropertyDescriptor(l,s).enumerable}))),t.push.apply(t,n)}return t}function ge(l){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?A0(Object(t),!0).forEach((function(n){de(l,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(t)):A0(Object(t)).forEach((function(n){Object.defineProperty(l,n,Object.getOwnPropertyDescriptor(t,n))}))}return l}function dn(l,e){if(l==null)return{};var t,n,s=(function(h,p){if(h==null)return{};var v={};for(var _ in h)if({}.hasOwnProperty.call(h,_)){if(p.indexOf(_)>=0)continue;v[_]=h[_]}return v})(l,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(l);for(n=0;n<a.length;n++)t=a[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(l,t)&&(s[t]=l[t])}return s}function ss(l,e){return e||(e=l.slice(0)),Object.freeze(Object.defineProperties(l,{raw:{value:Object.freeze(e)}}))}class M0{constructor(){de(this,"browserShadowBlurConstant",1),de(this,"DPI",96),de(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),de(this,"perfLimitSizeTotal",2097152),de(this,"maxCacheSideLimit",4096),de(this,"minCacheSideLimit",256),de(this,"disableStyleCopyPaste",!1),de(this,"enableGLFiltering",!0),de(this,"textureSize",4096),de(this,"forceGLPutImageData",!1),de(this,"cachesBoundsOfCurve",!1),de(this,"fontPaths",{}),de(this,"NUM_FRACTION_DIGITS",4)}}const Yt=new class extends M0{constructor(l){super(),this.configure(l)}configure(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,l)}addFonts(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=ge(ge({},this.fontPaths),l)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((l=>{delete this.fontPaths[l]}))}clearFonts(){this.fontPaths={}}restoreDefaults(l){const e=new M0,t=l?.reduce(((n,s)=>(n[s]=e[s],n)),{})||e;this.configure(t)}},Ss=function(l){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[l]("fabric",...t)};class $i extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class Xd extends $i{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}let Px=class{};class Ax extends Px{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((n=>this.testPrecision(t,n))),t.getExtension("WEBGL_lose_context").loseContext(),Ss("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const Mx={};let md;const Ix=l=>{md=l},Ii=()=>md||(md={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new Ax,dispose(){},copyPasteData:Mx}),Ua=()=>Ii().document,Ti=()=>Ii().window,$m=()=>{var l;return Math.max((l=Yt.devicePixelRatio)!==null&&l!==void 0?l:Ti().devicePixelRatio,1)},Po=new class{constructor(){de(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(l){let{fontFamily:e,fontStyle:t,fontWeight:n}=l;e=e.toLowerCase();const s=this.charWidthsCache;s.has(e)||s.set(e,new Map);const a=s.get(e),h="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return a.has(h)||a.set(h,new Map),a.get(h)}clearFontCache(l){l?this.charWidthsCache.delete((l||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(l){const{perfLimitSizeTotal:e}=Yt,t=Math.sqrt(e*l);return[Math.floor(t),Math.floor(e/t)]}},Nc="6.9.1";function Fa(){}const na=Math.PI/2,Cs=2*Math.PI,Gd=Math.PI/180,cr=Object.freeze([1,0,0,1,0,0]),Yd=16,$s=.4477152502,Rt="center",nn="left",Lr="top",vd="bottom",Mn="right",_r="none",qd=/\r?\n/,ev="moving",rh="scaling",tv="rotating",Kd="rotate",nv="skewing",Kl="resizing",rv="modifyPoly",jx="modifyPath",Bc="changed",ih="scale",br="scaleX",Yr="scaleY",zo="skewX",Vo="skewY",Rn="fill",xr="stroke",zc="modified",wo="json",ed="svg",ct=new class{constructor(){this[wo]=new Map,this[ed]=new Map}has(l){return this[wo].has(l)}getClass(l){const e=this[wo].get(l);if(!e)throw new $i("No class registered for ".concat(l));return e}setClass(l,e){e?this[wo].set(e,l):(this[wo].set(l.type,l),this[wo].set(l.type.toLowerCase(),l))}getSVGClass(l){return this[ed].get(l)}setSVGClass(l,e){this[ed].set(e??l.type.toLowerCase(),l)}},Zl=new class extends Array{remove(l){const e=this.indexOf(l);e>-1&&this.splice(e,1)}cancelAll(){const l=this.splice(0);return l.forEach((e=>e.abort())),l}cancelByCanvas(l){if(!l)return[];const e=this.filter((t=>{var n;return t.target===l||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===l}));return e.forEach((t=>t.abort())),e}cancelByTarget(l){if(!l)return[];const e=this.filter((t=>t.target===l));return e.forEach((t=>t.abort())),e}};class iv{constructor(){de(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach((n=>{let[s,a]=n;this.on(s,a)})),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach((s=>{let[a,h]=s;n.push(this.once(a,h))})),()=>n.forEach((s=>s()))}if(t){const n=this.on(e,(function(){for(var s=arguments.length,a=new Array(s),h=0;h<s;h++)a[h]=arguments[h];t.call(this,...a),n()}));return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],s=n.indexOf(t);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach((n=>{let[s,a]=n;this._removeEventListener(s,a)})):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let a=0;a<s.length;a++)s[a].call(this,t||{})}}const Ia=(l,e)=>{const t=l.indexOf(e);return t!==-1&&l.splice(t,1),l},ji=l=>{if(l===0)return 1;switch(Math.abs(l)/na){case 1:case 3:return 0;case 2:return-1}return Math.cos(l)},Li=l=>{if(l===0)return 0;const e=l/na,t=Math.sign(l);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(l)};class Ce{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Ce(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Ce(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Ce(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Ce(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Ce(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Ce(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Ce(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Ce(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Ce(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new Ce(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Ce(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new Ce(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Zd;const n=Li(e),s=ji(e),a=this.subtract(t);return new Ce(a.x*s-a.y*n,a.x*n+a.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ce(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Zd=new Ce(0,0),Pc=l=>!!l&&Array.isArray(l._objects);function Qd(l){class e extends l{constructor(){super(...arguments),de(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];const h=this._objects.push(...s);return s.forEach((p=>this._onObjectAdded(p))),h}insertAt(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),h=1;h<s;h++)a[h-1]=arguments[h];return this._objects.splice(n,0,...a),a.forEach((p=>this._onObjectAdded(p))),this._objects.length}remove(){const n=this._objects,s=[];for(var a=arguments.length,h=new Array(a),p=0;p<a;p++)h[p]=arguments[p];return h.forEach((v=>{const _=n.indexOf(v);_!==-1&&(n.splice(_,1),s.push(v),this._onObjectRemoved(v))})),s}forEachObject(n){this.getObjects().forEach(((s,a,h)=>n(s,a,h)))}getObjects(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return s.length===0?[...this._objects]:this._objects.filter((h=>h.isType(...s)))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some((a=>a instanceof e&&a.contains(n,!0)))}complexity(){return this._objects.reduce(((n,s)=>n+=s.complexity?s.complexity():0),0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Ia(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Ia(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const a=this._objects.indexOf(n);if(a!==0){const h=this.findNewLowerIndex(n,a,s);return Ia(this._objects,n),this._objects.splice(h,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const a=this._objects.indexOf(n);if(a!==this._objects.length-1){const h=this.findNewUpperIndex(n,a,s);return Ia(this._objects,n),this._objects.splice(h,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(Ia(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,a){let h;if(a){h=s;for(let p=s-1;p>=0;--p)if(n.isOverlapping(this._objects[p])){h=p;break}}else h=s-1;return h}findNewUpperIndex(n,s,a){let h;if(a){h=s;for(let p=s+1;p<this._objects.length;++p)if(n.isOverlapping(this._objects[p])){h=p;break}}else h=s+1;return h}collectObjects(n){let{left:s,top:a,width:h,height:p}=n,{includeIntersecting:v=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const _=[],b=new Ce(s,a),E=b.add(new Ce(h,p));for(let N=this._objects.length-1;N>=0;N--){const O=this._objects[N];O.selectable&&O.visible&&(v&&O.intersectsWithRect(b,E)||O.isContainedWithinRect(b,E)||v&&O.containsPoint(b)||v&&O.containsPoint(E))&&_.push(O)}return _}}return e}class sv extends iv{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function Wl(l){return Ti().requestAnimationFrame(l)}function av(l){return Ti().cancelAnimationFrame(l)}let Lx=0;const ra=()=>Lx++,ui=()=>{const l=Ua().createElement("canvas");if(!l||l.getContext===void 0)throw new $i("Failed to create `canvas` element");return l},ov=()=>Ua().createElement("img"),Dr=l=>{const e=ui();return e.width=l.width,e.height=l.height,e},Jd=(l,e,t)=>l.toDataURL("image/".concat(e),t),$d=(l,e,t)=>new Promise(((n,s)=>{l.toBlob(n,"image/".concat(e),t)})),En=l=>l*Gd,is=l=>l/Gd,lv=l=>l.every(((e,t)=>e===cr[t])),lr=(l,e,t)=>new Ce(l).transform(e,t),jr=l=>{const e=1/(l[0]*l[3]-l[1]*l[2]),t=[e*l[3],-e*l[1],-e*l[2],e*l[0],0,0],{x:n,y:s}=new Ce(l[4],l[5]).transform(t,!0);return t[4]=-n,t[5]=-s,t},wn=(l,e,t)=>[l[0]*e[0]+l[2]*e[1],l[1]*e[0]+l[3]*e[1],l[0]*e[2]+l[2]*e[3],l[1]*e[2]+l[3]*e[3],t?0:l[0]*e[4]+l[2]*e[5]+l[4],t?0:l[1]*e[4]+l[3]*e[5]+l[5]],sh=(l,e)=>l.reduceRight(((t,n)=>n&&t?wn(n,t,e):n||t),void 0)||cr.concat(),uv=l=>{let[e,t]=l;return Math.atan2(t,e)},Na=l=>{const e=uv(l),t=Math.pow(l[0],2)+Math.pow(l[1],2),n=Math.sqrt(t),s=(l[0]*l[3]-l[2]*l[1])/n,a=Math.atan2(l[0]*l[2]+l[1]*l[3],t);return{angle:is(e),scaleX:n,scaleY:s,skewX:is(a),skewY:0,translateX:l[4]||0,translateY:l[5]||0}},Wo=function(l){return[1,0,0,1,l,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Ha(){let{angle:l=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=En(l),s=ji(n),a=Li(n);return[s,a,-a,s,e?e-(s*e-a*t):0,t?t-(a*e+s*t):0]}const ah=function(l){return[l,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:l,0,0]},cv=l=>Math.tan(En(l)),ep=l=>[1,0,cv(l),1,0,0],tp=l=>[1,cv(l),0,1,0,0],au=l=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:s=!1,skewX:a=0,skewY:h=0}=l,p=ah(n?-e:e,s?-t:t);return a&&(p=wn(p,ep(a),!0)),h&&(p=wn(p,tp(h),!0)),p},hv=l=>{const{translateX:e=0,translateY:t=0,angle:n=0}=l;let s=Wo(e,t);n&&(s=wn(s,Ha({angle:n})));const a=au(l);return lv(a)||(s=wn(s,a)),s},Ul=function(l){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(n,s){if(e&&e.aborted)return s(new Xd("loadImage"));const a=ov();let h;e&&(h=function(v){a.src="",s(v)},e.addEventListener("abort",h,{once:!0}));const p=function(){a.onload=a.onerror=null,h&&e?.removeEventListener("abort",h),n(a)};l?(a.onload=p,a.onerror=function(){h&&e?.removeEventListener("abort",h),s(new $i("Error loading ".concat(a.src)))},t&&(a.crossOrigin=t),a.src=l):p()}))},Io=function(l){let{signal:e,reviver:t=Fa}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((n,s)=>{const a=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(l.map((h=>ct.getClass(h.type).fromObject(h,{signal:e}).then((p=>(t(h,p),a.push(p),p)))))).then(n).catch((h=>{a.forEach((p=>{p.dispose&&p.dispose()})),s(h)})).finally((()=>{e&&e.removeEventListener("abort",s)}))}))},ou=function(l){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((t,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const a=Object.values(l).map((p=>p&&p.type&&ct.has(p.type)?Io([p],{signal:e}).then((v=>{let[_]=v;return s.push(_),_})):p)),h=Object.keys(l);Promise.all(a).then((p=>p.reduce(((v,_,b)=>(v[h[b]]=_,v)),{}))).then(t).catch((p=>{s.forEach((v=>{v.dispose&&v.dispose()})),n(p)})).finally((()=>{e&&e.removeEventListener("abort",n)}))}))},Xa=function(l){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((e,t)=>(t in l&&(e[t]=l[t]),e)),{})},np=(l,e)=>Object.keys(l).reduce(((t,n)=>(e(l[n],n,l)&&(t[n]=l[n]),t)),{}),on=(l,e)=>parseFloat(Number(l).toFixed(e)),jo=l=>"matrix("+l.map((e=>on(e,Yt.NUM_FRACTION_DIGITS))).join(" ")+")",oi=l=>!!l&&l.toLive!==void 0,I0=l=>!!l&&typeof l.toObject=="function",j0=l=>!!l&&l.offsetX!==void 0&&"source"in l,ja=l=>!!l&&"multiSelectionStacking"in l;function fv(l){const e=l&&ki(l);let t=0,n=0;if(!l||!e)return{left:t,top:n};let s=l;const a=e.documentElement,h=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=h.scrollLeft||a.scrollLeft||0,n=h.scrollTop||a.scrollTop||0):(t+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:n}}const ki=l=>l.ownerDocument||null,dv=l=>{var e;return((e=l.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},pv=function(l,e,t){let{width:n,height:s}=t,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;l.width=n,l.height=s,a>1&&(l.setAttribute("width",(n*a).toString()),l.setAttribute("height",(s*a).toString()),e.scale(a,a))},yd=(l,e)=>{let{width:t,height:n}=e;t&&(l.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(l.style.height=typeof n=="number"?"".concat(n,"px"):n)};function L0(l){return l.onselectstart!==void 0&&(l.onselectstart=()=>!1),l.style.userSelect=_r,l}class rp{constructor(e){de(this,"_originalCanvasStyle",void 0),de(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&Ua().getElementById(e)||ui();var n;if(t.hasAttribute("data-fabric"))throw new $i("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:s}=this.lower;pv(n,s,e,t)}setCSSDimensions(e){yd(this.lower.el,e)}calcOffset(){return(function(e){var t;const n=e&&ki(e),s={left:0,top:0};if(!n)return s;const a=((t=dv(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(a.borderLeftWidth,10)||0,s.top+=parseInt(a.borderTopWidth,10)||0,s.left+=parseInt(a.paddingLeft,10)||0,s.top+=parseInt(a.paddingTop,10)||0;let h={left:0,top:0};const p=n.documentElement;e.getBoundingClientRect!==void 0&&(h=e.getBoundingClientRect());const v=fv(e);return{left:h.left+v.left-(p.clientLeft||0)+s.left,top:h.top+v.top-(p.clientTop||0)+s.top}})(this.lower.el)}dispose(){Ii().dispose(this.lower.el),delete this.lower}}const Dx={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...cr]},Rx=["objects"];class Uo extends Qd(sv){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Uo.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new rp(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const a=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),a}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Ss("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?$m():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=ge({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,s=[...this.viewportTransform],a=lr(e,jr(s));s[0]=t,s[3]=t;const h=lr(a,s);s[4]+=n.x-h.x,s[5]+=n.y-h.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new Ce(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new Ce(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Wl((()=>this.renderAndReset())))}calcViewportBoundaries(){const e=this.width,t=this.height,n=jr(this.viewportTransform),s=lr({x:0,y:0},n),a=lr({x:e,y:t},n),h=s.min(a),p=s.max(a);return this.vptCoords={tl:h,tr:new Ce(p.x,h.y),bl:new Ce(h.x,p.y),br:p}}cancelRequestedRender(){this.nextRenderHandle&&(av(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,s=t.length;n<s;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],s=this["".concat(t,"Image")],a=this.viewportTransform,h=this["".concat(t,"Vpt")];if(!n&&!s)return;const p=oi(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=p?n.toLive(e):n,h&&e.transform(...a),p){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const v=n.gradientTransform||n.patternTransform;v&&e.transform(...v)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:v}=this;this.skipOffscreen=h,h&&e.transform(...a),s.render(e),this.skipOffscreen=v,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Ce(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Ce(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Ce(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Ce(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Ce(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return lr(this.getCenterPoint(),jr(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Rt,Rt),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return ge(ge(ge({version:Nc},Xa(this,t)),{},{objects:this._objects.filter((a=>!a.excludeFromExport)).map((a=>this._toObject(a,e,t)))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const a=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),a}__serializeBgOverlay(e,t){const n={},s=this.backgroundImage,a=this.overlayImage,h=this.backgroundColor,p=this.overlayColor;return oi(h)?h.excludeFromExport||(n.background=h.toObject(t)):h&&(n.background=h),oi(p)?p.excludeFromExport||(n.overlay=p.toObject(t)):p&&(n.overlay=p),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,t)),a&&!a.excludeFromExport&&(n.overlayImage=this._toObject(a,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),s=t.height||"".concat(this.height),a=Yt.NUM_FRACTION_DIGITS,h=t.viewBox;let p;if(h)p='viewBox="'.concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height,'" ');else if(this.svgViewportTransformation){const v=this.viewportTransform;p='viewBox="'.concat(on(-v[4]/v[0],a)," ").concat(on(-v[5]/v[3],a)," ").concat(on(this.width/v[0],a)," ").concat(on(this.height/v[3],a),'" ')}else p='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',p,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Nc,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(ra()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((e=>{const t=this["".concat(e,"Color")];if(oi(t)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,a={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return t.toSVG(a,{additionalTransform:n?jo(s):""})}})).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=Yt.fontPaths;this._objects.forEach((function a(h){e.push(h),Pc(h)&&h._objects.forEach(a)})),e.forEach((a=>{if(!(h=a)||typeof h._renderText!="function")return;var h;const{styles:p,fontFamily:v}=a;!t[v]&&n[v]&&(t[v]=!0,p&&Object.values(p).forEach((_=>{Object.values(_).forEach((b=>{let{fontFamily:E=""}=b;!t[E]&&n[E]&&(t[E]=!0)}))})))}));const s=Object.keys(t).map((a=>`		@font-face {
			font-family: '`.concat(a,`';
			src: url('`).concat(n[a],`');
		}
`))).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject((n=>{n.excludeFromExport||this._setSVGObject(e,n,t)}))}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(oi(n)){const s=n.repeat||"",a=this.width,h=this.height,p=this["".concat(t,"Vpt")]?jo(jr(this.viewportTransform)):"";e.push('<rect transform="'.concat(p," translate(").concat(a/2,",").concat(h/2,')" x="').concat(n.offsetX-a/2,'" y="').concat(n.offsetY-h/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!j0(n)?a:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!j0(n)?h:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new $i("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:a=[]}=s,h=dn(s,Rx),{backgroundImage:p,background:v,overlayImage:_,overlay:b,clipPath:E}=h,N=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Io(a,{reviver:t,signal:n}),ou({backgroundImage:p,backgroundColor:v,overlayImage:_,overlayColor:b,clipPath:E},{signal:n})]).then((O=>{let[Q,W]=O;return this.clear(),this.add(...Q),this.set(h),this.set(W),this.renderOnAddRemove=N,this}))}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Dr(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:a=!1}=e,h=s*(a?this.getRetinaScaling():1);return Jd(this.toCanvasElement(h,e),t,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:a=!1}=e,h=s*(a?this.getRetinaScaling():1);return $d(this.toCanvasElement(h,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:s,top:a,filter:h}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const p=(t||this.width)*e,v=(n||this.height)*e,_=this.getZoom(),b=this.width,E=this.height,N=this.skipControlsDrawing,O=_*e,Q=this.viewportTransform,W=[O,0,0,O,(Q[4]-(s||0))*e,(Q[5]-(a||0))*e],ee=this.enableRetinaScaling,K=Dr({width:p,height:v}),ae=h?this._objects.filter((le=>h(le))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=W,this.width=p,this.height=v,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(K.getContext("2d"),ae),this.viewportTransform=Q,this.width=b,this.height=E,this.calcViewportBoundaries(),this.enableRetinaScaling=ee,this.skipControlsDrawing=N,K}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Zl.cancelByCanvas(this),this.disposed=!0,new Promise(((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((e=>e.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}de(Uo,"ownDefaults",Dx);const Fx=["touchstart","touchmove","touchend"],gv=l=>{const e=fv(l.target),t=(function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n})(l);return new Ce(t.clientX+e.left,t.clientY+e.top)},Vc=l=>Fx.includes(l.type)||l.pointerType==="touch",D0=l=>{l.preventDefault(),l.stopPropagation()},rs=l=>{let e=0,t=0,n=0,s=0;for(let a=0,h=l.length;a<h;a++){const{x:p,y:v}=l[a];(p>n||!a)&&(n=p),(p<e||!a)&&(e=p),(v>s||!a)&&(s=v),(v<t||!a)&&(t=v)}return{left:e,top:t,width:n-e,height:s-t}},Nx=["translateX","translateY","scaleX","scaleY"],mv=(l,e)=>Lo(l,wn(e,l.calcOwnMatrix())),Lo=(l,e)=>{const t=Na(e),{translateX:n,translateY:s,scaleX:a,scaleY:h}=t,p=dn(t,Nx),v=new Ce(n,s);l.flipX=!1,l.flipY=!1,Object.assign(l,p),l.set({scaleX:a,scaleY:h}),l.setPositionByOrigin(v,Rt,Rt)},vv=l=>{l.scaleX=1,l.scaleY=1,l.skewX=0,l.skewY=0,l.flipX=!1,l.flipY=!1,l.rotate(0)},ip=l=>({scaleX:l.scaleX,scaleY:l.scaleY,skewX:l.skewX,skewY:l.skewY,angle:l.angle,left:l.left,flipX:l.flipX,flipY:l.flipY,top:l.top}),oh=(l,e,t)=>{const n=l/2,s=e/2,a=[new Ce(-n,-s),new Ce(n,-s),new Ce(-n,s),new Ce(n,s)].map((p=>p.transform(t))),h=rs(a);return new Ce(h.width,h.height)},lu=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:cr;return wn(jr(arguments.length>1&&arguments[1]!==void 0?arguments[1]:cr),l)},ws=function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cr;return l.transform(lu(e,t))},yv=function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:cr;return l.transform(lu(e,t),!0)},_d=(l,e,t)=>{const n=lu(e,t);return Lo(l,wn(n,l.calcOwnMatrix())),n},sp=(l,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(l),ge(ge({},e),{},{target:n})),n.fire(l,e)},Bx={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Dn=l=>typeof l=="string"?Bx[l]:l-.5,Wc="not-allowed";function _v(l){return Dn(l.originX)===Dn(Rt)&&Dn(l.originY)===Dn(Rt)}function R0(l){return .5-Dn(l)}const Ai=(l,e)=>l[e],ap=(l,e,t,n)=>({e:l,transform:e,pointer:new Ce(t,n)});function xv(l,e){const t=l.getTotalAngle()+is(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function lh(l,e,t,n,s){var a;let{target:h,corner:p}=l;const v=h.controls[p],_=((a=h.canvas)===null||a===void 0?void 0:a.getZoom())||1,b=h.padding/_,E=(function(N,O,Q,W){const ee=N.getRelativeCenterPoint(),K=Q!==void 0&&W!==void 0?N.translateToGivenOrigin(ee,Rt,Rt,Q,W):new Ce(N.left,N.top);return(N.angle?O.rotate(-En(N.angle),ee):O).subtract(K)})(h,new Ce(n,s),e,t);return E.x>=b&&(E.x-=b),E.x<=-b&&(E.x+=b),E.y>=b&&(E.y-=b),E.y<=b&&(E.y+=b),E.x-=v.offsetX,E.y-=v.offsetY,E}const wv=(l,e,t,n)=>{const{target:s,offsetX:a,offsetY:h}=e,p=t-a,v=n-h,_=!Ai(s,"lockMovementX")&&s.left!==p,b=!Ai(s,"lockMovementY")&&s.top!==v;return _&&s.set(nn,p),b&&s.set(Lr,v),(_||b)&&sp(ev,ap(l,e,t,n)),_||b},Uc=l=>l.replace(/\s+/g," "),F0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},td=(l,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?l+6*(e-l)*t:t<.5?e:t<2/3?l+(e-l)*(2/3-t)*6:l),N0=(l,e,t,n)=>{l/=255,e/=255,t/=255;const s=Math.max(l,e,t),a=Math.min(l,e,t);let h,p;const v=(s+a)/2;if(s===a)h=p=0;else{const _=s-a;switch(p=v>.5?_/(2-s-a):_/(s+a),s){case l:h=(e-t)/_+(e<t?6:0);break;case e:h=(t-l)/_+2;break;case t:h=(l-e)/_+4}h/=6}return[Math.round(360*h),Math.round(100*p),Math.round(100*v),n]},B0=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(l)/(l.endsWith("%")?100:1)},vc=l=>Math.min(Math.round(l),255).toString(16).toUpperCase().padStart(2,"0"),z0=l=>{let[e,t,n,s=1]=l;const a=Math.round(.3*e+.59*t+.11*n);return[a,a,a,s]};class $t{constructor(e){if(de(this,"isUnrecognised",!1),e)if(e instanceof $t)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,s,a=1]=e;this.setSource([t,n,s,a])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in F0&&(e=F0[e]),e==="transparent"?[255,255,255,0]:$t.sourceFromHex(e)||$t.sourceFromRgb(e)||$t.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=N0(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,s]=N0(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,s]=this.getSource();return"".concat(vc(e)).concat(vc(t)).concat(vc(n)).concat(vc(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(z0(this.getSource())),this}toBlackWhite(e){const[t,,,n]=z0(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof $t||(e=new $t(e));const t=this.getSource(),n=e.getSource(),[s,a,h]=t.map(((p,v)=>Math.round(.5*p+.5*n[v])));return this.setSource([s,a,h,t[3]]),this}static fromRgb(e){return $t.fromRgba(e)}static fromRgba(e){return new $t($t.sourceFromRgb(e))}static sourceFromRgb(e){const t=Uc(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){const[n,s,a]=t.slice(1,4).map((h=>{const p=parseFloat(h);return h.endsWith("%")?Math.round(2.55*p):p}));return[n,s,a,B0(t[4])]}}static fromHsl(e){return $t.fromHsla(e)}static fromHsla(e){return new $t($t.sourceFromHsl(e))}static sourceFromHsl(e){const t=Uc(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;const n=($t.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,a=parseFloat(t[3])/100;let h,p,v;if(s===0)h=p=v=a;else{const _=a<=.5?a*(s+1):a+s-a*s,b=2*a-_;h=td(b,_,n+1/3),p=td(b,_,n),v=td(b,_,n-1/3)}return[Math.round(255*h),Math.round(255*p),Math.round(255*v),B0(t[4])]}static fromHex(e){return new $t($t.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map((v=>v+v)):t.match(/.{2}/g);const[s,a,h,p=255]=n.map((v=>parseInt(v,16)));return[s,a,h,p/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?is(n):t.includes("turn")?360*n:n}}const gr=function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yd;const t=/\D{0,2}$/.exec(l),n=parseFloat(l),s=Yt.DPI;switch(t?.[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},op=l=>{const[e,t]=l.trim().split(" "),[n,s]=(a=e)&&a!==_r?[a.slice(1,4),a.slice(5,8)]:a===_r?[a,a]:["Mid","Mid"];var a;return{meetOrSlice:t||"meet",alignX:n,alignY:s}},Ql=function(l,e){let t,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const a=new $t(e),h=a.getAlpha();t=a.toRgb(),h!==1&&(n=h.toString())}else t="none";return s?"".concat(l,": ").concat(t,"; ").concat(n?"".concat(l,"-opacity: ").concat(n,"; "):""):"".concat(l,'="').concat(t,'" ').concat(n?"".concat(l,'-opacity="').concat(n,'" '):"")};class bv{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):_r,a=this.strokeDashOffset?this.strokeDashOffset:"0",h=this.strokeLineCap?this.strokeLineCap:"butt",p=this.strokeLineJoin?this.strokeLineJoin:"miter",v=this.strokeMiterLimit?this.strokeMiterLimit:"4",_=this.opacity!==void 0?this.opacity:"1",b=this.visible?"":" visibility: hidden;",E=e?"":this.getSvgFilter(),N=Ql(Rn,this.fill);return[Ql(xr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",h,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",p,"; ","stroke-miterlimit: ",v,"; ",N,"fill-rule: ",t,"; ","opacity: ",_,";",E,b].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(jo(n));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),a=e.indexOf("COMMON_PARTS");return e[a]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:s,additionalTransform:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=t?"":'style="'.concat(this.getSvgStyles(),'" '),p=s?'style="'.concat(this.getSvgFilter(),'" '):"",v=this.clipPath,_=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",b=v&&v.absolutePositioned,E=this.stroke,N=this.fill,O=this.shadow,Q=[],W=e.indexOf("COMMON_PARTS");let ee;v&&(v.clipPathId="CLIPPATH_".concat(ra()),ee='<clipPath id="'.concat(v.clipPathId,`" >
`).concat(v.toClipPathSVG(n),`</clipPath>
`)),b&&Q.push("<g ",p,this.getSvgCommons(),` >
`),Q.push("<g ",this.getSvgTransform(!1),b?"":p+this.getSvgCommons(),` >
`);const K=[h,_,t?"":this.addPaintOrder()," ",a?'transform="'.concat(a,'" '):""].join("");return e[W]=K,oi(N)&&Q.push(N.toSVG(this)),oi(E)&&Q.push(E.toSVG(this)),O&&Q.push(O.toSVG(this)),v&&Q.push(ee),Q.push(e.join("")),Q.push(`</g>
`),b&&Q.push(`</g>
`),n?n(Q.join("")):Q.join("")}addPaintOrder(){return this.paintFirst!==Rn?' paint-order="'.concat(this.paintFirst,'" '):""}}function uh(l){return new RegExp("^("+l.join("|")+")\\b","i")}const Ba="textDecorationThickness",Sv=["fontSize","fontWeight","fontFamily","fontStyle"],Cv=["underline","overline","linethrough"],kv=[...Sv,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Tv=[...kv,...Cv,"textBackgroundColor","direction",Ba],zx=[...Sv,...Cv,xr,"strokeWidth",Rn,"deltaY","textBackgroundColor",Ba],Vx={_reNewline:qd,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:nn,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:nn,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[Ba]:66.667},Qi="justify",Hc="justify-left",Hl="justify-right",Xl="justify-center";var V0,W0,U0;const Ei=String.raw(V0||(V0=ss(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),nd=String.raw(W0||(W0=ss(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),xd="http://www.w3.org/2000/svg",Wx=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Ei+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Ei+"))?\\s+(.*)"),Ux={cx:nn,x:nn,r:"radius",cy:Lr,y:Lr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":Ba},rd="font-size",id="clip-path",Hx=uh(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),Xx=uh(["symbol","image","marker","pattern","view","svg"]),H0=uh(["symbol","g","a","svg","clipPath","defs"]),X0=new RegExp(String.raw(U0||(U0=ss(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),Ei,nd,Ei,nd,Ei,nd,Ei)),Gx=new Ce(1,0),Ev=new Ce,lp=(l,e)=>l.rotate(e),Xc=(l,e)=>new Ce(e).subtract(l),Gc=l=>l.distanceFrom(Ev),Yc=(l,e)=>Math.atan2(Ao(l,e),Pv(l,e)),Ov=l=>Yc(Gx,l),ch=l=>l.eq(Ev)?l:l.scalarDivide(Gc(l)),up=function(l){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return ch(new Ce(-l.y,l.x).scalarMultiply(e?1:-1))},Ao=(l,e)=>l.x*e.y-l.y*e.x,Pv=(l,e)=>l.x*e.x+l.y*e.y,wd=(l,e,t)=>{if(l.eq(e)||l.eq(t))return!0;const n=Ao(e,t),s=Ao(e,l),a=Ao(t,l);return n>=0?s>=0&&a<=0:!(s<=0&&a>=0)},G0="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Y0=new RegExp("(?:\\s|^)"+G0+G0+"("+Ei+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class wr{constructor(e){const t=typeof e=="string"?wr.parseShadow(e):e;Object.assign(this,wr.ownDefaults,t),this.id=ra()}static parseShadow(e){const t=e.trim(),[,n=0,s=0,a=0]=(Y0.exec(t)||[]).map((h=>parseFloat(h)||0));return{color:(t.replace(Y0,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:a}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=lp(new Ce(this.offsetX,this.offsetY),En(-e.angle)),n=new $t(this.color);let s=40,a=40;return e.width&&e.height&&(s=100*on((Math.abs(t.x)+this.blur)/e.width,Yt.NUM_FRACTION_DIGITS)+20,a=100*on((Math.abs(t.y)+this.blur)/e.height,Yt.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(a,'%" height="').concat(100+2*a,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(on(this.blur?this.blur/2:0,Yt.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(on(t.x,Yt.NUM_FRACTION_DIGITS),'" dy="').concat(on(t.y,Yt.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=wr.ownDefaults;return this.includeDefaultValues?e:np(e,((n,s)=>n!==t[s]))}static async fromObject(e){return new this(e)}}de(wr,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),de(wr,"type","shadow"),ct.setClass(wr,"shadow");const za=(l,e,t)=>Math.max(l,Math.min(e,t)),Yx=[Lr,nn,br,Yr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",zo,Vo],Ts=[Rn,xr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],qx={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:nn,originY:Lr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Rn,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},sd=(l,e,t,n)=>(l<Math.abs(e)?(l=e,n=t/4):n=e===0&&l===0?t/Cs*Math.asin(1):t/Cs*Math.asin(e/l),{a:l,c:e,p:t,s:n}),q0=(l,e,t,n,s)=>l*Math.pow(2,10*(n-=1))*Math.sin((n*s-e)*Cs/t),Av=(l,e,t,n)=>-t*Math.cos(l/n*na)+t+e,bd=(l,e,t,n)=>(l/=n)<1/2.75?t*(7.5625*l*l)+e:l<2/2.75?t*(7.5625*(l-=1.5/2.75)*l+.75)+e:l<2.5/2.75?t*(7.5625*(l-=2.25/2.75)*l+.9375)+e:t*(7.5625*(l-=2.625/2.75)*l+.984375)+e,K0=(l,e,t,n)=>t-bd(n-l,0,t,n)+e;var Kx=Object.freeze({__proto__:null,defaultEasing:Av,easeInBack:function(l,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(l/=n)*l*((s+1)*l-s)+e},easeInBounce:K0,easeInCirc:(l,e,t,n)=>-t*(Math.sqrt(1-(l/=n)*l)-1)+e,easeInCubic:(l,e,t,n)=>t*(l/n)**3+e,easeInElastic:(l,e,t,n)=>{const s=t;let a=0;if(l===0)return e;if((l/=n)===1)return e+t;a||(a=.3*n);const{a:h,s:p,p:v}=sd(s,t,a,1.70158);return-q0(h,p,v,l,n)+e},easeInExpo:(l,e,t,n)=>l===0?e:t*2**(10*(l/n-1))+e,easeInOutBack:function(l,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(l/=n/2)<1?t/2*(l*l*((1+(s*=1.525))*l-s))+e:t/2*((l-=2)*l*((1+(s*=1.525))*l+s)+2)+e},easeInOutBounce:(l,e,t,n)=>l<n/2?.5*K0(2*l,0,t,n)+e:.5*bd(2*l-n,0,t,n)+.5*t+e,easeInOutCirc:(l,e,t,n)=>(l/=n/2)<1?-t/2*(Math.sqrt(1-l**2)-1)+e:t/2*(Math.sqrt(1-(l-=2)*l)+1)+e,easeInOutCubic:(l,e,t,n)=>(l/=n/2)<1?t/2*l**3+e:t/2*((l-2)**3+2)+e,easeInOutElastic:(l,e,t,n)=>{const s=t;let a=0;if(l===0)return e;if((l/=n/2)===2)return e+t;a||(a=n*(.3*1.5));const{a:h,s:p,p:v,c:_}=sd(s,t,a,1.70158);return l<1?-.5*q0(h,p,v,l,n)+e:h*Math.pow(2,-10*(l-=1))*Math.sin((l*n-p)*Cs/v)*.5+_+e},easeInOutExpo:(l,e,t,n)=>l===0?e:l===n?e+t:(l/=n/2)<1?t/2*2**(10*(l-1))+e:t/2*-(2**(-10*--l)+2)+e,easeInOutQuad:(l,e,t,n)=>(l/=n/2)<1?t/2*l**2+e:-t/2*(--l*(l-2)-1)+e,easeInOutQuart:(l,e,t,n)=>(l/=n/2)<1?t/2*l**4+e:-t/2*((l-=2)*l**3-2)+e,easeInOutQuint:(l,e,t,n)=>(l/=n/2)<1?t/2*l**5+e:t/2*((l-2)**5+2)+e,easeInOutSine:(l,e,t,n)=>-t/2*(Math.cos(Math.PI*l/n)-1)+e,easeInQuad:(l,e,t,n)=>t*(l/=n)*l+e,easeInQuart:(l,e,t,n)=>t*(l/=n)*l**3+e,easeInQuint:(l,e,t,n)=>t*(l/n)**5+e,easeInSine:(l,e,t,n)=>-t*Math.cos(l/n*na)+t+e,easeOutBack:function(l,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((l=l/n-1)*l*((s+1)*l+s)+1)+e},easeOutBounce:bd,easeOutCirc:(l,e,t,n)=>t*Math.sqrt(1-(l=l/n-1)*l)+e,easeOutCubic:(l,e,t,n)=>t*((l/n-1)**3+1)+e,easeOutElastic:(l,e,t,n)=>{const s=t;let a=0;if(l===0)return e;if((l/=n)===1)return e+t;a||(a=.3*n);const{a:h,s:p,p:v,c:_}=sd(s,t,a,1.70158);return h*2**(-10*l)*Math.sin((l*n-p)*Cs/v)+_+e},easeOutExpo:(l,e,t,n)=>l===n?e+t:t*-(2**(-10*l/n)+1)+e,easeOutQuad:(l,e,t,n)=>-t*(l/=n)*(l-2)+e,easeOutQuart:(l,e,t,n)=>-t*((l=l/n-1)*l**3-1)+e,easeOutQuint:(l,e,t,n)=>t*((l/n-1)**5+1)+e,easeOutSine:(l,e,t,n)=>t*Math.sin(l/n*na)+e});const Zx=()=>!1;class cp{constructor(e){let{startValue:t,byValue:n,duration:s=500,delay:a=0,easing:h=Av,onStart:p=Fa,onChange:v=Fa,onComplete:_=Fa,abort:b=Zx,target:E}=e;de(this,"_state","pending"),de(this,"durationProgress",0),de(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=a,this.easing=h,this._onStart=p,this._onChange=v,this._onComplete=_,this._abort=b,this.target=E,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>Wl(e)),this.delay):Wl(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:a}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=a,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Wl(this.tick)))}register(){Zl.push(this)}unregister(){Zl.remove(this)}abort(){this._state="aborted",this.unregister()}}const Qx=["startValue","endValue"];class Jx extends cp{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(ge(ge({},dn(e,Qx)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const $x=["startValue","endValue"];class ew extends cp{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(ge(ge({},dn(e,$x)),{},{startValue:t,byValue:n.map(((s,a)=>s-t[a]))}))}calculate(e){const t=this.startValue.map(((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s)));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const tw=["startValue","endValue","easing","onChange","onComplete","abort"],nw=(l,e,t,n)=>e+t*(1-Math.cos(l/n*na)),ad=l=>l&&((e,t,n)=>l(new $t(e).toRgba(),t,n));class rw extends cp{constructor(e){let{startValue:t,endValue:n,easing:s=nw,onChange:a,onComplete:h,abort:p}=e,v=dn(e,tw);const _=new $t(t).getSource(),b=new $t(n).getSource();super(ge(ge({},v),{},{startValue:_,byValue:b.map(((E,N)=>E-_[N])),easing:s,onChange:ad(a),onComplete:ad(h),abort:ad(p)}))}calculate(e){const[t,n,s,a]=this.startValue.map(((p,v)=>this.easing(e,p,this.byValue[v],this.duration,v))),h=[...[t,n,s].map(Math.round),za(0,a,1)];return{value:h,valueProgress:h.map(((p,v)=>this.byValue[v]!==0?Math.abs((p-this.startValue[v])/this.byValue[v]):0)).find((p=>p!==0))||0}}}function hp(l){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(l)?new ew(l):new Jx(l);return e.start(),e}function Mv(l){const e=new rw(l);return e.start(),e}class mn{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some((t=>t.eq(e)))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter((s=>!this.includes(s)))),this}static isPointContained(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const a=Xc(t,n),h=Xc(t,e).divide(a);return s?Math.abs(h.x)===Math.abs(h.y):h.x===h.y&&h.x>=0&&h.x<=1}}static isPointInPolygon(e,t){const n=new Ce(e).setX(Math.min(e.x-1,...t.map((a=>a.x))));let s=0;for(let a=0;a<t.length;a++){const h=this.intersectSegmentSegment(t[a],t[(a+1)%t.length],e,n);if(h.includes(e))return!0;s+=+(h.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,n,s){let a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],h=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const p=t.x-e.x,v=t.y-e.y,_=s.x-n.x,b=s.y-n.y,E=e.x-n.x,N=e.y-n.y,O=_*N-b*E,Q=p*N-v*E,W=b*p-_*v;if(W!==0){const ee=O/W,K=Q/W;return(a||0<=ee&&ee<=1)&&(h||0<=K&&K<=1)?new mn("Intersection").append(new Ce(e.x+ee*p,e.y+ee*v)):new mn}if(O===0||Q===0){const ee=a||h||mn.isPointContained(e,n,s)||mn.isPointContained(t,n,s)||mn.isPointContained(n,e,t)||mn.isPointContained(s,e,t);return new mn(ee?"Coincident":void 0)}return new mn("Parallel")}static intersectSegmentLine(e,t,n,s){return mn.intersectLineLine(e,t,n,s,!1,!0)}static intersectSegmentSegment(e,t,n,s){return mn.intersectLineLine(e,t,n,s,!1,!1)}static intersectLinePolygon(e,t,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const a=new mn,h=n.length;for(let p,v,_,b=0;b<h;b++){if(p=n[b],v=n[(b+1)%h],_=mn.intersectLineLine(e,t,p,v,s,!1),_.status==="Coincident")return _;a.append(..._.points)}return a.points.length>0&&(a.status="Intersection"),a}static intersectSegmentPolygon(e,t,n){return mn.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new mn,s=e.length,a=[];for(let h=0;h<s;h++){const p=e[h],v=e[(h+1)%s],_=mn.intersectSegmentPolygon(p,v,t);_.status==="Coincident"?(a.push(_),n.append(p,v)):n.append(..._.points)}return a.length>0&&a.length===e.length?new mn("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const s=t.min(n),a=t.max(n),h=new Ce(a.x,s.y),p=new Ce(s.x,a.y);return mn.intersectPolygonPolygon(e,[s,h,a,p])}}class iw extends sv{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?lr(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=lr(e,jr(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new Ce(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),a=[e,t,n,s];if(this.group){const h=this.group.calcTransformMatrix();return a.map((p=>lr(p,h)))}return a}intersectsWithRect(e,t){return mn.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=mn.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every((t=>e.containsPoint(t)))}isContainedWithinRect(e,t){const{left:n,top:s,width:a,height:h}=this.getBoundingRect();return n>=e.x&&n+a<=t.x&&s>=e.y&&s+h<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return mn.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some((n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y))||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every((n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y)))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return rs(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(br,e),this._set(Yr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?is(uv(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||cr.concat()}calcACoords(){const e=Ha({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),s=Wo(t,n),a=wn(s,e),h=this._getTransformedDimensions(),p=h.x/2,v=h.y/2;return{tl:lr({x:-p,y:-v},a),tr:lr({x:p,y:-v},a),bl:lr({x:-p,y:v},a),br:lr({x:p,y:v},a)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Dn(this.originX),Dn(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every(((a,h)=>a===n[h]))?s.value:(this.group&&(t=wn(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},a=hv(s);return this.ownMatrixCache={key:e,value:a},a}_getNonTransformedDimensions(){return new Ce(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=ge({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let s=n,a=0;this.strokeUniform&&(s=0,a=n);const h=t.width+s,p=t.height+s;let v;return v=t.skewX===0&&t.skewY===0?new Ce(h*t.scaleX,p*t.scaleY):oh(h,p,au(t)),v.scalarAdd(a)}translateToGivenOrigin(e,t,n,s,a){let h=e.x,p=e.y;const v=Dn(s)-Dn(t),_=Dn(a)-Dn(n);if(v||_){const b=this._getTransformedDimensions();h+=v*b.x,p+=_*b.y}return new Ce(h,p)}translateToCenterPoint(e,t,n){if(t===Rt&&n===Rt)return e;const s=this.translateToGivenOrigin(e,t,n,Rt,Rt);return this.angle?s.rotate(En(this.angle),e):s}translateToOriginPoint(e,t,n){const s=this.translateToGivenOrigin(e,Rt,Rt,t,n);return this.angle?s.rotate(En(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?lr(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Ce(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const s=this.translateToCenterPoint(e,t,n),a=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:a.x,top:a.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),nn,Lr)}}const sw=["type"],aw=["extraParam"];let Zi=class Ac extends iw{static getDefaults(){return Ac.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Ss("warn","Setting type has no effect",e)}constructor(e){super(),de(this,"_cacheContext",null),Object.assign(this,Ac.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=ui(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,s=Yt.maxCacheSideLimit,a=Yt.minCacheSideLimit;if(t<=s&&n<=s&&t*n<=Yt.perfLimitSizeTotal)return t<a&&(e.width=a),n<a&&(e.height=a),e;const h=t/n,[p,v]=Po.limitDimsByArea(h),_=za(a,p,s),b=za(a,v,s);return t>_&&(e.zoomX/=t/_,e.width=_,e.capped=!0),n>b&&(e.zoomY/=n/b,e.height=b,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:s,zoomX:a,zoomY:h,x:p,y:v}=this._limitCacheSize(this._getCacheCanvasDimensions()),_=n!==e.width||s!==e.height,b=this.zoomX!==a||this.zoomY!==h;if(!e||!t)return!1;if(_||b){n!==e.width||s!==e.height?(e.width=n,e.height=s):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const E=p/2,N=v/2;return this.cacheTranslationX=Math.round(e.width/2-E)+E,this.cacheTranslationY=Math.round(e.height/2-N)+N,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(a,h),this.zoomX=a,this.zoomY=h,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new Ce(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Na(this.calcTransformMatrix());return new Ce(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==br&&e!==Yr||(t=this._constrainScale(t)),e===br&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof wr||(t=new wr(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:a}=this,{width:h,height:p}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:a,width:h,height:p,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===xr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const s=this.fill,a=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=a}createClipPathLayer(e,t){const n=Dr(t),s=n.getContext("2d");if(s.translate(t.cacheTranslationX,t.cacheTranslationY),s.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach((a=>{a.transform(s)})),t.parentClipPaths.push(e),e.absolutePositioned){const a=jr(this.calcTransformMatrix());s.transform(a[0],a[1],a[2],a[3],a[4],a[5])}return e.transform(s),e.drawObject(s,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const s=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,oi(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(oi(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[a,,,h]=n?.viewportTransform||cr,p=a*s,v=h*s,_=t.nonScaling?new Ce(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Yt.browserShadowBlurConstant*(p+v)*(_.x+_.y)/4,e.shadowOffsetX=t.offsetX*p*_.x,e.shadowOffsetY=t.offsetY*v*_.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!oi(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,a=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,a):e.transform(1,0,0,1,s,a),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:a}}_renderPaintInOrder(e){this.paintFirst===xr?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),a=this.getCanvasRetinaScaling(),h=s.x/this.scaleX/a,p=s.y/this.scaleY/a,v=Dr({width:Math.ceil(h),height:Math.ceil(p)}),_=v.getContext("2d");_&&(_.beginPath(),_.moveTo(0,0),_.lineTo(h,0),_.lineTo(h,p),_.lineTo(0,p),_.closePath(),_.translate(h/2,p/2),_.scale(s.zoomX/this.scaleX/a,s.zoomY/this.scaleY/a),this._applyPatternGradientTransform(_,t),_.fillStyle=t.toLive(e),_.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(a*this.scaleX/s.zoomX,a*this.scaleY/s.zoomY),e.strokeStyle=(n=_.createPattern(v,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new Ce(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(ct.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=ip(this),n=this.group,s=this.shadow,a=Math.abs,h=e.enableRetinaScaling?$m():1,p=(e.multiplier||1)*h,v=e.canvasProvider||(ae=>new Uo(ae,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&vv(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&_d(this,this.getViewportTransform()),this.setCoords();const _=ui(),b=this.getBoundingRect(),E=this.shadow,N=new Ce;if(E){const ae=E.blur,le=E.nonScaling?new Ce(1,1):this.getObjectScaling();N.x=2*Math.round(a(E.offsetX)+ae)*a(le.x),N.y=2*Math.round(a(E.offsetY)+ae)*a(le.y)}const O=b.width+N.x,Q=b.height+N.y;_.width=Math.ceil(O),_.height=Math.ceil(Q);const W=v(_);e.format==="jpeg"&&(W.backgroundColor="#fff"),this.setPositionByOrigin(new Ce(W.width/2,W.height/2),Rt,Rt);const ee=this.canvas;W._objects=[this],this.set("canvas",W),this.setCoords();const K=W.toCanvasElement(p||1,e);return this.set("canvas",ee),this.shadow=s,n&&(this.group=n),this.set(t),this.setCoords(),W._objects=[],W.destroy(),K}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Jd(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $d(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:s}=this;if(t){const{x:a,y:h}=this.getRelativeCenterPoint();this.originX=Rt,this.originY=Rt,this.left=a,this.top=h}if(this.set("angle",e),t){const{x:a,y:h}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=a,this.top=h,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Zl.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Ii().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce(((n,s)=>{let[a,h]=s;return n[a]=this._animate(a,h,t),n}),{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),a=this.constructor.colorProperties.includes(s[s.length-1]),{abort:h,startValue:p,onChange:v,onComplete:_}=n,b=ge(ge({},n),{},{target:this,startValue:p??s.reduce(((E,N)=>E[N]),this),endValue:t,abort:h?.bind(this),onChange:(E,N,O)=>{s.reduce(((Q,W,ee)=>(ee===s.length-1&&(Q[W]=E),Q[W])),this),v&&v(E,N,O)},onComplete:(E,N,O)=>{this.setCoords(),_&&_(E,N,O)}});return a?Mv(b):hp(b)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,a=0;a<t.length;a++){if(s=t[a],s===e)return{fork:[this,...t.slice(0,a)],otherFork:[],common:t.slice(a)};for(let h=0;h<n.length;h++){if(this===n[h])return{fork:[],otherFork:[e,...n.slice(0,h)],common:[this,...t]};if(s===n[h])return{fork:[this,...t.slice(0,a)],otherFork:[e,...n.slice(0,h)],common:t.slice(a)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const s=t.fork.pop(),a=t.otherFork.pop(),h=n._objects.indexOf(s),p=n._objects.indexOf(a);return h>-1&&h>p}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Ac.customProperties,this.constructor.customProperties||[]);let t;const n=Yt.NUM_FRACTION_DIGITS,{clipPath:s,fill:a,stroke:h,shadow:p,strokeDashArray:v,left:_,top:b,originX:E,originY:N,width:O,height:Q,strokeWidth:W,strokeLineCap:ee,strokeDashOffset:K,strokeLineJoin:ae,strokeUniform:le,strokeMiterLimit:ve,scaleX:we,scaleY:F,angle:ze,flipX:He,flipY:Je,opacity:ut,visible:Ie,backgroundColor:Ke,fillRule:dt,paintFirst:Ve,globalCompositeOperation:Bt,skewX:Le,skewY:wt}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const Be=Ze=>on(Ze,n),Xe=ge(ge({},Xa(this,e)),{},{type:this.constructor.type,version:Nc,originX:E,originY:N,left:Be(_),top:Be(b),width:Be(O),height:Be(Q),fill:I0(a)?a.toObject():a,stroke:I0(h)?h.toObject():h,strokeWidth:Be(W),strokeDashArray:v&&v.concat(),strokeLineCap:ee,strokeDashOffset:K,strokeLineJoin:ae,strokeUniform:le,strokeMiterLimit:Be(ve),scaleX:Be(we),scaleY:Be(F),angle:Be(ze),flipX:He,flipY:Je,opacity:Be(ut),shadow:p&&p.toObject(),visible:Ie,backgroundColor:Ke,fillRule:dt,paintFirst:Ve,globalCompositeOperation:Bt,skewX:Be(Le),skewY:Be(wt)},t?{clipPath:t}:null);return this.includeDefaultValues?Xe:this._removeDefaultValues(Xe)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return np(e,((s,a)=>{if(a===nn||a===Lr||a==="type")return!0;const h=n[a];return s!==h&&!(Array.isArray(s)&&Array.isArray(h)&&s.length===0&&h.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=dn(e,sw),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,a=dn(n,aw);return ou(t,a).then((h=>s?(delete h[s],new this(t[s],h)):new this(h)))}static fromObject(e,t){return this._fromObject(e,t)}};de(Zi,"stateProperties",Yx),de(Zi,"cacheProperties",Ts),de(Zi,"ownDefaults",qx),de(Zi,"type","FabricObject"),de(Zi,"colorProperties",[Rn,xr,"backgroundColor"]),de(Zi,"customProperties",[]),ct.setClass(Zi),ct.setClass(Zi,"object");const sa=(l,e,t)=>(n,s,a,h)=>{const p=e(n,s,a,h);return p&&sp(l,ge(ge({},ap(n,s,a,h)),t)),p};function Ga(l){return(e,t,n,s)=>{const{target:a,originX:h,originY:p}=t,v=a.getRelativeCenterPoint(),_=a.translateToOriginPoint(v,h,p),b=l(e,t,n,s);return a.setPositionByOrigin(_,t.originX,t.originY),b}}const Sd=sa(Kl,Ga(((l,e,t,n)=>{const s=lh(e,e.originX,e.originY,t,n);if(Dn(e.originX)===Dn(Rt)||Dn(e.originX)===Dn(Mn)&&s.x<0||Dn(e.originX)===Dn(nn)&&s.x>0){const{target:a}=e,h=a.strokeWidth/(a.strokeUniform?a.scaleX:1),p=_v(e)?2:1,v=a.width,_=Math.abs(s.x*p/a.scaleX)-h;return a.set("width",Math.max(_,1)),v!==a.width}return!1})));function Iv(l,e,t,n,s){n=n||{};const a=this.sizeX||n.cornerSize||s.cornerSize,h=this.sizeY||n.cornerSize||s.cornerSize,p=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,v=p?xr:Rn,_=!p&&(n.cornerStrokeColor||s.cornerStrokeColor);let b,E=e,N=t;l.save(),l.fillStyle=n.cornerColor||s.cornerColor||"",l.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",a>h?(b=a,l.scale(1,h/a),N=t*a/h):h>a?(b=h,l.scale(a/h,1),E=e*h/a):b=a,l.beginPath(),l.arc(E,N,b/2,0,Cs,!1),l[v](),_&&l.stroke(),l.restore()}function jv(l,e,t,n,s){n=n||{};const a=this.sizeX||n.cornerSize||s.cornerSize,h=this.sizeY||n.cornerSize||s.cornerSize,p=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,v=p?xr:Rn,_=!p&&(n.cornerStrokeColor||s.cornerStrokeColor),b=a/2,E=h/2;l.save(),l.fillStyle=n.cornerColor||s.cornerColor||"",l.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",l.translate(e,t);const N=s.getTotalAngle();l.rotate(En(N)),l["".concat(v,"Rect")](-b,-E,a,h),_&&l.strokeRect(-b,-E,a,h),l.restore()}class Mr{constructor(e){de(this,"visible",!0),de(this,"actionName",ih),de(this,"angle",0),de(this,"x",0),de(this,"y",0),de(this,"offsetX",0),de(this,"offsetY",0),de(this,"sizeX",0),de(this,"sizeY",0),de(this,"touchSizeX",0),de(this,"touchSizeY",0),de(this,"cursorStyle","crosshair"),de(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,s){var a;let{tl:h,tr:p,br:v,bl:_}=s;return((a=t.canvas)===null||a===void 0?void 0:a.getActiveObject())===t&&t.isControlVisible(e)&&mn.isPointInPolygon(n,[h,p,v,_])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,s){return new Ce(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,s,a,h){const p=sh([Wo(n,s),Ha({angle:e}),ah((a?this.touchSizeX:this.sizeX)||t,(a?this.touchSizeY:this.sizeY)||t)]);return{tl:new Ce(-.5,-.5).transform(p),tr:new Ce(.5,-.5).transform(p),br:new Ce(.5,.5).transform(p),bl:new Ce(-.5,.5).transform(p)}}render(e,t,n,s,a){((s=s||{}).cornerStyle||a.cornerStyle)==="circle"?Iv.call(this,e,t,n,s,a):jv.call(this,e,t,n,s,a)}}const Lv=(l,e,t)=>t.lockRotation?Wc:e.cursorStyle,Dv=sa(tv,Ga(((l,e,t,n)=>{let{target:s,ex:a,ey:h,theta:p,originX:v,originY:_}=e;const b=s.translateToOriginPoint(s.getRelativeCenterPoint(),v,_);if(Ai(s,"lockRotation"))return!1;const E=Math.atan2(h-b.y,a-b.x),N=Math.atan2(n-b.y,t-b.x);let O=is(N-E+p);if(s.snapAngle&&s.snapAngle>0){const W=s.snapAngle,ee=s.snapThreshold||W,K=Math.ceil(O/W)*W,ae=Math.floor(O/W)*W;Math.abs(O-ae)<ee?O=ae:Math.abs(O-K)<ee&&(O=K)}O<0&&(O=360+O),O%=360;const Q=s.angle!==O;return s.angle=O,Q})));function Rv(l,e){const t=e.canvas,n=l[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function Fv(l,e,t){const n=Ai(l,"lockScalingX"),s=Ai(l,"lockScalingY");if(n&&s||!e&&(n||s)&&t||n&&e==="x"||s&&e==="y")return!0;const{width:a,height:h,strokeWidth:p}=l;return a===0&&p===0&&e!=="y"||h===0&&p===0&&e!=="x"}const ow=["e","se","s","sw","w","nw","n","ne","e"],Eo=(l,e,t)=>{const n=Rv(l,t);if(Fv(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Wc;const s=xv(t,e);return"".concat(ow[s],"-resize")};function fp(l,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const a=e.target,h=s.by,p=Rv(l,a);let v,_,b,E,N,O;if(Fv(a,h,p))return!1;if(e.gestureScale)_=e.scaleX*e.gestureScale,b=e.scaleY*e.gestureScale;else{if(v=lh(e,e.originX,e.originY,t,n),N=h!=="y"?Math.sign(v.x||e.signX||1):1,O=h!=="x"?Math.sign(v.y||e.signY||1):1,e.signX||(e.signX=N),e.signY||(e.signY=O),Ai(a,"lockScalingFlip")&&(e.signX!==N||e.signY!==O))return!1;if(E=a._getTransformedDimensions(),p&&!h){const ee=Math.abs(v.x)+Math.abs(v.y),{original:K}=e,ae=ee/(Math.abs(E.x*K.scaleX/a.scaleX)+Math.abs(E.y*K.scaleY/a.scaleY));_=K.scaleX*ae,b=K.scaleY*ae}else _=Math.abs(v.x*a.scaleX/E.x),b=Math.abs(v.y*a.scaleY/E.y);_v(e)&&(_*=2,b*=2),e.signX!==N&&h!=="y"&&(e.originX=R0(e.originX),_*=-1,e.signX=N),e.signY!==O&&h!=="x"&&(e.originY=R0(e.originY),b*=-1,e.signY=O)}const Q=a.scaleX,W=a.scaleY;return h?(h==="x"&&a.set(br,_),h==="y"&&a.set(Yr,b)):(!Ai(a,"lockScalingX")&&a.set(br,_),!Ai(a,"lockScalingY")&&a.set(Yr,b)),Q!==a.scaleX||W!==a.scaleY}const Sl=sa(rh,Ga(((l,e,t,n)=>fp(l,e,t,n)))),Nv=sa(rh,Ga(((l,e,t,n)=>fp(l,e,t,n,{by:"x"})))),Bv=sa(rh,Ga(((l,e,t,n)=>fp(l,e,t,n,{by:"y"})))),lw=["target","ex","ey","skewingSide"],od={x:{counterAxis:"y",scale:br,skew:zo,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Yr,skew:Vo,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},uw=["ns","nesw","ew","nwse"],zv=(l,e,t)=>{if(e.x!==0&&Ai(t,"lockSkewingY")||e.y!==0&&Ai(t,"lockSkewingX"))return Wc;const n=xv(t,e)%4;return"".concat(uw[n],"-resize")};function Vv(l,e,t,n,s){const{target:a}=t,{counterAxis:h,origin:p,lockSkewing:v,skew:_,flip:b}=od[l];if(Ai(a,v))return!1;const{origin:E,flip:N}=od[h],O=Dn(t[E])*(a[N]?-1:1),Q=-Math.sign(O)*(a[b]?-1:1),W=.5*-((a[_]===0&&lh(t,Rt,Rt,n,s)[l]>0||a[_]>0?1:-1)*Q)+.5;return sa(nv,Ga(((K,ae,le,ve)=>(function(we,F,ze){let{target:He,ex:Je,ey:ut,skewingSide:Ie}=F,Ke=dn(F,lw);const{skew:dt}=od[we],Ve=ze.subtract(new Ce(Je,ut)).divide(new Ce(He.scaleX,He.scaleY))[we],Bt=He[dt],Le=Ke[dt],wt=Math.tan(En(Le)),Be=we==="y"?He._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:He._getTransformedDimensions({scaleX:1,scaleY:1}).y,Xe=2*Ve*Ie/Math.max(Be,1)+wt,Ze=is(Math.atan(Xe));He.set(dt,Ze);const be=Bt!==He[dt];if(be&&we==="y"){const{skewX:Fe,scaleX:yt}=He,Ct=He._getTransformedDimensions({skewY:Bt}),pt=He._getTransformedDimensions(),Mt=Fe!==0?Ct.x/pt.x:1;Mt!==1&&He.set(br,Mt*yt)}return be})(l,ae,new Ce(le,ve)))))(e,ge(ge({},t),{},{[p]:W,skewingSide:Q}),n,s)}const Wv=(l,e,t,n)=>Vv("x",l,e,t,n),Uv=(l,e,t,n)=>Vv("y",l,e,t,n);function hh(l,e){return l[e.canvas.altActionKey]}const Cl=(l,e,t)=>{const n=hh(l,t);return e.x===0?n?zo:Yr:e.y===0?n?Vo:br:""},La=(l,e,t)=>hh(l,t)?zv(0,e,t):Eo(l,e,t),Cd=(l,e,t,n)=>hh(l,e.target)?Uv(l,e,t,n):Nv(l,e,t,n),kd=(l,e,t,n)=>hh(l,e.target)?Wv(l,e,t,n):Bv(l,e,t,n),dp=()=>({ml:new Mr({x:-.5,y:0,cursorStyleHandler:La,actionHandler:Cd,getActionName:Cl}),mr:new Mr({x:.5,y:0,cursorStyleHandler:La,actionHandler:Cd,getActionName:Cl}),mb:new Mr({x:0,y:.5,cursorStyleHandler:La,actionHandler:kd,getActionName:Cl}),mt:new Mr({x:0,y:-.5,cursorStyleHandler:La,actionHandler:kd,getActionName:Cl}),tl:new Mr({x:-.5,y:-.5,cursorStyleHandler:Eo,actionHandler:Sl}),tr:new Mr({x:.5,y:-.5,cursorStyleHandler:Eo,actionHandler:Sl}),bl:new Mr({x:-.5,y:.5,cursorStyleHandler:Eo,actionHandler:Sl}),br:new Mr({x:.5,y:.5,cursorStyleHandler:Eo,actionHandler:Sl}),mtr:new Mr({x:0,y:-.5,actionHandler:Dv,cursorStyleHandler:Lv,offsetY:-40,withConnection:!0,actionName:Kd})}),Hv=()=>({mr:new Mr({x:.5,y:0,actionHandler:Sd,cursorStyleHandler:La,actionName:Kl}),ml:new Mr({x:-.5,y:0,actionHandler:Sd,cursorStyleHandler:La,actionName:Kl})}),Xv=()=>ge(ge({},dp()),Hv());class Do extends Zi{static getDefaults(){return ge(ge({},super.getDefaults()),Do.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),Do.ownDefaults),this.setOptions(e)}static createControls(){return{controls:dp()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,s=t.action;if(this===n&&s&&s.startsWith(ih))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[a,h]=n[s],p=this.controls[a];if(p.shouldActivate(a,this,e,t?h.touchCorner:h.corner))return this.__corner=a,{key:a,control:p,coord:this.oCoords[a]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=Wo(t.x,t.y),s=Ha({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),a=wn(n,s),h=wn(e,a),p=wn(h,[1/e[0],0,0,1/e[3],0,0]),v=this.group?Na(this.calcTransformMatrix()):void 0;v&&(v.scaleX=Math.abs(v.scaleX),v.scaleY=Math.abs(v.scaleY));const _=this._calculateCurrentDimensions(v),b={};return this.forEachControl(((E,N)=>{const O=E.positionHandler(_,p,this,E);b[N]=Object.assign(O,this._calcCornerCoords(E,O))})),b}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(En(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=ge({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,a=ge({hasBorders:n,hasControls:s},t),h=this.getViewportTransform(),p=a.hasBorders,v=a.hasControls,_=wn(h,this.calcTransformMatrix()),b=Na(_);e.save(),e.translate(b.translateX,b.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(b.angle-=180),e.rotate(En(this.group?b.angle:this.angle)),p&&this.drawBorders(e,b,t),v&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let s;if(n&&n.forActiveSelection||this.group){const a=oh(this.width,this.height,au(t)),h=this.isStrokeAccountedForInDimensions()?Zd:(this.strokeUniform?new Ce().scalarAdd(this.canvas?this.canvas.getZoom():1):new Ce(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=a.add(h).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl(((s,a)=>{s.withConnection&&s.getVisibility(this,a)&&(n=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))})),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:a,cornerColor:h}=this,p=ge({cornerStrokeColor:s,cornerDashArray:a,cornerColor:h},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=p.cornerColor,this.transparentCorners||(e.strokeStyle=p.cornerStrokeColor),this._setLineDash(e,p.cornerDashArray),this.forEachControl(((v,_)=>{if(v.getVisibility(this,_)){const b=this.oCoords[_];v.render(e,b.x,b.y,p,this)}})),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach((t=>{let[n,s]=t;return this.setControlVisible(n,s)}))}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const s=this.width+4,a=this.height+4;return t.clearRect(-s/2,-a/2,s,a),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function Gv(l,e){return e.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((n=>{n!=="constructor"&&Object.defineProperty(l.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}))})),l}de(Do,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Zn extends Do{}Gv(Zn,[bv]),ct.setClass(Zn),ct.setClass(Zn,"object");const Yv=(l,e,t,n)=>{const s=2*(n=Math.round(n))+1,{data:a}=l.getImageData(e-n,t-n,s,s);for(let h=3;h<a.length;h+=4)if(a[h]>0)return!1;return!0};class qv{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Ce(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Ce(1/this.options.scaleX,1/this.options.scaleY):new Ce(1,1)}createSideVector(e,t){const n=Xc(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new Ce(e);return t.y+=t.x*Math.tan(En(this.options.skewY)),t.x+=t.y*Math.tan(En(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const cw=new Ce;class Mo extends qv{static getOrthogonalRotationFactor(e,t){const n=t?Yc(e,t):Ov(e);return Math.abs(n)<na?-1:1}constructor(e,t,n,s){super(s),de(this,"AB",void 0),de(this,"AC",void 0),de(this,"alpha",void 0),de(this,"bisector",void 0),this.A=new Ce(e),this.B=new Ce(t),this.C=new Ce(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Yc(this.AB,this.AC),this.bisector=ch(lp(this.AB.eq(cw)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),a=up(s),h=Mo.getOrthogonalRotationFactor(a,this.bisector);return this.scaleUnitVector(a,n*h)}projectBevel(){const e=[];return(this.alpha%Cs==0?[this.B]:[this.B,this.C]).forEach((t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))})),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),a=this.options.strokeUniform?Gc(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return Gc(s)/this.strokeProjectionMagnitude<=a&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],s=new Ce(Mo.getOrthogonalRotationFactor(this.bisector),Mo.getOrthogonalRotationFactor(new Ce(this.bisector.y,this.bisector.x)));return[new Ce(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new Ce(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach((a=>{wd(a,e,t)&&n.push(this.A.add(a))})),n}projectRoundWithSkew(e,t){const n=[],{skewX:s,skewY:a,scaleX:h,scaleY:p,strokeUniform:v}=this.options,_=new Ce(Math.tan(En(s)),Math.tan(En(a))),b=this.strokeProjectionMagnitude,E=v?b/p/Math.sqrt(1/p**2+1/h**2*_.y**2):b/Math.sqrt(1+_.y**2),N=new Ce(Math.sqrt(Math.max(b**2-E**2,0)),E),O=v?b/Math.sqrt(1+_.x**2*(1/p)**2/(1/h+1/h*_.x*_.y)**2):b/Math.sqrt(1+_.x**2/(1+_.x*_.y)**2),Q=new Ce(O,Math.sqrt(Math.max(b**2-O**2,0)));return[Q,Q.scalarMultiply(-1),N,N.scalarMultiply(-1)].map((W=>this.applySkew(v?W.multiply(this.strokeUniformScalar):W))).forEach((W=>{wd(W,e,t)&&n.push(this.applySkew(this.A).add(W))})),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Cs==0,n=this.applySkew(this.A),s=e[t?0:2].subtract(n),a=e[t?1:0].subtract(n),h=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),p=Ao(s,h)>0,v=p?s:a,_=p?a:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(v,_)):e.push(...this.projectRoundNoSkew(v,_)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector})))}}class Z0 extends qv{constructor(e,t,n){super(n),this.A=new Ce(e),this.T=new Ce(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(up(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new Ce(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Mo(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new Ce(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(ch(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(t),s.subtract(t))}return e.map((t=>this.applySkew(t)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e})))}}const Kv=function(l,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(l.length===0)return n;const s=l.reduce(((a,h)=>(a[a.length-1].eq(h)||a.push(new Ce(h)),a)),[new Ce(l[0])]);if(s.length===1)t=!0;else if(!t){const a=s[0],h=((p,v)=>{for(let _=p.length-1;_>=0;_--)if(v(p[_],_,p))return _;return-1})(s,(p=>!p.eq(a)));s.splice(h+1)}return s.forEach(((a,h,p)=>{let v,_;h===0?(_=p[1],v=t?a:p[p.length-1]):h===p.length-1?(v=p[h-1],_=t?a:p[0]):(v=p[h-1],_=p[h+1]),t&&p.length===1?n.push(...new Z0(a,a,e).project()):!t||h!==0&&h!==p.length-1?n.push(...new Mo(a,v,_,e).project()):n.push(...new Z0(a,h===0?_:v,e).project())})),n},pp=l=>{const e={};return Object.keys(l).forEach((t=>{e[t]={},Object.keys(l[t]).forEach((n=>{e[t][n]=ge({},l[t][n])}))})),e},Zv=l=>l.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let _l;const fh=l=>{if(_l||_l||(_l="Intl"in Ti()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),_l){const e=_l.segment(l);return Array.from(e).map((t=>{let{segment:n}=t;return n}))}return hw(l)},hw=l=>{const e=[];for(let t,n=0;n<l.length;n++)(t=fw(l,n))!==!1&&e.push(t);return e},fw=(l,e)=>{const t=l.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return l.charAt(e);if(55296<=t&&t<=56319){if(l.length<=e+1)throw"High surrogate without following low surrogate";const s=l.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return l.charAt(e)+l.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=l.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var dw=Object.freeze({__proto__:null,capitalize:function(l){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(l.charAt(0).toUpperCase()).concat(e?l.slice(1):l.slice(1).toLowerCase())},escapeXml:Zv,graphemeSplit:fh});const dh=function(l,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.fill!==e.fill||l.stroke!==e.stroke||l.strokeWidth!==e.strokeWidth||l.fontSize!==e.fontSize||l.fontFamily!==e.fontFamily||l.fontWeight!==e.fontWeight||l.fontStyle!==e.fontStyle||l.textDecorationThickness!==e.textDecorationThickness||l.textBackgroundColor!==e.textBackgroundColor||l.deltaY!==e.deltaY||t&&(l.overline!==e.overline||l.underline!==e.underline||l.linethrough!==e.linethrough)},Qv=(l,e)=>{const t=e.split(`
`),n=[];let s=-1,a={};l=pp(l);for(let h=0;h<t.length;h++){const p=fh(t[h]);if(l[h])for(let v=0;v<p.length;v++){s++;const _=l[h][v];_&&Object.keys(_).length>0&&(dh(a,_,!0)?n.push({start:s,end:s+1,style:_}):n[n.length-1].end++),a=_||{}}else s+=p.length,a={}}return n},Jv=(l,e)=>{if(!Array.isArray(l))return pp(l);const t=e.split(qd),n={};let s=-1,a=0;for(let h=0;h<t.length;h++){const p=fh(t[h]);for(let v=0;v<p.length;v++)s++,l[a]&&l[a].start<=s&&s<l[a].end&&(n[h]=n[h]||{},n[h][v]=ge({},l[a].style),s===l[a].end-1&&a++)}return n},aa=["display","transform",Rn,"fill-opacity","fill-rule","opacity",xr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Q0(l,e){const t=l.nodeName,n=l.getAttribute("class"),s=l.getAttribute("id"),a="(?![a-zA-Z\\-]+)";let h;if(h=new RegExp("^"+t,"i"),e=e.replace(h,""),s&&e.length&&(h=new RegExp("#"+s+a,"i"),e=e.replace(h,"")),n&&e.length){const p=n.split(" ");for(let v=p.length;v--;)h=new RegExp("\\."+p[v]+a,"i"),e=e.replace(h,"")}return e.length===0}function pw(l,e){let t=!0;const n=Q0(l,e.pop());return n&&e.length&&(t=(function(s,a){let h,p=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&a.length;)p&&(h=a.pop()),p=Q0(s=s.parentElement,h);return a.length===0})(l,e)),n&&t&&e.length===0}const gw=l=>{var e;return(e=Ux[l])!==null&&e!==void 0?e:l},mw=new RegExp("(".concat(Ei,")"),"gi"),vw=l=>Uc(l.replace(mw," $1 ").replace(/,/gi," "));var J0,$0,em,tm,nm,rm,im;const vr="(".concat(Ei,")"),yw=String.raw(J0||(J0=ss(["(skewX)(",")"],["(skewX)\\(","\\)"])),vr),_w=String.raw($0||($0=ss(["(skewY)(",")"],["(skewY)\\(","\\)"])),vr),xw=String.raw(em||(em=ss(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),vr,vr,vr),ww=String.raw(tm||(tm=ss(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),vr,vr),bw=String.raw(nm||(nm=ss(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),vr,vr),Sw=String.raw(rm||(rm=ss(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),vr,vr,vr,vr,vr,vr),gp="(?:".concat(Sw,"|").concat(bw,"|").concat(xw,"|").concat(ww,"|").concat(yw,"|").concat(_w,")"),Cw="(?:".concat(gp,"*)"),kw=String.raw(im||(im=ss(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),Cw),Tw=new RegExp(kw),Ew=new RegExp(gp),Ow=new RegExp(gp,"g");function Jl(l){const e=[];if(!(l=vw(l).replace(/\s*([()])\s*/gi,"$1"))||l&&!Tw.test(l))return[...cr];for(const t of l.matchAll(Ow)){const n=Ew.exec(t[0]);if(!n)continue;let s=cr;const a=n.filter((Q=>!!Q)),[,h,...p]=a,[v,_,b,E,N,O]=p.map((Q=>parseFloat(Q)));switch(h){case"translate":s=Wo(v,_);break;case Kd:s=Ha({angle:v},{x:_,y:b});break;case ih:s=ah(v,_);break;case zo:s=ep(v);break;case Vo:s=tp(v);break;case"matrix":s=[v,_,b,E,N,O]}e.push(s)}return sh(e)}function Pw(l,e,t,n){const s=Array.isArray(e);let a,h=e;if(l!==Rn&&l!==xr||e!==_r){if(l==="strokeUniform")return e==="non-scaling-stroke";if(l==="strokeDashArray")h=e===_r?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(l==="transformMatrix")h=t&&t.transformMatrix?wn(t.transformMatrix,Jl(e)):Jl(e);else if(l==="visible")h=e!==_r&&e!=="hidden",t&&t.visible===!1&&(h=!1);else if(l==="opacity")h=parseFloat(e),t&&t.opacity!==void 0&&(h*=t.opacity);else if(l==="textAnchor")h=e==="start"?nn:e==="end"?Mn:Rt;else if(l==="charSpacing"||l===Ba)a=gr(e,n)/n*1e3;else if(l==="paintFirst"){const p=e.indexOf(Rn),v=e.indexOf(xr);h=Rn,(p>-1&&v>-1&&v<p||p===-1&&v>-1)&&(h=xr)}else{if(l==="href"||l==="xlink:href"||l==="font"||l==="id")return e;if(l==="imageSmoothing")return e==="optimizeQuality";a=s?e.map(gr):gr(e,n)}}else h="";return!s&&isNaN(a)?h:a}function $v(l,e){const t=l.match(Wx);if(!t)return;const n=t[1],s=t[3],a=t[4],h=t[5],p=t[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),a&&(e.fontSize=gr(a)),p&&(e.fontFamily=p),h&&(e.lineHeight=h==="normal"?1:h)}function Td(l,e){l.replace(/;\s*$/,"").split(";").forEach((t=>{if(!t)return;const[n,s]=t.split(":");e[n.trim().toLowerCase()]=s.trim()}))}function ey(l){const e={},t=l.getAttribute("style");return t&&(typeof t=="string"?Td(t,e):(function(n,s){Object.entries(n).forEach((a=>{let[h,p]=a;p!==void 0&&(s[h.toLowerCase()]=p)}))})(t,e)),e}const Aw={stroke:"strokeOpacity",fill:"fillOpacity"};function as(l,e,t){if(!l)return{};let n,s={},a=Yd;l.parentNode&&H0.test(l.parentNode.nodeName)&&(s=as(l.parentElement,e,t),s.fontSize&&(n=a=gr(s.fontSize)));const h=ge(ge(ge({},e.reduce(((_,b)=>{const E=l.getAttribute(b);return E&&(_[b]=E),_}),{})),(function(_){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={};for(const N in b)pw(_,N.split(" "))&&(E=ge(ge({},E),b[N]));return E})(l,t)),ey(l));h[id]&&l.setAttribute(id,h[id]),h[rd]&&(n=gr(h[rd],a),h[rd]="".concat(n));const p={};for(const _ in h){const b=gw(_),E=Pw(b,h[_],s,n);p[b]=E}p&&p.font&&$v(p.font,p);const v=ge(ge({},s),p);return H0.test(l.nodeName)?v:(function(_){const b=Zn.getDefaults();return Object.entries(Aw).forEach((E=>{let[N,O]=E;if(_[O]===void 0||_[N]==="")return;if(_[N]===void 0){if(!b[N])return;_[N]=b[N]}if(_[N].indexOf("url(")===0)return;const Q=new $t(_[N]);_[N]=Q.setAlpha(on(Q.getAlpha()*_[O],2)).toRgba()})),_})(v)}const Mw=["left","top","width","height","visible"],ty=["rx","ry"];class yr extends Zn{static getDefaults(){return ge(ge({},super.getDefaults()),yr.ownDefaults)}constructor(e){super(),Object.assign(this,yr.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,s=-t/2,a=-n/2,h=this.rx?Math.min(this.rx,t/2):0,p=this.ry?Math.min(this.ry,n/2):0,v=h!==0||p!==0;e.beginPath(),e.moveTo(s+h,a),e.lineTo(s+t-h,a),v&&e.bezierCurveTo(s+t-$s*h,a,s+t,a+$s*p,s+t,a+p),e.lineTo(s+t,a+n-p),v&&e.bezierCurveTo(s+t,a+n-$s*p,s+t-$s*h,a+n,s+t-h,a+n),e.lineTo(s+h,a+n),v&&e.bezierCurveTo(s+$s*h,a+n,s,a+n-$s*p,s,a+n-p),e.lineTo(s,a+p),v&&e.bezierCurveTo(s,a+$s*p,s+$s*h,a,s+h,a),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...ty,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const s=as(e,this.ATTRIBUTE_NAMES,n),{left:a=0,top:h=0,width:p=0,height:v=0,visible:_=!0}=s,b=dn(s,Mw);return new this(ge(ge(ge({},t),b),{},{left:a,top:h,width:p,height:v,visible:!!(_&&p&&v)}))}}de(yr,"type","Rect"),de(yr,"cacheProperties",[...Ts,...ty]),de(yr,"ownDefaults",{rx:0,ry:0}),de(yr,"ATTRIBUTE_NAMES",[...aa,"x","y","rx","ry","width","height"]),ct.setClass(yr),ct.setSVGClass(yr);const _s="initialization",qc="added",mp="removed",Kc="imperative",ny=(l,e)=>{const{strokeUniform:t,strokeWidth:n,width:s,height:a,group:h}=e,p=h&&h!==l?lu(h.calcTransformMatrix(),l.calcTransformMatrix()):null,v=p?e.getRelativeCenterPoint().transform(p):e.getRelativeCenterPoint(),_=!e.isStrokeAccountedForInDimensions(),b=t&&_?yv(new Ce(n,n),void 0,l.calcTransformMatrix()):Zd,E=!t&&_?n:0,N=oh(s+E,a+E,sh([p,e.calcOwnMatrix()],!0)).add(b).scalarDivide(2);return[v.subtract(N),v.add(N)]};class uu{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:s}=e;return t===_s||t===Kc||!!n&&s!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==_s&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:s}=t;if(n===Kc&&t.overrides)return t.overrides;if(e.length===0)return;const{left:a,top:h,width:p,height:v}=rs(e.map((E=>ny(s,E))).reduce(((E,N)=>E.concat(N)),[])),_=new Ce(p,v),b=new Ce(a,h).add(_.scalarDivide(2));if(n===_s){const E=this.getInitialSize(t,{size:_,center:b});return{center:b,relativeCorrection:new Ce(0,0),size:E}}return{center:b.transform(s.calcOwnMatrix()),size:_}}}de(uu,"type","strategy");class Zc extends uu{shouldPerformLayout(e){return!0}}de(Zc,"type","fit-content"),ct.setClass(Zc);const Iw=["strategy"],jw=["target","strategy","bubbles","prevStrategy"],ry="layoutManager";class Ro{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Zc;de(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=ge(ge({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[zc,ev,Kl,tv,rh,nv,Bc,rv,jx].map((s=>e.on(s,(a=>this.performLayout(s===zc?{type:"object_modified",trigger:s,e:a,target:n}:{type:"object_modifying",trigger:s,e:a,target:n})))))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach((n=>n())),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach((t=>this.unsubscribe(t,e)))}subscribeTargets(e){e.targets.forEach((t=>this.subscribe(t,e)))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:s}=t;if(n===_s||n===qc?this.subscribeTargets(e):n===mp&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),n===Kc&&e.deep){const a=dn(e,Iw);t.forEachObject((h=>h.layoutManager&&h.layoutManager.performLayout(ge(ge({},a),{},{bubbles:!1,target:h}))))}}getLayoutResult(e){const{target:t,strategy:n,type:s}=e,a=n.calcLayoutResult(e,t.getObjects());if(!a)return;const h=s===_s?new Ce:t.getRelativeCenterPoint(),{center:p,correction:v=new Ce,relativeCorrection:_=new Ce}=a,b=h.subtract(p).add(v).transform(s===_s?cr:jr(t.calcOwnMatrix()),!0).add(_);return{result:a,prevCenter:h,nextCenter:p,offset:b}}commitLayout(e,t){const{target:n}=e,{result:{size:s},nextCenter:a}=t;var h,p;n.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===_s?n.set({left:(h=e.x)!==null&&h!==void 0?h:a.x+s.x*Dn(n.originX),top:(p=e.y)!==null&&p!==void 0?p:a.y+s.y*Dn(n.originY)}):(n.setPositionByOrigin(a,Rt,Rt),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject((s=>{s.group===n&&this.layoutObject(e,t,s)})),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:s}=t;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,t){const{target:n,strategy:s,bubbles:a,prevStrategy:h}=e,p=dn(e,jw),{canvas:v}=n;n.fire("layout:after",{context:e,result:t}),v&&v.fire("object:layout:after",{context:e,result:t,target:n});const _=n.parent;a&&_!=null&&_.layoutManager&&((p.path||(p.path=[])).push(n),_.layoutManager.performLayout(ge(ge({},p),{},{target:_}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach((t=>t.forEach((n=>n())))),e.clear()}toObject(){return{type:ry,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ct.setClass(Ro,ry);const Lw=["type","objects","layoutManager"];class Dw extends Ro{performLayout(){}}class ur extends Qd(Zn){static getDefaults(){return ge(ge({},super.getDefaults()),ur.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),de(this,"_activeObjects",[]),de(this,"__objectSelectionTracker",void 0),de(this,"__objectSelectionDisposer",void 0),Object.assign(this,ur.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((s=>{this.enterGroup(s,!1)})),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new Ro,this.layoutManager.performLayout({type:_s,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Ss("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Ss("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter(((t,n,s)=>this.canEnterGroup(t)&&s.indexOf(t)===n))}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(t),a=super.add(...s);return this._onAfterObjectsChange(qc,s),a}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const a=this._filterObjectsBeforeEnteringGroup(n),h=super.insertAt(e,...a);return this._onAfterObjectsChange(qc,a),h}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(mp,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach((s=>{s._set(e,t)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const a=s.indexOf(n);a>-1&&(s.splice(a,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&Lo(e,wn(jr(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(Lo(e,wn(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Zn.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let a=0;a<this._objects.length;a++){var s;const h=this._objects[a];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&h.group!==this?(e.save(),e.transform(...jr(this.calcTransformMatrix())),h.render(e),e.restore()):h.group===this&&h.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((e=>e.setCoords()))}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(ge({target:this,type:Kc},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter((function(s){return!s.excludeFromExport})).map((function(s){const a=s.includeDefaultValues;s.includeDefaultValues=n;const h=s[e||"toObject"](t);return s.includeDefaultValues=a,h}))}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return ge(ge(ge({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((e=>{this._watchObject(!1,e),e.dispose()})),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=yr.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:s=[],layoutManager:a}=e,h=dn(e,Lw);return Promise.all([Io(s,t),ou(h,t)]).then((p=>{let[v,_]=p;const b=new this(v,ge(ge(ge({},h),_),{},{layoutManager:new Dw}));if(a){const E=ct.getClass(a.type),N=ct.getClass(a.strategy);b.layoutManager=new E(new N)}else b.layoutManager=new Ro;return b.layoutManager.subscribeTargets({type:_s,target:b,targets:b.getObjects()}),b.setCoords(),b}))}}de(ur,"type","Group"),de(ur,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ct.setClass(ur);const iy=(l,e)=>Math.min(e.width/l.width,e.height/l.height),sy=(l,e)=>Math.max(e.width/l.width,e.height/l.height),Ed="\\s*,?\\s*",xl="".concat(Ed,"(").concat(Ei,")"),Rw="".concat(xl).concat(xl).concat(xl).concat(Ed,"([01])").concat(Ed,"([01])").concat(xl).concat(xl),Fw={m:"l",M:"L"},Nw=(l,e,t,n,s,a,h,p,v,_,b)=>{const E=ji(l),N=Li(l),O=ji(e),Q=Li(e),W=t*s*O-n*a*Q+h,ee=n*s*O+t*a*Q+p;return["C",_+v*(-t*s*N-n*a*E),b+v*(-n*s*N+t*a*E),W+v*(t*s*Q+n*a*O),ee+v*(n*s*Q-t*a*O),W,ee]},sm=(l,e,t,n)=>{const s=Math.atan2(e,l),a=Math.atan2(n,t);return a>=s?a-s:2*Math.PI-(s-a)};function Od(l,e,t,n,s,a,h,p){let v;if(Yt.cachesBoundsOfCurve&&(v=[...arguments].join(),Po.boundsOfCurveCache[v]))return Po.boundsOfCurveCache[v];const _=Math.sqrt,b=Math.abs,E=[],N=[[0,0],[0,0]];let O=6*l-12*t+6*s,Q=-3*l+9*t-9*s+3*h,W=3*t-3*l;for(let ve=0;ve<2;++ve){if(ve>0&&(O=6*e-12*n+6*a,Q=-3*e+9*n-9*a+3*p,W=3*n-3*e),b(Q)<1e-12){if(b(O)<1e-12)continue;const Je=-W/O;0<Je&&Je<1&&E.push(Je);continue}const we=O*O-4*W*Q;if(we<0)continue;const F=_(we),ze=(-O+F)/(2*Q);0<ze&&ze<1&&E.push(ze);const He=(-O-F)/(2*Q);0<He&&He<1&&E.push(He)}let ee=E.length;const K=ee,ae=oy(l,e,t,n,s,a,h,p);for(;ee--;){const{x:ve,y:we}=ae(E[ee]);N[0][ee]=ve,N[1][ee]=we}N[0][K]=l,N[1][K]=e,N[0][K+1]=h,N[1][K+1]=p;const le=[new Ce(Math.min(...N[0]),Math.min(...N[1])),new Ce(Math.max(...N[0]),Math.max(...N[1]))];return Yt.cachesBoundsOfCurve&&(Po.boundsOfCurveCache[v]=le),le}const Bw=(l,e,t)=>{let[n,s,a,h,p,v,_,b]=t;const E=((N,O,Q,W,ee,K,ae)=>{if(Q===0||W===0)return[];let le=0,ve=0,we=0;const F=Math.PI,ze=ae*Gd,He=Li(ze),Je=ji(ze),ut=.5*(-Je*N-He*O),Ie=.5*(-Je*O+He*N),Ke=Q**2,dt=W**2,Ve=Ie**2,Bt=ut**2,Le=Ke*dt-Ke*Ve-dt*Bt;let wt=Math.abs(Q),Be=Math.abs(W);if(Le<0){const At=Math.sqrt(1-Le/(Ke*dt));wt*=At,Be*=At}else we=(ee===K?-1:1)*Math.sqrt(Le/(Ke*Ve+dt*Bt));const Xe=we*wt*Ie/Be,Ze=-we*Be*ut/wt,be=Je*Xe-He*Ze+.5*N,Fe=He*Xe+Je*Ze+.5*O;let yt=sm(1,0,(ut-Xe)/wt,(Ie-Ze)/Be),Ct=sm((ut-Xe)/wt,(Ie-Ze)/Be,(-ut-Xe)/wt,(-Ie-Ze)/Be);K===0&&Ct>0?Ct-=2*F:K===1&&Ct<0&&(Ct+=2*F);const pt=Math.ceil(Math.abs(Ct/F*2)),Mt=[],zt=Ct/pt,Ut=8/3*Math.sin(zt/4)*Math.sin(zt/4)/Math.sin(zt/2);let _t=yt+zt;for(let At=0;At<pt;At++)Mt[At]=Nw(yt,_t,Je,He,wt,Be,be,Fe,Ut,le,ve),le=Mt[At][5],ve=Mt[At][6],yt=_t,_t+=zt;return Mt})(_-l,b-e,s,a,p,v,h);for(let N=0,O=E.length;N<O;N++)E[N][1]+=l,E[N][2]+=e,E[N][3]+=l,E[N][4]+=e,E[N][5]+=l,E[N][6]+=e;return E},ay=l=>{let e=0,t=0,n=0,s=0;const a=[];let h,p=0,v=0;for(const _ of l){const b=[..._];let E;switch(b[0]){case"l":b[1]+=e,b[2]+=t;case"L":e=b[1],t=b[2],E=["L",e,t];break;case"h":b[1]+=e;case"H":e=b[1],E=["L",e,t];break;case"v":b[1]+=t;case"V":t=b[1],E=["L",e,t];break;case"m":b[1]+=e,b[2]+=t;case"M":e=b[1],t=b[2],n=b[1],s=b[2],E=["M",e,t];break;case"c":b[1]+=e,b[2]+=t,b[3]+=e,b[4]+=t,b[5]+=e,b[6]+=t;case"C":p=b[3],v=b[4],e=b[5],t=b[6],E=["C",b[1],b[2],p,v,e,t];break;case"s":b[1]+=e,b[2]+=t,b[3]+=e,b[4]+=t;case"S":h==="C"?(p=2*e-p,v=2*t-v):(p=e,v=t),e=b[3],t=b[4],E=["C",p,v,b[1],b[2],e,t],p=E[3],v=E[4];break;case"q":b[1]+=e,b[2]+=t,b[3]+=e,b[4]+=t;case"Q":p=b[1],v=b[2],e=b[3],t=b[4],E=["Q",p,v,e,t];break;case"t":b[1]+=e,b[2]+=t;case"T":h==="Q"?(p=2*e-p,v=2*t-v):(p=e,v=t),e=b[1],t=b[2],E=["Q",p,v,e,t];break;case"a":b[6]+=e,b[7]+=t;case"A":Bw(e,t,b).forEach((N=>a.push(N))),e=b[6],t=b[7];break;case"z":case"Z":e=n,t=s,E=["Z"]}E?(a.push(E),h=E[0]):h=""}return a},Qc=(l,e,t,n)=>Math.sqrt((t-l)**2+(n-e)**2),oy=(l,e,t,n,s,a,h,p)=>v=>{const _=v**3,b=(O=>3*O**2*(1-O))(v),E=(O=>3*O*(1-O)**2)(v),N=(O=>(1-O)**3)(v);return new Ce(h*_+s*b+t*E+l*N,p*_+a*b+n*E+e*N)},ly=l=>l**2,uy=l=>2*l*(1-l),cy=l=>(1-l)**2,zw=(l,e,t,n,s,a,h,p)=>v=>{const _=ly(v),b=uy(v),E=cy(v),N=3*(E*(t-l)+b*(s-t)+_*(h-s)),O=3*(E*(n-e)+b*(a-n)+_*(p-a));return Math.atan2(O,N)},Vw=(l,e,t,n,s,a)=>h=>{const p=ly(h),v=uy(h),_=cy(h);return new Ce(s*p+t*v+l*_,a*p+n*v+e*_)},Ww=(l,e,t,n,s,a)=>h=>{const p=1-h,v=2*(p*(t-l)+h*(s-t)),_=2*(p*(n-e)+h*(a-n));return Math.atan2(_,v)},am=(l,e,t)=>{let n=new Ce(e,t),s=0;for(let a=1;a<=100;a+=1){const h=l(a/100);s+=Qc(n.x,n.y,h.x,h.y),n=h}return s},Uw=(l,e)=>{let t,n=0,s=0,a={x:l.x,y:l.y},h=ge({},a),p=.01,v=0;const _=l.iterator,b=l.angleFinder;for(;s<e&&p>1e-4;)h=_(n),v=n,t=Qc(a.x,a.y,h.x,h.y),t+s>e?(n-=p,p/=2):(a=h,n+=p,s+=t);return ge(ge({},h),{},{angle:b(v)})},vp=l=>{let e,t,n=0,s=0,a=0,h=0,p=0;const v=[];for(const _ of l){const b={x:s,y:a,command:_[0],length:0};switch(_[0]){case"M":t=b,t.x=h=s=_[1],t.y=p=a=_[2];break;case"L":t=b,t.length=Qc(s,a,_[1],_[2]),s=_[1],a=_[2];break;case"C":e=oy(s,a,_[1],_[2],_[3],_[4],_[5],_[6]),t=b,t.iterator=e,t.angleFinder=zw(s,a,_[1],_[2],_[3],_[4],_[5],_[6]),t.length=am(e,s,a),s=_[5],a=_[6];break;case"Q":e=Vw(s,a,_[1],_[2],_[3],_[4]),t=b,t.iterator=e,t.angleFinder=Ww(s,a,_[1],_[2],_[3],_[4]),t.length=am(e,s,a),s=_[3],a=_[4];break;case"Z":t=b,t.destX=h,t.destY=p,t.length=Qc(s,a,h,p),s=h,a=p}n+=t.length,v.push(t)}return v.push({length:n,x:s,y:a}),v},hy=function(l,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vp(l),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const s=t[n],a=e/s.length,h=l[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return ge(ge({},new Ce(s.x,s.y).lerp(new Ce(s.destX,s.destY),a)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return ge(ge({},new Ce(s.x,s.y).lerp(new Ce(h[1],h[2]),a)),{},{angle:Math.atan2(h[2]-s.y,h[1]-s.x)});case"C":case"Q":return Uw(s,e)}},Hw=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),om=new RegExp(Rw,"g"),Xw=new RegExp(Ei,"gi"),Gw={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},fy=l=>{var e;const t=[],n=(e=l.match(Hw))!==null&&e!==void 0?e:[];for(const s of n){const a=s[0];if(a==="z"||a==="Z"){t.push([a]);continue}const h=Gw[a.toLowerCase()];let p=[];if(a==="a"||a==="A"){om.lastIndex=0;for(let v=null;v=om.exec(s);)p.push(...v.slice(1))}else p=s.match(Xw)||[];for(let v=0;v<p.length;v+=h){const _=new Array(h),b=Fw[a];_[0]=v>0&&b?b:a;for(let E=0;E<h;E++)_[E+1]=parseFloat(p[v+E]);t.push(_)}}return t},dy=function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new Ce(l[0]),n=new Ce(l[1]),s=1,a=0;const h=[],p=l.length,v=p>2;let _;for(v&&(s=l[2].x<n.x?-1:l[2].x===n.x?0:1,a=l[2].y<n.y?-1:l[2].y===n.y?0:1),h.push(["M",t.x-s*e,t.y-a*e]),_=1;_<p;_++){if(!t.eq(n)){const b=t.midPointFrom(n);h.push(["Q",t.x,t.y,b.x,b.y])}t=l[_],_+1<l.length&&(n=l[_+1])}return v&&(s=t.x>l[_-2].x?1:t.x===l[_-2].x?0:-1,a=t.y>l[_-2].y?1:t.y===l[_-2].y?0:-1),h.push(["L",t.x+s*e,t.y+a*e]),h},yp=(l,e)=>l.map((t=>t.map(((n,s)=>s===0||e===void 0?n:on(n,e))).join(" "))).join(" ");function Jc(l,e){const t=l.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach((n=>{let[s,a]=n;return t.setProperty(s,a)})))}const Da=(l,e)=>Math.floor(Math.random()*(e-l+1))+l;function py(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||Fa,n=new(Ti()).XMLHttpRequest,s=e.signal,a=function(){n.abort()},h=function(){s&&s.removeEventListener("abort",a),n.onerror=n.ontimeout=Fa};if(s&&s.aborted)throw new Xd("request");return s&&s.addEventListener("abort",a,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(h(),t(n),n.onreadystatechange=Fa)},n.onerror=n.ontimeout=h,n.open("get",l,!0),n.send(),n}const Mc=(l,e)=>{let t=l._findCenterFromElement();l.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:s,scaleY:a,angle:h,skewX:p}=Na(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(br,s),n.set(Yr,a),n.angle=h,n.skewX=p,n.skewY=0}})(l),t=t.transform(l.transformMatrix)),delete l.transformMatrix,e&&(l.scaleX*=e.scaleX,l.scaleY*=e.scaleY,l.cropX=e.cropX,l.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,l.width=e.width,l.height=e.height),l.setPositionByOrigin(t,Rt,Rt)};var Pd=Object.freeze({__proto__:null,addTransformToObject:mv,animate:hp,animateColor:Mv,applyTransformToObject:Lo,calcAngleBetweenVectors:Yc,calcDimensionsMatrix:au,calcPlaneChangeMatrix:lu,calcVectorRotation:Ov,cancelAnimFrame:av,capValue:za,composeMatrix:hv,copyCanvasElement:l=>{var e;const t=Dr(l);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(l,0,0),t},cos:ji,createCanvasElement:ui,createImage:ov,createRotateMatrix:Ha,createScaleMatrix:ah,createSkewXMatrix:ep,createSkewYMatrix:tp,createTranslateMatrix:Wo,createVector:Xc,crossProduct:Ao,degreesToRadians:En,dotProduct:Pv,ease:Kx,enlivenObjectEnlivables:ou,enlivenObjects:Io,findScaleToCover:sy,findScaleToFit:iy,getBoundsOfCurve:Od,getOrthonormalVector:up,getPathSegmentsInfo:vp,getPointOnPath:hy,getPointer:gv,getRandomInt:Da,getRegularPolygonPath:(l,e)=>{const t=2*Math.PI/l;let n=-na;l%2==0&&(n+=t/2);const s=new Array(l+1);for(let a=0;a<l;a++){const h=a*t+n,{x:p,y:v}=new Ce(ji(h),Li(h)).scalarMultiply(e);s[a]=[a===0?"M":"L",p,v]}return s[l]=["Z"],s},getSmoothPathFromPoints:dy,getSvgAttributes:l=>{const e=["instantiated_by_use","style","id","class"];switch(l){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:ch,groupSVGElements:(l,e)=>l&&l.length===1?l[0]:new ur(l,e),hasStyleChanged:dh,invertTransform:jr,isBetweenVectors:wd,isIdentityMatrix:lv,isTouchEvent:Vc,isTransparent:Yv,joinPath:yp,loadImage:Ul,magnitude:Gc,makeBoundingBoxFromPoints:rs,makePathSimpler:ay,matrixToSVG:jo,mergeClipPaths:(l,e)=>{var t;let n=l,s=e;n.inverted&&!s.inverted&&(n=e,s=l),_d(s,(t=s.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());const a=n.inverted&&s.inverted;return a&&(n.inverted=s.inverted=!1),new ur([n],{clipPath:s,inverted:a})},multiplyTransformMatrices:wn,multiplyTransformMatrixArray:sh,parsePath:fy,parsePreserveAspectRatioAttribute:op,parseUnit:gr,pick:Xa,projectStrokeOnPoints:Kv,qrDecompose:Na,radiansToDegrees:is,removeFromArray:Ia,removeTransformFromObject:(l,e)=>{const t=jr(e),n=wn(t,l.calcOwnMatrix());Lo(l,n)},removeTransformMatrixForSvgParsing:Mc,request:py,requestAnimFrame:Wl,resetObjectTransform:vv,rotatePoint:(l,e,t)=>l.rotate(t,e),rotateVector:lp,saveObjectTransform:ip,sendObjectToPlane:_d,sendPointToPlane:ws,sendVectorToPlane:yv,setStyle:Jc,sin:Li,sizeAfterTransform:oh,string:dw,stylesFromArray:Jv,stylesToArray:Qv,toBlob:$d,toDataURL:Jd,toFixed:on,transformPath:(l,e,t)=>(t&&(e=wn(e,[1,0,0,1,-t.x,-t.y])),l.map((n=>{const s=[...n];for(let a=1;a<n.length-1;a+=2){const{x:h,y:p}=lr({x:n[a],y:n[a+1]},e);s[a]=h,s[a+1]=p}return s}))),transformPoint:lr});class gy extends rp{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),de(this,"upper",void 0),de(this,"container",void 0);const{el:s}=this.lower,a=this.createUpperCanvas();this.upper={el:a,ctx:a.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(a,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const h=this.createContainerElement();h.classList.add(n),s.parentNode&&s.parentNode.replaceChild(h,s),h.append(s,a),this.container=h}createUpperCanvas(){const{el:e}=this.lower,t=ui();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Ua().createElement("div");return e.setAttribute("data-fabric","wrapper"),Jc(e,{position:"relative"}),L0(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:s}=t;Jc(e,ge(ge({},n),{},{"touch-action":s?"manipulation":_r})),L0(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:s}=this.upper;pv(n,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),yd(this.upper.el,e),yd(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),Ii().dispose(this.upper.el),delete this.upper,delete this.container}}class ph extends Uo{constructor(){super(...arguments),de(this,"targets",[]),de(this,"_hoveredTargets",[]),de(this,"_currentTransform",null),de(this,"_groupSelector",null),de(this,"contextTopDirty",!1)}static getDefaults(){return ge(ge({},super.getDefaults()),ph.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new gy(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter((t=>!t.group&&t!==e)).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const s=this.targetFindTolerance,a=this.pixelFindContext;this.clearContext(a),a.save(),a.translate(-t+s,-n+s),a.transform(...this.viewportTransform);const h=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(a),e.selectionBackgroundColor=h,a.restore();const p=Math.round(s*this.getRetinaScaling());return Yv(a,p,p,p)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find((n=>!!n&&e[n]===!0)):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&n.length>1&&n.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let s;return t===ih||t===br||t===Yr||t===Kl?s=this.centeredScaling||e.centeredScaling:t===Kd&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=Mn:["mr","tr","br"].includes(t)&&(n.x=nn),["tl","mt","tr"].includes(t)?n.y=vd:["bl","mb","br"].includes(t)&&(n.y=Lr)),n}_setupCurrentTransform(e,t,n){var s;const a=t.group?ws(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:h="",control:p}=t.getActiveControl()||{},v=n&&p?(s=p.getActionHandler(e,t,p))===null||s===void 0?void 0:s.bind(p):wv,_=((O,Q,W,ee)=>{if(!Q||!O)return"drag";const K=ee.controls[Q];return K.getActionName(W,K,ee)})(n,h,e,t),b=e[this.centeredKey],E=this._shouldCenterTransform(t,_,b)?{x:Rt,y:Rt}:this._getOriginFromCorner(t,h),N={target:t,action:_,actionHandler:v,actionPerformed:!1,corner:h,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:a.x-t.left,offsetY:a.y-t.top,originX:E.x,originY:E.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:En(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:b,original:ge(ge({},ip(t)),{},{originX:E.x,originY:E.y})};this._currentTransform=N,this.fire("before:transform",{e,transform:N})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:s,deltaY:a}=this._groupSelector,h=new Ce(t,n).transform(this.viewportTransform),p=new Ce(t+s,n+a).transform(this.viewportTransform),v=this.selectionLineWidth/2;let _=Math.min(h.x,p.x),b=Math.min(h.y,p.y),E=Math.max(h.x,p.x),N=Math.max(h.y,p.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(_,b,E-_,N-b)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,_+=v,b+=v,E-=v,N-=v,Zn.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(_,b,E-_,N-b))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(t,Vc(e))||s.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const a=this.targets;this.targets=[];const h=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&h&&h!==n?(this.targets=a,n):h}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const s=this.getZoom(),a=e.padding/s;if(a){const[h,p,v,_]=n,b=Math.atan2(p.y-h.y,p.x-h.x),E=ji(b)*a,N=Li(b)*a,O=E+N,Q=E-N;n=[new Ce(h.x-Q,h.y-O),new Ce(p.x+O,p.y-Q),new Ce(v.x+Q,v.y+O),new Ce(_.x-O,_.y+Q)]}return mn.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,ws(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,t)){if(Pc(s)&&s.subTargetCheck){const a=this._searchPossibleTargets(s._objects,t);a&&this.targets.push(a)}return s}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&Pc(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let a=s.length-1;a>0;a--){const h=s[a];if(!Pc(h)||!h.interactive)return h}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let a=gv(e),h=s.width||0,p=s.height||0;h&&p||(Lr in s&&vd in s&&(p=Math.abs(s.top-s.bottom)),Mn in s&&nn in s&&(h=Math.abs(s.right-s.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,t||(a=ws(a,void 0,this.viewportTransform));const v=this.getRetinaScaling();v!==1&&(a.x/=v,a.y/=v);const _=h===0||p===0?new Ce(1,1):new Ce(n.width/h,n.height/p);return a.multiply(_)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=ui(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return ja(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,s=!1;const a=this.getActiveObjects(),h=[],p=[];e.forEach((v=>{a.includes(v)||(n=!0,v.fire("deselected",{e:t,target:v}),p.push(v))})),a.forEach((v=>{e.includes(v)||(n=!0,v.fire("selected",{e:t,target:v}),h.push(v))})),e.length>0&&a.length>0?(s=!0,n&&this.fire("selection:updated",{e:t,selected:h,deselected:p})):a.length>0?(s=!0,this.fire("selection:created",{e:t,selected:h})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:p})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),s}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,ja(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),ja(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,s={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),n.fire(zc,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;ja(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const s=this._realizeGroupTransformOnObject(e),a=super._toObject(e,t,n);return e.set(s),a}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&ja(t)&&this._activeObject===t){const n=Xa(e,["angle","flipX","flipY",nn,br,Yr,zo,Vo,Lr]);return mv(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(s)}}de(ph,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Yw{constructor(e){de(this,"targets",[]),de(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach((e=>{e.isEditing&&e.exitEditing()}))}add(e){this.targets.push(e)}remove(e){this.unregister(e),Ia(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const qw=["target","oldTarget","fireCanvas","e"],Gr={passive:!1},bo=(l,e)=>{const t=l.getViewportPoint(e),n=l.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},ea=function(l){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return l.addEventListener(...t)},si=function(l){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return l.removeEventListener(...t)},Kw={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class $l extends ph{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),de(this,"_isClick",void 0),de(this,"textEditingManager",new Yw(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((t=>{this[t]=this[t].bind(this)})),this.addOrRemove(ea,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,s=this._getEventPrefix();e(dv(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,Gr),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel,{passive:!1}),e(n,"contextmenu",this._onContextMenu),e(n,"click",this._onClick),e(n,"dblclick",this._onClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Gr)}removeListeners(){this.addOrRemove(si,"remove");const e=this._getEventPrefix(),t=ki(this.upperCanvasEl);si(t,"".concat(e,"up"),this._onMouseUp),si(t,"touchend",this._onTouchEnd,Gr),si(t,"".concat(e,"move"),this._onMouseMove,Gr),si(t,"touchmove",this._onMouseMove,Gr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=ge({e},bo(this,e));this.fire("mouse:out",ge(ge({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",ge({},n)),this._hoveredTargets.forEach((s=>{this.fire("mouse:out",ge(ge({},n),{},{target:s})),s&&s.fire("mouseout",ge({},n))})),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",ge({e},bo(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void ea(this.upperCanvasEl,"drag",this._onDragProgress)}D0(e)}_renderDragEffects(e,t,n){let s=!1;const a=this._dropTarget;a&&a!==t&&a!==n&&(a.clearContextTop(),s=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();const h=this.contextTop;h.save(),h.transform(...this.viewportTransform),t&&(h.save(),t.transform(h),t.renderDragSourceEffect(e),h.restore(),s=!0),n&&(h.save(),n.transform(h),n.renderDropTargetEffect(e),h.restore(),s=!0),h.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==_r,n=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};si(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:s}=this.findDragTargets(e),a=this._dragSource,h={e,target:n,subTargets:s,dragSource:a,canDrop:!1,dropTarget:void 0};let p;this.fire(t,h),this._fireEnterLeaveEvents(n,h),n&&(n.canDrop(e)&&(p=n),n.fire(t,h));for(let v=0;v<s.length;v++){const _=s[v];_.canDrop(e)&&(p=_),_.fire(t,h)}this._renderDragEffects(e,a,p),this._dropTarget=p}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),s={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",ge({e,target:t,subTargets:n,dragSource:this._dragSource},bo(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&D0(e),this._basicEventHandler("contextmenu",s),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,a=this._getEventPrefix(),h=ki(s);ea(h,"touchend",this._onTouchEnd,Gr),t&&ea(h,"touchmove",this._onMouseMove,Gr),si(s,"".concat(a,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();si(t,"".concat(n,"move"),this._onMouseMove,Gr);const s=ki(t);ea(s,"".concat(n,"up"),this._onMouseUp),ea(s,"".concat(n,"move"),this._onMouseMove,Gr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=ki(this.upperCanvasEl);si(n,"touchend",this._onTouchEnd,Gr),si(n,"touchmove",this._onMouseMove,Gr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{ea(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=ki(this.upperCanvasEl);si(s,"".concat(n,"up"),this._onMouseUp),si(s,"".concat(n,"move"),this._onMouseMove,Gr),ea(t,"".concat(n,"move"),this._onMouseMove,Gr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,a=this._target,{button:h}=e;if(h)return(this.fireMiddleClick&&h===1||this.fireRightClick&&h===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let p,v,_=!1;if(n&&(this._finalizeCurrentTransform(e),_=n.actionPerformed),!s){const b=a===this._activeObject;this.handleSelection(e),_||(_=this._shouldRender(a)||!b&&a===this._activeObject)}if(a){const b=a.findControl(this.getViewportPoint(e),Vc(e)),{key:E,control:N}=b||{};if(v=E,a.selectable&&a!==this._activeObject&&a.activeOn==="up")this.setActiveObject(a,e),_=!0;else if(N){const O=N.getMouseUpHandler(e,a,N);O&&(p=this.getScenePoint(e),O.call(N,e,n,p.x,p.y))}a.isMoving=!1}if(n&&(n.target!==a||n.corner!==v)){const b=n.target&&n.target.controls[n.corner],E=b&&b.getMouseUpHandler(e,n.target,b);p=p||this.getScenePoint(e),E&&E.call(b,e,n,p.x,p.y)}this._setCursorFromEvent(e,a),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,a&&(a.__corner=void 0),_?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:s=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let a=0;a<s.length;a++)s[a]!==n&&s[a].fire(e,t);return t}_handleEvent(e,t,n){const s=this._target,a=this.targets||[],h=ge(ge(ge({e,target:s,subTargets:a},bo(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?n:{});this.fire("mouse:".concat(t),h),s&&s.fire("mouse".concat(t),h);for(let p=0;p<a.length;p++)a[p]!==s&&a[p].fire("mouse".concat(t),h)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,n=!!t&&t===this._activeObject;const{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let a=this._shouldRender(t),h=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,h=!0,a=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const p=this.getScenePoint(e);this._groupSelector={x:p.x,y:p.y,deltaY:0,deltaX:0}}if(n=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const p=t.findControl(this.getViewportPoint(e),Vc(e));if(t===this._activeObject&&(p||!h)){this._setupCurrentTransform(e,t,n);const v=p?p.control:void 0,_=this.getScenePoint(e),b=v&&v.getMouseDownHandler(e,t,v);b&&b.call(v,e,this._currentTransform,_.x,_.y)}}a&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),a&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=ws(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,s=this._hoveredTargets,a=this.targets,h=Math.max(s.length,a.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let p=0;p<h;p++)a[p]===t||s[p]&&s[p]===n||this.fireSyntheticInOutEvents("mouse",{e,target:a[p],oldTarget:s[p]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,s=this._hoveredTargets,a=this.targets,h=Math.max(s.length,a.length);this.fireSyntheticInOutEvents("drag",ge(ge({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let p=0;p<h;p++)this.fireSyntheticInOutEvents("drag",ge(ge({},t),{},{target:a[p],oldTarget:s[p]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:s,fireCanvas:a,e:h}=t,p=dn(t,qw);const{targetIn:v,targetOut:_,canvasIn:b,canvasOut:E}=Kw[e],N=s!==n;if(s&&N){const O=ge(ge({},p),{},{e:h,target:s,nextTarget:n},bo(this,h));a&&this.fire(E,O),s.fire(_,O)}if(n&&N){const O=ge(ge({},p),{},{e:h,target:n,previousTarget:s},bo(this,h));a&&this.fire(b,O),n.fire(v,O)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,s=n.target,a=s.group?ws(t,void 0,s.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,a),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:s,actionHandler:a,target:h}=t,p=!!a&&a(e,t,n.x,n.y);p&&h.setCoords(),s==="drag"&&p&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||p}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const s=ja(this._activeObject)?this._activeObject:null,a=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(a){const h=a.control;this.setCursor(h.cursorStyleHandler(e,h,t))}else t.subTargetCheck&&this.targets.concat().reverse().map((h=>{n=h.hoverCursor||n})),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,s=ja(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||s)&&(s||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(s){const a=n.getObjects();if(t===n){const h=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(a,h)||this.searchPossibleTargets(this._objects,h))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(a,e)}else{n.isEditing&&n.exitEditing();const a=new(ct.getClass("ActiveSelection"))([],{canvas:this});a.multiSelectAdd(n,t),this._hoveredTarget=a,this._setActiveObject(a,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:s,deltaY:a}=this._groupSelector,h=new Ce(t,n),p=h.add(new Ce(s,a)),v=h.min(p),_=h.max(p).subtract(v),b=this.collectObjects({left:v.x,top:v.y,width:_.x,height:_.y},{includeIntersecting:!this.selectionFullyContained}),E=h.eq(p)?b[0]?[b[0]]:[]:b.length>1?b.filter((N=>!N.onSelect({e}))).reverse():b;if(E.length===1)this.setActiveObject(E[0],e);else if(E.length>1){const N=ct.getClass("ActiveSelection");this.setActiveObject(new N(E,{canvas:this}),e)}return this._groupSelector=null,!0}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;const{upper:n}=this.elements;n.ctx=void 0;const s=super.toCanvasElement(e,t);return n.ctx=n.el.getContext("2d"),s}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const my={x1:0,y1:0,x2:0,y2:0},Zw=ge(ge({},my),{},{r1:0,r2:0}),Oo=(l,e)=>isNaN(l)&&typeof e=="number"?e:l;function vy(l){return l&&/%$/.test(l)&&Number.isFinite(parseFloat(l))}function yy(l,e){const t=typeof l=="number"?l:typeof l=="string"?parseFloat(l)/(vy(l)?100:1):NaN;return za(0,Oo(t,e),1)}const Qw=/\s*;\s*/,Jw=/\s*:\s*/;function $w(l,e){let t,n;const s=l.getAttribute("style");if(s){const h=s.split(Qw);h[h.length-1]===""&&h.pop();for(let p=h.length;p--;){const[v,_]=h[p].split(Jw).map((b=>b.trim()));v==="stop-color"?t=_:v==="stop-opacity"&&(n=_)}}const a=new $t(t||l.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:yy(l.getAttribute("offset"),0),color:a.toRgb(),opacity:Oo(parseFloat(n||l.getAttribute("stop-opacity")||""),1)*a.getAlpha()*e}}function eb(l,e){const t=[],n=l.getElementsByTagName("stop"),s=yy(e,1);for(let a=n.length;a--;)t.push($w(n[a],s));return t}function _y(l){return l.nodeName==="linearGradient"||l.nodeName==="LINEARGRADIENT"?"linear":"radial"}function xy(l){return l.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Si(l,e){return l.getAttribute(e)}function tb(l,e){return(function(t,n){let s,{width:a,height:h,gradientUnits:p}=n;return Object.entries(t).reduce(((v,_)=>{let[b,E]=_;if(E==="Infinity")s=1;else if(E==="-Infinity")s=0;else{const N=typeof E=="string";s=N?parseFloat(E):E,N&&vy(E)&&(s*=.01,p==="pixels"&&(b!=="x1"&&b!=="x2"&&b!=="r2"||(s*=a),b!=="y1"&&b!=="y2"||(s*=h)))}return v[b]=s,v}),{})})(_y(l)==="linear"?(function(t){return{x1:Si(t,"x1")||0,y1:Si(t,"y1")||0,x2:Si(t,"x2")||"100%",y2:Si(t,"y2")||0}})(l):(function(t){return{x1:Si(t,"fx")||Si(t,"cx")||"50%",y1:Si(t,"fy")||Si(t,"cy")||"50%",r1:0,x2:Si(t,"cx")||"50%",y2:Si(t,"cy")||"50%",r2:Si(t,"r")||"50%"}})(l),ge(ge({},e),{},{gradientUnits:xy(l)}))}class Oi{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:s={},colorStops:a=[],offsetX:h=0,offsetY:p=0,gradientTransform:v,id:_}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:ge(ge({},t==="radial"?Zw:my),s),colorStops:a,offsetX:h,offsetY:p,gradientTransform:v,id:_?"".concat(_,"_").concat(ra()):ra()})}addColorStop(e){for(const t in e){const n=new $t(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return ge(ge({},Xa(this,e)),{},{type:this.type,coords:ge({},this.coords),colorStops:this.colorStops.map((t=>ge({},t))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():cr.concat(),a=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",h=this.colorStops.map((E=>ge({},E))).sort(((E,N)=>E.offset-N.offset));let p=-this.offsetX,v=-this.offsetY;var _;a==="objectBoundingBox"?(p/=e.width,v/=e.height):(p+=e.width/2,v+=e.height/2),(_=e)&&typeof _._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(p-=e.pathOffset.x,v-=e.pathOffset.y),s[4]-=p,s[5]-=v;const b=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(a,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(jo(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:E,y1:N,x2:O,y2:Q}=this.coords;n.push("<linearGradient ",b,' x1="',E,'" y1="',N,'" x2="',O,'" y2="',Q,`">
`)}else if(this.type==="radial"){const{x1:E,y1:N,x2:O,y2:Q,r1:W,r2:ee}=this.coords,K=W>ee;n.push("<radialGradient ",b,' cx="',K?E:O,'" cy="',K?N:Q,'" r="',K?W:ee,'" fx="',K?O:E,'" fy="',K?Q:N,`">
`),K&&(h.reverse(),h.forEach((le=>{le.offset=1-le.offset})));const ae=Math.min(W,ee);if(ae>0){const le=ae/Math.max(W,ee);h.forEach((ve=>{ve.offset+=le*(1-ve.offset)}))}}return h.forEach((E=>{let{color:N,offset:O,opacity:Q}=E;n.push("<stop ",'offset="',100*O+"%",'" style="stop-color:',N,Q!==void 0?";stop-opacity: "+Q:";",`"/>
`)})),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:s,y2:a,r1:h,r2:p}=this.coords,v=this.type==="linear"?e.createLinearGradient(t,n,s,a):e.createRadialGradient(t,n,h,s,a,p);return this.colorStops.forEach((_=>{let{color:b,opacity:E,offset:N}=_;v.addColorStop(N,E!==void 0?new $t(b).setAlpha(E).toRgba():b)})),v}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(ge(ge({},e),{},{colorStops:t?t.map((s=>ge({},s))):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const s=xy(e),a=t._findCenterFromElement();return new this(ge({id:e.getAttribute("id")||void 0,type:_y(e),coords:tb(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:eb(e,n.opacity),gradientUnits:s,gradientTransform:Jl(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-a.x,offsetY:t.height/2-a.y}:{offsetX:0,offsetY:0}))}}de(Oi,"type","Gradient"),ct.setClass(Oi,"gradient"),ct.setClass(Oi,"linear"),ct.setClass(Oi,"radial");const nb=["type","source","patternTransform"];class Gl{get type(){return"pattern"}set type(e){Ss("warn","Setting type has no effect",e)}constructor(e){de(this,"repeat","repeat"),de(this,"offsetX",0),de(this,"offsetY",0),de(this,"crossOrigin",""),this.id=ra(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return ge(ge({},Xa(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:on(this.offsetX,Yt.NUM_FRACTION_DIGITS),offsetY:on(this.offsetY,Yt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:s,repeat:a,id:h}=this,p=Oo(this.offsetX/t,0),v=Oo(this.offsetY/n,0),_=a==="repeat-y"||a==="no-repeat"?1+Math.abs(p||0):Oo(s.width/t,0),b=a==="repeat-x"||a==="no-repeat"?1+Math.abs(v||0):Oo(s.height/n,0);return['<pattern id="SVGID_'.concat(h,'" x="').concat(p,'" y="').concat(v,'" width="').concat(_,'" height="').concat(b,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:s,patternTransform:a}=e,h=dn(e,nb);const p=await Ul(s,ge(ge({},t),{},{crossOrigin:h.crossOrigin}));return new this(ge(ge({},h),{},{patternTransform:a&&a.slice(0),source:p}))}}de(Gl,"type","Pattern"),ct.setClass(Gl),ct.setClass(Gl,"pattern");class gh{constructor(e){de(this,"color","rgb(0, 0, 0)"),de(this,"width",1),de(this,"shadow",null),de(this,"strokeLineCap","round"),de(this,"strokeLineJoin","round"),de(this,"strokeMiterLimit",10),de(this,"strokeDashArray",null),de(this,"limitedToCanvasSize",!1),this.canvas=e}_setBrushStyles(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])}_saveAndTransform(e){const t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}needsFullRender(){return new $t(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const e=this.canvas,t=this.shadow,n=e.contextTop,s=e.getZoom()*e.getRetinaScaling();n.shadowColor=t.color,n.shadowBlur=t.blur*s,n.shadowOffsetX=t.offsetX*s,n.shadowOffsetY=t.offsetY*s}_resetShadow(){const e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}_isOutSideCanvas(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}}const rb=["path","left","top"],ib=["d"];class Ji extends Zn{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:a}=t,h=dn(t,rb);super(),Object.assign(this,Ji.ownDefaults),this.setOptions(h),this._setPath(e||[],!0),typeof s=="number"&&this.set(nn,s),typeof a=="number"&&this.set(Lr,a)}_setPath(e,t){this.path=ay(Array.isArray(e)?e:fy(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Ce(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+n);break;case"M":e.moveTo(s[1]+t,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n,s[5]+t,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ge(ge({},super.toObject(e)),{},{path:this.path.map((t=>t.slice()))})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=yp(this.path,Yt.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Yt.NUM_FRACTION_DIGITS;return" translate(".concat(on(-this.pathOffset.x,e),", ").concat(on(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:s}=this._calcDimensions();this.set({width:t,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,Rt,Rt)}_calcBoundsFromPath(){const e=[];let t=0,n=0,s=0,a=0;for(const h of this.path)switch(h[0]){case"L":s=h[1],a=h[2],e.push({x:t,y:n},{x:s,y:a});break;case"M":s=h[1],a=h[2],t=s,n=a;break;case"C":e.push(...Od(s,a,h[1],h[2],h[3],h[4],h[5],h[6])),s=h[5],a=h[6];break;case"Q":e.push(...Od(s,a,h[1],h[2],h[1],h[2],h[3],h[4])),s=h[3],a=h[4];break;case"Z":s=t,a=n}return rs(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return ge(ge({},e),{},{pathOffset:new Ce(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const s=as(e,this.ATTRIBUTE_NAMES,n),{d:a}=s;return new this(a,ge(ge(ge({},dn(s,ib)),t),{},{left:void 0,top:void 0}))}}de(Ji,"type","Path"),de(Ji,"cacheProperties",[...Ts,"path","fillRule"]),de(Ji,"ATTRIBUTE_NAMES",[...aa,"d"]),ct.setClass(Ji),ct.setSVGClass(Ji);class Va extends gh{constructor(e){super(e),de(this,"decimate",.4),de(this,"drawStraightLine",!1),de(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(e,t,n){const s=t.midPointFrom(n);return e.quadraticCurveTo(t.x,t.y,s.x,s.y),s}onMouseDown(e,t){let{e:n}=t;this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],this._prepareForDrawing(e),this._addPoint(e),this._render())}onMouseMove(e,t){let{e:n}=t;if(this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(e))&&this._addPoint(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const s=this._points,a=s.length,h=this.canvas.contextTop;this._saveAndTransform(h),this.oldEnd&&(h.beginPath(),h.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=Va.drawSegment(h,s[a-2],s[a-1]),h.stroke(),h.restore()}}onMouseUp(e){let{e:t}=e;return!this.canvas._isMainEvent(t)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(e){this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)}_addPoint(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,t=this._points[0],n=this._points[1];if(this._saveAndTransform(e),e.beginPath(),this._points.length===2&&t.x===n.x&&t.y===n.y){const s=this.width/1e3;t.x-=s,n.x+=s}e.moveTo(t.x,t.y);for(let s=1;s<this._points.length;s++)Va.drawSegment(e,t,n),t=this._points[s],n=this._points[s+1];e.lineTo(t.x,t.y),e.stroke(),e.restore()}convertPointsToSVGPath(e){const t=this.width/1e3;return dy(e,t)}createPath(e){const t=new Ji(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new wr(this.shadow)),t}decimatePoints(e,t){if(e.length<=2)return e;let n,s=e[0];const a=this.canvas.getZoom(),h=Math.pow(t/a,2),p=e.length-1,v=[s];for(let _=1;_<p-1;_++)n=Math.pow(s.x-e[_].x,2)+Math.pow(s.y-e[_].y,2),n>=h&&(s=e[_],v.push(s));return v.push(e[p]),v}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const e=this.convertPointsToSVGPath(this._points);if((function(n){return yp(n)==="M 0 0 Q 0 0 0 0 L 0 0"})(e))return void this.canvas.requestRenderAll();const t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}}const sb=["left","top","radius"],wy=["radius","startAngle","endAngle","counterClockwise"];class Ir extends Zn{static getDefaults(){return ge(ge({},super.getDefaults()),Ir.ownDefaults)}constructor(e){super(),Object.assign(this,Ir.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,En(this.startAngle),En(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(br)}getRadiusY(){return this.get("radius")*this.get(Yr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...wy,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=En(this.startAngle),s=En(this.endAngle),a=ji(n)*t,h=Li(n)*t,p=ji(s)*t,v=Li(s)*t,_=e>180?1:0,b=this.counterClockwise?0:1;return['<path d="M '.concat(a," ").concat(h," A ").concat(t," ").concat(t," 0 ").concat(_," ").concat(b," ").concat(p," ").concat(v,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const s=as(e,this.ATTRIBUTE_NAMES,n),{left:a=0,top:h=0,radius:p=0}=s;return new this(ge(ge({},dn(s,sb)),{},{radius:p,left:a-p,top:h-p}))}static fromObject(e){return super._fromObject(e)}}de(Ir,"type","Circle"),de(Ir,"cacheProperties",[...Ts,...wy]),de(Ir,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),de(Ir,"ATTRIBUTE_NAMES",["cx","cy","r",...aa]),ct.setClass(Ir),ct.setSVGClass(Ir);class by extends gh{constructor(e){super(e),de(this,"width",10),this.points=[]}drawDot(e){const t=this.addPoint(e),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,t),n.restore()}dot(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.closePath(),e.fill()}onMouseDown(e){this.points=[],this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)}_render(){const e=this.canvas.contextTop,t=this.points;this._saveAndTransform(e);for(let n=0;n<t.length;n++)this.dot(e,t[n]);e.restore()}onMouseMove(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))}onMouseUp(){const e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;const t=[];for(let s=0;s<this.points.length;s++){const a=this.points[s],h=new Ir({radius:a.radius,left:a.x,top:a.y,originX:Rt,originY:Rt,fill:a.fill});this.shadow&&(h.shadow=new wr(this.shadow)),t.push(h)}const n=new ur(t,{canvas:this.canvas});this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.fire("path:created",{path:n}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()}addPoint(e){let{x:t,y:n}=e;const s={x:t,y:n,radius:Da(Math.max(0,this.width-20),this.width+20)/2,fill:new $t(this.color).setAlpha(Da(0,100)/100).toRgba()};return this.points.push(s),s}}class Sy extends gh{constructor(e){super(e),de(this,"width",10),de(this,"density",20),de(this,"dotWidth",1),de(this,"dotWidthVariance",1),de(this,"randomOpacity",!1),de(this,"optimizeOverlapping",!0),this.sprayChunks=[],this.sprayChunk=[]}onMouseDown(e){this.sprayChunks=[],this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.renderChunck(this.sprayChunk)}onMouseMove(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.renderChunck(this.sprayChunk))}onMouseUp(){const e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;const t=[];for(let s=0;s<this.sprayChunks.length;s++){const a=this.sprayChunks[s];for(let h=0;h<a.length;h++){const p=a[h],v=new yr({width:p.width,height:p.width,left:p.x+1,top:p.y+1,originX:Rt,originY:Rt,fill:this.color});t.push(v)}}const n=new ur(this.optimizeOverlapping?(function(s){const a={},h=[];for(let p,v=0;v<s.length;v++)p="".concat(s[v].left).concat(s[v].top),a[p]||(a[p]=!0,h.push(s[v]));return h})(t):t,{objectCaching:!0,subTargetCheck:!1,interactive:!1});this.shadow&&n.set("shadow",new wr(this.shadow)),this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.fire("path:created",{path:n}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()}renderChunck(e){const t=this.canvas.contextTop;t.fillStyle=this.color,this._saveAndTransform(t);for(let n=0;n<e.length;n++){const s=e[n];t.globalAlpha=s.opacity,t.fillRect(s.x,s.y,s.width,s.width)}t.restore()}_render(){const e=this.canvas.contextTop;e.fillStyle=this.color,this._saveAndTransform(e);for(let t=0;t<this.sprayChunks.length;t++)this.renderChunck(this.sprayChunks[t]);e.restore()}addSprayChunk(e){this.sprayChunk=[];const t=this.width/2;for(let n=0;n<this.density;n++)this.sprayChunk.push({x:Da(e.x-t,e.x+t),y:Da(e.y-t,e.y+t),width:this.dotWidthVariance?Da(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth,opacity:this.randomOpacity?Da(0,100)/100:1});this.sprayChunks.push(this.sprayChunk)}}class Cy extends Va{constructor(e){super(e)}getPatternSrc(){const e=ui(),t=e.getContext("2d");return e.width=e.height=25,t&&(t.fillStyle=this.color,t.beginPath(),t.arc(10,10,10,0,2*Math.PI,!1),t.closePath(),t.fill()),e}getPattern(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")}_setBrushStyles(e){super._setBrushStyles(e);const t=this.getPattern(e);t&&(e.strokeStyle=t)}createPath(e){const t=super.createPath(e),n=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new Gl({source:this.source||this.getPatternSrc(),offsetX:-n.x,offsetY:-n.y}),t}}const ab=["x1","y1","x2","y2"],ob=["x1","y1","x2","y2"],Ad=["x1","x2","y1","y2"];class li extends Zn{constructor(){let[e,t,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,li.ownDefaults),this.setOptions(a),this.x1=e,this.x2=n,this.y1=t,this.y2=s,this._setWidthHeight();const{left:h,top:p}=a;typeof h=="number"&&this.set(nn,h),typeof p=="number"&&this.set(Lr,p)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-t);const{left:a,top:h,width:p,height:v}=rs([{x:e,y:t},{x:n,y:s}]),_=new Ce(a+p/2,h+v/2);this.setPositionByOrigin(_,Rt,Rt)}_set(e,t){return super._set(e,t),Ad.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;oi(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new Ce((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ge(ge({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:s,width:a,height:h}=this,p=e<=t?-1:1,v=n<=s?-1:1;return{x1:p*a/2,x2:p*-a/2,y1:v*h/2,y2:v*-h/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,n){const s=as(e,this.ATTRIBUTE_NAMES,n),{x1:a=0,y1:h=0,x2:p=0,y2:v=0}=s;return new this([a,h,p,v],dn(s,ab))}static fromObject(e){let{x1:t,y1:n,x2:s,y2:a}=e,h=dn(e,ob);return this._fromObject(ge(ge({},h),{},{points:[t,n,s,a]}),{extraParam:"points"})}}de(li,"type","Line"),de(li,"cacheProperties",[...Ts,...Ad]),de(li,"ATTRIBUTE_NAMES",aa.concat(Ad)),ct.setClass(li),ct.setSVGClass(li);class es extends Zn{static getDefaults(){return ge(ge({},super.getDefaults()),es.ownDefaults)}constructor(e){super(),Object.assign(this,es.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}de(es,"type","Triangle"),de(es,"ownDefaults",{width:100,height:100}),ct.setClass(es),ct.setSVGClass(es);const ky=["rx","ry"];class Ci extends Zn{static getDefaults(){return ge(ge({},super.getDefaults()),Ci.ownDefaults)}constructor(e){super(),Object.assign(this,Ci.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(br)}getRy(){return this.get("ry")*this.get(Yr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...ky,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Cs,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const s=as(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function Ty(l){if(!l)return[];const e=l.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}de(Ci,"type","Ellipse"),de(Ci,"cacheProperties",[...Ts,...ky]),de(Ci,"ownDefaults",{rx:0,ry:0}),de(Ci,"ATTRIBUTE_NAMES",[...aa,"cx","cy","rx","ry"]),ct.setClass(Ci),ct.setSVGClass(Ci);const lb=["left","top"],Ey={exactBoundingBox:!1};class ai extends Zn{static getDefaults(){return ge(ge({},super.getDefaults()),ai.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),de(this,"strokeDiff",void 0),Object.assign(this,ai.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(nn,n),typeof s=="number"&&this.set(Lr,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return Kv(this.points,e,this.isOpen())}_calcDimensions(e){e=ge({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map((_=>_.projectedPoint)):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Ce,strokeOffset:new Ce,strokeDiff:new Ce};const n=rs(t),s=au(ge(ge({},e),{},{scaleX:1,scaleY:1})),a=rs(this.points.map((_=>lr(_,s,!0)))),h=new Ce(this.scaleX,this.scaleY);let p=n.left+n.width/2,v=n.top+n.height/2;return this.exactBoundingBox&&(p-=v*Math.tan(En(this.skewX)),v-=p*Math.tan(En(this.skewY))),ge(ge({},n),{},{pathOffset:new Ce(p,v),strokeOffset:new Ce(a.left,a.top).subtract(new Ce(n.left,n.top)).multiply(h),strokeDiff:new Ce(n.width,n.height).subtract(new Ce(a.width,a.height)).multiply(h)})}_findCenterFromElement(){const e=rs(this.points);return new Ce(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:s,height:a,pathOffset:h,strokeOffset:p,strokeDiff:v}=this._calcDimensions();this.set({width:s,height:a,pathOffset:h,strokeOffset:p,strokeDiff:v}),e&&this.setPositionByOrigin(new Ce(t+s/2,n+a/2),Rt,Rt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Ce(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let h;if(Object.keys(e).some((p=>this.strokeUniform||this.constructor.layoutProperties.includes(p)))){var t,n;const{width:p,height:v}=this._calcDimensions(e);h=new Ce((t=e.width)!==null&&t!==void 0?t:p,(n=e.height)!==null&&n!==void 0?n:v)}else{var s,a;h=new Ce((s=e.width)!==null&&s!==void 0?s:this.width,(a=e.height)!==null&&a!==void 0?a:this.height)}return h.multiply(new Ce(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&n&&((e===br||e===Yr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ge(ge({},super.toObject(e)),{},{points:this.points.map((t=>{let{x:n,y:s}=t;return{x:n,y:s}}))})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,s=Yt.NUM_FRACTION_DIGITS;for(let a=0,h=this.points.length;a<h;a++)e.push(on(this.points[a].x-t,s),",",on(this.points[a].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let a=0;a<t;a++){const h=this.points[a];e.lineTo(h.x-n,h.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(Ty(e.getAttribute("points")),ge(ge({},dn(as(e,this.ATTRIBUTE_NAMES,n),lb)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}de(ai,"ownDefaults",Ey),de(ai,"type","Polyline"),de(ai,"layoutProperties",[zo,Vo,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),de(ai,"cacheProperties",[...Ts,"points"]),de(ai,"ATTRIBUTE_NAMES",[...aa]),ct.setClass(ai),ct.setSVGClass(ai);class ta extends ai{isOpen(){return!1}}de(ta,"ownDefaults",Ey),de(ta,"type","Polygon"),ct.setClass(ta),ct.setSVGClass(ta);class Oy extends Zn{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const s in t[n])for(const a in t[n][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const s in n)for(const a in n[s])if(n[s][a][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,s,a=0,h=!0,p=0;for(const v in t){n=0;for(const _ in t[v]){const b=t[v][_]||{};a++,b[e]!==void 0?(s?b[e]!==s&&(h=!1):s=b[e],b[e]===this[e]&&delete b[e]):h=!1,Object.keys(b).length!==0?n++:delete t[v][_]}n===0&&delete t[v]}for(let v=0;v<this._textLines.length;v++)p+=this._textLines[v].length;h&&a===p&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,s,a;for(s in t){for(a in n=t[s],n)delete n[a][e],Object.keys(n[a]).length===0&&delete n[a];Object.keys(n).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const a=np(ge(ge({},this._getStyleDeclaration(n,s)),t),(h=>h!==void 0));this._setStyleDeclaration(n,s,a)}getSelectionStyles(e,t,n){const s=[];for(let a=e;a<(t||e);a++)s.push(this.getStyleAtPosition(a,n));return s}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,t,n){for(let s=t;s<(n||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const s=this.styles&&this.styles[e];return s&&(n=s[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return ge(ge({},Xa(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}de(Oy,"_styleProperties",zx);const ub=/  +/g,cb=/"/g;function ld(l,e,t,n,s){return"		".concat((function(a,h){let{left:p,top:v,width:_,height:b}=h,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yt.NUM_FRACTION_DIGITS;const N=Ql(Rn,a,!1),[O,Q,W,ee]=[p,v,_,b].map((K=>on(K,E)));return"<rect ".concat(N,' x="').concat(O,'" y="').concat(Q,'" width="').concat(W,'" height="').concat(ee,'"></rect>')})(l,{left:e,top:t,width:n,height:s}),`
`)}const hb=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let ud;class $n extends Oy{static getDefaults(){return ge(ge({},super.getDefaults()),$n.ownDefaults)}constructor(e,t){super(),de(this,"__charBounds",[]),Object.assign(this,$n.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=vp(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Qi)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,s,a,h,p;for(let v=0,_=this._textLines.length;v<_;v++)if((this.textAlign===Qi||v!==_-1&&!this.isEndOfWrapping(v))&&(s=0,a=this._textLines[v],t=this.getLineWidth(v),t<this.width&&(p=this.textLines[v].match(this._reSpacesAndTabs)))){n=p.length,e=(this.width-t)/n;for(let b=0;b<=a.length;b++)h=this.__charBounds[v][b],this._reSpaceAndTab.test(a[b])?(h.width+=e,h.kernedWidth+=e,h.left+=s,s+=e):h.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===xr?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Rt:e.textBaseline="middle";break;case"ascender":e.textBaseline=Lr;break;case"descender":e.textBaseline=vd}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,n,s,a,h){this._renderChars(e,t,n,s,a,h)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let a=0,h=this._textLines.length;a<h;a++){const p=this.getHeightOfLine(a);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",a)){s+=p;continue}const v=this._textLines[a].length,_=this._getLineLeftOffset(a);let b,E,N=0,O=0,Q=this.getValueOfPropertyAt(a,0,"textBackgroundColor");const W=this.getHeightOfLineImpl(a);for(let ee=0;ee<v;ee++){const K=this.__charBounds[a][ee];E=this.getValueOfPropertyAt(a,ee,"textBackgroundColor"),this.path?(e.save(),e.translate(K.renderLeft,K.renderTop),e.rotate(K.angle),e.fillStyle=E,E&&e.fillRect(-K.width/2,-W*(1-this._fontSizeFraction),K.width,W),e.restore()):E!==Q?(b=n+_+O,this.direction==="rtl"&&(b=this.width-b-N),e.fillStyle=Q,Q&&e.fillRect(b,s,N,W),O=K.left,N=K.width,Q=E):N+=K.kernedWidth}E&&!this.path&&(b=n+_+O,this.direction==="rtl"&&(b=this.width-b-N),e.fillStyle=E,e.fillRect(b,s,N,W)),s+=p}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,s){const a=Po.getFontCache(t),h=this._getFontDeclaration(t),p=n?n+e:e,v=n&&h===this._getFontDeclaration(s),_=t.fontSize/this.CACHE_FONT_SIZE;let b,E,N,O;if(n&&a.has(n)&&(N=a.get(n)),a.has(e)&&(O=b=a.get(e)),v&&a.has(p)&&(E=a.get(p),O=E-N),b===void 0||N===void 0||E===void 0){const Q=(function(){return ud||(ud=Dr({width:0,height:0}).getContext("2d")),ud})();this._setTextStyles(Q,t,!0),b===void 0&&(O=b=Q.measureText(e).width,a.set(e,b)),N===void 0&&v&&n&&(N=Q.measureText(n).width,a.set(n,N)),v&&E===void 0&&(E=Q.measureText(p).width,a.set(p,E),O=E-N)}return{width:b*_,kernedWidth:O*_}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,s=0;const a=this.pathSide===Mn,h=this.path,p=this._textLines[e],v=p.length,_=new Array(v);this.__charBounds[e]=_;for(let b=0;b<v;b++){const E=p[b];n=this._getGraphemeBox(E,e,b,t),_[b]=n,s+=n.kernedWidth,t=E}if(_[v]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},h&&h.segmentsInfo){let b=0;const E=h.segmentsInfo[h.segmentsInfo.length-1].length;switch(this.textAlign){case nn:b=a?E-s:0;break;case Rt:b=(E-s)/2;break;case Mn:b=a?0:E-s}b+=this.pathStartOffset*(a?-1:1);for(let N=a?v-1:0;a?N>=0:N<v;a?N--:N++)n=_[N],b>E?b%=E:b<0&&(b+=E),this._setGraphemeOnPath(b,n),b+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,s=this.path,a=hy(s.path,n,s.segmentsInfo);t.renderLeft=a.x-s.pathOffset.x,t.renderTop=a.y-s.pathOffset.y,t.angle=a.angle+(this.pathSide===Mn?Math.PI:0)}_getGraphemeBox(e,t,n,s,a){const h=this.getCompleteStyleDeclaration(t,n),p=s?this.getCompleteStyleDeclaration(t,n-1):{},v=this._measureChar(e,h,s,p);let _,b=v.kernedWidth,E=v.width;this.charSpacing!==0&&(_=this._getWidthOfCharSpacing(),E+=_,b+=_);const N={width:E,left:0,height:h.fontSize,kernedWidth:b,deltaY:h.deltaY};if(n>0&&!a){const O=this.__charBounds[t][n-1];N.left=O.left+O.width+v.kernedWidth-v.width}return N}getHeightOfLineImpl(e){const t=this.__lineHeights;if(t[e])return t[e];let n=this.getHeightOfChar(e,0);for(let s=1,a=this._textLines[e].length;s<a;s++)n=Math.max(this.getHeightOfChar(e,s),n);return t[e]=n*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,n=this._textLines.length;t<n;t++)e+=t===n-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const s=this._getLeftOffset(),a=this._getTopOffset();for(let h=0,p=this._textLines.length;h<p;h++)this._renderTextLine(t,e,this._textLines[h],s+this._getLineLeftOffset(h),a+n+this.getHeightOfLineImpl(h),h),n+=this.getHeightOfLine(h);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Rn))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,s,a,h){const p=this.textAlign.includes(Qi),v=this.path,_=!p&&this.charSpacing===0&&this.isEmptyStyles(h)&&!v,b=this.direction==="ltr",E=this.direction==="ltr"?1:-1,N=t.direction;let O,Q,W,ee,K,ae="",le=0;if(t.save(),N!==this.direction&&(t.canvas.setAttribute("dir",b?"ltr":"rtl"),t.direction=b?"ltr":"rtl",t.textAlign=b?nn:Mn),a-=this.getHeightOfLineImpl(h)*this._fontSizeFraction,_)return this._renderChar(e,t,h,0,n.join(""),s,a),void t.restore();for(let ve=0,we=n.length-1;ve<=we;ve++)ee=ve===we||this.charSpacing||v,ae+=n[ve],W=this.__charBounds[h][ve],le===0?(s+=E*(W.kernedWidth-W.width),le+=W.width):le+=W.kernedWidth,p&&!ee&&this._reSpaceAndTab.test(n[ve])&&(ee=!0),ee||(O=O||this.getCompleteStyleDeclaration(h,ve),Q=this.getCompleteStyleDeclaration(h,ve+1),ee=dh(O,Q,!1)),ee&&(v?(t.save(),t.translate(W.renderLeft,W.renderTop),t.rotate(W.angle),this._renderChar(e,t,h,ve,ae,-le/2,0),t.restore()):(K=s,this._renderChar(e,t,h,ve,ae,K,a)),ae="",O=Q,s+=E*le,le=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=Dr({width:t,height:n}),a=s.getContext("2d");return s.width=t,s.height=n,a.beginPath(),a.moveTo(0,0),a.lineTo(t,0),a.lineTo(t,n),a.lineTo(0,n),a.closePath(),a.translate(t/2,n/2),a.fillStyle=e.toLive(a),this._applyPatternGradientTransform(a,e),a.fill(),a.createPattern(s,"no-repeat")}handleFiller(e,t,n){let s,a;return oi(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,a=-this.height/2,e.translate(s,a),e[t]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:a}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,s,a,h,p){const v=this._getStyleDeclaration(n,s),_=this.getCompleteStyleDeclaration(n,s),b=e==="fillText"&&_.fill,E=e==="strokeText"&&_.stroke&&_.strokeWidth;if(E||b){if(t.save(),t.font=this._getFontDeclaration(_),v.textBackgroundColor&&this._removeShadow(t),v.deltaY&&(p+=v.deltaY),b){const N=this._setFillStyles(t,_);t.fillText(a,h-N.offsetX,p-N.offsetY)}if(E){const N=this._setStrokeStyles(t,_);t.strokeText(a,h-N.offsetX,p-N.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const s=this.get2DCursorLocation(e,!0),a=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),h=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),p={fontSize:a*n.size,deltaY:h+a*n.baseline};this.setSelectionStyles(p,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,s=this.textAlign,a=this.direction,h=this.isEndOfWrapping(e);let p=0;return s===Qi||s===Xl&&!h||s===Hl&&!h||s===Hc&&!h?0:(s===Rt&&(p=n/2),s===Mn&&(p=n),s===Xl&&(p=n/2),s===Hl&&(p=n),a==="rtl"&&(s===Mn||s===Qi||s===Hl?p=0:s===nn||s===Hc?p=-n:s!==Rt&&s!==Xl||(p=-n/2)),p)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var s;return(s=this._getStyleDeclaration(e,t)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const s=this._getLeftOffset(),a=this.path,h=this._getWidthOfCharSpacing(),p=t==="linethrough"?.5:t==="overline"?1:0,v=this.offsets[t];for(let _=0,b=this._textLines.length;_<b;_++){const E=this.getHeightOfLine(_);if(!this[t]&&!this.styleHas(t,_)){n+=E;continue}const N=this._textLines[_],O=E/this.lineHeight,Q=this._getLineLeftOffset(_);let W=0,ee=0,K=this.getValueOfPropertyAt(_,0,t),ae=this.getValueOfPropertyAt(_,0,Rn),le=this.getValueOfPropertyAt(_,0,Ba),ve=K,we=ae,F=le;const ze=n+O*(1-this._fontSizeFraction);let He=this.getHeightOfChar(_,0),Je=this.getValueOfPropertyAt(_,0,"deltaY");for(let Ke=0,dt=N.length;Ke<dt;Ke++){const Ve=this.__charBounds[_][Ke];ve=this.getValueOfPropertyAt(_,Ke,t),we=this.getValueOfPropertyAt(_,Ke,Rn),F=this.getValueOfPropertyAt(_,Ke,Ba);const Bt=this.getHeightOfChar(_,Ke),Le=this.getValueOfPropertyAt(_,Ke,"deltaY");if(a&&ve&&we){const wt=this.fontSize*F/1e3;e.save(),e.fillStyle=ae,e.translate(Ve.renderLeft,Ve.renderTop),e.rotate(Ve.angle),e.fillRect(-Ve.kernedWidth/2,v*Bt+Le-p*wt,Ve.kernedWidth,wt),e.restore()}else if((ve!==K||we!==ae||Bt!==He||F!==le||Le!==Je)&&ee>0){const wt=this.fontSize*le/1e3;let Be=s+Q+W;this.direction==="rtl"&&(Be=this.width-Be-ee),K&&ae&&le&&(e.fillStyle=ae,e.fillRect(Be,ze+v*He+Je-p*wt,ee,wt)),W=Ve.left,ee=Ve.width,K=ve,le=F,ae=we,He=Bt,Je=Le}else ee+=Ve.kernedWidth}let ut=s+Q+W;this.direction==="rtl"&&(ut=this.width-ut-ee),e.fillStyle=we;const Ie=this.fontSize*F/1e3;ve&&we&&F&&e.fillRect(ut,ze+v*He+Je-p*Ie,ee-h,Ie),n+=E}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;const h=e.includes("'")||e.includes('"')||e.includes(",")||$n.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(a?this.CACHE_FONT_SIZE:s,"px"),h].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return fh(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),s=[`
`];let a=[];for(let h=0;h<t.length;h++)n[h]=this.graphemeSplit(t[h]),a=a.concat(n[h],s);return a.pop(),{_unwrappedLines:n,lines:t,graphemeText:a,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ge(ge({},super.toObject([...Tv,...e])),{},{styles:Qv(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let s=!1,a=!1;if(typeof e=="object")for(const h in e)h==="path"&&this.setPathInfo(),s=s||n.includes(h),a=a||h==="path";else s=n.includes(e),a=e==="path";return a&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const s=as(e,$n.ATTRIBUTE_NAMES,n),a=ge(ge({},t),s),{textAnchor:h=nn,textDecoration:p="",dx:v=0,dy:_=0,top:b=0,left:E=0,fontSize:N=Yd,strokeWidth:O=1}=a,Q=dn(a,hb),W=new this(Uc(e.textContent||"").trim(),ge({left:E+v,top:b+_,underline:p.includes("underline"),overline:p.includes("overline"),linethrough:p.includes("line-through"),strokeWidth:0,fontSize:N},Q)),ee=W.getScaledHeight()/W.height,K=((W.height+W.strokeWidth)*W.lineHeight-W.height)*ee,ae=W.getScaledHeight()+K;let le=0;return h===Rt&&(le=W.getScaledWidth()/2),h===Mn&&(le=W.getScaledWidth()),W.set({left:W.left-le,top:W.top-(ae-W.fontSize*(.07+W._fontSizeFraction))/W.lineHeight,strokeWidth:O}),W}static fromObject(e){return this._fromObject(ge(ge({},e),{},{styles:Jv(e.styles||{},e.text)}),{extraParam:"text"})}}de($n,"textLayoutProperties",kv),de($n,"cacheProperties",[...Ts,...Tv]),de($n,"ownDefaults",Vx),de($n,"type","Text"),de($n,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),de($n,"ATTRIBUTE_NAMES",aa.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),Gv($n,[class extends bv{_toSVG(){const l=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(l.textTop,l.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(l){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:l,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:l,withShadow:!0,additionalTransform:jo(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(l){let{textBgRects:e,textSpans:t}=l;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(cb,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(l,e){const t=[],n=[];let s,a=l;this.backgroundColor&&n.push(...ld(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let h=0,p=this._textLines.length;h<p;h++)s=this._getLineLeftOffset(h),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",h))&&this._setSVGTextLineBg(n,h,e+s,a),this._setSVGTextLineText(t,h,e+s,a),a+=this.getHeightOfLine(h);return{textSpans:t,textBgRects:n}}_createTextCharSpan(l,e,t,n,s){const a=Yt.NUM_FRACTION_DIGITS,h=this.getSvgSpanStyles(e,l!==l.trim()||!!l.match(ub)),p=h?'style="'.concat(h,'"'):"",v=e.deltaY,_=v?' dy="'.concat(on(v,a),'" '):"",{angle:b,renderLeft:E,renderTop:N,width:O}=s;let Q="";if(E!==void 0){const W=O/2;b&&(Q=' rotate="'.concat(on(is(b),a),'"'));const ee=Ha({angle:is(b)});ee[4]=E,ee[5]=N;const K=new Ce(-W,0).transform(ee);t=K.x,n=K.y}return'<tspan x="'.concat(on(t,a),'" y="').concat(on(n,a),'" ').concat(_).concat(Q).concat(p,">").concat(Zv(l),"</tspan>")}_setSVGTextLineText(l,e,t,n){const s=this.getHeightOfLine(e),a=this.textAlign.includes(Qi),h=this._textLines[e];let p,v,_,b,E,N="",O=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let Q=0,W=h.length-1;Q<=W;Q++)E=Q===W||this.charSpacing||this.path,N+=h[Q],_=this.__charBounds[e][Q],O===0?(t+=_.kernedWidth-_.width,O+=_.width):O+=_.kernedWidth,a&&!E&&this._reSpaceAndTab.test(h[Q])&&(E=!0),E||(p=p||this.getCompleteStyleDeclaration(e,Q),v=this.getCompleteStyleDeclaration(e,Q+1),E=dh(p,v,!0)),E&&(b=this._getStyleDeclaration(e,Q),l.push(this._createTextCharSpan(N,b,t,n,_)),N="",p=v,this.direction==="rtl"?t-=O:t+=O,O=0)}_setSVGTextLineBg(l,e,t,n){const s=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight;let h,p=0,v=0,_=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let b=0;b<s.length;b++){const{left:E,width:N,kernedWidth:O}=this.__charBounds[e][b];h=this.getValueOfPropertyAt(e,b,"textBackgroundColor"),h!==_?(_&&l.push(...ld(_,t+v,n,p,a)),v=E,p=N,_=h):p+=O}h&&l.push(...ld(_,t+v,n,p,a))}_getSVGLineTopOffset(l){let e,t=0;for(e=0;e<l;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(l){return"".concat(super.getSvgStyles(l)," text-decoration-thickness: ").concat(on(this.textDecorationThickness*this.getObjectScaling().y/10,Yt.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(l,e){const{fontFamily:t,strokeWidth:n,stroke:s,fill:a,fontSize:h,fontStyle:p,fontWeight:v,deltaY:_,textDecorationThickness:b,linethrough:E,overline:N,underline:O}=l,Q=this.getSvgTextDecoration({underline:O??this.underline,overline:N??this.overline,linethrough:E??this.linethrough}),W=b||this.textDecorationThickness;return[s?Ql(xr,s):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",h?"font-size: ".concat(h,"px; "):"",p?"font-style: ".concat(p,"; "):"",v?"font-weight: ".concat(v,"; "):"",Q?"text-decoration: ".concat(Q,"; text-decoration-thickness: ").concat(on(W*this.getObjectScaling().y/10,Yt.NUM_FRACTION_DIGITS),"%; "):"",a?Ql(Rn,a):"",_?"baseline-shift: ".concat(-_,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(l){return["overline","underline","line-through"].filter((e=>l[e.replace("-","")])).join(" ")}}]),ct.setClass($n),ct.setSVGClass($n);class fb{constructor(e){de(this,"target",void 0),de(this,"__mouseDownInPlace",!1),de(this,"__dragStartFired",!1),de(this,"__isDraggingOver",!1),de(this,"__dragStartSelection",void 0),de(this,"__dragImageDisposer",void 0),de(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach((n=>n())),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:s,selectionEnd:a}=t;const h=this.target,p=h.canvas,v=new Ce(h.flipX?-1:1,h.flipY?-1:1),_=h._getCursorBoundaries(s),b=new Ce(_.left+_.leftOffset,_.top+_.topOffset).multiply(v).transform(h.calcTransformMatrix()),E=p.getScenePoint(e).subtract(b),N=h.getCanvasRetinaScaling(),O=h.getBoundingRect(),Q=b.subtract(new Ce(O.left,O.top)),W=p.viewportTransform,ee=Q.add(E).transform(W,!0),K=h.backgroundColor,ae=pp(h.styles);h.backgroundColor="";const le={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};h.setSelectionStyles(le,0,s),h.setSelectionStyles(le,a,h.text.length),h.dirty=!0;const ve=h.toCanvasElement({enableRetinaScaling:p.enableRetinaScaling,viewportTransform:!0});h.backgroundColor=K,h.styles=ae,h.dirty=!0,Jc(ve,{position:"fixed",left:"".concat(-ve.width,"px"),border:_r,width:"".concat(ve.width/N,"px"),height:"".concat(ve.height/N,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{ve.remove()},ki(e.target||this.target.hiddenTextarea).body.appendChild(ve),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(ve,ee.x,ee.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},a=t._text.slice(s.selectionStart,s.selectionEnd).join(""),h=ge({text:t.text,value:a},s);e.dataTransfer.setData("text/plain",a),e.dataTransfer.setData("application/fabric",JSON.stringify({value:a,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,h)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let a=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(a&&!s){const h=this.target,p=h.canvas;let v=h.getSelectionStartFromPointer(n);const{styles:_}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},b=a[Math.max(0,a.length-1)],E=0;if(this.__dragStartSelection){const N=this.__dragStartSelection.selectionStart,O=this.__dragStartSelection.selectionEnd;v>N&&v<=O?v=N:v>O&&(v-=O-N),h.removeChars(N,O),delete this.__dragStartSelection}h._reNewline.test(b)&&(h._reNewline.test(h._text[v])||v===h._text.length)&&(a=a.trimEnd()),e.didDrop=!0,e.dropTarget=h,h.insertChars(a,_,v),p.setActiveObject(h),h.enterEditing(n),h.selectionStart=Math.min(v+E,h._text.length),h.selectionEnd=Math.min(h.selectionStart+a.length,h._text.length),h.hiddenTextarea.value=h.text,h._updateTextarea(),h.hiddenTextarea.focus(),h.fire(Bc,{index:v+E,action:"drop"}),p.fire("text:changed",{target:h}),p.contextTopDirty=!0,p.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,a=this.target.canvas,{selectionStart:h,selectionEnd:p}=this.__dragStartSelection,v=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||_r;v===_r?(s.selectionStart=h,s.selectionEnd=p,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),v==="move"&&(s.removeChars(h,p),s.selectionStart=s.selectionEnd=h,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Bc,{index:h,action:"dragend"}),a.fire("text:changed",{target:s}),a.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const lm=/[ \n\.,;!\?\-]/;class db extends $n{constructor(){super(...arguments),de(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:s,onComplete:a}=e;return hp({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:s,onComplete:a,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:h=>{this._currentCursorOpacity=h,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach((t=>{t&&!t.isDone()&&(e=!0,t.abort())})),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((e=>!e||e.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(t===-1||!qd.test(n[e-1]))?e-1:e,a=n[s];for(;s>0&&s<n.length&&!lm.test(a);)s+=t,a=n[s];return t===-1&&lm.test(a)&&s++,s}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.searchWordBoundary(e,-1),s=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.findLineBoundaryLeft(e),s=this.findLineBoundaryRight(e);this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;ki(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,a=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==a||s!==n&&a!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===a||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const s=n.slice(0,e),a=this.graphemeSplit(s).length;if(e===t)return{selectionStart:a,selectionEnd:a};const h=n.slice(e,t);return{selectionStart:a,selectionEnd:a+this.graphemeSplit(h).length}}fromGraphemeToStringSelection(e,t,n){const s=n.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,a=n.charIndex,h=this.getValueOfPropertyAt(s,a,"fontSize")*this.lineHeight,p=t.leftOffset,v=this.getCanvasRetinaScaling(),_=this.canvas.upperCanvasEl,b=_.width/v,E=_.height/v,N=b-h,O=E-h,Q=new Ce(t.left+p,t.top+t.topOffset+h).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Ce(_.clientWidth/b,_.clientHeight/E));return Q.x<0&&(Q.x=0),Q.x>N&&(Q.x=N),Q.y<0&&(Q.y=0),Q.y>O&&(Q.y=O),Q.x+=this.canvas._offset.left,Q.y+=this.canvas._offset.top,{left:"".concat(Q.x,"px"),top:"".concat(Q.y,"px"),fontSize:"".concat(h,"px"),charHeight:h}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(zc),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:a,charIndex:h}=this.get2DCursorLocation(t,!0);if(n!==a){if(this.styles[n])for(let p=s;p<this._unwrappedTextLines[n].length;p++)delete this.styles[n][p];if(this.styles[a])for(let p=h;p<this._unwrappedTextLines[a].length;p++){const v=this.styles[a][p];v&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+p-h]=v)}for(let p=n+1;p<=a;p++)delete this.styles[p];this.shiftLineStyles(a,n-a)}else if(this.styles[n]){const p=this.styles[n],v=h-s;for(let _=s;_<h;_++)delete p[_];for(const _ in this.styles[n]){const b=parseInt(_,10);b>=h&&(p[b-v]=p[_],delete p[_])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const s in this.styles){const a=parseInt(s,10);a>e&&(this.styles[a+t]=n[a],n[a-t]||delete this.styles[a])}}insertNewlineStyleObject(e,t,n,s){const a={},h=this._unwrappedTextLines[e].length,p=h===t;let v=!1;n||(n=1),this.shiftLineStyles(e,n);const _=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const E in this.styles[e]){const N=parseInt(E,10);N>=t&&(v=!0,a[N-t]=this.styles[e][E],p&&t===0||delete this.styles[e][E])}let b=!1;for(v&&!p&&(this.styles[e+n]=a,b=!0),(b||h>t)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:ge({},s[n-1])}:_?this.styles[e+n]={0:ge({},_)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,s){this.styles||(this.styles={});const a=this.styles[e],h=a?ge({},a):{};n||(n=1);for(const v in h){const _=parseInt(v,10);_>=t&&(a[_+n]=h[_],h[_-n]||delete a[_])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=ge({},s[n]));return}if(!a)return;const p=a[t?t-1:1];for(;p&&n--;)this.styles[e][t+n]=ge({},p)}insertNewStyleBlock(e,t,n){const s=this.get2DCursorLocation(t,!0),a=[0];let h,p=0;for(let v=0;v<e.length;v++)e[v]===`
`?(p++,a[p]=0):a[p]++;for(a[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,a[0],n),n=n&&n.slice(a[0]+1)),p&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+a[0],p),h=1;h<p;h++)a[h]>0?this.insertCharStyleObject(s.lineIndex+h,0,a[h],n):n&&this.styles[s.lineIndex+h]&&n[0]&&(this.styles[s.lineIndex+h][0]=n[0]),n=n&&n.slice(a[h]+1);a[h]>0&&this.insertCharStyleObject(s.lineIndex+h,0,a[h],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const a=this.graphemeSplit(e);this.insertNewStyleBlock(a,n,t),this._text=[...this._text.slice(0,n),...a,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=nn:this._selectionDirection===Mn&&(this._selectionDirection=nn,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===Mn?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=Mn:this._selectionDirection===nn&&(this._selectionDirection=Mn,this.selectionStart=t),this.selectionEnd=n)}}class pb extends db{initHiddenTextarea(){const e=this.canvas&&ki(this.canvas.getElement())||Ua(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map((h=>{let[p,v]=h;return t.setAttribute(p,v)}));const{top:n,left:s,fontSize:a}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(a,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((h=>{let[p,v]=h;return t.addEventListener(p,this[v].bind(this))})),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:n,selectionStart:s,selectionEnd:a}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const h=()=>{this.updateFromTextArea(),this.fire(Bc),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void h();const p=this._splitTextIntoLines(n).graphemeText,v=this._text.length,_=p.length,b=this.selectionStart,E=this.selectionEnd,N=b!==E;let O,Q,W,ee,K=_-v;const ae=this.fromStringToGraphemeSelection(s,a,n),le=b>ae.selectionStart;N?(Q=this._text.slice(b,E),K+=E-b):_<v&&(Q=le?this._text.slice(E+K,E):this._text.slice(b,b-K));const ve=p.slice(ae.selectionEnd-K,ae.selectionEnd);if(Q&&Q.length&&(ve.length&&(O=this.getSelectionStyles(b,b+1,!1),O=ve.map((()=>O[0]))),N?(W=b,ee=E):le?(W=E-Q.length,ee=E):(W=E,ee=E+Q.length),this.removeStyleFromTo(W,ee)),ve.length){const{copyPasteData:we}=Ii();t&&ve.join("")===we.copiedText&&!Yt.disableStyleCopyPaste&&(O=we.copiedTextStyle),this.insertNewStyleBlock(ve,b,O)}h()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:s}=t;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Ii();e.copiedText=this.getSelectedText(),Yt.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,s=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],s+=n.left+n.width),s}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),a=s.lineIndex;if(a===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const h=s.charIndex,p=this._getWidthBeforeCursor(a,h),v=this._getIndexOnLine(a+1,p);return this._textLines[a].slice(h).length+v+1+this.missingNewlineOffset(a)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),a=s.lineIndex;if(a===0||e.metaKey||e.keyCode===33)return-n;const h=s.charIndex,p=this._getWidthBeforeCursor(a,h),v=this._getIndexOnLine(a-1,p),_=this._textLines[a].slice(0,h),b=this.missingNewlineOffset(a-1);return-this._textLines[a-1].length+v-_.length+(1-b)}_getIndexOnLine(e,t){const n=this._textLines[e];let s,a,h=this._getLineLeftOffset(e),p=0;for(let v=0,_=n.length;v<_;v++)if(s=this.__charBounds[e][v].width,h+=s,h>t){a=!0;const b=h-s,E=h,N=Math.abs(b-t);p=Math.abs(E-t)<N?v:v-1;break}return a||(p=n.length-1),p}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Mn);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=za(0,this.selectionStart,s),this.selectionEnd=za(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===nn?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=nn,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Mn&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=nn,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===nn&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Mn,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Mn,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const um=l=>!!l.button;class gb extends pb{constructor(){super(...arguments),de(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new fb(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:n}=e;this.canvas&&this.editable&&!um(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:n}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const a=this.canvas._activeObject;if(a&&a!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||um(t)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(jr(this.calcTransformMatrix())).add(new Ce(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,a=0;for(let _=0;_<this._textLines.length&&n<=t.y;_++)n+=this.getHeightOfLine(_),a=_,_>0&&(s+=this._textLines[_-1].length+this.missingNewlineOffset(_-1));let h=Math.abs(this._getLineLeftOffset(a));const p=this._textLines[a].length,v=this.__charBounds[a];for(let _=0;_<p;_++){const b=h+v[_].kernedWidth;if(t.x<=b){Math.abs(t.x-b)<=Math.abs(t.x-h)&&s++;break}h=b,s++}return Math.min(this.flipX?p-s:s,this._text.length)}}const yc="moveCursorUp",_c="moveCursorDown",xc="moveCursorLeft",wc="moveCursorRight",bc="exitEditing",cm=(l,e)=>{const t=e.getRetinaScaling();l.setTransform(t,0,0,t,0,0);const n=e.viewportTransform;l.transform(n[0],n[1],n[2],n[3],n[4],n[5])},mb=ge({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:bc,27:bc,33:yc,34:_c,35:wc,36:xc,37:xc,38:yc,39:wc,40:_c},keysMapRtl:{9:bc,27:bc,33:yc,34:_c,35:xc,36:wc,37:wc,38:yc,39:xc,40:_c},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class ts extends gb{static getDefaults(){return ge(ge({},super.getDefaults()),ts.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,ge(ge({},ts.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof $l&&this.canvas.textEditingManager.remove(this),t instanceof $l&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),s=n.length>0;let a,h=e;if(s){a=Dr(e.canvas),h=a.getContext("2d"),cm(h,this.canvas);const p=this.calcTransformMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(h,t):this.renderCursor(h,t),s)for(const p of n){const v=p.clipPath,_=Dr(e.canvas),b=_.getContext("2d");if(cm(b,this.canvas),!v.absolutePositioned){const E=p.calcTransformMatrix();b.transform(E[0],E[1],E[2],E[3],E[4],E[5])}v.transform(b),v.drawObject(b,!0,{}),this.drawClipPathOnCache(h,v,_)}s&&(e.setTransform(1,0,0,1,0,0),e.drawImage(a,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),a=this._getCursorBoundariesOffsets(e,t);return{left:n,top:s,leftOffset:a.left,topOffset:a.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:s,lineIndex:a}=this.get2DCursorLocation(e);for(let _=0;_<a;_++)t+=this.getHeightOfLine(_);const h=this._getLineLeftOffset(a),p=this.__charBounds[a][s];p&&(n=p.left),this.charSpacing!==0&&s===this._textLines[a].length&&(n-=this._getWidthOfCharSpacing());const v={top:t,left:h+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Mn||this.textAlign===Qi||this.textAlign===Hl?v.left*=-1:this.textAlign===nn||this.textAlign===Hc?v.left=h-(n>0?n:0):this.textAlign!==Rt&&this.textAlign!==Xl||(v.left=h-(n>0?n:0))),v}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,a=n.charIndex>0?n.charIndex-1:0,h=this.getValueOfPropertyAt(s,a,"fontSize"),p=this.getObjectScaling().x*this.canvas.getZoom(),v=this.cursorWidth/p,_=this.getValueOfPropertyAt(s,a,"deltaY"),b=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-h*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,a,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-v/2,top:b+t.top+_,width:v,height:h}}_renderCursor(e,t,n){const{color:s,opacity:a,left:h,top:p,width:v,height:_}=this.getCursorRenderingData(n,t);e.fillStyle=s,e.globalAlpha=a,e.fillRect(h,p,v,_)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const s=t.selectionStart,a=t.selectionEnd,h=this.textAlign.includes(Qi),p=this.get2DCursorLocation(s),v=this.get2DCursorLocation(a),_=p.lineIndex,b=v.lineIndex,E=p.charIndex<0?0:p.charIndex,N=v.charIndex<0?0:v.charIndex;for(let O=_;O<=b;O++){const Q=this._getLineLeftOffset(O)||0;let W=this.getHeightOfLine(O),ee=0,K=0,ae=0;if(O===_&&(K=this.__charBounds[_][E].left),O>=_&&O<b)ae=h&&!this.isEndOfWrapping(O)?this.width:this.getLineWidth(O)||5;else if(O===b)if(N===0)ae=this.__charBounds[b][N].left;else{const ze=this._getWidthOfCharSpacing();ae=this.__charBounds[b][N-1].left+this.__charBounds[b][N-1].width-ze}ee=W,(this.lineHeight<1||O===b&&this.lineHeight>1)&&(W/=this.lineHeight);let le=n.left+Q+K,ve=W,we=0;const F=ae-K;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",ve=1,we=W):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Mn||this.textAlign===Qi||this.textAlign===Hl?le=this.width-le-F:this.textAlign===nn||this.textAlign===Hc?le=n.left+Q-ae:this.textAlign!==Rt&&this.textAlign!==Xl||(le=n.left+Q-ae)),e.fillRect(le,n.top+n.topOffset+we,F,ve),n.topOffset+=ee}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Rn)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}de(ts,"ownDefaults",mb),de(ts,"type","IText"),ct.setClass(ts),ct.setClass(ts,"i-text");class ns extends ts{static getDefaults(){return ge(ge({},super.getDefaults()),ns.ownDefaults)}constructor(e,t){super(e,ge(ge({},ns.ownDefaults),t))}static createControls(){return{controls:Xv()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Qi)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,s=0;const a={};for(let h=0;h<e.graphemeLines.length;h++)e.graphemeText[s]===`
`&&h>0?(n=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&h>0&&(n++,s++),a[h]={line:t,offset:n},s+=e.graphemeLines[h].length,n+=e.graphemeLines[h].length;return a}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,s=e+1,a=!1;const h=this._styleMap[e],p=this._styleMap[e+1];h&&(e=h.line,n=h.offset),p&&(s=p.line,a=s===e,t=p.offset);const v=e===void 0?this.styles:{line:this.styles[e]};for(const _ in v)for(const b in v[_]){const E=parseInt(b,10);if(E>=n&&(!a||E<t))for(const N in v[_][b])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let a=0;a<n.wordsData.length;a++)s.push(...this._wrapLine(a,t,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let s=0;return{wordsData:e.map(((a,h)=>{let p=0;const v=t?this.graphemeSplit(a):this.wordSplit(a);return v.length===0?[{word:[],width:0}]:v.map((_=>{const b=t?[_]:this.graphemeSplit(_),E=this._measureWord(b,h,p);return s=Math.max(E,s),p+=b.length+n.length,{word:b,width:E}}))})),largestWordWidth:s}}_measureWord(e,t){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=0;for(let h=0,p=e.length;h<p;h++)a+=this._getGraphemeBox(e[h],t,h+s,n,!0).kernedWidth,n=e[h];return a}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:s,wordsData:a}=n,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const p=this._getWidthOfCharSpacing(),v=this.splitByGrapheme,_=[],b=v?"":" ";let E=0,N=[],O=0,Q=0,W=!0;t-=h;const ee=Math.max(t,s,this.dynamicMinWidth),K=a[e];let ae;for(O=0,ae=0;ae<K.length;ae++){const{word:le,width:ve}=K[ae];O+=le.length,E+=Q+ve-p,E>ee&&!W?(_.push(N),N=[],E=ve,W=!0):E+=p,W||v||N.push(b),N=N.concat(le),Q=v?0:this._measureWord([b],e,O),O++,W=!1}return ae&&_.push(N),s+h>this.dynamicMinWidth&&(this.dynamicMinWidth=s-p+h),_}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),s=new Array(n.length);for(let a=0;a<n.length;a++)s[a]=n[a].join("");return t.lines=s,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}de(ns,"type","Textbox"),de(ns,"textLayoutProperties",[...ts.textLayoutProperties,"width"]),de(ns,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ct.setClass(ns);class Md extends uu{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:s,group:a}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:h,height:p}=rs(ny(n,s)),v=new Ce(h,p);if(s.absolutePositioned)return{center:ws(s.getRelativeCenterPoint(),void 0,a?a.calcTransformMatrix():void 0),size:v};{const _=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:b=new Ce,correction:E=new Ce}=this.calcBoundingBox(t,e)||{};return{center:b.add(_),correction:E.subtract(_),size:v}}return{center:n.getRelativeCenterPoint().add(_),size:v}}}}de(Md,"type","clip-path"),ct.setClass(Md);class Id extends uu{getInitialSize(e,t){let{target:n}=e,{size:s}=t;return new Ce(n.width||s.x,n.height||s.y)}}de(Id,"type","fixed"),ct.setClass(Id);class vb extends Ro{subscribeTargets(e){const t=e.target;e.targets.reduce(((n,s)=>(s.parent&&n.add(s.parent),n)),new Set).forEach((n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})}))}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce(((s,a)=>(a.parent&&s.add(a.parent),s)),new Set).forEach((s=>{!n.some((a=>a.parent===s))&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})}))}}class Pi extends ur{static getDefaults(){return ge(ge({},super.getDefaults()),Pi.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Pi.ownDefaults),this.setOptions(t);const{left:n,top:s,layoutManager:a}=t;this.groupInit(e,{left:n,top:s,layoutManager:a??new vb})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach((s=>{const a=this._objects.findIndex((p=>p.isInFrontOf(s))),h=a===-1?this.size():a;this.insertAt(h,s)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(Ss("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach((s=>{const{parent:a}=s;a&&n.add(a)})),e===mp?n.forEach((s=>{s._onAfterObjectsChange(qc,t)})):n.forEach((s=>{s._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=ge(ge({hasControls:!1},n),{},{forActiveSelection:!0});for(let a=0;a<this._objects.length;a++)this._objects[a]._renderControls(e,s);super._renderControls(e,t),e.restore()}}de(Pi,"type","ActiveSelection"),de(Pi,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ct.setClass(Pi),ct.setClass(Pi,"activeSelection");class Py{constructor(){de(this,"resources",{})}applyFilters(e,t,n,s,a){const h=a.getContext("2d");if(!h)return;h.drawImage(t,0,0,n,s);const p={sourceWidth:n,sourceHeight:s,imageData:h.getImageData(0,0,n,s),originalEl:t,originalImageData:h.getImageData(0,0,n,s),canvasEl:a,ctx:h,filterBackend:this};e.forEach((_=>{_.applyTo(p)}));const{imageData:v}=p;return v.width===n&&v.height===s||(a.width=v.width,a.height=v.height),h.putImageData(v,0,0),p}}class eu{constructor(){let{tileSize:e=Yt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};de(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),de(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=Dr({width:e,height:t}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,t,n,s,a,h){const p=this.gl,v=a.getContext("2d");if(!p||!v)return;let _;h&&(_=this.getCachedTexture(h,t));const b={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:p,sourceTexture:this.createTexture(p,n,s,_?void 0:t),targetTexture:this.createTexture(p,n,s),originalTexture:_||this.createTexture(p,n,s,_?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},E=p.createFramebuffer();return p.bindFramebuffer(p.FRAMEBUFFER,E),e.forEach((N=>{N&&N.applyTo(b)})),(function(N){const O=N.targetCanvas,Q=O.width,W=O.height,ee=N.destinationWidth,K=N.destinationHeight;Q===ee&&W===K||(O.width=ee,O.height=K)})(b),this.copyGLTo2D(p,b),p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(b.sourceTexture),p.deleteTexture(b.targetTexture),p.deleteFramebuffer(E),v.setTransform(1,0,0,1,0,0),b}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,s,a){const{NEAREST:h,TEXTURE_2D:p,RGBA:v,UNSIGNED_BYTE:_,CLAMP_TO_EDGE:b,TEXTURE_MAG_FILTER:E,TEXTURE_MIN_FILTER:N,TEXTURE_WRAP_S:O,TEXTURE_WRAP_T:Q}=e,W=e.createTexture();return e.bindTexture(p,W),e.texParameteri(p,E,a||h),e.texParameteri(p,N,a||h),e.texParameteri(p,O,b),e.texParameteri(p,Q,b),s?e.texImage2D(p,0,v,v,_,s):e.texImage2D(p,0,v,t,n,0,v,_,null),W}getCachedTexture(e,t,n){const{textureCache:s}=this;if(s[e])return s[e];{const a=this.createTexture(this.gl,t.width,t.height,t,n);return a&&(s[e]=a),a}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,s=t.targetCanvas,a=s.getContext("2d");if(!a)return;a.translate(0,s.height),a.scale(1,-1);const h=n.height-s.height;a.drawImage(n,0,h,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),s=t.destinationWidth,a=t.destinationHeight,h=s*a*4;if(!n)return;const p=new Uint8Array(this.imageBuffer,0,h),v=new Uint8ClampedArray(this.imageBuffer,0,h);e.readPixels(0,0,s,a,e.RGBA,e.UNSIGNED_BYTE,p);const _=new ImageData(v,s,a);n.putImageData(_,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),a=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),a&&(t.vendor=a.toLowerCase())}return this.gpuInfo=t,t}}let Ic;function Ay(){const{WebGLProbe:l}=Ii();return l.queryWebGL(ui()),Yt.enableGLFiltering&&l.isSupported(Yt.textureSize)?new eu({tileSize:Yt.textureSize}):new Py}function jc(){return!Ic&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Ic=Ay()),Ic}function yb(l){Ic=l}const _b=["filters","resizeFilter","src","crossOrigin","type"],My=["cropX","cropY"];class mr extends Zn{static getDefaults(){return ge(ge({},super.getDefaults()),mr.ownDefaults)}constructor(e,t){super(),de(this,"_lastScaleX",1),de(this,"_lastScaleY",1),de(this,"_filterScalingX",1),de(this,"_filterScalingY",1),this.filters=[],Object.assign(this,mr.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(ra()),this.setElement(typeof e=="string"?(this.canvas&&ki(this.canvas.getElement())||Ua()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),(t=e.classList)===null||t===void 0||t.add(mr.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=jc(!1);t instanceof eu&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((e=>{const t=this[e];t&&Ii().dispose(t),this[e]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach((n=>{n&&t.push(n.toObject())})),ge(ge({},super.toObject([...My,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,s=-this.height/2;let a=[],h=[],p="",v="";if(!t)return[];if(this.hasCrop()){const _=ra();a.push('<clipPath id="imageCrop_'+_+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),p=' clip-path="url(#imageCrop_'+_+')" '}if(this.imageSmoothing||(v=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(v).concat(p,`></image>
`)),this.stroke||this.strokeDashArray){const _=this.fill;this.fill=null,h=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=_}return a=this.paintFirst!==Rn?a.concat(h,e):a.concat(e,h),a}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ul(e,{crossOrigin:t,signal:n}).then((s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,a=n.y,h=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&a>t)return this._element=h,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=a);const p=Dr(h),{width:v,height:_}=h;this._element=p,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=a,jc().applyFilters([e],h,v,_,this._element),this._filterScalingX=p.width/this._originalElement.width,this._filterScalingY=p.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter((a=>a&&!a.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const a=Dr({width:n,height:s});this._element=a,this._filteredEl=a}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);jc().applyFilters(e,this._originalElement,n,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,s=this._filterScalingY,a=this.width,h=this.height,p=Math.max(this.cropX,0),v=Math.max(this.cropY,0),_=t.naturalWidth||t.width,b=t.naturalHeight||t.height,E=p*n,N=v*s,O=Math.min(a*n,_-E),Q=Math.min(h*s,b-N),W=-a/2,ee=-h/2,K=Math.min(a,_/n-p),ae=Math.min(h,b/s-v);t&&e.drawImage(t,E,N,O,Q,W,ee,K,ae)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=op(this.preserveAspectRatio||""),t=this.width,n=this.height,s={width:t,height:n};let a,h=this._element.width,p=this._element.height,v=1,_=1,b=0,E=0,N=0,O=0;return!e||e.alignX===_r&&e.alignY===_r?(v=t/h,_=n/p):(e.meetOrSlice==="meet"&&(v=_=iy(this._element,s),a=(t-h*v)/2,e.alignX==="Min"&&(b=-a),e.alignX==="Max"&&(b=a),a=(n-p*_)/2,e.alignY==="Min"&&(E=-a),e.alignY==="Max"&&(E=a)),e.meetOrSlice==="slice"&&(v=_=sy(this._element,s),a=h-t/v,e.alignX==="Mid"&&(N=a/2),e.alignX==="Max"&&(N=a),a=p-n/_,e.alignY==="Mid"&&(O=a/2),e.alignY==="Max"&&(O=a),h=t/v,p=n/_)),{width:h,height:p,scaleX:v,scaleY:_,offsetLeft:b,offsetTop:E,cropX:N,cropY:O}}static fromObject(e,t){let{filters:n,resizeFilter:s,src:a,crossOrigin:h,type:p}=e,v=dn(e,_b);return Promise.all([Ul(a,ge(ge({},t),{},{crossOrigin:h})),n&&Io(n,t),s&&Io([s],t),ou(v,t)]).then((_=>{let[b,E=[],[N]=[],O={}]=_;return new this(b,ge(ge({},v),{},{src:a,filters:E,resizeFilter:N},O))}))}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return Ul(e,{crossOrigin:t,signal:n}).then((a=>new this(a,s)))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=as(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"]||s.href,t,s).catch((a=>(Ss("log","Unable to parse Image",a),null)))}}function cd(l){if(!Xx.test(l.nodeName))return{};const e=l.getAttribute("viewBox");let t,n,s=1,a=1,h=0,p=0;const v=l.getAttribute("width"),_=l.getAttribute("height"),b=l.getAttribute("x")||0,E=l.getAttribute("y")||0,N=!(e&&X0.test(e)),O=!v||!_||v==="100%"||_==="100%";let Q="",W=0,ee=0;if(N&&(b||E)&&l.parentNode&&l.parentNode.nodeName!=="#document"&&(Q=" translate("+gr(b||"0")+" "+gr(E||"0")+") ",t=(l.getAttribute("transform")||"")+Q,l.setAttribute("transform",t),l.removeAttribute("x"),l.removeAttribute("y")),N&&O)return{width:0,height:0};const K={width:0,height:0};if(N)return K.width=gr(v),K.height=gr(_),K;const ae=e.match(X0);h=-parseFloat(ae[1]),p=-parseFloat(ae[2]);const le=parseFloat(ae[3]),ve=parseFloat(ae[4]);K.minX=h,K.minY=p,K.viewBoxWidth=le,K.viewBoxHeight=ve,O?(K.width=le,K.height=ve):(K.width=gr(v),K.height=gr(_),s=K.width/le,a=K.height/ve);const we=op(l.getAttribute("preserveAspectRatio")||"");if(we.alignX!==_r&&(we.meetOrSlice==="meet"&&(a=s=s>a?a:s),we.meetOrSlice==="slice"&&(a=s=s>a?s:a),W=K.width-le*s,ee=K.height-ve*s,we.alignX==="Mid"&&(W/=2),we.alignY==="Mid"&&(ee/=2),we.alignX==="Min"&&(W=0),we.alignY==="Min"&&(ee=0)),s===1&&a===1&&h===0&&p===0&&b===0&&E===0)return K;if((b||E)&&l.parentNode.nodeName!=="#document"&&(Q=" translate("+gr(b||"0")+" "+gr(E||"0")+") "),t=Q+" matrix("+s+" 0 0 "+a+" "+(h*s+W)+" "+(p*a+ee)+") ",l.nodeName==="svg"){for(n=l.ownerDocument.createElementNS(xd,"g");l.firstChild;)n.appendChild(l.firstChild);l.appendChild(n)}else n=l,n.removeAttribute("x"),n.removeAttribute("y"),t=n.getAttribute("transform")+t;return n.setAttribute("transform",t),K}de(mr,"type","Image"),de(mr,"cacheProperties",[...Ts,...My]),de(mr,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),de(mr,"CSS_CANVAS","canvas-img"),de(mr,"ATTRIBUTE_NAMES",[...aa,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),ct.setClass(mr),ct.setSVGClass(mr);const $c=l=>l.tagName.replace("svg:",""),xb=uh(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function Iy(l,e){let t,n,s,a,h=[];for(s=0,a=e.length;s<a;s++)t=e[s],n=l.getElementsByTagNameNS("http://www.w3.org/2000/svg",t),h=h.concat(Array.from(n));return h}const wb=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],hd="xlink:href";function jy(l,e){var t;const n=((t=e.getAttribute(hd))===null||t===void 0?void 0:t.slice(1))||"",s=l.getElementById(n);if(s&&s.getAttribute(hd)&&jy(l,s),s&&(wb.forEach((a=>{const h=s.getAttribute(a);!e.hasAttribute(a)&&h&&e.setAttribute(a,h)})),!e.children.length)){const a=s.cloneNode(!0);for(;a.firstChild;)e.appendChild(a.firstChild)}e.removeAttribute(hd)}const bb=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"];function Ly(l){const e=l.getElementsByTagName("style"),t={};for(let n=0;n<e.length;n++){const s=(e[n].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");s.trim()!==""&&s.split("}").filter(((a,h,p)=>p.length>1&&a.trim())).forEach((a=>{if((a.match(/{/g)||[]).length>1&&a.trim().startsWith("@"))return;const h=a.split("{"),p={},v=h[1].trim().split(";").filter((function(_){return _.trim()}));for(let _=0;_<v.length;_++){const b=v[_].split(":"),E=b[0].trim(),N=b[1].trim();p[E]=N}(a=h[0].trim()).split(",").forEach((_=>{(_=_.replace(/^svg/i,"").trim())!==""&&(t[_]=ge(ge({},t[_]||{}),p))}))}))}return t}const hm=l=>ct.getSVGClass($c(l).toLowerCase());class Sb{constructor(e,t,n,s,a){this.elements=e,this.options=t,this.reviver=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s,this.clipPaths=a,this.gradientDefs=(function(h){const p=Iy(h,bb),v={};let _=p.length;for(;_--;){const b=p[_];b.getAttribute("xlink:href")&&jy(h,b);const E=b.getAttribute("id");E&&(v[E]=b)}return v})(s),this.cssRules=Ly(s)}parse(){return Promise.all(this.elements.map((e=>this.createObject(e))))}async createObject(e){const t=hm(e);if(t){const n=await t.fromElement(e,this.options,this.cssRules);return this.resolveGradient(n,e,Rn),this.resolveGradient(n,e,xr),n instanceof mr&&n._originalElement?Mc(n,n.parsePreserveAspectRatioAttribute()):Mc(n),await this.resolveClipPath(n,e),this.reviver&&this.reviver(e,n),n}return null}extractPropertyDefinition(e,t,n){const s=e[t],a=this.regexUrl;if(!a.test(s))return;a.lastIndex=0;const h=a.exec(s)[1];return a.lastIndex=0,n[h]}resolveGradient(e,t,n){const s=this.extractPropertyDefinition(e,n,this.gradientDefs);if(s){const a=t.getAttribute(n+"-opacity"),h=Oi.fromElement(s,e,ge(ge({},this.options),{},{opacity:a}));e.set(n,h)}}async resolveClipPath(e,t,n){const s=this.extractPropertyDefinition(e,"clipPath",this.clipPaths);if(s){const a=jr(e.calcTransformMatrix()),h=s[0].parentElement;let p=t;for(;!n&&p.parentElement&&p.getAttribute("clip-path")!==e.clipPath;)p=p.parentElement;p.parentElement.appendChild(h);const v=Jl("".concat(p.getAttribute("transform")||""," ").concat(h.getAttribute("originalTransform")||""));h.setAttribute("transform","matrix(".concat(v.join(","),")"));const _=await Promise.all(s.map((ae=>hm(ae).fromElement(ae,this.options,this.cssRules).then((le=>(Mc(le),le.fillRule=le.clipRule,delete le.clipRule,le)))))),b=_.length===1?_[0]:new ur(_),E=wn(a,b.calcTransformMatrix());b.clipPath&&await this.resolveClipPath(b,p,h.getAttribute("clip-path")?p:void 0);const{scaleX:N,scaleY:O,angle:Q,skewX:W,translateX:ee,translateY:K}=Na(E);b.set({flipX:!1,flipY:!1}),b.set({scaleX:N,scaleY:O,angle:Q,skewX:W,skewY:0}),b.setPositionByOrigin(new Ce(ee,K),Rt,Rt),e.clipPath=b}else delete e.clipPath}}const fm=l=>Hx.test($c(l)),jd=()=>({objects:[],elements:[],options:{},allElements:[]});async function _p(l,e){let{crossOrigin:t,signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n&&n.aborted)return Ss("log",new Xd("parseSVGDocument")),jd();const s=l.documentElement;(function(b){const E=Iy(b,["use","svg:use"]),N=["x","y","xlink:href","href","transform"];for(const O of E){const Q=O.attributes,W={};for(const Je of Q)Je.value&&(W[Je.name]=Je.value);const ee=(W["xlink:href"]||W.href||"").slice(1);if(ee==="")return;const K=b.getElementById(ee);if(K===null)return;let ae=K.cloneNode(!0);const le=ae.attributes,ve={};for(const Je of le)Je.value&&(ve[Je.name]=Je.value);const{x:we=0,y:F=0,transform:ze=""}=W,He="".concat(ze," ").concat(ve.transform||""," translate(").concat(we,", ").concat(F,")");if(cd(ae),/^svg$/i.test(ae.nodeName)){const Je=ae.ownerDocument.createElementNS(xd,"g");Object.entries(ve).forEach((ut=>{let[Ie,Ke]=ut;return Je.setAttributeNS(xd,Ie,Ke)})),Je.append(...ae.childNodes),ae=Je}for(const Je of Q){if(!Je)continue;const{name:ut,value:Ie}=Je;if(!N.includes(ut))if(ut==="style"){const Ke={};Td(Ie,Ke),Object.entries(ve).forEach((Ve=>{let[Bt,Le]=Ve;Ke[Bt]=Le})),Td(ve.style||"",Ke);const dt=Object.entries(Ke).map((Ve=>Ve.join(":"))).join(";");ae.setAttribute(ut,dt)}else!ve[ut]&&ae.setAttribute(ut,Ie)}ae.setAttribute("transform",He),ae.setAttribute("instantiated_by_use","1"),ae.removeAttribute("id"),O.parentNode.replaceChild(ae,O)}})(l);const a=Array.from(s.getElementsByTagName("*")),h=ge(ge({},cd(s)),{},{crossOrigin:t,signal:n}),p=a.filter((b=>(cd(b),fm(b)&&!(function(E){let N=E;for(;N&&(N=N.parentElement);)if(N&&N.nodeName&&xb.test($c(N))&&!N.getAttribute("instantiated_by_use"))return!0;return!1})(b))));if(!p||p&&!p.length)return ge(ge({},jd()),{},{options:h,allElements:a});const v={};return a.filter((b=>$c(b)==="clipPath")).forEach((b=>{b.setAttribute("originalTransform",b.getAttribute("transform")||"");const E=b.getAttribute("id");v[E]=Array.from(b.getElementsByTagName("*")).filter((N=>fm(N)))})),{objects:await new Sb(p,h,e,l,v).parse(),elements:p,options:h,allElements:a}}function Lc(l,e,t){return _p(new(Ti()).DOMParser().parseFromString(l.trim(),"text/xml"),e,t)}function Cb(l,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(((n,s)=>{py(l.replace(/^\n\s*/,"").trim(),{onComplete:a=>{const h=a.responseXML;h&&n(h),s()},signal:t.signal})})).then((n=>_p(n,e,t))).catch((()=>jd()))}const Dy=rv,dm=l=>function(e,t,n){const{points:s,pathOffset:a}=n;return new Ce(s[l]).subtract(a).transform(wn(n.getViewportTransform(),n.calcTransformMatrix()))},Ry=(l,e,t,n)=>{const{target:s,pointIndex:a}=e,h=s,p=ws(new Ce(t,n),void 0,h.calcOwnMatrix());return h.points[a]=p.add(h.pathOffset),h.setDimensions(),h.set("dirty",!0),!0},Fy=(l,e)=>function(t,n,s,a){const h=n.target,p=new Ce(h.points[(l>0?l:h.points.length)-1]),v=p.subtract(h.pathOffset).transform(h.calcOwnMatrix()),_=e(t,ge(ge({},n),{},{pointIndex:l}),s,a),b=p.subtract(h.pathOffset).transform(h.calcOwnMatrix()).subtract(v);return h.left-=b.x,h.top-=b.y,_},pm=l=>sa(Dy,Fy(l,Ry)),Ld=(l,e,t)=>{const{path:n,pathOffset:s}=l,a=n[e];return new Ce(a[t]-s.x,a[t+1]-s.y).transform(wn(l.getViewportTransform(),l.calcTransformMatrix()))};function kb(l,e,t){const{commandIndex:n,pointIndex:s}=this;return Ld(t,n,s)}function Tb(l,e,t,n){const{target:s}=e,{commandIndex:a,pointIndex:h}=this,p=((v,_,b,E,N)=>{const{path:O,pathOffset:Q}=v,W=O[(E>0?E:O.length)-1],ee=new Ce(W[N],W[N+1]),K=ee.subtract(Q).transform(v.calcOwnMatrix()),ae=ws(new Ce(_,b),void 0,v.calcOwnMatrix());O[E][N]=ae.x+Q.x,O[E][N+1]=ae.y+Q.y,v.setDimensions();const le=ee.subtract(v.pathOffset).transform(v.calcOwnMatrix()).subtract(K);return v.left-=le.x,v.top-=le.y,v.set("dirty",!0),!0})(s,t,n,a,h);return sp(this.actionName,ge(ge({},ap(l,e,t,n)),{},{commandIndex:a,pointIndex:h})),p}class Ny extends Mr{constructor(e){super(e)}render(e,t,n,s,a){const h=ge(ge({},s),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,h,a)}}class Eb extends Ny{constructor(e){super(e)}render(e,t,n,s,a){const{path:h}=a,{commandIndex:p,pointIndex:v,connectToCommandIndex:_,connectToPointIndex:b}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);const[E]=h[p],N=Ld(a,_,b);if(E==="Q"){const O=Ld(a,p,v+2);e.moveTo(O.x,O.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(N.x,N.y),e.stroke(),e.restore(),super.render(e,t,n,s,a)}}const Sc=(l,e,t,n,s,a)=>new(t?Eb:Ny)(ge(ge({commandIndex:l,pointIndex:e,actionName:"modifyPath",positionHandler:kb,actionHandler:Tb,connectToCommandIndex:s,connectToPointIndex:a},n),t?n.controlPointStyle:n.pointStyle));var Ob=Object.freeze({__proto__:null,changeWidth:Sd,createObjectDefaultControls:dp,createPathControls:function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};let n="M";return l.path.forEach(((s,a)=>{const h=s[0];switch(h!=="Z"&&(t["c_".concat(a,"_").concat(h)]=Sc(a,s.length-2,!1,e)),h){case"C":t["c_".concat(a,"_C_CP_1")]=Sc(a,1,!0,e,a-1,(p=>p==="C"?5:p==="Q"?3:1)(n)),t["c_".concat(a,"_C_CP_2")]=Sc(a,3,!0,e,a,5);break;case"Q":t["c_".concat(a,"_Q_CP_1")]=Sc(a,1,!0,e,a,3)}n=h})),t},createPolyActionHandler:pm,createPolyControls:function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};for(let n=0;n<(typeof l=="number"?l:l.points.length);n++)t["p".concat(n)]=new Mr(ge({actionName:Dy,positionHandler:dm(n),actionHandler:pm(n)},e));return t},createPolyPositionHandler:dm,createResizeControls:Hv,createTextboxDefaultControls:Xv,dragHandler:wv,factoryPolyActionHandler:Fy,getLocalPoint:lh,polyActionHandler:Ry,renderCircleControl:Iv,renderSquareControl:jv,rotationStyleHandler:Lv,rotationWithSnapping:Dv,scaleCursorStyleHandler:Eo,scaleOrSkewActionName:Cl,scaleSkewCursorStyleHandler:La,scalingEqually:Sl,scalingX:Nv,scalingXOrSkewingY:Cd,scalingY:Bv,scalingYOrSkewingX:kd,skewCursorStyleHandler:zv,skewHandlerX:Wv,skewHandlerY:Uv,wrapWithFireEvent:sa,wrapWithFixedAnchor:Ga});const cu=l=>l.webgl!==void 0,Pb=(l,e)=>{const t=Dr({width:l,height:e}),n=ui().getContext("webgl"),s={imageBuffer:new ArrayBuffer(l*e*4)},a={destinationWidth:l,destinationHeight:e,targetCanvas:t};let h;h=Ti().performance.now(),eu.prototype.copyGLTo2D.call(s,n,a);const p=Ti().performance.now()-h;return h=Ti().performance.now(),eu.prototype.copyGLTo2DPutImageData.call(s,n,a),p>Ti().performance.now()-h},xp="precision highp float",Ab=`
    `.concat(xp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),Mb=["type"],Ib=["type"],jb=new RegExp(xp,"g");class Fn{get type(){return this.constructor.type}constructor(){let e=dn(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Mb);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Ab}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=Ii();s!=="highp"&&(t=t.replace(jb,xp.replace("highp",s)));const a=e.createShader(e.VERTEX_SHADER),h=e.createShader(e.FRAGMENT_SHADER),p=e.createProgram();if(!a||!h||!p)throw new $i("Vertex, fragment shader or program creation error");if(e.shaderSource(a,n),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new $i("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.shaderSource(h,t),e.compileShader(h),!e.getShaderParameter(h,e.COMPILE_STATUS))throw new $i("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(h)));if(e.attachShader(p,a),e.attachShader(p,h),e.linkProgram(p),!e.getProgramParameter(p,e.LINK_STATUS))throw new $i('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(p)));const v=this.getUniformLocations(e,p)||{};return v.uStepW=e.getUniformLocation(p,"uStepW"),v.uStepH=e.getUniformLocation(p,"uStepH"),{program:p,attributeLocations:this.getAttributeLocations(e,p),uniformLocations:v}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,s={};for(let a=0;a<n.length;a++)s[n[a]]=e.getUniformLocation(t,n[a]);return s}sendAttributeData(e,t,n){const s=t.aPosition,a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){cu(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,s=Dr({width:t,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return ge({type:this.type},e.reduce(((t,n)=>(t[n]=this[n],t)),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(dn(e,Ib))}}de(Fn,"type","BaseFilter"),de(Fn,"uniformLocations",[]);const Lb={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class kl extends Fn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(Lb[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new $t(this.color).getSource(),s=this.alpha,a=n[0]*s,h=n[1]*s,p=n[2]*s,v=1-s;for(let _=0;_<t.length;_+=4){const b=t[_],E=t[_+1],N=t[_+2];let O,Q,W;switch(this.mode){case"multiply":O=b*a/255,Q=E*h/255,W=N*p/255;break;case"screen":O=255-(255-b)*(255-a)/255,Q=255-(255-E)*(255-h)/255,W=255-(255-N)*(255-p)/255;break;case"add":O=b+a,Q=E+h,W=N+p;break;case"difference":O=Math.abs(b-a),Q=Math.abs(E-h),W=Math.abs(N-p);break;case"subtract":O=b-a,Q=E-h,W=N-p;break;case"darken":O=Math.min(b,a),Q=Math.min(E,h),W=Math.min(N,p);break;case"lighten":O=Math.max(b,a),Q=Math.max(E,h),W=Math.max(N,p);break;case"overlay":O=a<128?2*b*a/255:255-2*(255-b)*(255-a)/255,Q=h<128?2*E*h/255:255-2*(255-E)*(255-h)/255,W=p<128?2*N*p/255:255-2*(255-N)*(255-p)/255;break;case"exclusion":O=a+b-2*a*b/255,Q=h+E-2*h*E/255,W=p+N-2*p*N/255;break;case"tint":O=a+b*v,Q=h+E*v,W=p+N*v}t[_]=O,t[_+1]=Q,t[_+2]=W}}sendUniformData(e,t){const n=new $t(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}de(kl,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),de(kl,"type","BlendColor"),de(kl,"uniformLocations",["uColor"]),ct.setClass(kl);const Db={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},Rb=["type","image"];class Tl extends Fn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Db[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:s},filterBackend:{resources:a}}=e;const h=this.image;a.blendImage||(a.blendImage=ui());const p=a.blendImage,v=p.getContext("2d");p.width!==n||p.height!==s?(p.width=n,p.height=s):v.clearRect(0,0,n,s),v.setTransform(h.scaleX,0,0,h.scaleY,h.left,h.top),v.drawImage(h.getElement(),0,0,n,s);const _=v.getImageData(0,0,n,s).data;for(let b=0;b<t.length;b+=4){const E=t[b],N=t[b+1],O=t[b+2],Q=t[b+3],W=_[b],ee=_[b+1],K=_[b+2],ae=_[b+3];switch(this.mode){case"multiply":t[b]=E*W/255,t[b+1]=N*ee/255,t[b+2]=O*K/255,t[b+3]=Q*ae/255;break;case"mask":t[b+3]=ae}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return ge(ge({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:s}=e,a=dn(e,Rb);return mr.fromObject(s,t).then((h=>new this(ge(ge({},a),{},{image:h}))))}}de(Tl,"type","BlendImage"),de(Tl,"defaults",{mode:"multiply",alpha:1}),de(Tl,"uniformLocations",["uTransformMatrix","uImage"]),ct.setClass(Tl);class El extends Fn{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){cu(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;this.aspectRatio=n/s,this.horizontal=!0;let a=this.getBlurValue()*n;const h=new Uint8ClampedArray(t),p=15,v=4*n;for(let _=0;_<t.length;_+=4){let b=0,E=0,N=0,O=0,Q=0;const W=_-_%v,ee=W+v;for(let K=-14;K<p;K++){const ae=K/p,le=4*Math.floor(a*ae),ve=1-Math.abs(ae);let we=_+le;we<W?we=W:we>ee&&(we=ee);const F=t[we+3]*ve;b+=t[we]*F,E+=t[we+1]*F,N+=t[we+2]*F,O+=F,Q+=ve}h[_]=b/O,h[_+1]=E/O,h[_+2]=N/O,h[_+3]=O/Q}this.horizontal=!1,a=this.getBlurValue()*s;for(let _=0;_<h.length;_+=4){let b=0,E=0,N=0,O=0,Q=0;const W=_%v,ee=h.length-v+W;for(let K=-14;K<p;K++){const ae=K/p,le=Math.floor(a*ae)*v,ve=1-Math.abs(ae);let we=_+le;we<W?we=W:we>ee&&(we=ee);const F=h[we+3]*ve;b+=h[we]*F,E+=h[we+1]*F,N+=h[we+2]*F,O+=F,Q+=ve}t[_]=b/O,t[_+1]=E/O,t[_+2]=N/O,t[_+3]=O/Q}}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:n}=this;return t?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}de(El,"type","Blur"),de(El,"defaults",{blur:0}),de(El,"uniformLocations",["uDelta"]),ct.setClass(El);class Ol extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]+=n,t[s+1]+=n,t[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}de(Ol,"type","Brightness"),de(Ol,"defaults",{brightness:0}),de(Ol,"uniformLocations",["uBrightness"]),ct.setClass(Ol);const By={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Ra extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let a=0;a<t.length;a+=4){const h=t[a],p=t[a+1],v=t[a+2];if(t[a]=h*n[0]+p*n[1]+v*n[2]+255*n[4],t[a+1]=h*n[5]+p*n[6]+v*n[7]+255*n[9],t[a+2]=h*n[10]+p*n[11]+v*n[12]+255*n[14],!s){const _=t[a+3];t[a]+=_*n[3],t[a+1]+=_*n[8],t[a+2]+=_*n[13],t[a+3]=h*n[15]+p*n[16]+v*n[17]+_*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],a=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,a)}toObject(){return ge(ge({},super.toObject()),{},{matrix:[...this.matrix]})}}function Ya(l,e){var t;const n=(de(t=class extends Ra{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",l),de(t,"defaults",{colorsOnly:!1,matrix:e}),t);return ct.setClass(n,l),n}de(Ra,"type","ColorMatrix"),de(Ra,"defaults",By),de(Ra,"uniformLocations",["uColorMatrix","uConstants"]),ct.setClass(Ra);const Fb=Ya("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),Nb=Ya("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),Bb=Ya("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),zb=Ya("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),Vb=Ya("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),Wb=Ya("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),Ub=Ya("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Dd extends Fn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){cu(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach((t=>{t.applyTo(e)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((e=>e.toObject()))}}isNeutralState(){return!this.subFilters.some((e=>!e.isNeutralState()))}static fromObject(e,t){return Promise.all((e.subFilters||[]).map((n=>ct.getClass(n.type).fromObject(n,t)))).then((n=>new this({subFilters:n})))}}de(Dd,"type","Composed"),ct.setClass(Dd);class Pl extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let a=0;a<t.length;a+=4)t[a]=s*(t[a]-128)+128,t[a+1]=s*(t[a+1]-128)+128,t[a+2]=s*(t[a+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}de(Pl,"type","Contrast"),de(Pl,"defaults",{contrast:0}),de(Pl,"uniformLocations",["uContrast"]),ct.setClass(Pl);const Hb={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Al extends Fn{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return Hb[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,s=this.matrix,a=Math.round(Math.sqrt(s.length)),h=Math.floor(a/2),p=t.width,v=t.height,_=e.ctx.createImageData(p,v),b=_.data,E=this.opaque?1:0;let N,O,Q,W,ee,K,ae,le,ve,we,F,ze,He;for(F=0;F<v;F++)for(we=0;we<p;we++){for(ee=4*(F*p+we),N=0,O=0,Q=0,W=0,He=0;He<a;He++)for(ze=0;ze<a;ze++)ae=F+He-h,K=we+ze-h,ae<0||ae>=v||K<0||K>=p||(le=4*(ae*p+K),ve=s[He*a+ze],N+=n[le]*ve,O+=n[le+1]*ve,Q+=n[le+2]*ve,E||(W+=n[le+3]*ve));b[ee]=N,b[ee+1]=O,b[ee+2]=Q,b[ee+3]=E?n[ee+3]:W}e.imageData=_}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return ge(ge({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}de(Al,"type","Convolute"),de(Al,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),de(Al,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ct.setClass(Al);const zy="Gamma";class Ml extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,s=1/n[0],a=1/n[1],h=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const p=this.rgbValues;for(let v=0;v<256;v++)p.r[v]=255*Math.pow(v/255,s),p.g[v]=255*Math.pow(v/255,a),p.b[v]=255*Math.pow(v/255,h);for(let v=0;v<t.length;v+=4)t[v]=p.r[t[v]],t[v+1]=p.g[t[v+1]],t[v+2]=p.b[t[v+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:zy,gamma:this.gamma.concat()}}}de(Ml,"type",zy),de(Ml,"defaults",{gamma:[1,1,1]}),de(Ml,"uniformLocations",["uGamma"]),ct.setClass(Ml);const Xb={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Il extends Fn{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,s=0;s<t.length;s+=4){const a=t[s],h=t[s+1],p=t[s+2];switch(this.mode){case"average":n=(a+h+p)/3;break;case"lightness":n=(Math.min(a,h,p)+Math.max(a,h,p))/2;break;case"luminosity":n=.21*a+.72*h+.07*p}t[s+2]=t[s+1]=t[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Xb[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}de(Il,"type","Grayscale"),de(Il,"defaults",{mode:"average"}),de(Il,"uniformLocations",["uMode"]),ct.setClass(Il);const Gb=ge(ge({},By),{},{rotation:0});class Dc extends Ra{calculateMatrix(){const e=this.rotation*Math.PI,t=ji(e),n=Li(e),s=1/3,a=Math.sqrt(s)*n,h=1-t;this.matrix=[t+h/3,s*h-a,s*h+a,0,0,s*h+a,t+s*h,s*h-a,0,0,s*h-a,s*h+a,t+s*h,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}de(Dc,"type","HueRotation"),de(Dc,"defaults",Gb),ct.setClass(Dc);class jl extends Fn{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}de(jl,"type","Invert"),de(jl,"defaults",{alpha:!1,invert:!0}),de(jl,"uniformLocations",["uInvert","uAlpha"]),ct.setClass(jl);class Ll extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let s=0;s<t.length;s+=4){const a=(.5-Math.random())*n;t[s]+=a,t[s+1]+=a,t[s+2]+=a}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}de(Ll,"type","Noise"),de(Ll,"defaults",{noise:0}),de(Ll,"uniformLocations",["uNoise","uSeed"]),ct.setClass(Ll);class Dl extends Fn{applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;for(let a=0;a<s;a+=this.blocksize)for(let h=0;h<n;h+=this.blocksize){const p=4*a*n+4*h,v=t[p],_=t[p+1],b=t[p+2],E=t[p+3];for(let N=a;N<Math.min(a+this.blocksize,s);N++)for(let O=h;O<Math.min(h+this.blocksize,n);O++){const Q=4*N*n+4*O;t[Q]=v,t[Q+1]=_,t[Q+2]=b,t[Q+3]=E}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}de(Dl,"type","Pixelate"),de(Dl,"defaults",{blocksize:4}),de(Dl,"uniformLocations",["uBlocksize"]),ct.setClass(Dl);class Rl extends Fn{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,s=new $t(this.color).getSource(),a=[s[0]-n,s[1]-n,s[2]-n],h=[s[0]+n,s[1]+n,s[2]+n];for(let p=0;p<t.length;p+=4){const v=t[p],_=t[p+1],b=t[p+2];v>a[0]&&_>a[1]&&b>a[2]&&v<h[0]&&_<h[1]&&b<h[2]&&(t[p+3]=0)}}sendUniformData(e,t){const n=new $t(this.color).getSource(),s=this.distance,a=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],h=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(t.uLow,a),e.uniform4fv(t.uHigh,h)}}de(Rl,"type","RemoveColor"),de(Rl,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),de(Rl,"uniformLocations",["uLow","uHigh"]),ct.setClass(Rl);class Fl extends Fn{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let a=1;a<=n;a++)s[a-1]=e(a*t);return s}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map(((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){cu(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const a=t.width,h=t.height,p=Math.round(a*n),v=Math.round(h*s);let _;_=this.resizeType==="sliceHack"?this.sliceByTwo(e,a,h,p,v):this.resizeType==="hermite"?this.hermiteFastResize(e,a,h,p,v):this.resizeType==="bilinear"?this.bilinearFiltering(e,a,h,p,v):this.resizeType==="lanczos"?this.lanczosResize(e,a,h,p,v):new ImageData(p,v),e.imageData=_}sliceByTwo(e,t,n,s,a){const h=e.imageData,p=.5;let v=!1,_=!1,b=t*p,E=n*p;const N=e.filterBackend.resources;let O=0,Q=0;const W=t;let ee=0;N.sliceByTwo||(N.sliceByTwo=ui());const K=N.sliceByTwo;(K.width<1.5*t||K.height<n)&&(K.width=1.5*t,K.height=n);const ae=K.getContext("2d");for(ae.clearRect(0,0,1.5*t,n),ae.putImageData(h,0,0),s=Math.floor(s),a=Math.floor(a);!v||!_;)t=b,n=E,s<Math.floor(b*p)?b=Math.floor(b*p):(b=s,v=!0),a<Math.floor(E*p)?E=Math.floor(E*p):(E=a,_=!0),ae.drawImage(K,O,Q,t,n,W,ee,b,E),O=W,Q=ee,ee+=E;return ae.getImageData(O,Q,s,a)}lanczosResize(e,t,n,s,a){const h=e.imageData.data,p=e.ctx.createImageData(s,a),v=p.data,_=this.lanczosCreate(this.lanczosLobes),b=this.rcpScaleX,E=this.rcpScaleY,N=2/this.rcpScaleX,O=2/this.rcpScaleY,Q=Math.ceil(b*this.lanczosLobes/2),W=Math.ceil(E*this.lanczosLobes/2),ee={},K={x:0,y:0},ae={x:0,y:0};return(function le(ve){let we,F,ze,He,Je,ut,Ie,Ke,dt,Ve,Bt;for(K.x=(ve+.5)*b,ae.x=Math.floor(K.x),we=0;we<a;we++){for(K.y=(we+.5)*E,ae.y=Math.floor(K.y),Je=0,ut=0,Ie=0,Ke=0,dt=0,F=ae.x-Q;F<=ae.x+Q;F++)if(!(F<0||F>=t)){Ve=Math.floor(1e3*Math.abs(F-K.x)),ee[Ve]||(ee[Ve]={});for(let Le=ae.y-W;Le<=ae.y+W;Le++)Le<0||Le>=n||(Bt=Math.floor(1e3*Math.abs(Le-K.y)),ee[Ve][Bt]||(ee[Ve][Bt]=_(Math.sqrt(Math.pow(Ve*N,2)+Math.pow(Bt*O,2))/1e3)),ze=ee[Ve][Bt],ze>0&&(He=4*(Le*t+F),Je+=ze,ut+=ze*h[He],Ie+=ze*h[He+1],Ke+=ze*h[He+2],dt+=ze*h[He+3]))}He=4*(we*s+ve),v[He]=ut/Je,v[He+1]=Ie/Je,v[He+2]=Ke/Je,v[He+3]=dt/Je}return++ve<s?le(ve):p})(0)}bilinearFiltering(e,t,n,s,a){let h,p,v,_,b,E,N,O,Q,W,ee,K,ae,le=0;const ve=this.rcpScaleX,we=this.rcpScaleY,F=4*(t-1),ze=e.imageData.data,He=e.ctx.createImageData(s,a),Je=He.data;for(N=0;N<a;N++)for(O=0;O<s;O++)for(b=Math.floor(ve*O),E=Math.floor(we*N),Q=ve*O-b,W=we*N-E,ae=4*(E*t+b),ee=0;ee<4;ee++)h=ze[ae+ee],p=ze[ae+4+ee],v=ze[ae+F+ee],_=ze[ae+F+4+ee],K=h*(1-Q)*(1-W)+p*Q*(1-W)+v*W*(1-Q)+_*Q*W,Je[le++]=K;return He}hermiteFastResize(e,t,n,s,a){const h=this.rcpScaleX,p=this.rcpScaleY,v=Math.ceil(h/2),_=Math.ceil(p/2),b=e.imageData.data,E=e.ctx.createImageData(s,a),N=E.data;for(let O=0;O<a;O++)for(let Q=0;Q<s;Q++){const W=4*(Q+O*s);let ee=0,K=0,ae=0,le=0,ve=0,we=0,F=0;const ze=(O+.5)*p;for(let He=Math.floor(O*p);He<(O+1)*p;He++){const Je=Math.abs(ze-(He+.5))/_,ut=(Q+.5)*h,Ie=Je*Je;for(let Ke=Math.floor(Q*h);Ke<(Q+1)*h;Ke++){let dt=Math.abs(ut-(Ke+.5))/v;const Ve=Math.sqrt(Ie+dt*dt);Ve>1&&Ve<-1||(ee=2*Ve*Ve*Ve-3*Ve*Ve+1,ee>0&&(dt=4*(Ke+He*t),F+=ee*b[dt+3],ae+=ee,b[dt+3]<255&&(ee=ee*b[dt+3]/250),le+=ee*b[dt],ve+=ee*b[dt+1],we+=ee*b[dt+2],K+=ee))}}N[W]=le/K,N[W+1]=ve/K,N[W+2]=we/K,N[W+3]=F/ae}return E}}de(Fl,"type","Resize"),de(Fl,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),de(Fl,"uniformLocations",["uDelta","uTaps"]),ct.setClass(Fl);class Nl extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let s=0;s<t.length;s+=4){const a=t[s],h=t[s+1],p=t[s+2],v=Math.max(a,h,p);t[s]+=v!==a?(v-a)*n:0,t[s+1]+=v!==h?(v-h)*n:0,t[s+2]+=v!==p?(v-p)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}de(Nl,"type","Saturation"),de(Nl,"defaults",{saturation:0}),de(Nl,"uniformLocations",["uSaturation"]),ct.setClass(Nl);class Bl extends Fn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let s=0;s<t.length;s+=4){const a=t[s],h=t[s+1],p=t[s+2],v=Math.max(a,h,p),_=(a+h+p)/3,b=2*Math.abs(v-_)/255*n;t[s]+=v!==a?(v-a)*b:0,t[s+1]+=v!==h?(v-h)*b:0,t[s+2]+=v!==p?(v-p)*b:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}de(Bl,"type","Vibrance"),de(Bl,"defaults",{vibrance:0}),de(Bl,"uniformLocations",["uVibrance"]),ct.setClass(Bl);var Yb=Object.freeze({__proto__:null,BaseFilter:Fn,BlackWhite:Ub,BlendColor:kl,BlendImage:Tl,Blur:El,Brightness:Ol,Brownie:Fb,ColorMatrix:Ra,Composed:Dd,Contrast:Pl,Convolute:Al,Gamma:Ml,Grayscale:Il,HueRotation:Dc,Invert:jl,Kodachrome:Bb,Noise:Ll,Pixelate:Dl,Polaroid:Vb,RemoveColor:Rl,Resize:Fl,Saturation:Nl,Sepia:Wb,Technicolor:zb,Vibrance:Bl,Vintage:Nb});const qb=Object.freeze(Object.defineProperty({__proto__:null,ActiveSelection:Pi,BaseBrush:gh,BaseFabricObject:Zi,Canvas:$l,Canvas2dFilterBackend:Py,CanvasDOMManager:gy,Circle:Ir,CircleBrush:by,ClipPathLayout:Md,Color:$t,Control:Mr,Ellipse:Ci,FabricImage:mr,FabricObject:Zn,FabricText:$n,FitContentLayout:Zc,FixedLayout:Id,Gradient:Oi,Group:ur,IText:ts,Image:mr,InteractiveFabricObject:Do,Intersection:mn,LayoutManager:Ro,LayoutStrategy:uu,Line:li,Object:Zn,Observable:iv,Path:Ji,Pattern:Gl,PatternBrush:Cy,PencilBrush:Va,Point:Ce,Polygon:ta,Polyline:ai,Rect:yr,Shadow:wr,SprayBrush:Sy,StaticCanvas:Uo,StaticCanvasDOMManager:rp,Text:$n,Textbox:ns,Triangle:es,WebGLFilterBackend:eu,cache:Po,classRegistry:ct,config:Yt,controlsUtils:Ob,createCollectionMixin:Qd,filters:Yb,getCSSRules:Ly,getEnv:Ii,getFabricDocument:Ua,getFabricWindow:Ti,getFilterBackend:jc,iMatrix:cr,initFilterBackend:Ay,isPutImageFaster:Pb,isWebGLPipelineState:cu,loadSVGFromString:Lc,loadSVGFromURL:Cb,parseAttributes:as,parseFontDeclaration:$v,parsePointsAttribute:Ty,parseSVGDocument:_p,parseStyleAttribute:ey,parseTransformAttribute:Jl,runningAnimations:Zl,setEnv:Ix,setFilterBackend:yb,util:Pd,version:Nc},Symbol.toStringTag,{value:"Module"})),ia={namespace:"app",separator:".",trimKeys:!0,expiry:!0};function Kb(l){ia.namespace=l}function Vy(l){ia.namespace=l}function Zb(){return ia.namespace}function Qb(){return ia}function Jb(l){ia.separator=l}function mh(){return ia.separator}function $b(l){return`${ia.namespace}${ia.separator}${l}`}const e2="1.2.0";var wp={version:e2,createNamespace:Kb,getCurrentNamespace:Zb,switchNamespace:Vy,get:Qb,setSeparator:Jb,getSeparator:mh,generateKey:$b};function t2(l){l&&Vy(l)}function n2(l){try{return JSON.parse(l)}catch{return l}}function Wy(l){return l===void 0}function Uy(l){return l===null||l==="null"}function r2(l,e){if(l===0)return"0 B";const t=1024,n=["B","KB","MB"],s=Math.floor(Math.log(l)/Math.log(t));return(l/Math.pow(t,s)).toFixed(2)+" "+(e?n[s]:"")}function i2(l,e,t){e=e.toUpperCase();let n="";switch(e){case"B":n=l.toFixed(2);break;case"KB":n=(l/1024).toFixed(2);break;case"MB":n=(l/(1024*1024)).toFixed(2);break;default:return console.warn(`Unsupported format "${e}" provided. Falling back to auto-formatting.`),r2(l,t)}return t?`${n} ${e}`:n}var tu={parse:n2,isUndefined:Wy,isNull:Uy,units:i2};function Hy(l){return Wy(l)||Uy(l)}function s2(l,e=null){if(Hy(l))return null;const t=wp.generateKey(l),n=this.storage.getItem(t);if(tu.isNull(n))return e;try{let s=tu.parse(n);return s.expire&&Date.now()>s.expire?(this.remove(l),e):s.value}catch{return e}}function a2(l,e,t={}){if(Hy(l))return null;const n=wp.generateKey(l),{expire:s}=t;let a={value:e,...s?{expire:Date.now()+s}:{}};this.storage.setItem(n,JSON.stringify(a))}function o2(l){return!!this.get(l)}function l2(l){const e=this.get(l),t=wp.generateKey(l);return this.storage.removeItem(t),e}function u2(){return this.storage.clear()}function c2(l){return this.storage.key(l)}function h2(){const l=[];for(let e=0;e<this.storage.length;e++)l.push(this.storage.key(e));return l}function f2(l){return this.storage.get(l).trim()}function d2(l,e={}){const t=this.get(l);if(t===null)return 0;const n=new Blob([JSON.stringify(t)]).size;if(e.format){let s="unit"in e?e.unit:!0;return tu.units(n,e.format,s)}return n}function p2(l,e){const t=mh();for(let n in e)n in e&&this.set(`${l}${t}${n}`,e[n])}function g2(l){const e={},t=mh();for(let n=0,s=this.storage.length;n<s;n++){const a=this.key(n),[,h,p]=a.split(`${t}`,3);h===l&&p&&(e[p]=this.get(`${h}${t}${p}`))}return e}const m2=5*1024*1024;function v2(l={}){const e=l.capacity||m2,t=this.used(),n=e-t,s=n>0?n:0;if(l.format){let a="unit"in l?l.unit:!0;return tu.units(s,l.format,a)}return s}function y2(){let l=0;const e=mh();for(let t=0;t<this.count;t++){const n=this.key(t),[,s]=n.split(`${e}`,2),a=this.get(s);l+=new Blob([JSON.stringify(n)]).size,l+=new Blob([JSON.stringify(a)]).size}return l}const _2=5*1024*1024;function x2(l={}){const e=l.capacity||_2;if(l.format){let t="unit"in l?l.unit:!0;return tu.units(e,l.format,t)}return e}var w2={size:d2,free:v2,used:y2,capacity:x2,from:t2,get:s2,set:a2,has:o2,remove:l2,clear:u2,key:c2,keys:h2,trim:f2,getFormattedData:g2,setFormattedData:p2};function gm(l){return{storage:l,get count(){return l.length},...w2}}function mm(l){if(!l)throw new Error("Storage is not supported in this environment.");return l}const b2={local:gm(mm(window.localStorage)),session:gm(mm(window.sessionStorage))},vm=l=>{let e;const t=new Set,n=(_,b)=>{const E=typeof _=="function"?_(e):_;if(!Object.is(E,e)){const N=e;e=b??(typeof E!="object"||E===null)?E:Object.assign({},e,E),t.forEach(O=>O(e,N))}},s=()=>e,p={setState:n,getState:s,getInitialState:()=>v,subscribe:_=>(t.add(_),()=>t.delete(_))},v=e=l(n,s,p);return p},S2=(l=>l?vm(l):vm),C2=l=>l;function k2(l,e=C2){const t=To.useSyncExternalStore(l.subscribe,To.useCallback(()=>e(l.getState()),[l,e]),To.useCallback(()=>e(l.getInitialState()),[l,e]));return To.useDebugValue(t),t}const ym=l=>{const e=S2(l),t=n=>k2(e,n);return Object.assign(t,e),t},T2=(l=>l?ym(l):ym),E2="landscape",O2="A4",P2="Default",A2="freehand",M2={Default:{w:1024,h:600},Freehand:{w:1920,h:1080},A4:{w:794,h:1123},A5:{w:794,h:1123},Letter:{w:816,h:1056},Legal:{w:816,h:1344}},I2={bg:"#F2F6FA"};function _m(l,e){const t=Pd.invertTransform(l.calcTransformMatrix());return Pd.transformPoint(e,t)}function j2(l,e=0,t=1){return Math.max(e,Math.min(t,l))}function xm(l,e,t){const n=t.x-e.x,s=t.y-e.y,a=l.x-e.x,h=l.y-e.y,p=n*n+s*s;return p===0?0:j2((a*n+h*s)/p)}class Xy{canvas;activeObj=null;start;end;line;stops=[];activeStop=null;gradientType="linear";getColor;constructor(e,t){this.canvas=e,this.getColor=t}enable(){this.canvas.on("mouse:down",this.onMouseDown)}disable(){this.canvas.off("mouse:down",this.onMouseDown),this.cleanup()}onMouseDown=e=>{const t=this.canvas.findTarget(e.e,!1);if(t&&!(t===this.start||t===this.end)){if(this.stops.includes(t)){this.setActiveStop(t);return}if(t===this.line){this.addStopFromEvent(e);return}this.attach(t)}};attach(e){this.cleanup(),this.activeObj=e;const t=e.getBoundingRect(!0,!0),n=this.getColor();this.start=this.createHandle(t.left,t.top+t.height/2),this.end=this.createHandle(t.left+t.width,t.top+t.height/2),this.line=new li([this.start.left,this.start.top,this.end.left,this.end.top],{stroke:"#6366f1",strokeWidth:1,selectable:!1,evented:!0,excludeFromExport:!0}),this.createStop(0,n),this.createStop(1,n),this.canvas.add(this.line,this.start,this.end,...this.stops),this.setActiveStop(this.stops[1]),this.update()}createHandle(e,t){const n=new Ir({left:e,top:t,radius:7,fill:"#111",originX:"center",originY:"center",selectable:!0,hasControls:!1,hasBorders:!1,excludeFromExport:!0});return n.on("moving",this.update),n}createStop(e,t){const n=this.pointAt(e),s=new Ir({left:n.x,top:n.y,radius:6,fill:t,originX:"center",originY:"center",selectable:!0,hasControls:!1,hasBorders:!1,excludeFromExport:!0});return s.offset=e,s.on("moving",()=>{const a=xm(new Ce(s.left,s.top),new Ce(this.start.left,this.start.top),new Ce(this.end.left,this.end.top));s.offset=a;const h=this.pointAt(a);s.set({left:h.x,top:h.y}),this.update()}),s.on("mousedown",a=>{a.e.stopPropagation(),this.setActiveStop(s)}),s.on("mousedblclick",a=>{a.e.preventDefault(),this.removeStop(s)}),this.stops.push(s),s}removeStop(e){this.stops.length<=2||(this.canvas.remove(e),this.stops=this.stops.filter(t=>t!==e),this.activeStop===e&&(this.activeStop=this.stops[0]||null),this.update())}addStopFromEvent(e){const t=this.canvas.getPointer(e.e),n=xm(new Ce(t.x,t.y),new Ce(this.start.left,this.start.top),new Ce(this.end.left,this.end.top)),s=this.createStop(n,this.getColor());this.canvas.add(s),this.setActiveStop(s),this.update()}setActiveStop(e){this.activeStop=e,this.stops.forEach(t=>t.set("stroke",t===e?"#000":void 0)),this.canvas.requestRenderAll()}updateActiveColor(e){this.activeStop&&(this.activeStop.set("fill",e),this.update())}toggleGradientType(){this.gradientType=this.gradientType==="linear"?"radial":"linear",this.update()}update=()=>{if(!this.activeObj)return;this.line.set({x1:this.start.left,y1:this.start.top,x2:this.end.left,y2:this.end.top}),this.stops.forEach(a=>{const h=this.pointAt(a.offset);a.set({left:h.x,top:h.y})});const e=_m(this.activeObj,new Ce(this.start.left,this.start.top)),t=_m(this.activeObj,new Ce(this.end.left,this.end.top)),n=this.stops.sort((a,h)=>a.offset-h.offset).map(a=>({offset:a.offset,color:a.fill})),s=this.gradientType==="linear"?new Oi({type:"linear",gradientUnits:"pixels",coords:{x1:e.x,y1:e.y,x2:t.x,y2:t.y},colorStops:n}):new Oi({type:"radial",gradientUnits:"pixels",coords:{x1:e.x,y1:e.y,r1:0,x2:t.x,y2:t.y,r2:Math.hypot(t.x-e.x,t.y-e.y)},colorStops:n});this.activeObj.set("fill",s),this.canvas.requestRenderAll()};pointAt(e){return{x:this.start.left+(this.end.left-this.start.left)*e,y:this.start.top+(this.end.top-this.start.top)*e}}cleanup(){this.canvas.remove(this.start,this.end,this.line,...this.stops),this.stops=[],this.activeStop=null,this.activeObj=null}syncFromObject(e){return!e.fill||!e.fill.type?(this.disable(),null):(this.gradientType=e.fill.type,this.gradientType)}}function L2(l,e){const t=l.canvas,n=l.getCenterPoint();e.scaleX*=l.scaleX,e.scaleY*=l.scaleY,l.scaleX=1,l.scaleY=1,l.remove(e),e.set({left:n.x,top:n.y,angle:l.angle,flipX:l.flipX,flipY:l.flipY,originX:"center",originY:"center"}),t.remove(l),t.add(e),t.setActiveObject(e),e.enterEditing(),e.selectAll(),e.setCoords(),t.requestRenderAll()}const D2=(l,e,t)=>({canvas:null,activeTool:"select",isPanning:!1,isDrawingMode:!1,freeDrawingBrush:null,activePanel:null,selectedObject:"textbox",showTextToolbar:!0,hasActiveShape:!1,geditor:null,hasMultipleSelection:()=>{const n=e().canvas;return n?n.getActiveObjects().length>1:!1},init:async n=>{if(e().canvas)return;const s=new $l(n,{backgroundColor:I2.bg,preserveObjectStacking:!0});e().saveState(),l({canvas:s}),e().setPageFormat(A2,E2),e().enablePan(),e().setBrush();const a=new Xy(s,()=>e().fill);l({geditor:a});const h=p=>{const v=p.target;l({hasActiveShape:!!v}),e().setToolbar(p),e().updateFromFabric(v)};s.on("selection:created",p=>h(p)),s.on("selection:updated",p=>h(p)),s.on("selection:cleared",()=>{e().clearToolbar()}),s.on("mouse:down",p=>h(p)),s.on("mouse:dblclick",p=>{const v=p.target;!v||v.type!=="group"||!v.__text||(console.log(v.__text),L2(v,v.__text),v.__text.on("changed",function(){const _=this.__group;if(!_)return;const b=_.__box;if(!b)return;const E=20;b.width=Math.max(this.width+E,b.width),b.height=Math.max(this.height+E,b.height),window.gradientEditor=a,_.setCoords(),s.requestRenderAll()}),v.__text.on("editing:exited",function(){const _=this.canvas,b=this.__group;if(!b)return;const E=this.getCenterPoint();this.scaleX/=b.scaleX||1,this.scaleY/=b.scaleY||1,b.add(this),b.set({left:E.x,top:E.y,angle:this.angle,flipX:this.flipX,flipY:this.flipY,scaleX:1,scaleY:1}),_.remove(this),_.add(b),_.setActiveObject(b),b.setCoords(),_.requestRenderAll()}))}),s.on("object:modified",p=>h(p))},init1:async n=>{if(e().canvas)return;const s=new $l(n,{backgroundColor:"#fff",preserveObjectStacking:!1});e().saveState(),l({canvas:s}),e().enablePan(),e().setPageFormat(O2,P2),e().setBrush();const a=_=>{!_||e()._isRestoring||(e().updateFromFabric(_),e().saveState())},h=(_,b=!1)=>{_?.type==="textbox"?(l({selectedObject:_,showTextToolbar:!0,isEditingText:b}),e().syncFromObject(_)):l({selectedObject:"shape"})},p=()=>{l({selectedObject:null,showTextToolbar:!1,isEditingText:!1})};Object.entries({"object:removed":_=>a(_.target),"selection:created":_=>h(_.target),"selection:updated":_=>h(_.target),"selection:cleared":()=>p(),"mouse:down":_=>h(_.target),"path:created":_=>{const b=_.path;console.log("New path created:",b),e().updateFromFabric(b),e().saveState()}}).forEach(([_,b])=>{s.on(_,b)})},setCanvas:n=>{l({canvas:n}),n&&(n.freeDrawingBrush=new Va(n),n.freeDrawingBrush.color="#000",n.freeDrawingBrush.width=2,e().enablePan(),e().setPageFormat("Freehand","landscape"),n.on("path:created",()=>e().pushState()),n.on("object:added",s=>{const a=s.target||null;a&&(l({selectedObject:a}),e().syncFromObject(a))}),n.on("selection:created",s=>{const a=s.selected?.[0]||null;l({selectedObject:a}),e().syncFromObject(a)}),n.on("selection:updated",s=>{const a=s.selected?.[0]||null;l({selectedObject:a}),e().syncFromObject(a)}),n.on("selection:cleared",()=>{l({selectedObject:null}),e().syncFromObject(null)}),n.on("object:modified",s=>{const a=s.target||null;l({selectedObject:a}),e().syncFromObject(a)}),n.on("before:transform",s=>{s.target?.type==="textbox"&&l({showTextToolbar:!1})}),n.on("object:scaling",s=>{console.log("Scaling:",s.target?.type)}),n.on("after:transform",s=>{const a=s.target||null;a?.type==="textbox"&&(l({showTextToolbar:!0,selectedObject:a}),e().syncFromObject(a))}))},setSelectedObject:()=>{l({selectedObject:!1})},setActiveTool:n=>{const s=e().canvas;if(s){switch(l({activeTool:n}),n){case"pan":s.isDrawingMode=!1,s.defaultCursor="grab",s.selection=!1,s.skipTargetFind=!0;break;case"draw":console.log("here"),s.isDrawingMode=!0,s.freeDrawingBrush.color="#000";break;case"select":default:s.isDrawingMode=!1,s.defaultCursor="default",s.selection=!0,s.skipTargetFind=!1;break}s.requestRenderAll()}},enablePan:()=>{const n=e().canvas;n&&(console.log("Pan tool enabled"),n.on("mouse:wheel",s=>{const a=s.e;let h=n.getZoom();const p=Math.pow(.999,a.deltaY);h*=p,h=Math.min(Math.max(h,.1),5);const v=new Ce(a.offsetX,a.offsetY);n.zoomToPoint(v,h),a.preventDefault(),a.stopPropagation()}),n.on("mouse:down",()=>{e().activeTool==="pan"&&(l({isPanning:!0}),n.setCursor("grabbing"),n.requestRenderAll())}),n.on("mouse:move",s=>{if(!e().isPanning)return;const a=s.e;n.relativePan(new Ce(a.movementX,a.movementY)),n.requestRenderAll()}),n.on("mouse:up",()=>{e().isPanning&&(l({isPanning:!1}),n.setCursor("grab"),n.requestRenderAll())}))},syncFromObject:n=>{n&&l({fill:n.fill||"#ffffff",stroke:n.stroke||"#111827",strokeWidth:n.strokeWidth||2,strokeStyle:n.strokeDashArray?n.strokeDashArray[0]===10?"dashed":"dotted":"solid"})},updateTextStyle:n=>{const s=e().canvas,a=e().selectedObject;!s||!a||a.type!=="textbox"||(n.fontSize&&a.set("fontSize",n.fontSize),n.fill&&a.set("fill",n.fill),n.bold!==void 0&&a.set("fontWeight",n.bold?"bold":"normal"),n.italic!==void 0&&a.set("fontStyle",n.italic?"italic":"normal"),n.underline!==void 0&&a.set("underline",n.underline),s.renderAll(),e().pushState())},clearBoard:()=>{const n=e().canvas;n&&(b2.local.clear(),n.clear(),n.backgroundColor="#FFF",n.requestRenderAll())},clearToolbar:()=>{l({selectedObject:null,showTextToolbar:!1,isEditingText:!1,hasActiveShape:!1})},setToolbar:(n,s=!1)=>{const a=n.target;a?.type==="textbox"?(l({selectedObject:a,showTextToolbar:!0,isEditingText:s}),e().syncFromObject(a)):a?.customType==="shape"||n?.selected?.length>0||a?.type=="group"||a?.type=="activeselection"?l({selectedObject:"shape"}):l({selectedObject:null})}}),R2=(l,e,t)=>({toolbarPosition:"left",isFullScreen:!1,setToolbarPosition:n=>l({toolbarPosition:n}),toggleFullscreen:()=>{const n=document.documentElement;document.fullscreenElement?(document.exitFullscreen?.(),l({isFullScreen:!1})):(n.requestFullscreen?.(),l({isFullScreen:!0}))},zoomIn:()=>{const n=e().canvas;if(!n)return;const s=new Ce(n.width/2,n.height/2),a=Math.min(n.getZoom()*1.1,5);n.zoomToPoint(s,a),n.requestRenderAll()},zoomOut:()=>{const n=e().canvas;if(!n)return;const s=new Ce(n.width/2,n.height/2),a=Math.max(n.getZoom()/1.1,.1);n.zoomToPoint(s,a),n.requestRenderAll()},zoomFit:()=>{const n=e().canvas;if(!n)return;const s=n.getObjects().filter(K=>K.visible);if(s.length===0){const K=n.viewportTransform,ae=1;K[0]=ae,K[3]=ae,K[4]=0,K[5]=0,n.setViewportTransform(K),n.requestRenderAll();return}let a=1/0,h=1/0,p=-1/0,v=-1/0;s.forEach(K=>{const ae=K.getBoundingRect(!0,!0);a=Math.min(a,ae.left),h=Math.min(h,ae.top),p=Math.max(p,ae.left+ae.width),v=Math.max(v,ae.top+ae.height)});const _={left:a,top:h,width:p-a,height:v-h},b=20,E=n.width-b*2,N=n.height-b*2;let O=Math.min(E/_.width,N/_.height);O=Math.min(Math.max(O,.1),5);const Q=_.left+_.width/2,W=_.top+_.height/2,ee=n.viewportTransform;ee[0]=O,ee[3]=O,ee[4]=n.width/2-Q*O,ee[5]=n.height/2-W*O,n.setViewportTransform(ee),n.requestRenderAll()}}),F2=(l,e,t)=>({layers:[],clipboard:null,setLayers:n=>l({layers:n}),addLayer:(n,s)=>{const a=e().layers||[],h=n.toObject().id||Date.now();l({layers:[...a,{id:h,type:s,object:n,name:s,visible:!0,locked:!1}]}),e().canvas?.requestRenderAll()},renameLayer:(n,s)=>{const a=e().layers.map(h=>(h.id===n&&(h.name=s),h));l({layers:a})},removeLayer:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObjects();if(!s||s.length===0)return;const a=e().layers.filter(h=>!s.includes(h.object));l({layers:a}),s.forEach(h=>n.remove(h)),n.discardActiveObject(),n.requestRenderAll()},toggleVisibility:n=>{const s=e().layers.map(a=>(a.id===n&&(a.visible=!a.visible,a.object&&(a.object.visible=a.visible)),a));l({layers:s}),e().canvas?.requestRenderAll()},duplicateLayer:n=>{const s=e().layers.find(a=>a.id===n);s?.object&&s.object.clone(a=>{a.set({left:s.object.left+10,top:s.object.top+10,id:Date.now()}),e().canvas.add(a),e().canvas.setActiveObject(a),e().canvas.requestRenderAll();const h=e().layers;l({layers:[...h,{id:a.id,type:s.type,name:s.name+"_copy",object:a}]})})},toggleLayerLock:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObject();if(!s)return;const a=e().layers.map(h=>{if(h.object===s){const p=!h.locked;return s.selectable=!p,s.evented=!p,{...h,locked:p}}return h});console.log(e().layers),l({layers:a})},isActiveObjectLocked:()=>e().selectedObject?._locked===!0,toggleActiveObjectLock:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObject();if(!s)return;!s._locked?(s.lockMovementX=!0,s.lockMovementY=!0,s.lockScalingX=!0,s.lockScalingY=!0,s.lockRotation=!0,s.hasControls=!1,s._locked=!0):(s.lockMovementX=!1,s.lockMovementY=!1,s.lockScalingX=!1,s.lockScalingY=!1,s.lockRotation=!1,s.hasControls=!0,s._locked=!1),n.renderAll()},bringForward:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObjects();s.length&&(s.forEach(a=>{if(a.type!=="activeselection"){const h=n.getObjects().indexOf(a);n.moveObjectTo(a,h+1)}}),n.requestRenderAll())},sendBackward:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObjects();s.length&&(s.forEach(a=>{if(a.type!=="activeselection"){const h=n.getObjects().indexOf(a);n.moveObjectTo(a,Math.max(0,h-1))}}),n.requestRenderAll())},bringToFront:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObjects();s.length&&(s.forEach(a=>{a.type!=="activeselection"&&n.moveObjectTo(a,n.getObjects().length-1)}),n.requestRenderAll())},sendToBack:()=>{const n=e().canvas;!n||![...n.getActiveObjects()].length||(n.getActiveObjects().forEach(a=>{a.type!=="activeselection"&&n.moveObjectTo(a,0)}),n.requestRenderAll())},deleteObject:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObjects();s&&(s.forEach(a=>n.remove(a)),n.discardActiveObject(),n.requestRenderAll())},groupLayers:n=>{const s=e().canvas;if(!s)return;const a=s.getActiveObjects();e().deleteObject();const h=new ur(a);s.add(h),s.requestRenderAll()},ungroupSelected:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObject();s&&(n.remove(s),n.add(...s.removeAll()),n.requestRenderAll())},groupLayers1:n=>{const s=e(),a="group-"+Date.now(),h={id:a,name:"Group",visible:!0,locked:!1,parentId:null},p=s.layers.map(v=>n.includes(v.id)?{...v,parentId:a}:v);l({layers:[...p,h]})},ungroupLayers1:n=>{const a=e().layers.map(h=>n.includes(h.id)&&h.children?.length?null:n.includes(h.parentId)?{...h,parentId:null}:h).filter(Boolean);l({layers:a})},alignLayers:(n,s)=>{const a=e();if(!s.length)return;const h=a.layers.filter(_=>s.includes(_.id));let p;switch(n){case"left":p=Math.min(...h.map(_=>_.x||0));break;case"center":p=Math.round(h.reduce((_,b)=>_+(b.x||0),0)/h.length);break;case"right":p=Math.max(...h.map(_=>(_.x||0)+(_.width||0)));break;default:return}const v=a.layers.map(_=>s.includes(_.id)?{..._,x:n==="right"?p-(_.width||0):p}:_);l({layers:v})},distributeLayers:(n,s)=>{const a=e(),h=a.layers.filter(p=>s.includes(p.id));if(!(h.length<3)){if(n==="horizontal"){const p=h.sort((N,O)=>(N.x||0)-(O.x||0)),v=p[0].x||0,b=((p[p.length-1].x||0)-v)/(p.length-1),E=a.layers.map(N=>{const O=p.findIndex(Q=>Q.id===N.id);return O>=0?{...N,x:v+b*O}:N});l({layers:E})}if(n==="vertical"){const p=h.sort((N,O)=>(N.y||0)-(O.y||0)),v=p[0].y||0,b=((p[p.length-1].y||0)-v)/(p.length-1),E=a.layers.map(N=>{const O=p.findIndex(Q=>Q.id===N.id);return O>=0?{...N,y:v+b*O}:N});l({layers:E})}}},copy:()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObject();s&&s.clone().then(a=>{l({clipboard:a})})},paste:async()=>{const n=e().canvas,s=e().clipboard;if(!n||!s)return;const a=await s.clone();n.discardActiveObject(),a.set({left:a.left+10,top:a.top+10,evented:!0,customType:"shape"}),a.type==="activeSelection"?(a.canvas=n,a.forEachObject(h=>n.add(h)),a.setCoords()):n.add(a),l({clipboard:a}),n.setActiveObject(a),n.requestRenderAll()},duplicate:async()=>{const n=e().canvas;if(!n)return;const s=n.getActiveObject();if(!s)return;const a=await s.clone();n.discardActiveObject(),a.set({left:a.left+10,top:a.top+10,evented:!0}),console.log(a.type),a.type==="activeselection"?(a.canvas=n,a.forEachObject(h=>n.add(h)),a.setCoords()):n.add(a),l({clipboard:a}),n.setActiveObject(a),n.requestRenderAll()},alignObjects:n=>{const s=e().canvas;if(!s)return;const a=s.getActiveObjects();if(!a||a.length<2)return;const h=a.map(W=>({o:W,box:W.getBoundingRect(!0,!0)})),p=Math.min(...h.map(W=>W.box.left)),v=Math.max(...h.map(W=>W.box.left+W.box.width)),_=Math.min(...h.map(W=>W.box.top)),b=Math.max(...h.map(W=>W.box.top+W.box.height)),E=v-p,N=b-_,O=(W,ee)=>{const K=W-ee.box.left;ee.o.set({left:ee.o.left+K})},Q=(W,ee)=>{const K=W-ee.box.top;ee.o.set({top:ee.o.top+K})};switch(console.log("key..",n),n){case"align-left":h.forEach(W=>O(p,W));break;case"align-hcenter":{const W=p+E/2;h.forEach(ee=>{const K=W-ee.box.width/2;O(K,ee)});break}case"align-right":h.forEach(W=>{const ee=v-W.box.width;O(ee,W)});break;case"align-top":h.forEach(W=>Q(_,W));break;case"align-vcenter":{const W=_+N/2;h.forEach(ee=>{const K=W-ee.box.height/2;Q(K,ee)});break}case"align-bottom":h.forEach(W=>{const ee=b-W.box.height;Q(ee,W)});break;case"distribute-h":{const W=[...h].sort((le,ve)=>le.box.left-ve.box.left);if(W.length<3)break;const ee=W[0].box.left+W[0].box.width/2,ae=(W[W.length-1].box.left+W[W.length-1].box.width/2-ee)/(W.length-1);W.forEach((le,ve)=>{const F=ee+ae*ve-le.box.width/2;O(F,le)});break}case"distribute-v":{const W=[...h].sort((le,ve)=>le.box.top-ve.box.top);if(W.length<3)break;const ee=W[0].box.top+W[0].box.height/2,ae=(W[W.length-1].box.top+W[W.length-1].box.height/2-ee)/(W.length-1);W.forEach((le,ve)=>{const F=ee+ae*ve-le.box.height/2;Q(F,le)});break}}a.forEach(W=>W.setCoords()),s.requestRenderAll()},distributeObjects:n=>{const{canvas:s}=e();if(!s)return;const a=s.getActiveObjects();if(a.length<3)return;n==="horizontal"?a.sort((v,_)=>v.left-_.left):a.sort((v,_)=>v.top-_.top);const h=a[0],p=a[a.length-1];if(n==="horizontal"){const _=(p.left-h.left-(h.getScaledWidth()+p.getScaledWidth())/2)/(a.length-1);a.forEach((b,E)=>{E!==0&&E!==a.length-1&&(b.set({left:h.left+E*_}),b.setCoords())})}else{const _=(p.top-h.top-(h.getScaledHeight()+p.getScaledHeight())/2)/(a.length-1);a.forEach((b,E)=>{E!==0&&E!==a.length-1&&(b.set({top:h.top+E*_}),b.setCoords())})}s.requestRenderAll()},canPaste(){return!!this.clipboard},isGroupSelected(){const n=e().canvas?.getActiveObject();return n?n.type==="group"||Array.isArray(n._objects):!1}}),N2=(l,e,t)=>({pageFormat:"Freehand",orientation:"landscape",zoom:1,scale:1,setPageFormat:(n,s="portrait")=>{l({pageFormat:n,orientation:s}),e().applyPageSize(n,s)},setOrientation:n=>{l({orientation:n}),e().applyPageSize(e().pageFormat,n)},setZoom:n=>{const s=e().canvas;s&&(s.setZoom(n),l({zoom:n}),e().drawBackground(),s.renderAll())},applyPageSize:(n=e().pageFormat,s=e().orientation)=>{const a=e().canvas;if(!a)return;if(String(n||"").toLowerCase()==="freehand"){a.setWidth(window.innerWidth*2),a.setHeight(window.innerHeight*2),a.setZoom(1),a.calcOffset(),a.renderAll(),l({scale:1,pageWidth:a.getWidth(),pageHeight:a.getHeight()});return}const{w:p,h:v}=M2[n],_=s==="portrait"?p:v,b=s==="portrait"?v:p,N=800/_;a.setWidth(_*N),a.setHeight(b*N),a.setZoom(N),a.calcOffset(),a.renderAll(),l({scale:N,pageWidth:_,pageHeight:b}),e().drawBackground()}}),vh=()=>qb,B2=({get:l})=>{const e=vh(),t=Math.max(2,l().gridSize),n=Math.max(1,l().gridMajorEvery),s=t*n,a=document.createElement("canvas");a.width=a.height=s;const h=a.getContext("2d");if(!h)return null;const p=(v,_,b,E,N,O)=>{h.beginPath(),h.moveTo(v+.5,_+.5),h.lineTo(b+.5,E+.5),h.lineWidth=N,h.strokeStyle=O,h.stroke()};for(let v=1;v<n;v++){const _=v*t;p(_,0,_,s,l().gridLineWidth,l().gridColor),p(0,_,s,_,l().gridLineWidth,l().gridColor)}return p(s-1,0,s-1,s,l().gridMajorLineWidth,l().gridMajorColor),p(0,s-1,s,s-1,l().gridMajorLineWidth,l().gridMajorColor),new e.Pattern({source:a,repeat:"repeat"})},z2=({get:l})=>{const e=vh(),t=Math.max(2,l().ruledLineHeight),n=document.createElement("canvas");n.width=2,n.height=t;const s=n.getContext("2d");return s?(s.beginPath(),s.moveTo(0,t-1+.5),s.lineTo(n.width,t-1+.5),s.lineWidth=l().ruledLineWidth,s.strokeStyle=l().ruledColor,s.stroke(),new e.Pattern({source:n,repeat:"repeat"})):null},V2=({get:l})=>{const e=vh(),t=Math.max(6,l().gridSize),n=document.createElement("canvas");n.width=n.height=t;const s=n.getContext("2d");return s?(s.beginPath(),s.arc(1,1,1,0,Math.PI*2),s.fillStyle=l().gridColor,s.fill(),new e.Pattern({source:n,repeat:"repeat"})):null},W2=({get:l})=>{const e=vh(),t=Math.max(16,l().gridSize*2),n=document.createElement("canvas");n.width=n.height=t;const s=n.getContext("2d");return s?(s.strokeStyle=l().gridColor,s.lineWidth=1,s.beginPath(),s.moveTo(0,t),s.lineTo(t/2,0),s.lineTo(t,t),s.stroke(),new e.Pattern({source:n,repeat:"repeat"})):null},U2={none:null,grid:B2,ruled:z2,dots:V2,isometric:W2},H2=(l,e,t)=>({backgroundStyle:"none",gridSize:20,gridColor:"#e0e0e0",gridMajorEvery:5,gridMajorColor:"#bdbdbd",gridLineWidth:1,gridMajorLineWidth:1,ruledLineHeight:24,ruledColor:"#c0d6ff",ruledLineWidth:1,setBackgroundStyle:n=>{l({backgroundStyle:n}),e().drawBackground()},toggleGrid:()=>{const n=e().backgroundStyle==="grid"?"none":"grid";l({backgroundStyle:n}),e().drawBackground()},setGridOptions:n=>{l(n),e().drawBackground()},setRuledOptions:n=>{l(n),e().drawBackground()},drawBackground:()=>{const n=e().canvas;if(!n)return;const s=e().backgroundStyle,a=U2[s];if(!a){n.backgroundColor=null,n.requestRenderAll();return}const h=a({get:e});n.backgroundColor=h||null,n.requestRenderAll()}}),X2=[{id:"newfile",description:"New File",shortcut:["Meta+n","Ctrl+n"],handler:({get:l,set:e})=>{const{clearBoard:t}=l();t()}},{id:"copy",description:"Copy selected object",shortcut:["Meta+c","Ctrl+c"],handler:({get:l,set:e})=>{const{copy:t}=l();t()}},{id:"paste",description:"Paste object",shortcut:["Meta+v","Ctrl+v"],handler:({get:l,set:e})=>{const{paste:t}=l();t()}},{id:"duplicate",description:"Duplicate object",shortcut:["Meta+D","Ctrl+D"],handler:({get:l,set:e})=>{const{duplicate:t}=l();t()}},{id:"delete",description:"Delete selected object",shortcut:["Delete","Backspace"],handler:({get:l,set:e})=>{const{removeLayer:t}=l();t()}},{id:"group",description:"Group selected object",shortcut:["Meta+G","Ctrl+G"],handler:({get:l,set:e})=>{const{groupLayers:t}=l();t()}},{id:"ungroup",description:"Ungroup selected object",shortcut:["Meta+Shift+U","Ctrl+Shift+U"],handler:({get:l,set:e})=>{const{ungroupSelected:t}=l();t()}},{id:"undo",description:"Undo",shortcut:["Meta+Z","Ctrl+Z"],handler:({get:l,set:e})=>{const{undo:t}=l();t()}},{id:"redo",description:"Redo",shortcut:["Meta+Shift+Z","Ctrl+Y"],handler:({get:l,set:e})=>{const{redo:t}=l();t()}}],G2=(l,e,t)=>({commands:X2.map(s=>({...s,handler:()=>s.handler({get:e,set:l})})),runCommand:s=>{const a=e().commands.find(h=>h.id===s);a&&a.handler()}}),Y2=(l,e,t)=>({brush:"pencil",width:4,color:"#000",cursor:"crosshair",setBrush:(n={})=>{const s=e().canvas;if(!s)return;const a={pencil:()=>new Va(s),circle:()=>new by(s),spray:()=>new Sy(s),pattern:()=>new Cy(s),eraser:()=>new(void 0)(s)},h=n?.brush??e().brush,p=a[h]?a[h]():a.pencil(),v=n?.color??e().color,_=n?.width??e().width,b=n.cursor??"url('/pencil.svg') 0 32, crosshair";p.color=v,p.width=_,s.freeDrawingBrush=p,s.freeDrawingCursor=b,l({brush:h,color:v,width:_,cursor:b}),s.renderAll()},setBrushWidth:(n={})=>{const s=e().canvas;if(!s)return;console.log(n);const a=n?.width??e().width;s.freeDrawingBrush.width=a,l({width:a})},setBrushColor:(n={})=>{const s=e().canvas;if(!s)return;console.log(n);const a=n?.color??e().color;s.freeDrawingBrush.color=a,l({color:a})}});var Gy={inherit:"inherit",current:"currentcolor",transparent:"transparent",black:"#000",white:"#fff",slate:{50:"oklch(98.4% 0.003 247.858)",100:"oklch(96.8% 0.007 247.896)",200:"oklch(92.9% 0.013 255.508)",300:"oklch(86.9% 0.022 252.894)",400:"oklch(70.4% 0.04 256.788)",500:"oklch(55.4% 0.046 257.417)",600:"oklch(44.6% 0.043 257.281)",700:"oklch(37.2% 0.044 257.287)",800:"oklch(27.9% 0.041 260.031)",900:"oklch(20.8% 0.042 265.755)",950:"oklch(12.9% 0.042 264.695)"},gray:{50:"oklch(98.5% 0.002 247.839)",100:"oklch(96.7% 0.003 264.542)",200:"oklch(92.8% 0.006 264.531)",300:"oklch(87.2% 0.01 258.338)",400:"oklch(70.7% 0.022 261.325)",500:"oklch(55.1% 0.027 264.364)",600:"oklch(44.6% 0.03 256.802)",700:"oklch(37.3% 0.034 259.733)",800:"oklch(27.8% 0.033 256.848)",900:"oklch(21% 0.034 264.665)",950:"oklch(13% 0.028 261.692)"},zinc:{50:"oklch(98.5% 0 0)",100:"oklch(96.7% 0.001 286.375)",200:"oklch(92% 0.004 286.32)",300:"oklch(87.1% 0.006 286.286)",400:"oklch(70.5% 0.015 286.067)",500:"oklch(55.2% 0.016 285.938)",600:"oklch(44.2% 0.017 285.786)",700:"oklch(37% 0.013 285.805)",800:"oklch(27.4% 0.006 286.033)",900:"oklch(21% 0.006 285.885)",950:"oklch(14.1% 0.005 285.823)"},neutral:{50:"oklch(98.5% 0 0)",100:"oklch(97% 0 0)",200:"oklch(92.2% 0 0)",300:"oklch(87% 0 0)",400:"oklch(70.8% 0 0)",500:"oklch(55.6% 0 0)",600:"oklch(43.9% 0 0)",700:"oklch(37.1% 0 0)",800:"oklch(26.9% 0 0)",900:"oklch(20.5% 0 0)",950:"oklch(14.5% 0 0)"},stone:{50:"oklch(98.5% 0.001 106.423)",100:"oklch(97% 0.001 106.424)",200:"oklch(92.3% 0.003 48.717)",300:"oklch(86.9% 0.005 56.366)",400:"oklch(70.9% 0.01 56.259)",500:"oklch(55.3% 0.013 58.071)",600:"oklch(44.4% 0.011 73.639)",700:"oklch(37.4% 0.01 67.558)",800:"oklch(26.8% 0.007 34.298)",900:"oklch(21.6% 0.006 56.043)",950:"oklch(14.7% 0.004 49.25)"},red:{50:"oklch(97.1% 0.013 17.38)",100:"oklch(93.6% 0.032 17.717)",200:"oklch(88.5% 0.062 18.334)",300:"oklch(80.8% 0.114 19.571)",400:"oklch(70.4% 0.191 22.216)",500:"oklch(63.7% 0.237 25.331)",600:"oklch(57.7% 0.245 27.325)",700:"oklch(50.5% 0.213 27.518)",800:"oklch(44.4% 0.177 26.899)",900:"oklch(39.6% 0.141 25.723)",950:"oklch(25.8% 0.092 26.042)"},orange:{50:"oklch(98% 0.016 73.684)",100:"oklch(95.4% 0.038 75.164)",200:"oklch(90.1% 0.076 70.697)",300:"oklch(83.7% 0.128 66.29)",400:"oklch(75% 0.183 55.934)",500:"oklch(70.5% 0.213 47.604)",600:"oklch(64.6% 0.222 41.116)",700:"oklch(55.3% 0.195 38.402)",800:"oklch(47% 0.157 37.304)",900:"oklch(40.8% 0.123 38.172)",950:"oklch(26.6% 0.079 36.259)"},amber:{50:"oklch(98.7% 0.022 95.277)",100:"oklch(96.2% 0.059 95.617)",200:"oklch(92.4% 0.12 95.746)",300:"oklch(87.9% 0.169 91.605)",400:"oklch(82.8% 0.189 84.429)",500:"oklch(76.9% 0.188 70.08)",600:"oklch(66.6% 0.179 58.318)",700:"oklch(55.5% 0.163 48.998)",800:"oklch(47.3% 0.137 46.201)",900:"oklch(41.4% 0.112 45.904)",950:"oklch(27.9% 0.077 45.635)"},yellow:{50:"oklch(98.7% 0.026 102.212)",100:"oklch(97.3% 0.071 103.193)",200:"oklch(94.5% 0.129 101.54)",300:"oklch(90.5% 0.182 98.111)",400:"oklch(85.2% 0.199 91.936)",500:"oklch(79.5% 0.184 86.047)",600:"oklch(68.1% 0.162 75.834)",700:"oklch(55.4% 0.135 66.442)",800:"oklch(47.6% 0.114 61.907)",900:"oklch(42.1% 0.095 57.708)",950:"oklch(28.6% 0.066 53.813)"},lime:{50:"oklch(98.6% 0.031 120.757)",100:"oklch(96.7% 0.067 122.328)",200:"oklch(93.8% 0.127 124.321)",300:"oklch(89.7% 0.196 126.665)",400:"oklch(84.1% 0.238 128.85)",500:"oklch(76.8% 0.233 130.85)",600:"oklch(64.8% 0.2 131.684)",700:"oklch(53.2% 0.157 131.589)",800:"oklch(45.3% 0.124 130.933)",900:"oklch(40.5% 0.101 131.063)",950:"oklch(27.4% 0.072 132.109)"},green:{50:"oklch(98.2% 0.018 155.826)",100:"oklch(96.2% 0.044 156.743)",200:"oklch(92.5% 0.084 155.995)",300:"oklch(87.1% 0.15 154.449)",400:"oklch(79.2% 0.209 151.711)",500:"oklch(72.3% 0.219 149.579)",600:"oklch(62.7% 0.194 149.214)",700:"oklch(52.7% 0.154 150.069)",800:"oklch(44.8% 0.119 151.328)",900:"oklch(39.3% 0.095 152.535)",950:"oklch(26.6% 0.065 152.934)"},emerald:{50:"oklch(97.9% 0.021 166.113)",100:"oklch(95% 0.052 163.051)",200:"oklch(90.5% 0.093 164.15)",300:"oklch(84.5% 0.143 164.978)",400:"oklch(76.5% 0.177 163.223)",500:"oklch(69.6% 0.17 162.48)",600:"oklch(59.6% 0.145 163.225)",700:"oklch(50.8% 0.118 165.612)",800:"oklch(43.2% 0.095 166.913)",900:"oklch(37.8% 0.077 168.94)",950:"oklch(26.2% 0.051 172.552)"},teal:{50:"oklch(98.4% 0.014 180.72)",100:"oklch(95.3% 0.051 180.801)",200:"oklch(91% 0.096 180.426)",300:"oklch(85.5% 0.138 181.071)",400:"oklch(77.7% 0.152 181.912)",500:"oklch(70.4% 0.14 182.503)",600:"oklch(60% 0.118 184.704)",700:"oklch(51.1% 0.096 186.391)",800:"oklch(43.7% 0.078 188.216)",900:"oklch(38.6% 0.063 188.416)",950:"oklch(27.7% 0.046 192.524)"},cyan:{50:"oklch(98.4% 0.019 200.873)",100:"oklch(95.6% 0.045 203.388)",200:"oklch(91.7% 0.08 205.041)",300:"oklch(86.5% 0.127 207.078)",400:"oklch(78.9% 0.154 211.53)",500:"oklch(71.5% 0.143 215.221)",600:"oklch(60.9% 0.126 221.723)",700:"oklch(52% 0.105 223.128)",800:"oklch(45% 0.085 224.283)",900:"oklch(39.8% 0.07 227.392)",950:"oklch(30.2% 0.056 229.695)"},sky:{50:"oklch(97.7% 0.013 236.62)",100:"oklch(95.1% 0.026 236.824)",200:"oklch(90.1% 0.058 230.902)",300:"oklch(82.8% 0.111 230.318)",400:"oklch(74.6% 0.16 232.661)",500:"oklch(68.5% 0.169 237.323)",600:"oklch(58.8% 0.158 241.966)",700:"oklch(50% 0.134 242.749)",800:"oklch(44.3% 0.11 240.79)",900:"oklch(39.1% 0.09 240.876)",950:"oklch(29.3% 0.066 243.157)"},blue:{50:"oklch(97% 0.014 254.604)",100:"oklch(93.2% 0.032 255.585)",200:"oklch(88.2% 0.059 254.128)",300:"oklch(80.9% 0.105 251.813)",400:"oklch(70.7% 0.165 254.624)",500:"oklch(62.3% 0.214 259.815)",600:"oklch(54.6% 0.245 262.881)",700:"oklch(48.8% 0.243 264.376)",800:"oklch(42.4% 0.199 265.638)",900:"oklch(37.9% 0.146 265.522)",950:"oklch(28.2% 0.091 267.935)"},indigo:{50:"oklch(96.2% 0.018 272.314)",100:"oklch(93% 0.034 272.788)",200:"oklch(87% 0.065 274.039)",300:"oklch(78.5% 0.115 274.713)",400:"oklch(67.3% 0.182 276.935)",500:"oklch(58.5% 0.233 277.117)",600:"oklch(51.1% 0.262 276.966)",700:"oklch(45.7% 0.24 277.023)",800:"oklch(39.8% 0.195 277.366)",900:"oklch(35.9% 0.144 278.697)",950:"oklch(25.7% 0.09 281.288)"},violet:{50:"oklch(96.9% 0.016 293.756)",100:"oklch(94.3% 0.029 294.588)",200:"oklch(89.4% 0.057 293.283)",300:"oklch(81.1% 0.111 293.571)",400:"oklch(70.2% 0.183 293.541)",500:"oklch(60.6% 0.25 292.717)",600:"oklch(54.1% 0.281 293.009)",700:"oklch(49.1% 0.27 292.581)",800:"oklch(43.2% 0.232 292.759)",900:"oklch(38% 0.189 293.745)",950:"oklch(28.3% 0.141 291.089)"},purple:{50:"oklch(97.7% 0.014 308.299)",100:"oklch(94.6% 0.033 307.174)",200:"oklch(90.2% 0.063 306.703)",300:"oklch(82.7% 0.119 306.383)",400:"oklch(71.4% 0.203 305.504)",500:"oklch(62.7% 0.265 303.9)",600:"oklch(55.8% 0.288 302.321)",700:"oklch(49.6% 0.265 301.924)",800:"oklch(43.8% 0.218 303.724)",900:"oklch(38.1% 0.176 304.987)",950:"oklch(29.1% 0.149 302.717)"},fuchsia:{50:"oklch(97.7% 0.017 320.058)",100:"oklch(95.2% 0.037 318.852)",200:"oklch(90.3% 0.076 319.62)",300:"oklch(83.3% 0.145 321.434)",400:"oklch(74% 0.238 322.16)",500:"oklch(66.7% 0.295 322.15)",600:"oklch(59.1% 0.293 322.896)",700:"oklch(51.8% 0.253 323.949)",800:"oklch(45.2% 0.211 324.591)",900:"oklch(40.1% 0.17 325.612)",950:"oklch(29.3% 0.136 325.661)"},pink:{50:"oklch(97.1% 0.014 343.198)",100:"oklch(94.8% 0.028 342.258)",200:"oklch(89.9% 0.061 343.231)",300:"oklch(82.3% 0.12 346.018)",400:"oklch(71.8% 0.202 349.761)",500:"oklch(65.6% 0.241 354.308)",600:"oklch(59.2% 0.249 0.584)",700:"oklch(52.5% 0.223 3.958)",800:"oklch(45.9% 0.187 3.815)",900:"oklch(40.8% 0.153 2.432)",950:"oklch(28.4% 0.109 3.907)"},rose:{50:"oklch(96.9% 0.015 12.422)",100:"oklch(94.1% 0.03 12.58)",200:"oklch(89.2% 0.058 10.001)",300:"oklch(81% 0.117 11.638)",400:"oklch(71.2% 0.194 13.428)",500:"oklch(64.5% 0.246 16.439)",600:"oklch(58.6% 0.253 17.585)",700:"oklch(51.4% 0.222 16.935)",800:"oklch(45.5% 0.188 13.697)",900:"oklch(41% 0.159 10.272)",950:"oklch(27.1% 0.105 12.094)"}};function q2(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Rc={exports:{}};const K2={},Z2=Object.freeze(Object.defineProperty({__proto__:null,default:K2},Symbol.toStringTag,{value:"Module"})),wm=U_(Z2);var zl={exports:{}},Q2=zl.exports,bm;function J2(){return bm||(bm=1,(function(l,e){(function(t,n){n(e)})(Q2,(function(t){var n=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],s=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],a="-----------------------------------------------------------------------------------------------------------------------------------------------------",h="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",p={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},v="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",_={5:v,"5module":v+" export import",6:v+" const class extends export import super"},b=/^in(stanceof)?$/,E=new RegExp("["+h+"]"),N=new RegExp("["+h+a+"]");function O(c,x){for(var D=65536,G=0;G<x.length;G+=2){if(D+=x[G],D>c)return!1;if(D+=x[G+1],D>=c)return!0}return!1}function Q(c,x){return c<65?c===36:c<91?!0:c<97?c===95:c<123?!0:c<=65535?c>=170&&E.test(String.fromCharCode(c)):x===!1?!1:O(c,s)}function W(c,x){return c<48?c===36:c<58?!0:c<65?!1:c<91?!0:c<97?c===95:c<123?!0:c<=65535?c>=170&&N.test(String.fromCharCode(c)):x===!1?!1:O(c,s)||O(c,n)}var ee=function(x,D){D===void 0&&(D={}),this.label=x,this.keyword=D.keyword,this.beforeExpr=!!D.beforeExpr,this.startsExpr=!!D.startsExpr,this.isLoop=!!D.isLoop,this.isAssign=!!D.isAssign,this.prefix=!!D.prefix,this.postfix=!!D.postfix,this.binop=D.binop||null,this.updateContext=null};function K(c,x){return new ee(c,{beforeExpr:!0,binop:x})}var ae={beforeExpr:!0},le={startsExpr:!0},ve={};function we(c,x){return x===void 0&&(x={}),x.keyword=c,ve[c]=new ee(c,x)}var F={num:new ee("num",le),regexp:new ee("regexp",le),string:new ee("string",le),name:new ee("name",le),privateId:new ee("privateId",le),eof:new ee("eof"),bracketL:new ee("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ee("]"),braceL:new ee("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ee("}"),parenL:new ee("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ee(")"),comma:new ee(",",ae),semi:new ee(";",ae),colon:new ee(":",ae),dot:new ee("."),question:new ee("?",ae),questionDot:new ee("?."),arrow:new ee("=>",ae),template:new ee("template"),invalidTemplate:new ee("invalidTemplate"),ellipsis:new ee("...",ae),backQuote:new ee("`",le),dollarBraceL:new ee("${",{beforeExpr:!0,startsExpr:!0}),eq:new ee("=",{beforeExpr:!0,isAssign:!0}),assign:new ee("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ee("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ee("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:K("||",1),logicalAND:K("&&",2),bitwiseOR:K("|",3),bitwiseXOR:K("^",4),bitwiseAND:K("&",5),equality:K("==/!=/===/!==",6),relational:K("</>/<=/>=",7),bitShift:K("<</>>/>>>",8),plusMin:new ee("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:K("%",10),star:K("*",10),slash:K("/",10),starstar:new ee("**",{beforeExpr:!0}),coalesce:K("??",1),_break:we("break"),_case:we("case",ae),_catch:we("catch"),_continue:we("continue"),_debugger:we("debugger"),_default:we("default",ae),_do:we("do",{isLoop:!0,beforeExpr:!0}),_else:we("else",ae),_finally:we("finally"),_for:we("for",{isLoop:!0}),_function:we("function",le),_if:we("if"),_return:we("return",ae),_switch:we("switch"),_throw:we("throw",ae),_try:we("try"),_var:we("var"),_const:we("const"),_while:we("while",{isLoop:!0}),_with:we("with"),_new:we("new",{beforeExpr:!0,startsExpr:!0}),_this:we("this",le),_super:we("super",le),_class:we("class",le),_extends:we("extends",ae),_export:we("export"),_import:we("import",le),_null:we("null",le),_true:we("true",le),_false:we("false",le),_in:we("in",{beforeExpr:!0,binop:7}),_instanceof:we("instanceof",{beforeExpr:!0,binop:7}),_typeof:we("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:we("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:we("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},ze=/\r\n?|\n|\u2028|\u2029/,He=new RegExp(ze.source,"g");function Je(c){return c===10||c===13||c===8232||c===8233}function ut(c,x,D){D===void 0&&(D=c.length);for(var G=x;G<D;G++){var re=c.charCodeAt(G);if(Je(re))return G<D-1&&re===13&&c.charCodeAt(G+1)===10?G+2:G+1}return-1}var Ie=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ke=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,dt=Object.prototype,Ve=dt.hasOwnProperty,Bt=dt.toString,Le=Object.hasOwn||(function(c,x){return Ve.call(c,x)}),wt=Array.isArray||(function(c){return Bt.call(c)==="[object Array]"}),Be=Object.create(null);function Xe(c){return Be[c]||(Be[c]=new RegExp("^(?:"+c.replace(/ /g,"|")+")$"))}function Ze(c){return c<=65535?String.fromCharCode(c):(c-=65536,String.fromCharCode((c>>10)+55296,(c&1023)+56320))}var be=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Fe=function(x,D){this.line=x,this.column=D};Fe.prototype.offset=function(x){return new Fe(this.line,this.column+x)};var yt=function(x,D,G){this.start=D,this.end=G,x.sourceFile!==null&&(this.source=x.sourceFile)};function Ct(c,x){for(var D=1,G=0;;){var re=ut(c,G,x);if(re<0)return new Fe(D,x-G);++D,G=re}}var pt={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Mt=!1;function zt(c){var x={};for(var D in pt)x[D]=c&&Le(c,D)?c[D]:pt[D];if(x.ecmaVersion==="latest"?x.ecmaVersion=1e8:x.ecmaVersion==null?(!Mt&&typeof console=="object"&&console.warn&&(Mt=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),x.ecmaVersion=11):x.ecmaVersion>=2015&&(x.ecmaVersion-=2009),x.allowReserved==null&&(x.allowReserved=x.ecmaVersion<5),(!c||c.allowHashBang==null)&&(x.allowHashBang=x.ecmaVersion>=14),wt(x.onToken)){var G=x.onToken;x.onToken=function(re){return G.push(re)}}return wt(x.onComment)&&(x.onComment=Ut(x,x.onComment)),x}function Ut(c,x){return function(D,G,re,Se,Oe,Ge){var rt={type:D?"Block":"Line",value:G,start:re,end:Se};c.locations&&(rt.loc=new yt(this,Oe,Ge)),c.ranges&&(rt.range=[re,Se]),x.push(rt)}}var _t=1,At=2,en=4,oa=8,Rr=16,Es=32,Di=64,la=128,Fr=256,Ri=512,Fi=_t|At|Fr;function qr(c,x){return At|(c?en:0)|(x?oa:0)}var tn=0,fi=1,Gt=2,Os=3,Ft=4,r=5,u=function(x,D,G){this.options=x=zt(x),this.sourceFile=x.sourceFile,this.keywords=Xe(_[x.ecmaVersion>=6?6:x.sourceType==="module"?"5module":5]);var re="";x.allowReserved!==!0&&(re=p[x.ecmaVersion>=6?6:x.ecmaVersion===5?5:3],x.sourceType==="module"&&(re+=" await")),this.reservedWords=Xe(re);var Se=(re?re+" ":"")+p.strict;this.reservedWordsStrict=Xe(Se),this.reservedWordsStrictBind=Xe(Se+" "+p.strictBind),this.input=String(D),this.containsEsc=!1,G?(this.pos=G,this.lineStart=this.input.lastIndexOf(`
`,G-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(ze).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=F.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=x.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&x.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(_t),this.regexpState=null,this.privateNameStack=[]},f={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};u.prototype.parse=function(){var x=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(x)},f.inFunction.get=function(){return(this.currentVarScope().flags&At)>0},f.inGenerator.get=function(){return(this.currentVarScope().flags&oa)>0},f.inAsync.get=function(){return(this.currentVarScope().flags&en)>0},f.canAwait.get=function(){for(var c=this.scopeStack.length-1;c>=0;c--){var x=this.scopeStack[c],D=x.flags;if(D&(Fr|Ri))return!1;if(D&At)return(D&en)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},f.allowSuper.get=function(){var c=this.currentThisScope(),x=c.flags;return(x&Di)>0||this.options.allowSuperOutsideMethod},f.allowDirectSuper.get=function(){return(this.currentThisScope().flags&la)>0},f.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},f.allowNewDotTarget.get=function(){for(var c=this.scopeStack.length-1;c>=0;c--){var x=this.scopeStack[c],D=x.flags;if(D&(Fr|Ri)||D&At&&!(D&Rr))return!0}return!1},f.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Fr)>0},u.extend=function(){for(var x=[],D=arguments.length;D--;)x[D]=arguments[D];for(var G=this,re=0;re<x.length;re++)G=x[re](G);return G},u.parse=function(x,D){return new this(D,x).parse()},u.parseExpressionAt=function(x,D,G){var re=new this(G,x,D);return re.nextToken(),re.parseExpression()},u.tokenizer=function(x,D){return new this(D,x)},Object.defineProperties(u.prototype,f);var g=u.prototype,m=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;g.strictDirective=function(c){if(this.options.ecmaVersion<5)return!1;for(;;){Ke.lastIndex=c,c+=Ke.exec(this.input)[0].length;var x=m.exec(this.input.slice(c));if(!x)return!1;if((x[1]||x[2])==="use strict"){Ke.lastIndex=c+x[0].length;var D=Ke.exec(this.input),G=D.index+D[0].length,re=this.input.charAt(G);return re===";"||re==="}"||ze.test(D[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(re)||re==="!"&&this.input.charAt(G+1)==="=")}c+=x[0].length,Ke.lastIndex=c,c+=Ke.exec(this.input)[0].length,this.input[c]===";"&&c++}},g.eat=function(c){return this.type===c?(this.next(),!0):!1},g.isContextual=function(c){return this.type===F.name&&this.value===c&&!this.containsEsc},g.eatContextual=function(c){return this.isContextual(c)?(this.next(),!0):!1},g.expectContextual=function(c){this.eatContextual(c)||this.unexpected()},g.canInsertSemicolon=function(){return this.type===F.eof||this.type===F.braceR||ze.test(this.input.slice(this.lastTokEnd,this.start))},g.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},g.semicolon=function(){!this.eat(F.semi)&&!this.insertSemicolon()&&this.unexpected()},g.afterTrailingComma=function(c,x){if(this.type===c)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),x||this.next(),!0},g.expect=function(c){this.eat(c)||this.unexpected()},g.unexpected=function(c){this.raise(c??this.start,"Unexpected token")};var w=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};g.checkPatternErrors=function(c,x){if(c){c.trailingComma>-1&&this.raiseRecoverable(c.trailingComma,"Comma is not permitted after the rest element");var D=x?c.parenthesizedAssign:c.parenthesizedBind;D>-1&&this.raiseRecoverable(D,x?"Assigning to rvalue":"Parenthesized pattern")}},g.checkExpressionErrors=function(c,x){if(!c)return!1;var D=c.shorthandAssign,G=c.doubleProto;if(!x)return D>=0||G>=0;D>=0&&this.raise(D,"Shorthand property assignments are valid only in destructuring patterns"),G>=0&&this.raiseRecoverable(G,"Redefinition of __proto__ property")},g.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},g.isSimpleAssignTarget=function(c){return c.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(c.expression):c.type==="Identifier"||c.type==="MemberExpression"};var S=u.prototype;S.parseTopLevel=function(c){var x=Object.create(null);for(c.body||(c.body=[]);this.type!==F.eof;){var D=this.parseStatement(null,!0,x);c.body.push(D)}if(this.inModule)for(var G=0,re=Object.keys(this.undefinedExports);G<re.length;G+=1){var Se=re[G];this.raiseRecoverable(this.undefinedExports[Se].start,"Export '"+Se+"' is not defined")}return this.adaptDirectivePrologue(c.body),this.next(),c.sourceType=this.options.sourceType,this.finishNode(c,"Program")};var C={kind:"loop"},T={kind:"switch"};S.isLet=function(c){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ke.lastIndex=this.pos;var x=Ke.exec(this.input),D=this.pos+x[0].length,G=this.input.charCodeAt(D);if(G===91||G===92)return!0;if(c)return!1;if(G===123||G>55295&&G<56320)return!0;if(Q(G,!0)){for(var re=D+1;W(G=this.input.charCodeAt(re),!0);)++re;if(G===92||G>55295&&G<56320)return!0;var Se=this.input.slice(D,re);if(!b.test(Se))return!0}return!1},S.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ke.lastIndex=this.pos;var c=Ke.exec(this.input),x=this.pos+c[0].length,D;return!ze.test(this.input.slice(this.pos,x))&&this.input.slice(x,x+8)==="function"&&(x+8===this.input.length||!(W(D=this.input.charCodeAt(x+8))||D>55295&&D<56320))},S.isUsingKeyword=function(c,x){if(this.options.ecmaVersion<17||!this.isContextual(c?"await":"using"))return!1;Ke.lastIndex=this.pos;var D=Ke.exec(this.input),G=this.pos+D[0].length;if(ze.test(this.input.slice(this.pos,G)))return!1;if(c){var re=G+5,Se;if(this.input.slice(G,re)!=="using"||re===this.input.length||W(Se=this.input.charCodeAt(re))||Se>55295&&Se<56320)return!1;Ke.lastIndex=re;var Oe=Ke.exec(this.input);if(Oe&&ze.test(this.input.slice(re,re+Oe[0].length)))return!1}if(x){var Ge=G+2,rt;if(this.input.slice(G,Ge)==="of"&&(Ge===this.input.length||!W(rt=this.input.charCodeAt(Ge))&&!(rt>55295&&rt<56320)))return!1}var Ot=this.input.charCodeAt(G);return Q(Ot,!0)||Ot===92},S.isAwaitUsing=function(c){return this.isUsingKeyword(!0,c)},S.isUsing=function(c){return this.isUsingKeyword(!1,c)},S.parseStatement=function(c,x,D){var G=this.type,re=this.startNode(),Se;switch(this.isLet(c)&&(G=F._var,Se="let"),G){case F._break:case F._continue:return this.parseBreakContinueStatement(re,G.keyword);case F._debugger:return this.parseDebuggerStatement(re);case F._do:return this.parseDoStatement(re);case F._for:return this.parseForStatement(re);case F._function:return c&&(this.strict||c!=="if"&&c!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(re,!1,!c);case F._class:return c&&this.unexpected(),this.parseClass(re,!0);case F._if:return this.parseIfStatement(re);case F._return:return this.parseReturnStatement(re);case F._switch:return this.parseSwitchStatement(re);case F._throw:return this.parseThrowStatement(re);case F._try:return this.parseTryStatement(re);case F._const:case F._var:return Se=Se||this.value,c&&Se!=="var"&&this.unexpected(),this.parseVarStatement(re,Se);case F._while:return this.parseWhileStatement(re);case F._with:return this.parseWithStatement(re);case F.braceL:return this.parseBlock(!0,re);case F.semi:return this.parseEmptyStatement(re);case F._export:case F._import:if(this.options.ecmaVersion>10&&G===F._import){Ke.lastIndex=this.pos;var Oe=Ke.exec(this.input),Ge=this.pos+Oe[0].length,rt=this.input.charCodeAt(Ge);if(rt===40||rt===46)return this.parseExpressionStatement(re,this.parseExpression())}return this.options.allowImportExportEverywhere||(x||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),G===F._import?this.parseImport(re):this.parseExport(re,D);default:if(this.isAsyncFunction())return c&&this.unexpected(),this.next(),this.parseFunctionStatement(re,!0,!c);var Ot=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(Ot)return x&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),Ot==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(re,!1,Ot),this.semicolon(),this.finishNode(re,"VariableDeclaration");var It=this.value,Kt=this.parseExpression();return G===F.name&&Kt.type==="Identifier"&&this.eat(F.colon)?this.parseLabeledStatement(re,It,Kt,c):this.parseExpressionStatement(re,Kt)}},S.parseBreakContinueStatement=function(c,x){var D=x==="break";this.next(),this.eat(F.semi)||this.insertSemicolon()?c.label=null:this.type!==F.name?this.unexpected():(c.label=this.parseIdent(),this.semicolon());for(var G=0;G<this.labels.length;++G){var re=this.labels[G];if((c.label==null||re.name===c.label.name)&&(re.kind!=null&&(D||re.kind==="loop")||c.label&&D))break}return G===this.labels.length&&this.raise(c.start,"Unsyntactic "+x),this.finishNode(c,D?"BreakStatement":"ContinueStatement")},S.parseDebuggerStatement=function(c){return this.next(),this.semicolon(),this.finishNode(c,"DebuggerStatement")},S.parseDoStatement=function(c){return this.next(),this.labels.push(C),c.body=this.parseStatement("do"),this.labels.pop(),this.expect(F._while),c.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(F.semi):this.semicolon(),this.finishNode(c,"DoWhileStatement")},S.parseForStatement=function(c){this.next();var x=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(C),this.enterScope(0),this.expect(F.parenL),this.type===F.semi)return x>-1&&this.unexpected(x),this.parseFor(c,null);var D=this.isLet();if(this.type===F._var||this.type===F._const||D){var G=this.startNode(),re=D?"let":this.value;return this.next(),this.parseVar(G,!0,re),this.finishNode(G,"VariableDeclaration"),this.parseForAfterInit(c,G,x)}var Se=this.isContextual("let"),Oe=!1,Ge=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(Ge){var rt=this.startNode();return this.next(),Ge==="await using"&&this.next(),this.parseVar(rt,!0,Ge),this.finishNode(rt,"VariableDeclaration"),this.parseForAfterInit(c,rt,x)}var Ot=this.containsEsc,It=new w,Kt=this.start,cn=x>-1?this.parseExprSubscripts(It,"await"):this.parseExpression(!0,It);return this.type===F._in||(Oe=this.options.ecmaVersion>=6&&this.isContextual("of"))?(x>-1?(this.type===F._in&&this.unexpected(x),c.await=!0):Oe&&this.options.ecmaVersion>=8&&(cn.start===Kt&&!Ot&&cn.type==="Identifier"&&cn.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(c.await=!1)),Se&&Oe&&this.raise(cn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(cn,!1,It),this.checkLValPattern(cn),this.parseForIn(c,cn)):(this.checkExpressionErrors(It,!0),x>-1&&this.unexpected(x),this.parseFor(c,cn))},S.parseForAfterInit=function(c,x,D){return(this.type===F._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&x.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===F._in?D>-1&&this.unexpected(D):c.await=D>-1),this.parseForIn(c,x)):(D>-1&&this.unexpected(D),this.parseFor(c,x))},S.parseFunctionStatement=function(c,x,D){return this.next(),this.parseFunction(c,R|(D?0:B),!1,x)},S.parseIfStatement=function(c){return this.next(),c.test=this.parseParenExpression(),c.consequent=this.parseStatement("if"),c.alternate=this.eat(F._else)?this.parseStatement("if"):null,this.finishNode(c,"IfStatement")},S.parseReturnStatement=function(c){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(F.semi)||this.insertSemicolon()?c.argument=null:(c.argument=this.parseExpression(),this.semicolon()),this.finishNode(c,"ReturnStatement")},S.parseSwitchStatement=function(c){this.next(),c.discriminant=this.parseParenExpression(),c.cases=[],this.expect(F.braceL),this.labels.push(T),this.enterScope(0);for(var x,D=!1;this.type!==F.braceR;)if(this.type===F._case||this.type===F._default){var G=this.type===F._case;x&&this.finishNode(x,"SwitchCase"),c.cases.push(x=this.startNode()),x.consequent=[],this.next(),G?x.test=this.parseExpression():(D&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),D=!0,x.test=null),this.expect(F.colon)}else x||this.unexpected(),x.consequent.push(this.parseStatement(null));return this.exitScope(),x&&this.finishNode(x,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(c,"SwitchStatement")},S.parseThrowStatement=function(c){return this.next(),ze.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),c.argument=this.parseExpression(),this.semicolon(),this.finishNode(c,"ThrowStatement")};var P=[];S.parseCatchClauseParam=function(){var c=this.parseBindingAtom(),x=c.type==="Identifier";return this.enterScope(x?Es:0),this.checkLValPattern(c,x?Ft:Gt),this.expect(F.parenR),c},S.parseTryStatement=function(c){if(this.next(),c.block=this.parseBlock(),c.handler=null,this.type===F._catch){var x=this.startNode();this.next(),this.eat(F.parenL)?x.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),x.param=null,this.enterScope(0)),x.body=this.parseBlock(!1),this.exitScope(),c.handler=this.finishNode(x,"CatchClause")}return c.finalizer=this.eat(F._finally)?this.parseBlock():null,!c.handler&&!c.finalizer&&this.raise(c.start,"Missing catch or finally clause"),this.finishNode(c,"TryStatement")},S.parseVarStatement=function(c,x,D){return this.next(),this.parseVar(c,!1,x,D),this.semicolon(),this.finishNode(c,"VariableDeclaration")},S.parseWhileStatement=function(c){return this.next(),c.test=this.parseParenExpression(),this.labels.push(C),c.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(c,"WhileStatement")},S.parseWithStatement=function(c){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),c.object=this.parseParenExpression(),c.body=this.parseStatement("with"),this.finishNode(c,"WithStatement")},S.parseEmptyStatement=function(c){return this.next(),this.finishNode(c,"EmptyStatement")},S.parseLabeledStatement=function(c,x,D,G){for(var re=0,Se=this.labels;re<Se.length;re+=1){var Oe=Se[re];Oe.name===x&&this.raise(D.start,"Label '"+x+"' is already declared")}for(var Ge=this.type.isLoop?"loop":this.type===F._switch?"switch":null,rt=this.labels.length-1;rt>=0;rt--){var Ot=this.labels[rt];if(Ot.statementStart===c.start)Ot.statementStart=this.start,Ot.kind=Ge;else break}return this.labels.push({name:x,kind:Ge,statementStart:this.start}),c.body=this.parseStatement(G?G.indexOf("label")===-1?G+"label":G:"label"),this.labels.pop(),c.label=D,this.finishNode(c,"LabeledStatement")},S.parseExpressionStatement=function(c,x){return c.expression=x,this.semicolon(),this.finishNode(c,"ExpressionStatement")},S.parseBlock=function(c,x,D){for(c===void 0&&(c=!0),x===void 0&&(x=this.startNode()),x.body=[],this.expect(F.braceL),c&&this.enterScope(0);this.type!==F.braceR;){var G=this.parseStatement(null);x.body.push(G)}return D&&(this.strict=!1),this.next(),c&&this.exitScope(),this.finishNode(x,"BlockStatement")},S.parseFor=function(c,x){return c.init=x,this.expect(F.semi),c.test=this.type===F.semi?null:this.parseExpression(),this.expect(F.semi),c.update=this.type===F.parenR?null:this.parseExpression(),this.expect(F.parenR),c.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(c,"ForStatement")},S.parseForIn=function(c,x){var D=this.type===F._in;return this.next(),x.type==="VariableDeclaration"&&x.declarations[0].init!=null&&(!D||this.options.ecmaVersion<8||this.strict||x.kind!=="var"||x.declarations[0].id.type!=="Identifier")&&this.raise(x.start,(D?"for-in":"for-of")+" loop variable declaration may not have an initializer"),c.left=x,c.right=D?this.parseExpression():this.parseMaybeAssign(),this.expect(F.parenR),c.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(c,D?"ForInStatement":"ForOfStatement")},S.parseVar=function(c,x,D,G){for(c.declarations=[],c.kind=D;;){var re=this.startNode();if(this.parseVarId(re,D),this.eat(F.eq)?re.init=this.parseMaybeAssign(x):!G&&D==="const"&&!(this.type===F._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!G&&(D==="using"||D==="await using")&&this.options.ecmaVersion>=17&&this.type!==F._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+D+" declaration"):!G&&re.id.type!=="Identifier"&&!(x&&(this.type===F._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):re.init=null,c.declarations.push(this.finishNode(re,"VariableDeclarator")),!this.eat(F.comma))break}return c},S.parseVarId=function(c,x){c.id=x==="using"||x==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(c.id,x==="var"?fi:Gt,!1)};var R=1,B=2,j=4;S.parseFunction=function(c,x,D,G,re){this.initFunction(c),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!G)&&(this.type===F.star&&x&B&&this.unexpected(),c.generator=this.eat(F.star)),this.options.ecmaVersion>=8&&(c.async=!!G),x&R&&(c.id=x&j&&this.type!==F.name?null:this.parseIdent(),c.id&&!(x&B)&&this.checkLValSimple(c.id,this.strict||c.generator||c.async?this.treatFunctionsAsVar?fi:Gt:Os));var Se=this.yieldPos,Oe=this.awaitPos,Ge=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(qr(c.async,c.generator)),x&R||(c.id=this.type===F.name?this.parseIdent():null),this.parseFunctionParams(c),this.parseFunctionBody(c,D,!1,re),this.yieldPos=Se,this.awaitPos=Oe,this.awaitIdentPos=Ge,this.finishNode(c,x&R?"FunctionDeclaration":"FunctionExpression")},S.parseFunctionParams=function(c){this.expect(F.parenL),c.params=this.parseBindingList(F.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},S.parseClass=function(c,x){this.next();var D=this.strict;this.strict=!0,this.parseClassId(c,x),this.parseClassSuper(c);var G=this.enterClassBody(),re=this.startNode(),Se=!1;for(re.body=[],this.expect(F.braceL);this.type!==F.braceR;){var Oe=this.parseClassElement(c.superClass!==null);Oe&&(re.body.push(Oe),Oe.type==="MethodDefinition"&&Oe.kind==="constructor"?(Se&&this.raiseRecoverable(Oe.start,"Duplicate constructor in the same class"),Se=!0):Oe.key&&Oe.key.type==="PrivateIdentifier"&&I(G,Oe)&&this.raiseRecoverable(Oe.key.start,"Identifier '#"+Oe.key.name+"' has already been declared"))}return this.strict=D,this.next(),c.body=this.finishNode(re,"ClassBody"),this.exitClassBody(),this.finishNode(c,x?"ClassDeclaration":"ClassExpression")},S.parseClassElement=function(c){if(this.eat(F.semi))return null;var x=this.options.ecmaVersion,D=this.startNode(),G="",re=!1,Se=!1,Oe="method",Ge=!1;if(this.eatContextual("static")){if(x>=13&&this.eat(F.braceL))return this.parseClassStaticBlock(D),D;this.isClassElementNameStart()||this.type===F.star?Ge=!0:G="static"}if(D.static=Ge,!G&&x>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===F.star)&&!this.canInsertSemicolon()?Se=!0:G="async"),!G&&(x>=9||!Se)&&this.eat(F.star)&&(re=!0),!G&&!Se&&!re){var rt=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Oe=rt:G=rt)}if(G?(D.computed=!1,D.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),D.key.name=G,this.finishNode(D.key,"Identifier")):this.parseClassElementName(D),x<13||this.type===F.parenL||Oe!=="method"||re||Se){var Ot=!D.static&&Y(D,"constructor"),It=Ot&&c;Ot&&Oe!=="method"&&this.raise(D.key.start,"Constructor can't have get/set modifier"),D.kind=Ot?"constructor":Oe,this.parseClassMethod(D,re,Se,It)}else this.parseClassField(D);return D},S.isClassElementNameStart=function(){return this.type===F.name||this.type===F.privateId||this.type===F.num||this.type===F.string||this.type===F.bracketL||this.type.keyword},S.parseClassElementName=function(c){this.type===F.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),c.computed=!1,c.key=this.parsePrivateIdent()):this.parsePropertyName(c)},S.parseClassMethod=function(c,x,D,G){var re=c.key;c.kind==="constructor"?(x&&this.raise(re.start,"Constructor can't be a generator"),D&&this.raise(re.start,"Constructor can't be an async method")):c.static&&Y(c,"prototype")&&this.raise(re.start,"Classes may not have a static property named prototype");var Se=c.value=this.parseMethod(x,D,G);return c.kind==="get"&&Se.params.length!==0&&this.raiseRecoverable(Se.start,"getter should have no params"),c.kind==="set"&&Se.params.length!==1&&this.raiseRecoverable(Se.start,"setter should have exactly one param"),c.kind==="set"&&Se.params[0].type==="RestElement"&&this.raiseRecoverable(Se.params[0].start,"Setter cannot use rest params"),this.finishNode(c,"MethodDefinition")},S.parseClassField=function(c){return Y(c,"constructor")?this.raise(c.key.start,"Classes can't have a field named 'constructor'"):c.static&&Y(c,"prototype")&&this.raise(c.key.start,"Classes can't have a static field named 'prototype'"),this.eat(F.eq)?(this.enterScope(Ri|Di),c.value=this.parseMaybeAssign(),this.exitScope()):c.value=null,this.semicolon(),this.finishNode(c,"PropertyDefinition")},S.parseClassStaticBlock=function(c){c.body=[];var x=this.labels;for(this.labels=[],this.enterScope(Fr|Di);this.type!==F.braceR;){var D=this.parseStatement(null);c.body.push(D)}return this.next(),this.exitScope(),this.labels=x,this.finishNode(c,"StaticBlock")},S.parseClassId=function(c,x){this.type===F.name?(c.id=this.parseIdent(),x&&this.checkLValSimple(c.id,Gt,!1)):(x===!0&&this.unexpected(),c.id=null)},S.parseClassSuper=function(c){c.superClass=this.eat(F._extends)?this.parseExprSubscripts(null,!1):null},S.enterClassBody=function(){var c={declared:Object.create(null),used:[]};return this.privateNameStack.push(c),c.declared},S.exitClassBody=function(){var c=this.privateNameStack.pop(),x=c.declared,D=c.used;if(this.options.checkPrivateFields)for(var G=this.privateNameStack.length,re=G===0?null:this.privateNameStack[G-1],Se=0;Se<D.length;++Se){var Oe=D[Se];Le(x,Oe.name)||(re?re.used.push(Oe):this.raiseRecoverable(Oe.start,"Private field '#"+Oe.name+"' must be declared in an enclosing class"))}};function I(c,x){var D=x.key.name,G=c[D],re="true";return x.type==="MethodDefinition"&&(x.kind==="get"||x.kind==="set")&&(re=(x.static?"s":"i")+x.kind),G==="iget"&&re==="iset"||G==="iset"&&re==="iget"||G==="sget"&&re==="sset"||G==="sset"&&re==="sget"?(c[D]="true",!1):G?!0:(c[D]=re,!1)}function Y(c,x){var D=c.computed,G=c.key;return!D&&(G.type==="Identifier"&&G.name===x||G.type==="Literal"&&G.value===x)}S.parseExportAllDeclaration=function(c,x){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(c.exported=this.parseModuleExportName(),this.checkExport(x,c.exported,this.lastTokStart)):c.exported=null),this.expectContextual("from"),this.type!==F.string&&this.unexpected(),c.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(c.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(c,"ExportAllDeclaration")},S.parseExport=function(c,x){if(this.next(),this.eat(F.star))return this.parseExportAllDeclaration(c,x);if(this.eat(F._default))return this.checkExport(x,"default",this.lastTokStart),c.declaration=this.parseExportDefaultDeclaration(),this.finishNode(c,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())c.declaration=this.parseExportDeclaration(c),c.declaration.type==="VariableDeclaration"?this.checkVariableExport(x,c.declaration.declarations):this.checkExport(x,c.declaration.id,c.declaration.id.start),c.specifiers=[],c.source=null,this.options.ecmaVersion>=16&&(c.attributes=[]);else{if(c.declaration=null,c.specifiers=this.parseExportSpecifiers(x),this.eatContextual("from"))this.type!==F.string&&this.unexpected(),c.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(c.attributes=this.parseWithClause());else{for(var D=0,G=c.specifiers;D<G.length;D+=1){var re=G[D];this.checkUnreserved(re.local),this.checkLocalExport(re.local),re.local.type==="Literal"&&this.raise(re.local.start,"A string literal cannot be used as an exported binding without `from`.")}c.source=null,this.options.ecmaVersion>=16&&(c.attributes=[])}this.semicolon()}return this.finishNode(c,"ExportNamedDeclaration")},S.parseExportDeclaration=function(c){return this.parseStatement(null)},S.parseExportDefaultDeclaration=function(){var c;if(this.type===F._function||(c=this.isAsyncFunction())){var x=this.startNode();return this.next(),c&&this.next(),this.parseFunction(x,R|j,!1,c)}else if(this.type===F._class){var D=this.startNode();return this.parseClass(D,"nullableID")}else{var G=this.parseMaybeAssign();return this.semicolon(),G}},S.checkExport=function(c,x,D){c&&(typeof x!="string"&&(x=x.type==="Identifier"?x.name:x.value),Le(c,x)&&this.raiseRecoverable(D,"Duplicate export '"+x+"'"),c[x]=!0)},S.checkPatternExport=function(c,x){var D=x.type;if(D==="Identifier")this.checkExport(c,x,x.start);else if(D==="ObjectPattern")for(var G=0,re=x.properties;G<re.length;G+=1){var Se=re[G];this.checkPatternExport(c,Se)}else if(D==="ArrayPattern")for(var Oe=0,Ge=x.elements;Oe<Ge.length;Oe+=1){var rt=Ge[Oe];rt&&this.checkPatternExport(c,rt)}else D==="Property"?this.checkPatternExport(c,x.value):D==="AssignmentPattern"?this.checkPatternExport(c,x.left):D==="RestElement"&&this.checkPatternExport(c,x.argument)},S.checkVariableExport=function(c,x){if(c)for(var D=0,G=x;D<G.length;D+=1){var re=G[D];this.checkPatternExport(c,re.id)}},S.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},S.parseExportSpecifier=function(c){var x=this.startNode();return x.local=this.parseModuleExportName(),x.exported=this.eatContextual("as")?this.parseModuleExportName():x.local,this.checkExport(c,x.exported,x.exported.start),this.finishNode(x,"ExportSpecifier")},S.parseExportSpecifiers=function(c){var x=[],D=!0;for(this.expect(F.braceL);!this.eat(F.braceR);){if(D)D=!1;else if(this.expect(F.comma),this.afterTrailingComma(F.braceR))break;x.push(this.parseExportSpecifier(c))}return x},S.parseImport=function(c){return this.next(),this.type===F.string?(c.specifiers=P,c.source=this.parseExprAtom()):(c.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),c.source=this.type===F.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(c.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(c,"ImportDeclaration")},S.parseImportSpecifier=function(){var c=this.startNode();return c.imported=this.parseModuleExportName(),this.eatContextual("as")?c.local=this.parseIdent():(this.checkUnreserved(c.imported),c.local=c.imported),this.checkLValSimple(c.local,Gt),this.finishNode(c,"ImportSpecifier")},S.parseImportDefaultSpecifier=function(){var c=this.startNode();return c.local=this.parseIdent(),this.checkLValSimple(c.local,Gt),this.finishNode(c,"ImportDefaultSpecifier")},S.parseImportNamespaceSpecifier=function(){var c=this.startNode();return this.next(),this.expectContextual("as"),c.local=this.parseIdent(),this.checkLValSimple(c.local,Gt),this.finishNode(c,"ImportNamespaceSpecifier")},S.parseImportSpecifiers=function(){var c=[],x=!0;if(this.type===F.name&&(c.push(this.parseImportDefaultSpecifier()),!this.eat(F.comma)))return c;if(this.type===F.star)return c.push(this.parseImportNamespaceSpecifier()),c;for(this.expect(F.braceL);!this.eat(F.braceR);){if(x)x=!1;else if(this.expect(F.comma),this.afterTrailingComma(F.braceR))break;c.push(this.parseImportSpecifier())}return c},S.parseWithClause=function(){var c=[];if(!this.eat(F._with))return c;this.expect(F.braceL);for(var x={},D=!0;!this.eat(F.braceR);){if(D)D=!1;else if(this.expect(F.comma),this.afterTrailingComma(F.braceR))break;var G=this.parseImportAttribute(),re=G.key.type==="Identifier"?G.key.name:G.key.value;Le(x,re)&&this.raiseRecoverable(G.key.start,"Duplicate attribute key '"+re+"'"),x[re]=!0,c.push(G)}return c},S.parseImportAttribute=function(){var c=this.startNode();return c.key=this.type===F.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(F.colon),this.type!==F.string&&this.unexpected(),c.value=this.parseExprAtom(),this.finishNode(c,"ImportAttribute")},S.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===F.string){var c=this.parseLiteral(this.value);return be.test(c.value)&&this.raise(c.start,"An export name cannot include a lone surrogate."),c}return this.parseIdent(!0)},S.adaptDirectivePrologue=function(c){for(var x=0;x<c.length&&this.isDirectiveCandidate(c[x]);++x)c[x].directive=c[x].expression.raw.slice(1,-1)},S.isDirectiveCandidate=function(c){return this.options.ecmaVersion>=5&&c.type==="ExpressionStatement"&&c.expression.type==="Literal"&&typeof c.expression.value=="string"&&(this.input[c.start]==='"'||this.input[c.start]==="'")};var z=u.prototype;z.toAssignable=function(c,x,D){if(this.options.ecmaVersion>=6&&c)switch(c.type){case"Identifier":this.inAsync&&c.name==="await"&&this.raise(c.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":c.type="ObjectPattern",D&&this.checkPatternErrors(D,!0);for(var G=0,re=c.properties;G<re.length;G+=1){var Se=re[G];this.toAssignable(Se,x),Se.type==="RestElement"&&(Se.argument.type==="ArrayPattern"||Se.argument.type==="ObjectPattern")&&this.raise(Se.argument.start,"Unexpected token")}break;case"Property":c.kind!=="init"&&this.raise(c.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(c.value,x);break;case"ArrayExpression":c.type="ArrayPattern",D&&this.checkPatternErrors(D,!0),this.toAssignableList(c.elements,x);break;case"SpreadElement":c.type="RestElement",this.toAssignable(c.argument,x),c.argument.type==="AssignmentPattern"&&this.raise(c.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":c.operator!=="="&&this.raise(c.left.end,"Only '=' operator can be used for specifying default value."),c.type="AssignmentPattern",delete c.operator,this.toAssignable(c.left,x);break;case"ParenthesizedExpression":this.toAssignable(c.expression,x,D);break;case"ChainExpression":this.raiseRecoverable(c.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!x)break;default:this.raise(c.start,"Assigning to rvalue")}else D&&this.checkPatternErrors(D,!0);return c},z.toAssignableList=function(c,x){for(var D=c.length,G=0;G<D;G++){var re=c[G];re&&this.toAssignable(re,x)}if(D){var Se=c[D-1];this.options.ecmaVersion===6&&x&&Se&&Se.type==="RestElement"&&Se.argument.type!=="Identifier"&&this.unexpected(Se.argument.start)}return c},z.parseSpread=function(c){var x=this.startNode();return this.next(),x.argument=this.parseMaybeAssign(!1,c),this.finishNode(x,"SpreadElement")},z.parseRestBinding=function(){var c=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==F.name&&this.unexpected(),c.argument=this.parseBindingAtom(),this.finishNode(c,"RestElement")},z.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case F.bracketL:var c=this.startNode();return this.next(),c.elements=this.parseBindingList(F.bracketR,!0,!0),this.finishNode(c,"ArrayPattern");case F.braceL:return this.parseObj(!0)}return this.parseIdent()},z.parseBindingList=function(c,x,D,G){for(var re=[],Se=!0;!this.eat(c);)if(Se?Se=!1:this.expect(F.comma),x&&this.type===F.comma)re.push(null);else{if(D&&this.afterTrailingComma(c))break;if(this.type===F.ellipsis){var Oe=this.parseRestBinding();this.parseBindingListItem(Oe),re.push(Oe),this.type===F.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(c);break}else re.push(this.parseAssignableListItem(G))}return re},z.parseAssignableListItem=function(c){var x=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(x),x},z.parseBindingListItem=function(c){return c},z.parseMaybeDefault=function(c,x,D){if(D=D||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(F.eq))return D;var G=this.startNodeAt(c,x);return G.left=D,G.right=this.parseMaybeAssign(),this.finishNode(G,"AssignmentPattern")},z.checkLValSimple=function(c,x,D){x===void 0&&(x=tn);var G=x!==tn;switch(c.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(c.name)&&this.raiseRecoverable(c.start,(G?"Binding ":"Assigning to ")+c.name+" in strict mode"),G&&(x===Gt&&c.name==="let"&&this.raiseRecoverable(c.start,"let is disallowed as a lexically bound name"),D&&(Le(D,c.name)&&this.raiseRecoverable(c.start,"Argument name clash"),D[c.name]=!0),x!==r&&this.declareName(c.name,x,c.start));break;case"ChainExpression":this.raiseRecoverable(c.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":G&&this.raiseRecoverable(c.start,"Binding member expression");break;case"ParenthesizedExpression":return G&&this.raiseRecoverable(c.start,"Binding parenthesized expression"),this.checkLValSimple(c.expression,x,D);default:this.raise(c.start,(G?"Binding":"Assigning to")+" rvalue")}},z.checkLValPattern=function(c,x,D){switch(x===void 0&&(x=tn),c.type){case"ObjectPattern":for(var G=0,re=c.properties;G<re.length;G+=1){var Se=re[G];this.checkLValInnerPattern(Se,x,D)}break;case"ArrayPattern":for(var Oe=0,Ge=c.elements;Oe<Ge.length;Oe+=1){var rt=Ge[Oe];rt&&this.checkLValInnerPattern(rt,x,D)}break;default:this.checkLValSimple(c,x,D)}},z.checkLValInnerPattern=function(c,x,D){switch(x===void 0&&(x=tn),c.type){case"Property":this.checkLValInnerPattern(c.value,x,D);break;case"AssignmentPattern":this.checkLValPattern(c.left,x,D);break;case"RestElement":this.checkLValPattern(c.argument,x,D);break;default:this.checkLValPattern(c,x,D)}};var H=function(x,D,G,re,Se){this.token=x,this.isExpr=!!D,this.preserveSpace=!!G,this.override=re,this.generator=!!Se},L={b_stat:new H("{",!1),b_expr:new H("{",!0),b_tmpl:new H("${",!1),p_stat:new H("(",!1),p_expr:new H("(",!0),q_tmpl:new H("`",!0,!0,function(c){return c.tryReadTemplateToken()}),f_stat:new H("function",!1),f_expr:new H("function",!0),f_expr_gen:new H("function",!0,!1,null,!0),f_gen:new H("function",!1,!1,null,!0)},U=u.prototype;U.initialContext=function(){return[L.b_stat]},U.curContext=function(){return this.context[this.context.length-1]},U.braceIsBlock=function(c){var x=this.curContext();return x===L.f_expr||x===L.f_stat?!0:c===F.colon&&(x===L.b_stat||x===L.b_expr)?!x.isExpr:c===F._return||c===F.name&&this.exprAllowed?ze.test(this.input.slice(this.lastTokEnd,this.start)):c===F._else||c===F.semi||c===F.eof||c===F.parenR||c===F.arrow?!0:c===F.braceL?x===L.b_stat:c===F._var||c===F._const||c===F.name?!1:!this.exprAllowed},U.inGeneratorContext=function(){for(var c=this.context.length-1;c>=1;c--){var x=this.context[c];if(x.token==="function")return x.generator}return!1},U.updateContext=function(c){var x,D=this.type;D.keyword&&c===F.dot?this.exprAllowed=!1:(x=D.updateContext)?x.call(this,c):this.exprAllowed=D.beforeExpr},U.overrideContext=function(c){this.curContext()!==c&&(this.context[this.context.length-1]=c)},F.parenR.updateContext=F.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var c=this.context.pop();c===L.b_stat&&this.curContext().token==="function"&&(c=this.context.pop()),this.exprAllowed=!c.isExpr},F.braceL.updateContext=function(c){this.context.push(this.braceIsBlock(c)?L.b_stat:L.b_expr),this.exprAllowed=!0},F.dollarBraceL.updateContext=function(){this.context.push(L.b_tmpl),this.exprAllowed=!0},F.parenL.updateContext=function(c){var x=c===F._if||c===F._for||c===F._with||c===F._while;this.context.push(x?L.p_stat:L.p_expr),this.exprAllowed=!0},F.incDec.updateContext=function(){},F._function.updateContext=F._class.updateContext=function(c){c.beforeExpr&&c!==F._else&&!(c===F.semi&&this.curContext()!==L.p_stat)&&!(c===F._return&&ze.test(this.input.slice(this.lastTokEnd,this.start)))&&!((c===F.colon||c===F.braceL)&&this.curContext()===L.b_stat)?this.context.push(L.f_expr):this.context.push(L.f_stat),this.exprAllowed=!1},F.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},F.backQuote.updateContext=function(){this.curContext()===L.q_tmpl?this.context.pop():this.context.push(L.q_tmpl),this.exprAllowed=!1},F.star.updateContext=function(c){if(c===F._function){var x=this.context.length-1;this.context[x]===L.f_expr?this.context[x]=L.f_expr_gen:this.context[x]=L.f_gen}this.exprAllowed=!0},F.name.updateContext=function(c){var x=!1;this.options.ecmaVersion>=6&&c!==F.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(x=!0),this.exprAllowed=x};var A=u.prototype;A.checkPropClash=function(c,x,D){if(!(this.options.ecmaVersion>=9&&c.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(c.computed||c.method||c.shorthand))){var G=c.key,re;switch(G.type){case"Identifier":re=G.name;break;case"Literal":re=String(G.value);break;default:return}var Se=c.kind;if(this.options.ecmaVersion>=6){re==="__proto__"&&Se==="init"&&(x.proto&&(D?D.doubleProto<0&&(D.doubleProto=G.start):this.raiseRecoverable(G.start,"Redefinition of __proto__ property")),x.proto=!0);return}re="$"+re;var Oe=x[re];if(Oe){var Ge;Se==="init"?Ge=this.strict&&Oe.init||Oe.get||Oe.set:Ge=Oe.init||Oe[Se],Ge&&this.raiseRecoverable(G.start,"Redefinition of property")}else Oe=x[re]={init:!1,get:!1,set:!1};Oe[Se]=!0}},A.parseExpression=function(c,x){var D=this.start,G=this.startLoc,re=this.parseMaybeAssign(c,x);if(this.type===F.comma){var Se=this.startNodeAt(D,G);for(Se.expressions=[re];this.eat(F.comma);)Se.expressions.push(this.parseMaybeAssign(c,x));return this.finishNode(Se,"SequenceExpression")}return re},A.parseMaybeAssign=function(c,x,D){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(c);this.exprAllowed=!1}var G=!1,re=-1,Se=-1,Oe=-1;x?(re=x.parenthesizedAssign,Se=x.trailingComma,Oe=x.doubleProto,x.parenthesizedAssign=x.trailingComma=-1):(x=new w,G=!0);var Ge=this.start,rt=this.startLoc;(this.type===F.parenL||this.type===F.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=c==="await");var Ot=this.parseMaybeConditional(c,x);if(D&&(Ot=D.call(this,Ot,Ge,rt)),this.type.isAssign){var It=this.startNodeAt(Ge,rt);return It.operator=this.value,this.type===F.eq&&(Ot=this.toAssignable(Ot,!1,x)),G||(x.parenthesizedAssign=x.trailingComma=x.doubleProto=-1),x.shorthandAssign>=Ot.start&&(x.shorthandAssign=-1),this.type===F.eq?this.checkLValPattern(Ot):this.checkLValSimple(Ot),It.left=Ot,this.next(),It.right=this.parseMaybeAssign(c),Oe>-1&&(x.doubleProto=Oe),this.finishNode(It,"AssignmentExpression")}else G&&this.checkExpressionErrors(x,!0);return re>-1&&(x.parenthesizedAssign=re),Se>-1&&(x.trailingComma=Se),Ot},A.parseMaybeConditional=function(c,x){var D=this.start,G=this.startLoc,re=this.parseExprOps(c,x);if(this.checkExpressionErrors(x))return re;if(this.eat(F.question)){var Se=this.startNodeAt(D,G);return Se.test=re,Se.consequent=this.parseMaybeAssign(),this.expect(F.colon),Se.alternate=this.parseMaybeAssign(c),this.finishNode(Se,"ConditionalExpression")}return re},A.parseExprOps=function(c,x){var D=this.start,G=this.startLoc,re=this.parseMaybeUnary(x,!1,!1,c);return this.checkExpressionErrors(x)||re.start===D&&re.type==="ArrowFunctionExpression"?re:this.parseExprOp(re,D,G,-1,c)},A.parseExprOp=function(c,x,D,G,re){var Se=this.type.binop;if(Se!=null&&(!re||this.type!==F._in)&&Se>G){var Oe=this.type===F.logicalOR||this.type===F.logicalAND,Ge=this.type===F.coalesce;Ge&&(Se=F.logicalAND.binop);var rt=this.value;this.next();var Ot=this.start,It=this.startLoc,Kt=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,re),Ot,It,Se,re),cn=this.buildBinary(x,D,c,Kt,rt,Oe||Ge);return(Oe&&this.type===F.coalesce||Ge&&(this.type===F.logicalOR||this.type===F.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(cn,x,D,G,re)}return c},A.buildBinary=function(c,x,D,G,re,Se){G.type==="PrivateIdentifier"&&this.raise(G.start,"Private identifier can only be left side of binary expression");var Oe=this.startNodeAt(c,x);return Oe.left=D,Oe.operator=re,Oe.right=G,this.finishNode(Oe,Se?"LogicalExpression":"BinaryExpression")},A.parseMaybeUnary=function(c,x,D,G){var re=this.start,Se=this.startLoc,Oe;if(this.isContextual("await")&&this.canAwait)Oe=this.parseAwait(G),x=!0;else if(this.type.prefix){var Ge=this.startNode(),rt=this.type===F.incDec;Ge.operator=this.value,Ge.prefix=!0,this.next(),Ge.argument=this.parseMaybeUnary(null,!0,rt,G),this.checkExpressionErrors(c,!0),rt?this.checkLValSimple(Ge.argument):this.strict&&Ge.operator==="delete"&&V(Ge.argument)?this.raiseRecoverable(Ge.start,"Deleting local variable in strict mode"):Ge.operator==="delete"&&q(Ge.argument)?this.raiseRecoverable(Ge.start,"Private fields can not be deleted"):x=!0,Oe=this.finishNode(Ge,rt?"UpdateExpression":"UnaryExpression")}else if(!x&&this.type===F.privateId)(G||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Oe=this.parsePrivateIdent(),this.type!==F._in&&this.unexpected();else{if(Oe=this.parseExprSubscripts(c,G),this.checkExpressionErrors(c))return Oe;for(;this.type.postfix&&!this.canInsertSemicolon();){var Ot=this.startNodeAt(re,Se);Ot.operator=this.value,Ot.prefix=!1,Ot.argument=Oe,this.checkLValSimple(Oe),this.next(),Oe=this.finishNode(Ot,"UpdateExpression")}}if(!D&&this.eat(F.starstar))if(x)this.unexpected(this.lastTokStart);else return this.buildBinary(re,Se,Oe,this.parseMaybeUnary(null,!1,!1,G),"**",!1);else return Oe};function V(c){return c.type==="Identifier"||c.type==="ParenthesizedExpression"&&V(c.expression)}function q(c){return c.type==="MemberExpression"&&c.property.type==="PrivateIdentifier"||c.type==="ChainExpression"&&q(c.expression)||c.type==="ParenthesizedExpression"&&q(c.expression)}A.parseExprSubscripts=function(c,x){var D=this.start,G=this.startLoc,re=this.parseExprAtom(c,x);if(re.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return re;var Se=this.parseSubscripts(re,D,G,!1,x);return c&&Se.type==="MemberExpression"&&(c.parenthesizedAssign>=Se.start&&(c.parenthesizedAssign=-1),c.parenthesizedBind>=Se.start&&(c.parenthesizedBind=-1),c.trailingComma>=Se.start&&(c.trailingComma=-1)),Se},A.parseSubscripts=function(c,x,D,G,re){for(var Se=this.options.ecmaVersion>=8&&c.type==="Identifier"&&c.name==="async"&&this.lastTokEnd===c.end&&!this.canInsertSemicolon()&&c.end-c.start===5&&this.potentialArrowAt===c.start,Oe=!1;;){var Ge=this.parseSubscript(c,x,D,G,Se,Oe,re);if(Ge.optional&&(Oe=!0),Ge===c||Ge.type==="ArrowFunctionExpression"){if(Oe){var rt=this.startNodeAt(x,D);rt.expression=Ge,Ge=this.finishNode(rt,"ChainExpression")}return Ge}c=Ge}},A.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(F.arrow)},A.parseSubscriptAsyncArrow=function(c,x,D,G){return this.parseArrowExpression(this.startNodeAt(c,x),D,!0,G)},A.parseSubscript=function(c,x,D,G,re,Se,Oe){var Ge=this.options.ecmaVersion>=11,rt=Ge&&this.eat(F.questionDot);G&&rt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Ot=this.eat(F.bracketL);if(Ot||rt&&this.type!==F.parenL&&this.type!==F.backQuote||this.eat(F.dot)){var It=this.startNodeAt(x,D);It.object=c,Ot?(It.property=this.parseExpression(),this.expect(F.bracketR)):this.type===F.privateId&&c.type!=="Super"?It.property=this.parsePrivateIdent():It.property=this.parseIdent(this.options.allowReserved!=="never"),It.computed=!!Ot,Ge&&(It.optional=rt),c=this.finishNode(It,"MemberExpression")}else if(!G&&this.eat(F.parenL)){var Kt=new w,cn=this.yieldPos,Kr=this.awaitPos,pi=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Zr=this.parseExprList(F.parenR,this.options.ecmaVersion>=8,!1,Kt);if(re&&!rt&&this.shouldParseAsyncArrow())return this.checkPatternErrors(Kt,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=cn,this.awaitPos=Kr,this.awaitIdentPos=pi,this.parseSubscriptAsyncArrow(x,D,Zr,Oe);this.checkExpressionErrors(Kt,!0),this.yieldPos=cn||this.yieldPos,this.awaitPos=Kr||this.awaitPos,this.awaitIdentPos=pi||this.awaitIdentPos;var Qr=this.startNodeAt(x,D);Qr.callee=c,Qr.arguments=Zr,Ge&&(Qr.optional=rt),c=this.finishNode(Qr,"CallExpression")}else if(this.type===F.backQuote){(rt||Se)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var zr=this.startNodeAt(x,D);zr.tag=c,zr.quasi=this.parseTemplate({isTagged:!0}),c=this.finishNode(zr,"TaggedTemplateExpression")}return c},A.parseExprAtom=function(c,x,D){this.type===F.slash&&this.readRegexp();var G,re=this.potentialArrowAt===this.start;switch(this.type){case F._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),G=this.startNode(),this.next(),this.type===F.parenL&&!this.allowDirectSuper&&this.raise(G.start,"super() call outside constructor of a subclass"),this.type!==F.dot&&this.type!==F.bracketL&&this.type!==F.parenL&&this.unexpected(),this.finishNode(G,"Super");case F._this:return G=this.startNode(),this.next(),this.finishNode(G,"ThisExpression");case F.name:var Se=this.start,Oe=this.startLoc,Ge=this.containsEsc,rt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Ge&&rt.name==="async"&&!this.canInsertSemicolon()&&this.eat(F._function))return this.overrideContext(L.f_expr),this.parseFunction(this.startNodeAt(Se,Oe),0,!1,!0,x);if(re&&!this.canInsertSemicolon()){if(this.eat(F.arrow))return this.parseArrowExpression(this.startNodeAt(Se,Oe),[rt],!1,x);if(this.options.ecmaVersion>=8&&rt.name==="async"&&this.type===F.name&&!Ge&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return rt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(F.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Se,Oe),[rt],!0,x)}return rt;case F.regexp:var Ot=this.value;return G=this.parseLiteral(Ot.value),G.regex={pattern:Ot.pattern,flags:Ot.flags},G;case F.num:case F.string:return this.parseLiteral(this.value);case F._null:case F._true:case F._false:return G=this.startNode(),G.value=this.type===F._null?null:this.type===F._true,G.raw=this.type.keyword,this.next(),this.finishNode(G,"Literal");case F.parenL:var It=this.start,Kt=this.parseParenAndDistinguishExpression(re,x);return c&&(c.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Kt)&&(c.parenthesizedAssign=It),c.parenthesizedBind<0&&(c.parenthesizedBind=It)),Kt;case F.bracketL:return G=this.startNode(),this.next(),G.elements=this.parseExprList(F.bracketR,!0,!0,c),this.finishNode(G,"ArrayExpression");case F.braceL:return this.overrideContext(L.b_expr),this.parseObj(!1,c);case F._function:return G=this.startNode(),this.next(),this.parseFunction(G,0);case F._class:return this.parseClass(this.startNode(),!1);case F._new:return this.parseNew();case F.backQuote:return this.parseTemplate();case F._import:return this.options.ecmaVersion>=11?this.parseExprImport(D):this.unexpected();default:return this.parseExprAtomDefault()}},A.parseExprAtomDefault=function(){this.unexpected()},A.parseExprImport=function(c){var x=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===F.parenL&&!c)return this.parseDynamicImport(x);if(this.type===F.dot){var D=this.startNodeAt(x.start,x.loc&&x.loc.start);return D.name="import",x.meta=this.finishNode(D,"Identifier"),this.parseImportMeta(x)}else this.unexpected()},A.parseDynamicImport=function(c){if(this.next(),c.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(F.parenR)?c.options=null:(this.expect(F.comma),this.afterTrailingComma(F.parenR)?c.options=null:(c.options=this.parseMaybeAssign(),this.eat(F.parenR)||(this.expect(F.comma),this.afterTrailingComma(F.parenR)||this.unexpected())));else if(!this.eat(F.parenR)){var x=this.start;this.eat(F.comma)&&this.eat(F.parenR)?this.raiseRecoverable(x,"Trailing comma is not allowed in import()"):this.unexpected(x)}return this.finishNode(c,"ImportExpression")},A.parseImportMeta=function(c){this.next();var x=this.containsEsc;return c.property=this.parseIdent(!0),c.property.name!=="meta"&&this.raiseRecoverable(c.property.start,"The only valid meta property for import is 'import.meta'"),x&&this.raiseRecoverable(c.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(c.start,"Cannot use 'import.meta' outside a module"),this.finishNode(c,"MetaProperty")},A.parseLiteral=function(c){var x=this.startNode();return x.value=c,x.raw=this.input.slice(this.start,this.end),x.raw.charCodeAt(x.raw.length-1)===110&&(x.bigint=x.value!=null?x.value.toString():x.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(x,"Literal")},A.parseParenExpression=function(){this.expect(F.parenL);var c=this.parseExpression();return this.expect(F.parenR),c},A.shouldParseArrow=function(c){return!this.canInsertSemicolon()},A.parseParenAndDistinguishExpression=function(c,x){var D=this.start,G=this.startLoc,re,Se=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Oe=this.start,Ge=this.startLoc,rt=[],Ot=!0,It=!1,Kt=new w,cn=this.yieldPos,Kr=this.awaitPos,pi;for(this.yieldPos=0,this.awaitPos=0;this.type!==F.parenR;)if(Ot?Ot=!1:this.expect(F.comma),Se&&this.afterTrailingComma(F.parenR,!0)){It=!0;break}else if(this.type===F.ellipsis){pi=this.start,rt.push(this.parseParenItem(this.parseRestBinding())),this.type===F.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else rt.push(this.parseMaybeAssign(!1,Kt,this.parseParenItem));var Zr=this.lastTokEnd,Qr=this.lastTokEndLoc;if(this.expect(F.parenR),c&&this.shouldParseArrow(rt)&&this.eat(F.arrow))return this.checkPatternErrors(Kt,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=cn,this.awaitPos=Kr,this.parseParenArrowList(D,G,rt,x);(!rt.length||It)&&this.unexpected(this.lastTokStart),pi&&this.unexpected(pi),this.checkExpressionErrors(Kt,!0),this.yieldPos=cn||this.yieldPos,this.awaitPos=Kr||this.awaitPos,rt.length>1?(re=this.startNodeAt(Oe,Ge),re.expressions=rt,this.finishNodeAt(re,"SequenceExpression",Zr,Qr)):re=rt[0]}else re=this.parseParenExpression();if(this.options.preserveParens){var zr=this.startNodeAt(D,G);return zr.expression=re,this.finishNode(zr,"ParenthesizedExpression")}else return re},A.parseParenItem=function(c){return c},A.parseParenArrowList=function(c,x,D,G){return this.parseArrowExpression(this.startNodeAt(c,x),D,!1,G)};var J=[];A.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var c=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===F.dot){var x=this.startNodeAt(c.start,c.loc&&c.loc.start);x.name="new",c.meta=this.finishNode(x,"Identifier"),this.next();var D=this.containsEsc;return c.property=this.parseIdent(!0),c.property.name!=="target"&&this.raiseRecoverable(c.property.start,"The only valid meta property for new is 'new.target'"),D&&this.raiseRecoverable(c.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(c.start,"'new.target' can only be used in functions and class static block"),this.finishNode(c,"MetaProperty")}var G=this.start,re=this.startLoc;return c.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),G,re,!0,!1),this.eat(F.parenL)?c.arguments=this.parseExprList(F.parenR,this.options.ecmaVersion>=8,!1):c.arguments=J,this.finishNode(c,"NewExpression")},A.parseTemplateElement=function(c){var x=c.isTagged,D=this.startNode();return this.type===F.invalidTemplate?(x||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),D.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):D.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),D.tail=this.type===F.backQuote,this.finishNode(D,"TemplateElement")},A.parseTemplate=function(c){c===void 0&&(c={});var x=c.isTagged;x===void 0&&(x=!1);var D=this.startNode();this.next(),D.expressions=[];var G=this.parseTemplateElement({isTagged:x});for(D.quasis=[G];!G.tail;)this.type===F.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(F.dollarBraceL),D.expressions.push(this.parseExpression()),this.expect(F.braceR),D.quasis.push(G=this.parseTemplateElement({isTagged:x}));return this.next(),this.finishNode(D,"TemplateLiteral")},A.isAsyncProp=function(c){return!c.computed&&c.key.type==="Identifier"&&c.key.name==="async"&&(this.type===F.name||this.type===F.num||this.type===F.string||this.type===F.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===F.star)&&!ze.test(this.input.slice(this.lastTokEnd,this.start))},A.parseObj=function(c,x){var D=this.startNode(),G=!0,re={};for(D.properties=[],this.next();!this.eat(F.braceR);){if(G)G=!1;else if(this.expect(F.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(F.braceR))break;var Se=this.parseProperty(c,x);c||this.checkPropClash(Se,re,x),D.properties.push(Se)}return this.finishNode(D,c?"ObjectPattern":"ObjectExpression")},A.parseProperty=function(c,x){var D=this.startNode(),G,re,Se,Oe;if(this.options.ecmaVersion>=9&&this.eat(F.ellipsis))return c?(D.argument=this.parseIdent(!1),this.type===F.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(D,"RestElement")):(D.argument=this.parseMaybeAssign(!1,x),this.type===F.comma&&x&&x.trailingComma<0&&(x.trailingComma=this.start),this.finishNode(D,"SpreadElement"));this.options.ecmaVersion>=6&&(D.method=!1,D.shorthand=!1,(c||x)&&(Se=this.start,Oe=this.startLoc),c||(G=this.eat(F.star)));var Ge=this.containsEsc;return this.parsePropertyName(D),!c&&!Ge&&this.options.ecmaVersion>=8&&!G&&this.isAsyncProp(D)?(re=!0,G=this.options.ecmaVersion>=9&&this.eat(F.star),this.parsePropertyName(D)):re=!1,this.parsePropertyValue(D,c,G,re,Se,Oe,x,Ge),this.finishNode(D,"Property")},A.parseGetterSetter=function(c){var x=c.key.name;this.parsePropertyName(c),c.value=this.parseMethod(!1),c.kind=x;var D=c.kind==="get"?0:1;if(c.value.params.length!==D){var G=c.value.start;c.kind==="get"?this.raiseRecoverable(G,"getter should have no params"):this.raiseRecoverable(G,"setter should have exactly one param")}else c.kind==="set"&&c.value.params[0].type==="RestElement"&&this.raiseRecoverable(c.value.params[0].start,"Setter cannot use rest params")},A.parsePropertyValue=function(c,x,D,G,re,Se,Oe,Ge){(D||G)&&this.type===F.colon&&this.unexpected(),this.eat(F.colon)?(c.value=x?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Oe),c.kind="init"):this.options.ecmaVersion>=6&&this.type===F.parenL?(x&&this.unexpected(),c.method=!0,c.value=this.parseMethod(D,G),c.kind="init"):!x&&!Ge&&this.options.ecmaVersion>=5&&!c.computed&&c.key.type==="Identifier"&&(c.key.name==="get"||c.key.name==="set")&&this.type!==F.comma&&this.type!==F.braceR&&this.type!==F.eq?((D||G)&&this.unexpected(),this.parseGetterSetter(c)):this.options.ecmaVersion>=6&&!c.computed&&c.key.type==="Identifier"?((D||G)&&this.unexpected(),this.checkUnreserved(c.key),c.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=re),x?c.value=this.parseMaybeDefault(re,Se,this.copyNode(c.key)):this.type===F.eq&&Oe?(Oe.shorthandAssign<0&&(Oe.shorthandAssign=this.start),c.value=this.parseMaybeDefault(re,Se,this.copyNode(c.key))):c.value=this.copyNode(c.key),c.kind="init",c.shorthand=!0):this.unexpected()},A.parsePropertyName=function(c){if(this.options.ecmaVersion>=6){if(this.eat(F.bracketL))return c.computed=!0,c.key=this.parseMaybeAssign(),this.expect(F.bracketR),c.key;c.computed=!1}return c.key=this.type===F.num||this.type===F.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},A.initFunction=function(c){c.id=null,this.options.ecmaVersion>=6&&(c.generator=c.expression=!1),this.options.ecmaVersion>=8&&(c.async=!1)},A.parseMethod=function(c,x,D){var G=this.startNode(),re=this.yieldPos,Se=this.awaitPos,Oe=this.awaitIdentPos;return this.initFunction(G),this.options.ecmaVersion>=6&&(G.generator=c),this.options.ecmaVersion>=8&&(G.async=!!x),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(qr(x,G.generator)|Di|(D?la:0)),this.expect(F.parenL),G.params=this.parseBindingList(F.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(G,!1,!0,!1),this.yieldPos=re,this.awaitPos=Se,this.awaitIdentPos=Oe,this.finishNode(G,"FunctionExpression")},A.parseArrowExpression=function(c,x,D,G){var re=this.yieldPos,Se=this.awaitPos,Oe=this.awaitIdentPos;return this.enterScope(qr(D,!1)|Rr),this.initFunction(c),this.options.ecmaVersion>=8&&(c.async=!!D),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,c.params=this.toAssignableList(x,!0),this.parseFunctionBody(c,!0,!1,G),this.yieldPos=re,this.awaitPos=Se,this.awaitIdentPos=Oe,this.finishNode(c,"ArrowFunctionExpression")},A.parseFunctionBody=function(c,x,D,G){var re=x&&this.type!==F.braceL,Se=this.strict,Oe=!1;if(re)c.body=this.parseMaybeAssign(G),c.expression=!0,this.checkParams(c,!1);else{var Ge=this.options.ecmaVersion>=7&&!this.isSimpleParamList(c.params);(!Se||Ge)&&(Oe=this.strictDirective(this.end),Oe&&Ge&&this.raiseRecoverable(c.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var rt=this.labels;this.labels=[],Oe&&(this.strict=!0),this.checkParams(c,!Se&&!Oe&&!x&&!D&&this.isSimpleParamList(c.params)),this.strict&&c.id&&this.checkLValSimple(c.id,r),c.body=this.parseBlock(!1,void 0,Oe&&!Se),c.expression=!1,this.adaptDirectivePrologue(c.body.body),this.labels=rt}this.exitScope()},A.isSimpleParamList=function(c){for(var x=0,D=c;x<D.length;x+=1){var G=D[x];if(G.type!=="Identifier")return!1}return!0},A.checkParams=function(c,x){for(var D=Object.create(null),G=0,re=c.params;G<re.length;G+=1){var Se=re[G];this.checkLValInnerPattern(Se,fi,x?null:D)}},A.parseExprList=function(c,x,D,G){for(var re=[],Se=!0;!this.eat(c);){if(Se)Se=!1;else if(this.expect(F.comma),x&&this.afterTrailingComma(c))break;var Oe=void 0;D&&this.type===F.comma?Oe=null:this.type===F.ellipsis?(Oe=this.parseSpread(G),G&&this.type===F.comma&&G.trailingComma<0&&(G.trailingComma=this.start)):Oe=this.parseMaybeAssign(!1,G),re.push(Oe)}return re},A.checkUnreserved=function(c){var x=c.start,D=c.end,G=c.name;if(this.inGenerator&&G==="yield"&&this.raiseRecoverable(x,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&G==="await"&&this.raiseRecoverable(x,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&Fi)&&G==="arguments"&&this.raiseRecoverable(x,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(G==="arguments"||G==="await")&&this.raise(x,"Cannot use "+G+" in class static initialization block"),this.keywords.test(G)&&this.raise(x,"Unexpected keyword '"+G+"'"),!(this.options.ecmaVersion<6&&this.input.slice(x,D).indexOf("\\")!==-1)){var re=this.strict?this.reservedWordsStrict:this.reservedWords;re.test(G)&&(!this.inAsync&&G==="await"&&this.raiseRecoverable(x,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(x,"The keyword '"+G+"' is reserved"))}},A.parseIdent=function(c){var x=this.parseIdentNode();return this.next(!!c),this.finishNode(x,"Identifier"),c||(this.checkUnreserved(x),x.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=x.start)),x},A.parseIdentNode=function(){var c=this.startNode();return this.type===F.name?c.name=this.value:this.type.keyword?(c.name=this.type.keyword,(c.name==="class"||c.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=F.name):this.unexpected(),c},A.parsePrivateIdent=function(){var c=this.startNode();return this.type===F.privateId?c.name=this.value:this.unexpected(),this.next(),this.finishNode(c,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(c.start,"Private field '#"+c.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(c)),c},A.parseYield=function(c){this.yieldPos||(this.yieldPos=this.start);var x=this.startNode();return this.next(),this.type===F.semi||this.canInsertSemicolon()||this.type!==F.star&&!this.type.startsExpr?(x.delegate=!1,x.argument=null):(x.delegate=this.eat(F.star),x.argument=this.parseMaybeAssign(c)),this.finishNode(x,"YieldExpression")},A.parseAwait=function(c){this.awaitPos||(this.awaitPos=this.start);var x=this.startNode();return this.next(),x.argument=this.parseMaybeUnary(null,!0,!1,c),this.finishNode(x,"AwaitExpression")};var X=u.prototype;X.raise=function(c,x){var D=Ct(this.input,c);x+=" ("+D.line+":"+D.column+")",this.sourceFile&&(x+=" in "+this.sourceFile);var G=new SyntaxError(x);throw G.pos=c,G.loc=D,G.raisedAt=this.pos,G},X.raiseRecoverable=X.raise,X.curPosition=function(){if(this.options.locations)return new Fe(this.curLine,this.pos-this.lineStart)};var te=u.prototype,ie=function(x){this.flags=x,this.var=[],this.lexical=[],this.functions=[]};te.enterScope=function(c){this.scopeStack.push(new ie(c))},te.exitScope=function(){this.scopeStack.pop()},te.treatFunctionsAsVarInScope=function(c){return c.flags&At||!this.inModule&&c.flags&_t},te.declareName=function(c,x,D){var G=!1;if(x===Gt){var re=this.currentScope();G=re.lexical.indexOf(c)>-1||re.functions.indexOf(c)>-1||re.var.indexOf(c)>-1,re.lexical.push(c),this.inModule&&re.flags&_t&&delete this.undefinedExports[c]}else if(x===Ft){var Se=this.currentScope();Se.lexical.push(c)}else if(x===Os){var Oe=this.currentScope();this.treatFunctionsAsVar?G=Oe.lexical.indexOf(c)>-1:G=Oe.lexical.indexOf(c)>-1||Oe.var.indexOf(c)>-1,Oe.functions.push(c)}else for(var Ge=this.scopeStack.length-1;Ge>=0;--Ge){var rt=this.scopeStack[Ge];if(rt.lexical.indexOf(c)>-1&&!(rt.flags&Es&&rt.lexical[0]===c)||!this.treatFunctionsAsVarInScope(rt)&&rt.functions.indexOf(c)>-1){G=!0;break}if(rt.var.push(c),this.inModule&&rt.flags&_t&&delete this.undefinedExports[c],rt.flags&Fi)break}G&&this.raiseRecoverable(D,"Identifier '"+c+"' has already been declared")},te.checkLocalExport=function(c){this.scopeStack[0].lexical.indexOf(c.name)===-1&&this.scopeStack[0].var.indexOf(c.name)===-1&&(this.undefinedExports[c.name]=c)},te.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},te.currentVarScope=function(){for(var c=this.scopeStack.length-1;;c--){var x=this.scopeStack[c];if(x.flags&(Fi|Ri|Fr))return x}},te.currentThisScope=function(){for(var c=this.scopeStack.length-1;;c--){var x=this.scopeStack[c];if(x.flags&(Fi|Ri|Fr)&&!(x.flags&Rr))return x}};var se=function(x,D,G){this.type="",this.start=D,this.end=0,x.options.locations&&(this.loc=new yt(x,G)),x.options.directSourceFile&&(this.sourceFile=x.options.directSourceFile),x.options.ranges&&(this.range=[D,0])},he=u.prototype;he.startNode=function(){return new se(this,this.start,this.startLoc)},he.startNodeAt=function(c,x){return new se(this,c,x)};function ne(c,x,D,G){return c.type=x,c.end=D,this.options.locations&&(c.loc.end=G),this.options.ranges&&(c.range[1]=D),c}he.finishNode=function(c,x){return ne.call(this,c,x,this.lastTokEnd,this.lastTokEndLoc)},he.finishNodeAt=function(c,x,D,G){return ne.call(this,c,x,D,G)},he.copyNode=function(c){var x=new se(this,c.start,this.startLoc);for(var D in c)x[D]=c[D];return x};var ce="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",fe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ye=fe+" Extended_Pictographic",xe=ye,Ee=xe+" EBase EComp EMod EPres ExtPict",Ne=Ee,We=Ne,$e={9:fe,10:ye,11:xe,12:Ee,13:Ne,14:We},it="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",je={9:"",10:"",11:"",12:"",13:"",14:it},De="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",tt="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",at=tt+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",st=at+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",xt=st+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",vt=xt+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ot=vt+" "+ce,Lt={9:tt,10:at,11:st,12:xt,13:vt,14:ot},bt={};function pn(c){var x=bt[c]={binary:Xe($e[c]+" "+De),binaryOfStrings:Xe(je[c]),nonBinary:{General_Category:Xe(De),Script:Xe(Lt[c])}};x.nonBinary.Script_Extensions=x.nonBinary.Script,x.nonBinary.gc=x.nonBinary.General_Category,x.nonBinary.sc=x.nonBinary.Script,x.nonBinary.scx=x.nonBinary.Script_Extensions}for(var sn=0,Sn=[9,10,11,12,13,14];sn<Sn.length;sn+=1){var ln=Sn[sn];pn(ln)}var qe=u.prototype,Ht=function(x,D){this.parent=x,this.base=D||this};Ht.prototype.separatedFrom=function(x){for(var D=this;D;D=D.parent)for(var G=x;G;G=G.parent)if(D.base===G.base&&D!==G)return!0;return!1},Ht.prototype.sibling=function(){return new Ht(this.parent,this.base)};var an=function(x){this.parser=x,this.validFlags="gim"+(x.options.ecmaVersion>=6?"uy":"")+(x.options.ecmaVersion>=9?"s":"")+(x.options.ecmaVersion>=13?"d":"")+(x.options.ecmaVersion>=15?"v":""),this.unicodeProperties=bt[x.options.ecmaVersion>=14?14:x.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};an.prototype.reset=function(x,D,G){var re=G.indexOf("v")!==-1,Se=G.indexOf("u")!==-1;this.start=x|0,this.source=D+"",this.flags=G,re&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Se&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Se&&this.parser.options.ecmaVersion>=9)},an.prototype.raise=function(x){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+x)},an.prototype.at=function(x,D){D===void 0&&(D=!1);var G=this.source,re=G.length;if(x>=re)return-1;var Se=G.charCodeAt(x);if(!(D||this.switchU)||Se<=55295||Se>=57344||x+1>=re)return Se;var Oe=G.charCodeAt(x+1);return Oe>=56320&&Oe<=57343?(Se<<10)+Oe-56613888:Se},an.prototype.nextIndex=function(x,D){D===void 0&&(D=!1);var G=this.source,re=G.length;if(x>=re)return re;var Se=G.charCodeAt(x),Oe;return!(D||this.switchU)||Se<=55295||Se>=57344||x+1>=re||(Oe=G.charCodeAt(x+1))<56320||Oe>57343?x+1:x+2},an.prototype.current=function(x){return x===void 0&&(x=!1),this.at(this.pos,x)},an.prototype.lookahead=function(x){return x===void 0&&(x=!1),this.at(this.nextIndex(this.pos,x),x)},an.prototype.advance=function(x){x===void 0&&(x=!1),this.pos=this.nextIndex(this.pos,x)},an.prototype.eat=function(x,D){return D===void 0&&(D=!1),this.current(D)===x?(this.advance(D),!0):!1},an.prototype.eatChars=function(x,D){D===void 0&&(D=!1);for(var G=this.pos,re=0,Se=x;re<Se.length;re+=1){var Oe=Se[re],Ge=this.at(G,D);if(Ge===-1||Ge!==Oe)return!1;G=this.nextIndex(G,D)}return this.pos=G,!0},qe.validateRegExpFlags=function(c){for(var x=c.validFlags,D=c.flags,G=!1,re=!1,Se=0;Se<D.length;Se++){var Oe=D.charAt(Se);x.indexOf(Oe)===-1&&this.raise(c.start,"Invalid regular expression flag"),D.indexOf(Oe,Se+1)>-1&&this.raise(c.start,"Duplicate regular expression flag"),Oe==="u"&&(G=!0),Oe==="v"&&(re=!0)}this.options.ecmaVersion>=15&&G&&re&&this.raise(c.start,"Invalid regular expression flag")};function qt(c){for(var x in c)return!0;return!1}qe.validateRegExpPattern=function(c){this.regexp_pattern(c),!c.switchN&&this.options.ecmaVersion>=9&&qt(c.groupNames)&&(c.switchN=!0,this.regexp_pattern(c))},qe.regexp_pattern=function(c){c.pos=0,c.lastIntValue=0,c.lastStringValue="",c.lastAssertionIsQuantifiable=!1,c.numCapturingParens=0,c.maxBackReference=0,c.groupNames=Object.create(null),c.backReferenceNames.length=0,c.branchID=null,this.regexp_disjunction(c),c.pos!==c.source.length&&(c.eat(41)&&c.raise("Unmatched ')'"),(c.eat(93)||c.eat(125))&&c.raise("Lone quantifier brackets")),c.maxBackReference>c.numCapturingParens&&c.raise("Invalid escape");for(var x=0,D=c.backReferenceNames;x<D.length;x+=1){var G=D[x];c.groupNames[G]||c.raise("Invalid named capture referenced")}},qe.regexp_disjunction=function(c){var x=this.options.ecmaVersion>=16;for(x&&(c.branchID=new Ht(c.branchID,null)),this.regexp_alternative(c);c.eat(124);)x&&(c.branchID=c.branchID.sibling()),this.regexp_alternative(c);x&&(c.branchID=c.branchID.parent),this.regexp_eatQuantifier(c,!0)&&c.raise("Nothing to repeat"),c.eat(123)&&c.raise("Lone quantifier brackets")},qe.regexp_alternative=function(c){for(;c.pos<c.source.length&&this.regexp_eatTerm(c););},qe.regexp_eatTerm=function(c){return this.regexp_eatAssertion(c)?(c.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(c)&&c.switchU&&c.raise("Invalid quantifier"),!0):(c.switchU?this.regexp_eatAtom(c):this.regexp_eatExtendedAtom(c))?(this.regexp_eatQuantifier(c),!0):!1},qe.regexp_eatAssertion=function(c){var x=c.pos;if(c.lastAssertionIsQuantifiable=!1,c.eat(94)||c.eat(36))return!0;if(c.eat(92)){if(c.eat(66)||c.eat(98))return!0;c.pos=x}if(c.eat(40)&&c.eat(63)){var D=!1;if(this.options.ecmaVersion>=9&&(D=c.eat(60)),c.eat(61)||c.eat(33))return this.regexp_disjunction(c),c.eat(41)||c.raise("Unterminated group"),c.lastAssertionIsQuantifiable=!D,!0}return c.pos=x,!1},qe.regexp_eatQuantifier=function(c,x){return x===void 0&&(x=!1),this.regexp_eatQuantifierPrefix(c,x)?(c.eat(63),!0):!1},qe.regexp_eatQuantifierPrefix=function(c,x){return c.eat(42)||c.eat(43)||c.eat(63)||this.regexp_eatBracedQuantifier(c,x)},qe.regexp_eatBracedQuantifier=function(c,x){var D=c.pos;if(c.eat(123)){var G=0,re=-1;if(this.regexp_eatDecimalDigits(c)&&(G=c.lastIntValue,c.eat(44)&&this.regexp_eatDecimalDigits(c)&&(re=c.lastIntValue),c.eat(125)))return re!==-1&&re<G&&!x&&c.raise("numbers out of order in {} quantifier"),!0;c.switchU&&!x&&c.raise("Incomplete quantifier"),c.pos=D}return!1},qe.regexp_eatAtom=function(c){return this.regexp_eatPatternCharacters(c)||c.eat(46)||this.regexp_eatReverseSolidusAtomEscape(c)||this.regexp_eatCharacterClass(c)||this.regexp_eatUncapturingGroup(c)||this.regexp_eatCapturingGroup(c)},qe.regexp_eatReverseSolidusAtomEscape=function(c){var x=c.pos;if(c.eat(92)){if(this.regexp_eatAtomEscape(c))return!0;c.pos=x}return!1},qe.regexp_eatUncapturingGroup=function(c){var x=c.pos;if(c.eat(40)){if(c.eat(63)){if(this.options.ecmaVersion>=16){var D=this.regexp_eatModifiers(c),G=c.eat(45);if(D||G){for(var re=0;re<D.length;re++){var Se=D.charAt(re);D.indexOf(Se,re+1)>-1&&c.raise("Duplicate regular expression modifiers")}if(G){var Oe=this.regexp_eatModifiers(c);!D&&!Oe&&c.current()===58&&c.raise("Invalid regular expression modifiers");for(var Ge=0;Ge<Oe.length;Ge++){var rt=Oe.charAt(Ge);(Oe.indexOf(rt,Ge+1)>-1||D.indexOf(rt)>-1)&&c.raise("Duplicate regular expression modifiers")}}}}if(c.eat(58)){if(this.regexp_disjunction(c),c.eat(41))return!0;c.raise("Unterminated group")}}c.pos=x}return!1},qe.regexp_eatCapturingGroup=function(c){if(c.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(c):c.current()===63&&c.raise("Invalid group"),this.regexp_disjunction(c),c.eat(41))return c.numCapturingParens+=1,!0;c.raise("Unterminated group")}return!1},qe.regexp_eatModifiers=function(c){for(var x="",D=0;(D=c.current())!==-1&&er(D);)x+=Ze(D),c.advance();return x};function er(c){return c===105||c===109||c===115}qe.regexp_eatExtendedAtom=function(c){return c.eat(46)||this.regexp_eatReverseSolidusAtomEscape(c)||this.regexp_eatCharacterClass(c)||this.regexp_eatUncapturingGroup(c)||this.regexp_eatCapturingGroup(c)||this.regexp_eatInvalidBracedQuantifier(c)||this.regexp_eatExtendedPatternCharacter(c)},qe.regexp_eatInvalidBracedQuantifier=function(c){return this.regexp_eatBracedQuantifier(c,!0)&&c.raise("Nothing to repeat"),!1},qe.regexp_eatSyntaxCharacter=function(c){var x=c.current();return Nr(x)?(c.lastIntValue=x,c.advance(),!0):!1};function Nr(c){return c===36||c>=40&&c<=43||c===46||c===63||c>=91&&c<=94||c>=123&&c<=125}qe.regexp_eatPatternCharacters=function(c){for(var x=c.pos,D=0;(D=c.current())!==-1&&!Nr(D);)c.advance();return c.pos!==x},qe.regexp_eatExtendedPatternCharacter=function(c){var x=c.current();return x!==-1&&x!==36&&!(x>=40&&x<=43)&&x!==46&&x!==63&&x!==91&&x!==94&&x!==124?(c.advance(),!0):!1},qe.regexp_groupSpecifier=function(c){if(c.eat(63)){this.regexp_eatGroupName(c)||c.raise("Invalid group");var x=this.options.ecmaVersion>=16,D=c.groupNames[c.lastStringValue];if(D)if(x)for(var G=0,re=D;G<re.length;G+=1){var Se=re[G];Se.separatedFrom(c.branchID)||c.raise("Duplicate capture group name")}else c.raise("Duplicate capture group name");x?(D||(c.groupNames[c.lastStringValue]=[])).push(c.branchID):c.groupNames[c.lastStringValue]=!0}},qe.regexp_eatGroupName=function(c){if(c.lastStringValue="",c.eat(60)){if(this.regexp_eatRegExpIdentifierName(c)&&c.eat(62))return!0;c.raise("Invalid capture group name")}return!1},qe.regexp_eatRegExpIdentifierName=function(c){if(c.lastStringValue="",this.regexp_eatRegExpIdentifierStart(c)){for(c.lastStringValue+=Ze(c.lastIntValue);this.regexp_eatRegExpIdentifierPart(c);)c.lastStringValue+=Ze(c.lastIntValue);return!0}return!1},qe.regexp_eatRegExpIdentifierStart=function(c){var x=c.pos,D=this.options.ecmaVersion>=11,G=c.current(D);return c.advance(D),G===92&&this.regexp_eatRegExpUnicodeEscapeSequence(c,D)&&(G=c.lastIntValue),hr(G)?(c.lastIntValue=G,!0):(c.pos=x,!1)};function hr(c){return Q(c,!0)||c===36||c===95}qe.regexp_eatRegExpIdentifierPart=function(c){var x=c.pos,D=this.options.ecmaVersion>=11,G=c.current(D);return c.advance(D),G===92&&this.regexp_eatRegExpUnicodeEscapeSequence(c,D)&&(G=c.lastIntValue),Wn(G)?(c.lastIntValue=G,!0):(c.pos=x,!1)};function Wn(c){return W(c,!0)||c===36||c===95||c===8204||c===8205}qe.regexp_eatAtomEscape=function(c){return this.regexp_eatBackReference(c)||this.regexp_eatCharacterClassEscape(c)||this.regexp_eatCharacterEscape(c)||c.switchN&&this.regexp_eatKGroupName(c)?!0:(c.switchU&&(c.current()===99&&c.raise("Invalid unicode escape"),c.raise("Invalid escape")),!1)},qe.regexp_eatBackReference=function(c){var x=c.pos;if(this.regexp_eatDecimalEscape(c)){var D=c.lastIntValue;if(c.switchU)return D>c.maxBackReference&&(c.maxBackReference=D),!0;if(D<=c.numCapturingParens)return!0;c.pos=x}return!1},qe.regexp_eatKGroupName=function(c){if(c.eat(107)){if(this.regexp_eatGroupName(c))return c.backReferenceNames.push(c.lastStringValue),!0;c.raise("Invalid named reference")}return!1},qe.regexp_eatCharacterEscape=function(c){return this.regexp_eatControlEscape(c)||this.regexp_eatCControlLetter(c)||this.regexp_eatZero(c)||this.regexp_eatHexEscapeSequence(c)||this.regexp_eatRegExpUnicodeEscapeSequence(c,!1)||!c.switchU&&this.regexp_eatLegacyOctalEscapeSequence(c)||this.regexp_eatIdentityEscape(c)},qe.regexp_eatCControlLetter=function(c){var x=c.pos;if(c.eat(99)){if(this.regexp_eatControlLetter(c))return!0;c.pos=x}return!1},qe.regexp_eatZero=function(c){return c.current()===48&&!Vt(c.lookahead())?(c.lastIntValue=0,c.advance(),!0):!1},qe.regexp_eatControlEscape=function(c){var x=c.current();return x===116?(c.lastIntValue=9,c.advance(),!0):x===110?(c.lastIntValue=10,c.advance(),!0):x===118?(c.lastIntValue=11,c.advance(),!0):x===102?(c.lastIntValue=12,c.advance(),!0):x===114?(c.lastIntValue=13,c.advance(),!0):!1},qe.regexp_eatControlLetter=function(c){var x=c.current();return Cn(x)?(c.lastIntValue=x%32,c.advance(),!0):!1};function Cn(c){return c>=65&&c<=90||c>=97&&c<=122}qe.regexp_eatRegExpUnicodeEscapeSequence=function(c,x){x===void 0&&(x=!1);var D=c.pos,G=x||c.switchU;if(c.eat(117)){if(this.regexp_eatFixedHexDigits(c,4)){var re=c.lastIntValue;if(G&&re>=55296&&re<=56319){var Se=c.pos;if(c.eat(92)&&c.eat(117)&&this.regexp_eatFixedHexDigits(c,4)){var Oe=c.lastIntValue;if(Oe>=56320&&Oe<=57343)return c.lastIntValue=(re-55296)*1024+(Oe-56320)+65536,!0}c.pos=Se,c.lastIntValue=re}return!0}if(G&&c.eat(123)&&this.regexp_eatHexDigits(c)&&c.eat(125)&&On(c.lastIntValue))return!0;G&&c.raise("Invalid unicode escape"),c.pos=D}return!1};function On(c){return c>=0&&c<=1114111}qe.regexp_eatIdentityEscape=function(c){if(c.switchU)return this.regexp_eatSyntaxCharacter(c)?!0:c.eat(47)?(c.lastIntValue=47,!0):!1;var x=c.current();return x!==99&&(!c.switchN||x!==107)?(c.lastIntValue=x,c.advance(),!0):!1},qe.regexp_eatDecimalEscape=function(c){c.lastIntValue=0;var x=c.current();if(x>=49&&x<=57){do c.lastIntValue=10*c.lastIntValue+(x-48),c.advance();while((x=c.current())>=48&&x<=57);return!0}return!1};var tr=0,vn=1,Nn=2;qe.regexp_eatCharacterClassEscape=function(c){var x=c.current();if(Ps(x))return c.lastIntValue=-1,c.advance(),vn;var D=!1;if(c.switchU&&this.options.ecmaVersion>=9&&((D=x===80)||x===112)){c.lastIntValue=-1,c.advance();var G;if(c.eat(123)&&(G=this.regexp_eatUnicodePropertyValueExpression(c))&&c.eat(125))return D&&G===Nn&&c.raise("Invalid property name"),G;c.raise("Invalid property name")}return tr};function Ps(c){return c===100||c===68||c===115||c===83||c===119||c===87}qe.regexp_eatUnicodePropertyValueExpression=function(c){var x=c.pos;if(this.regexp_eatUnicodePropertyName(c)&&c.eat(61)){var D=c.lastStringValue;if(this.regexp_eatUnicodePropertyValue(c)){var G=c.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(c,D,G),vn}}if(c.pos=x,this.regexp_eatLoneUnicodePropertyNameOrValue(c)){var re=c.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(c,re)}return tr},qe.regexp_validateUnicodePropertyNameAndValue=function(c,x,D){Le(c.unicodeProperties.nonBinary,x)||c.raise("Invalid property name"),c.unicodeProperties.nonBinary[x].test(D)||c.raise("Invalid property value")},qe.regexp_validateUnicodePropertyNameOrValue=function(c,x){if(c.unicodeProperties.binary.test(x))return vn;if(c.switchV&&c.unicodeProperties.binaryOfStrings.test(x))return Nn;c.raise("Invalid property name")},qe.regexp_eatUnicodePropertyName=function(c){var x=0;for(c.lastStringValue="";As(x=c.current());)c.lastStringValue+=Ze(x),c.advance();return c.lastStringValue!==""};function As(c){return Cn(c)||c===95}qe.regexp_eatUnicodePropertyValue=function(c){var x=0;for(c.lastStringValue="";Ms(x=c.current());)c.lastStringValue+=Ze(x),c.advance();return c.lastStringValue!==""};function Ms(c){return As(c)||Vt(c)}qe.regexp_eatLoneUnicodePropertyNameOrValue=function(c){return this.regexp_eatUnicodePropertyValue(c)},qe.regexp_eatCharacterClass=function(c){if(c.eat(91)){var x=c.eat(94),D=this.regexp_classContents(c);return c.eat(93)||c.raise("Unterminated character class"),x&&D===Nn&&c.raise("Negated character class may contain strings"),!0}return!1},qe.regexp_classContents=function(c){return c.current()===93?vn:c.switchV?this.regexp_classSetExpression(c):(this.regexp_nonEmptyClassRanges(c),vn)},qe.regexp_nonEmptyClassRanges=function(c){for(;this.regexp_eatClassAtom(c);){var x=c.lastIntValue;if(c.eat(45)&&this.regexp_eatClassAtom(c)){var D=c.lastIntValue;c.switchU&&(x===-1||D===-1)&&c.raise("Invalid character class"),x!==-1&&D!==-1&&x>D&&c.raise("Range out of order in character class")}}},qe.regexp_eatClassAtom=function(c){var x=c.pos;if(c.eat(92)){if(this.regexp_eatClassEscape(c))return!0;if(c.switchU){var D=c.current();(D===99||Br(D))&&c.raise("Invalid class escape"),c.raise("Invalid escape")}c.pos=x}var G=c.current();return G!==93?(c.lastIntValue=G,c.advance(),!0):!1},qe.regexp_eatClassEscape=function(c){var x=c.pos;if(c.eat(98))return c.lastIntValue=8,!0;if(c.switchU&&c.eat(45))return c.lastIntValue=45,!0;if(!c.switchU&&c.eat(99)){if(this.regexp_eatClassControlLetter(c))return!0;c.pos=x}return this.regexp_eatCharacterClassEscape(c)||this.regexp_eatCharacterEscape(c)},qe.regexp_classSetExpression=function(c){var x=vn,D;if(!this.regexp_eatClassSetRange(c))if(D=this.regexp_eatClassSetOperand(c)){D===Nn&&(x=Nn);for(var G=c.pos;c.eatChars([38,38]);){if(c.current()!==38&&(D=this.regexp_eatClassSetOperand(c))){D!==Nn&&(x=vn);continue}c.raise("Invalid character in character class")}if(G!==c.pos)return x;for(;c.eatChars([45,45]);)this.regexp_eatClassSetOperand(c)||c.raise("Invalid character in character class");if(G!==c.pos)return x}else c.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(c)){if(D=this.regexp_eatClassSetOperand(c),!D)return x;D===Nn&&(x=Nn)}},qe.regexp_eatClassSetRange=function(c){var x=c.pos;if(this.regexp_eatClassSetCharacter(c)){var D=c.lastIntValue;if(c.eat(45)&&this.regexp_eatClassSetCharacter(c)){var G=c.lastIntValue;return D!==-1&&G!==-1&&D>G&&c.raise("Range out of order in character class"),!0}c.pos=x}return!1},qe.regexp_eatClassSetOperand=function(c){return this.regexp_eatClassSetCharacter(c)?vn:this.regexp_eatClassStringDisjunction(c)||this.regexp_eatNestedClass(c)},qe.regexp_eatNestedClass=function(c){var x=c.pos;if(c.eat(91)){var D=c.eat(94),G=this.regexp_classContents(c);if(c.eat(93))return D&&G===Nn&&c.raise("Negated character class may contain strings"),G;c.pos=x}if(c.eat(92)){var re=this.regexp_eatCharacterClassEscape(c);if(re)return re;c.pos=x}return null},qe.regexp_eatClassStringDisjunction=function(c){var x=c.pos;if(c.eatChars([92,113])){if(c.eat(123)){var D=this.regexp_classStringDisjunctionContents(c);if(c.eat(125))return D}else c.raise("Invalid escape");c.pos=x}return null},qe.regexp_classStringDisjunctionContents=function(c){for(var x=this.regexp_classString(c);c.eat(124);)this.regexp_classString(c)===Nn&&(x=Nn);return x},qe.regexp_classString=function(c){for(var x=0;this.regexp_eatClassSetCharacter(c);)x++;return x===1?vn:Nn},qe.regexp_eatClassSetCharacter=function(c){var x=c.pos;if(c.eat(92))return this.regexp_eatCharacterEscape(c)||this.regexp_eatClassSetReservedPunctuator(c)?!0:c.eat(98)?(c.lastIntValue=8,!0):(c.pos=x,!1);var D=c.current();return D<0||D===c.lookahead()&&Ni(D)||qa(D)?!1:(c.advance(),c.lastIntValue=D,!0)};function Ni(c){return c===33||c>=35&&c<=38||c>=42&&c<=44||c===46||c>=58&&c<=64||c===94||c===96||c===126}function qa(c){return c===40||c===41||c===45||c===47||c>=91&&c<=93||c>=123&&c<=125}qe.regexp_eatClassSetReservedPunctuator=function(c){var x=c.current();return Bi(x)?(c.lastIntValue=x,c.advance(),!0):!1};function Bi(c){return c===33||c===35||c===37||c===38||c===44||c===45||c>=58&&c<=62||c===64||c===96||c===126}qe.regexp_eatClassControlLetter=function(c){var x=c.current();return Vt(x)||x===95?(c.lastIntValue=x%32,c.advance(),!0):!1},qe.regexp_eatHexEscapeSequence=function(c){var x=c.pos;if(c.eat(120)){if(this.regexp_eatFixedHexDigits(c,2))return!0;c.switchU&&c.raise("Invalid escape"),c.pos=x}return!1},qe.regexp_eatDecimalDigits=function(c){var x=c.pos,D=0;for(c.lastIntValue=0;Vt(D=c.current());)c.lastIntValue=10*c.lastIntValue+(D-48),c.advance();return c.pos!==x};function Vt(c){return c>=48&&c<=57}qe.regexp_eatHexDigits=function(c){var x=c.pos,D=0;for(c.lastIntValue=0;zi(D=c.current());)c.lastIntValue=16*c.lastIntValue+Vi(D),c.advance();return c.pos!==x};function zi(c){return c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102}function Vi(c){return c>=65&&c<=70?10+(c-65):c>=97&&c<=102?10+(c-97):c-48}qe.regexp_eatLegacyOctalEscapeSequence=function(c){if(this.regexp_eatOctalDigit(c)){var x=c.lastIntValue;if(this.regexp_eatOctalDigit(c)){var D=c.lastIntValue;x<=3&&this.regexp_eatOctalDigit(c)?c.lastIntValue=x*64+D*8+c.lastIntValue:c.lastIntValue=x*8+D}else c.lastIntValue=x;return!0}return!1},qe.regexp_eatOctalDigit=function(c){var x=c.current();return Br(x)?(c.lastIntValue=x-48,c.advance(),!0):(c.lastIntValue=0,!1)};function Br(c){return c>=48&&c<=55}qe.regexp_eatFixedHexDigits=function(c,x){var D=c.pos;c.lastIntValue=0;for(var G=0;G<x;++G){var re=c.current();if(!zi(re))return c.pos=D,!1;c.lastIntValue=16*c.lastIntValue+Vi(re),c.advance()}return!0};var fr=function(x){this.type=x.type,this.value=x.value,this.start=x.start,this.end=x.end,x.options.locations&&(this.loc=new yt(x,x.startLoc,x.endLoc)),x.options.ranges&&(this.range=[x.start,x.end])},Pt=u.prototype;Pt.next=function(c){!c&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new fr(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Pt.getToken=function(){return this.next(),new fr(this)},typeof Symbol<"u"&&(Pt[Symbol.iterator]=function(){var c=this;return{next:function(){var x=c.getToken();return{done:x.type===F.eof,value:x}}}}),Pt.nextToken=function(){var c=this.curContext();if((!c||!c.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(F.eof);if(c.override)return c.override(this);this.readToken(this.fullCharCodeAtPos())},Pt.readToken=function(c){return Q(c,this.options.ecmaVersion>=6)||c===92?this.readWord():this.getTokenFromCode(c)},Pt.fullCharCodeAtPos=function(){var c=this.input.charCodeAt(this.pos);if(c<=55295||c>=56320)return c;var x=this.input.charCodeAt(this.pos+1);return x<=56319||x>=57344?c:(c<<10)+x-56613888},Pt.skipBlockComment=function(){var c=this.options.onComment&&this.curPosition(),x=this.pos,D=this.input.indexOf("*/",this.pos+=2);if(D===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=D+2,this.options.locations)for(var G=void 0,re=x;(G=ut(this.input,re,this.pos))>-1;)++this.curLine,re=this.lineStart=G;this.options.onComment&&this.options.onComment(!0,this.input.slice(x+2,D),x,this.pos,c,this.curPosition())},Pt.skipLineComment=function(c){for(var x=this.pos,D=this.options.onComment&&this.curPosition(),G=this.input.charCodeAt(this.pos+=c);this.pos<this.input.length&&!Je(G);)G=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(x+c,this.pos),x,this.pos,D,this.curPosition())},Pt.skipSpace=function(){e:for(;this.pos<this.input.length;){var c=this.input.charCodeAt(this.pos);switch(c){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(c>8&&c<14||c>=5760&&Ie.test(String.fromCharCode(c)))++this.pos;else break e}}},Pt.finishToken=function(c,x){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var D=this.type;this.type=c,this.value=x,this.updateContext(D)},Pt.readToken_dot=function(){var c=this.input.charCodeAt(this.pos+1);if(c>=48&&c<=57)return this.readNumber(!0);var x=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&c===46&&x===46?(this.pos+=3,this.finishToken(F.ellipsis)):(++this.pos,this.finishToken(F.dot))},Pt.readToken_slash=function(){var c=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):c===61?this.finishOp(F.assign,2):this.finishOp(F.slash,1)},Pt.readToken_mult_modulo_exp=function(c){var x=this.input.charCodeAt(this.pos+1),D=1,G=c===42?F.star:F.modulo;return this.options.ecmaVersion>=7&&c===42&&x===42&&(++D,G=F.starstar,x=this.input.charCodeAt(this.pos+2)),x===61?this.finishOp(F.assign,D+1):this.finishOp(G,D)},Pt.readToken_pipe_amp=function(c){var x=this.input.charCodeAt(this.pos+1);if(x===c){if(this.options.ecmaVersion>=12){var D=this.input.charCodeAt(this.pos+2);if(D===61)return this.finishOp(F.assign,3)}return this.finishOp(c===124?F.logicalOR:F.logicalAND,2)}return x===61?this.finishOp(F.assign,2):this.finishOp(c===124?F.bitwiseOR:F.bitwiseAND,1)},Pt.readToken_caret=function(){var c=this.input.charCodeAt(this.pos+1);return c===61?this.finishOp(F.assign,2):this.finishOp(F.bitwiseXOR,1)},Pt.readToken_plus_min=function(c){var x=this.input.charCodeAt(this.pos+1);return x===c?x===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||ze.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(F.incDec,2):x===61?this.finishOp(F.assign,2):this.finishOp(F.plusMin,1)},Pt.readToken_lt_gt=function(c){var x=this.input.charCodeAt(this.pos+1),D=1;return x===c?(D=c===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+D)===61?this.finishOp(F.assign,D+1):this.finishOp(F.bitShift,D)):x===33&&c===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(x===61&&(D=2),this.finishOp(F.relational,D))},Pt.readToken_eq_excl=function(c){var x=this.input.charCodeAt(this.pos+1);return x===61?this.finishOp(F.equality,this.input.charCodeAt(this.pos+2)===61?3:2):c===61&&x===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(F.arrow)):this.finishOp(c===61?F.eq:F.prefix,1)},Pt.readToken_question=function(){var c=this.options.ecmaVersion;if(c>=11){var x=this.input.charCodeAt(this.pos+1);if(x===46){var D=this.input.charCodeAt(this.pos+2);if(D<48||D>57)return this.finishOp(F.questionDot,2)}if(x===63){if(c>=12){var G=this.input.charCodeAt(this.pos+2);if(G===61)return this.finishOp(F.assign,3)}return this.finishOp(F.coalesce,2)}}return this.finishOp(F.question,1)},Pt.readToken_numberSign=function(){var c=this.options.ecmaVersion,x=35;if(c>=13&&(++this.pos,x=this.fullCharCodeAtPos(),Q(x,!0)||x===92))return this.finishToken(F.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Ze(x)+"'")},Pt.getTokenFromCode=function(c){switch(c){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(F.parenL);case 41:return++this.pos,this.finishToken(F.parenR);case 59:return++this.pos,this.finishToken(F.semi);case 44:return++this.pos,this.finishToken(F.comma);case 91:return++this.pos,this.finishToken(F.bracketL);case 93:return++this.pos,this.finishToken(F.bracketR);case 123:return++this.pos,this.finishToken(F.braceL);case 125:return++this.pos,this.finishToken(F.braceR);case 58:return++this.pos,this.finishToken(F.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(F.backQuote);case 48:var x=this.input.charCodeAt(this.pos+1);if(x===120||x===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(x===111||x===79)return this.readRadixNumber(8);if(x===98||x===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(c);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(c);case 124:case 38:return this.readToken_pipe_amp(c);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(c);case 60:case 62:return this.readToken_lt_gt(c);case 61:case 33:return this.readToken_eq_excl(c);case 63:return this.readToken_question();case 126:return this.finishOp(F.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Ze(c)+"'")},Pt.finishOp=function(c,x){var D=this.input.slice(this.pos,this.pos+x);return this.pos+=x,this.finishToken(c,D)},Pt.readRegexp=function(){for(var c,x,D=this.pos;;){this.pos>=this.input.length&&this.raise(D,"Unterminated regular expression");var G=this.input.charAt(this.pos);if(ze.test(G)&&this.raise(D,"Unterminated regular expression"),c)c=!1;else{if(G==="[")x=!0;else if(G==="]"&&x)x=!1;else if(G==="/"&&!x)break;c=G==="\\"}++this.pos}var re=this.input.slice(D,this.pos);++this.pos;var Se=this.pos,Oe=this.readWord1();this.containsEsc&&this.unexpected(Se);var Ge=this.regexpState||(this.regexpState=new an(this));Ge.reset(D,re,Oe),this.validateRegExpFlags(Ge),this.validateRegExpPattern(Ge);var rt=null;try{rt=new RegExp(re,Oe)}catch{}return this.finishToken(F.regexp,{pattern:re,flags:Oe,value:rt})},Pt.readInt=function(c,x,D){for(var G=this.options.ecmaVersion>=12&&x===void 0,re=D&&this.input.charCodeAt(this.pos)===48,Se=this.pos,Oe=0,Ge=0,rt=0,Ot=x??1/0;rt<Ot;++rt,++this.pos){var It=this.input.charCodeAt(this.pos),Kt=void 0;if(G&&It===95){re&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Ge===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),rt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Ge=It;continue}if(It>=97?Kt=It-97+10:It>=65?Kt=It-65+10:It>=48&&It<=57?Kt=It-48:Kt=1/0,Kt>=c)break;Ge=It,Oe=Oe*c+Kt}return G&&Ge===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Se||x!=null&&this.pos-Se!==x?null:Oe};function nr(c,x){return x?parseInt(c,8):parseFloat(c.replace(/_/g,""))}function rr(c){return typeof BigInt!="function"?null:BigInt(c.replace(/_/g,""))}Pt.readRadixNumber=function(c){var x=this.pos;this.pos+=2;var D=this.readInt(c);return D==null&&this.raise(this.start+2,"Expected number in radix "+c),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(D=rr(this.input.slice(x,this.pos)),++this.pos):Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(F.num,D)},Pt.readNumber=function(c){var x=this.pos;!c&&this.readInt(10,void 0,!0)===null&&this.raise(x,"Invalid number");var D=this.pos-x>=2&&this.input.charCodeAt(x)===48;D&&this.strict&&this.raise(x,"Invalid number");var G=this.input.charCodeAt(this.pos);if(!D&&!c&&this.options.ecmaVersion>=11&&G===110){var re=rr(this.input.slice(x,this.pos));return++this.pos,Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(F.num,re)}D&&/[89]/.test(this.input.slice(x,this.pos))&&(D=!1),G===46&&!D&&(++this.pos,this.readInt(10),G=this.input.charCodeAt(this.pos)),(G===69||G===101)&&!D&&(G=this.input.charCodeAt(++this.pos),(G===43||G===45)&&++this.pos,this.readInt(10)===null&&this.raise(x,"Invalid number")),Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Se=nr(this.input.slice(x,this.pos),D);return this.finishToken(F.num,Se)},Pt.readCodePoint=function(){var c=this.input.charCodeAt(this.pos),x;if(c===123){this.options.ecmaVersion<6&&this.unexpected();var D=++this.pos;x=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,x>1114111&&this.invalidStringToken(D,"Code point out of bounds")}else x=this.readHexChar(4);return x},Pt.readString=function(c){for(var x="",D=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var G=this.input.charCodeAt(this.pos);if(G===c)break;G===92?(x+=this.input.slice(D,this.pos),x+=this.readEscapedChar(!1),D=this.pos):G===8232||G===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(Je(G)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return x+=this.input.slice(D,this.pos++),this.finishToken(F.string,x)};var Un={};Pt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(c){if(c===Un)this.readInvalidTemplateToken();else throw c}this.inTemplateElement=!1},Pt.invalidStringToken=function(c,x){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Un;this.raise(c,x)},Pt.readTmplToken=function(){for(var c="",x=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var D=this.input.charCodeAt(this.pos);if(D===96||D===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===F.template||this.type===F.invalidTemplate)?D===36?(this.pos+=2,this.finishToken(F.dollarBraceL)):(++this.pos,this.finishToken(F.backQuote)):(c+=this.input.slice(x,this.pos),this.finishToken(F.template,c));if(D===92)c+=this.input.slice(x,this.pos),c+=this.readEscapedChar(!0),x=this.pos;else if(Je(D)){switch(c+=this.input.slice(x,this.pos),++this.pos,D){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:c+=`
`;break;default:c+=String.fromCharCode(D);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),x=this.pos}else++this.pos}},Pt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(F.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},Pt.readEscapedChar=function(c){var x=this.input.charCodeAt(++this.pos);switch(++this.pos,x){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Ze(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),c){var D=this.pos-1;this.invalidStringToken(D,"Invalid escape sequence in template string")}default:if(x>=48&&x<=55){var G=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],re=parseInt(G,8);return re>255&&(G=G.slice(0,-1),re=parseInt(G,8)),this.pos+=G.length-1,x=this.input.charCodeAt(this.pos),(G!=="0"||x===56||x===57)&&(this.strict||c)&&this.invalidStringToken(this.pos-1-G.length,c?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(re)}return Je(x)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(x)}},Pt.readHexChar=function(c){var x=this.pos,D=this.readInt(16,c);return D===null&&this.invalidStringToken(x,"Bad character escape sequence"),D},Pt.readWord1=function(){this.containsEsc=!1;for(var c="",x=!0,D=this.pos,G=this.options.ecmaVersion>=6;this.pos<this.input.length;){var re=this.fullCharCodeAtPos();if(W(re,G))this.pos+=re<=65535?1:2;else if(re===92){this.containsEsc=!0,c+=this.input.slice(D,this.pos);var Se=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Oe=this.readCodePoint();(x?Q:W)(Oe,G)||this.invalidStringToken(Se,"Invalid Unicode escape"),c+=Ze(Oe),D=this.pos}else break;x=!1}return c+this.input.slice(D,this.pos)},Pt.readWord=function(){var c=this.readWord1(),x=F.name;return this.keywords.test(c)&&(x=ve[c]),this.finishToken(x,c)};var Hn="8.15.0";u.acorn={Parser:u,version:Hn,defaultOptions:pt,Position:Fe,SourceLocation:yt,getLineInfo:Ct,Node:se,TokenType:ee,tokTypes:F,keywordTypes:ve,TokContext:H,tokContexts:L,isIdentifierChar:W,isIdentifierStart:Q,Token:fr,isNewLine:Je,lineBreak:ze,lineBreakG:He,nonASCIIwhitespace:Ie};function Sr(c,x){return u.parse(c,x)}function Cr(c,x,D){return u.parseExpressionAt(c,x,D)}function di(c,x){return u.tokenizer(c,x)}t.Node=se,t.Parser=u,t.Position=Fe,t.SourceLocation=yt,t.TokContext=H,t.Token=fr,t.TokenType=ee,t.defaultOptions=pt,t.getLineInfo=Ct,t.isIdentifierChar=W,t.isIdentifierStart=Q,t.isNewLine=Je,t.keywordTypes=ve,t.lineBreak=ze,t.lineBreakG=He,t.nonASCIIwhitespace=Ie,t.parse=Sr,t.parseExpressionAt=Cr,t.tokContexts=L,t.tokTypes=F,t.tokenizer=di,t.version=Hn}))})(zl,zl.exports)),zl.exports}/*!
 * Paper.js v0.12.18 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Jul 17 14:57:24 2024 +0200
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var $2=Rc.exports,Sm;function eS(){return Sm||(Sm=1,(function(l){(function(e,t){e=e||wm;var n=e.window,s=e.document,a=new function(){var r=/^(statics|enumerable|beans|preserve)$/,u=[],f=u.slice,g=Object.create,m=Object.getOwnPropertyDescriptor,w=Object.defineProperty,S=u.forEach||function(j,I){for(var Y=0,z=this.length;Y<z;Y++)j.call(I,this[Y],Y,this)},C=function(j,I){for(var Y in this)this.hasOwnProperty(Y)&&j.call(I,this[Y],Y,this)},T=Object.assign||function(j){for(var I=1,Y=arguments.length;I<Y;I++){var z=arguments[I];for(var H in z)z.hasOwnProperty(H)&&(j[H]=z[H])}return j},P=function(j,I,Y){if(j){var z=m(j,"length");(z&&typeof z.value=="number"?S:C).call(j,I,Y=Y||j)}return Y};function R(j,I,Y,z,H){var L={};function U(X,te){te=te||(te=m(I,X))&&(te.get?te:te.value),typeof te=="string"&&te[0]==="#"&&(te=j[te.substring(1)]||te);var ie=typeof te=="function",se=te,he=H||ie&&!te.base?te&&te.get?X in j:j[X]:null,ne;(!H||!he)&&(ie&&he&&(te.base=he),ie&&z!==!1&&(ne=X.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(L[ne[3].toLowerCase()+ne[4]]=ne[2]),(!se||ie||!se.get||typeof se.get!="function"||!B.isPlainObject(se))&&(se={value:se,writable:!0}),(m(j,X)||{configurable:!0}).configurable&&(se.configurable=!0,se.enumerable=Y??!ne),w(j,X,se))}if(I){for(var A in I)I.hasOwnProperty(A)&&!r.test(A)&&U(A);for(var A in L){var V=L[A],q=j["set"+V],J=j["get"+V]||q&&j["is"+V];J&&(z===!0||J.length===0)&&U(A,{get:J,set:q})}}return j}function B(){for(var j=0,I=arguments.length;j<I;j++){var Y=arguments[j];Y&&T(this,Y)}return this}return R(B,{inject:function(j){if(j){var I=j.statics===!0?j:j.statics,Y=j.beans,z=j.preserve;I!==j&&R(this.prototype,j,j.enumerable,Y,z),R(this,I,null,Y,z)}for(var H=1,L=arguments.length;H<L;H++)this.inject(arguments[H]);return this},extend:function(){for(var j=this,I,Y,z=0,H,L=arguments.length;z<L&&!(I&&Y);z++)H=arguments[z],I=I||H.initialize,Y=Y||H.prototype;return I=I||function(){j.apply(this,arguments)},Y=I.prototype=Y||g(this.prototype),w(Y,"constructor",{value:I,writable:!0,configurable:!0}),R(I,this),arguments.length&&this.inject.apply(I,arguments),I.base=j,I}}).inject({enumerable:!1,initialize:B,set:B,inject:function(){for(var j=0,I=arguments.length;j<I;j++){var Y=arguments[j];Y&&R(this,Y,Y.enumerable,Y.beans,Y.preserve)}return this},extend:function(){var j=g(this);return j.inject.apply(j,arguments)},each:function(j,I){return P(this,j,I)},clone:function(){return new this.constructor(this)},statics:{set:T,each:P,create:g,define:w,describe:m,clone:function(j){return T(new j.constructor,j)},isPlainObject:function(j){var I=j!=null&&j.constructor;return I&&(I===Object||I===B||I.name==="Object")},pick:function(j,I){return j!==t?j:I},slice:function(j,I,Y){return f.call(j,I,Y)}}})};l.exports=a,a.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+a.each(this,function(r,u){if(!/^_/.test(u)){var f=typeof r;this.push(u+": "+(f==="number"?b.instance.number(r):f==="string"?"'"+r+"'":r))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(r){return a.importJSON(r,this)},exportJSON:function(r){return a.exportJSON(this,r)},toJSON:function(){return a.serialize(this)},set:function(r,u){return r&&a.filter(this,r,u,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function r(){var u=r.base.apply(this,arguments),f=u.prototype._class;return f&&!a.exports[f]&&(a.exports[f]=u),u},equals:function(r,u){if(r===u)return!0;if(r&&r.equals)return r.equals(u);if(u&&u.equals)return u.equals(r);if(r&&u&&typeof r=="object"&&typeof u=="object"){if(Array.isArray(r)&&Array.isArray(u)){var f=r.length;if(f!==u.length)return!1;for(;f--;)if(!a.equals(r[f],u[f]))return!1}else{var g=Object.keys(r),f=g.length;if(f!==Object.keys(u).length)return!1;for(;f--;){var m=g[f];if(!(u.hasOwnProperty(m)&&a.equals(r[m],u[m])))return!1}}return!0}return!1},read:function(r,u,f,g){if(this===a){var m=this.peek(r,u);return r.__index++,m}var w=this.prototype,S=w._readIndex,C=u||S&&r.__index||0,T=r.length,P=r[C];if(g=g||T-C,P instanceof this||f&&f.readNull&&P==null&&g<=1)return S&&(r.__index=C+1),P&&f&&f.clone?P.clone():P;if(P=a.create(w),S&&(P.__read=!0),P=P.initialize.apply(P,C>0||C+g<T?a.slice(r,C,C+g):r)||P,S){r.__index=C+P.__read;var R=P.__filtered;R&&(r.__filtered=R,P.__filtered=t),P.__read=t}return P},peek:function(r,u){return r[r.__index=u||r.__index||0]},remain:function(r){return r.length-(r.__index||0)},readList:function(r,u,f,g){for(var m=[],w,S=u||0,C=g?S+g:r.length,T=S;T<C;T++)m.push(Array.isArray(w=r[T])?this.read(w,0,f):this.read(r,T,f,1));return m},readNamed:function(r,u,f,g,m){var w=this.getNamed(r,u),S=w!==t;if(S){var C=r.__filtered;if(!C){var T=this.getSource(r);C=r.__filtered=a.create(T),C.__unfiltered=T}C[u]=t}return this.read(S?[w]:r,f,g,m)},readSupported:function(r,u){var f=this.getSource(r),g=this,m=!1;return f&&Object.keys(f).forEach(function(w){if(w in u){var S=g.readNamed(r,w);S!==t&&(u[w]=S),m=!0}}),m},getSource:function(r){var u=r.__source;if(u===t){var f=r.length===1&&r[0];u=r.__source=f&&a.isPlainObject(f)?f:null}return u},getNamed:function(r,u){var f=this.getSource(r);if(f)return u?f[u]:r.__filtered||f},hasNamed:function(r,u){return!!this.getNamed(r,u)},filter:function(r,u,f,g){var m;function w(R){if(!(f&&R in f)&&!(m&&R in m)){var B=u[R];B!==t&&(r[R]=B)}}if(g){for(var S={},C=0,T,P=g.length;C<P;C++)(T=g[C])in u&&(w(T),S[T]=!0);m=S}return Object.keys(u.__unfiltered||u).forEach(w),r},isPlainValue:function(r,u){return a.isPlainObject(r)||Array.isArray(r)||u&&typeof r=="string"},serialize:function(r,u,f,g){u=u||{};var m=!g,w;if(m&&(u.formatter=new b(u.precision),g={length:0,definitions:{},references:{},add:function(B,j){var I="#"+B._id,Y=this.references[I];if(!Y){this.length++;var z=j.call(B),H=B._class;H&&z[0]!==H&&z.unshift(H),this.definitions[I]=z,Y=this.references[I]=[I]}return Y}}),r&&r._serialize){w=r._serialize(u,g);var S=r._class;S&&!r._compactSerialize&&(m||!f)&&w[0]!==S&&w.unshift(S)}else if(Array.isArray(r)){w=[];for(var C=0,T=r.length;C<T;C++)w[C]=a.serialize(r[C],u,f,g)}else if(a.isPlainObject(r)){w={};for(var P=Object.keys(r),C=0,T=P.length;C<T;C++){var R=P[C];w[R]=a.serialize(r[R],u,f,g)}}else typeof r=="number"?w=u.formatter.number(r,u.precision):w=r;return m&&g.length>0?[["dictionary",g.definitions],w]:w},deserialize:function(r,u,f,g,m){var w=r,S=!f,C=S&&r&&r.length&&r[0][0]==="dictionary";if(f=f||{},Array.isArray(r)){var T=r[0],P=T==="dictionary";if(r.length==1&&/^#/.test(T))return f.dictionary[T];T=a.exports[T],w=[];for(var R=T?1:0,B=r.length;R<B;R++)w.push(a.deserialize(r[R],u,f,P,C));if(T){var j=w;u?w=u(T,j,S||m):w=new T(j)}}else if(a.isPlainObject(r)){w={},g&&(f.dictionary=w);for(var I in r)w[I]=a.deserialize(r[I],u,f)}return C?w[1]:w},exportJSON:function(r,u){var f=a.serialize(r,u);return u&&u.asString==!1?f:JSON.stringify(f)},importJSON:function(r,u){return a.deserialize(typeof r=="string"?JSON.parse(r):r,function(f,g,m){var w=m&&u&&u.constructor===f,S=w?u:a.create(f.prototype);if(g.length===1&&S instanceof F&&(w||!(S instanceof He))){var C=g[0];a.isPlainObject(C)&&(C.insert=!1,w&&(g=g.concat([F.INSERT])))}return(w?S.set:f).apply(S,g),w&&(u=null),S})},push:function(r,u){var f=u.length;if(f<4096)r.push.apply(r,u);else{var g=r.length;r.length+=f;for(var m=0;m<f;m++)r[g+m]=u[m]}return r},splice:function(r,u,f,g){var m=u&&u.length,w=f===t;f=w?r.length:f,f>r.length&&(f=r.length);for(var S=0;S<m;S++)u[S]._index=f+S;if(w)return a.push(r,u),[];var C=[f,g];u&&a.push(C,u);for(var T=r.splice.apply(r,C),S=0,P=T.length;S<P;S++)T[S]._index=t;for(var S=f+m,P=r.length;S<P;S++)r[S]._index=S;return T},capitalize:function(r){return r.replace(/\b[a-z]/g,function(u){return u.toUpperCase()})},camelize:function(r){return r.replace(/-(.)/g,function(u,f){return f.toUpperCase()})},hyphenate:function(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var h={on:function(r,u){if(typeof r!="string")a.each(r,function(w,S){this.on(S,w)},this);else{var f=this._eventTypes,g=f&&f[r],m=this._callbacks=this._callbacks||{};m=m[r]=m[r]||[],m.indexOf(u)===-1&&(m.push(u),g&&g.install&&m.length===1&&g.install.call(this,r))}return this},off:function(r,u){if(typeof r!="string"){a.each(r,function(S,C){this.off(C,S)},this);return}var f=this._eventTypes,g=f&&f[r],m=this._callbacks&&this._callbacks[r],w;return m&&(!u||(w=m.indexOf(u))!==-1&&m.length===1?(g&&g.uninstall&&g.uninstall.call(this,r),delete this._callbacks[r]):w!==-1&&m.splice(w,1)),this},once:function(r,u){return this.on(r,function f(){u.apply(this,arguments),this.off(r,f)})},emit:function(r,u){var f=this._callbacks&&this._callbacks[r];if(!f)return!1;var g=a.slice(arguments,1),m=u&&u.target&&!u.currentTarget;f=f.slice(),m&&(u.currentTarget=this);for(var w=0,S=f.length;w<S;w++)if(f[w].apply(this,g)==!1){u&&u.stop&&u.stop();break}return m&&delete u.currentTarget,!0},responds:function(r){return!!(this._callbacks&&this._callbacks[r])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(r){var u=this._eventTypes,f=this._callbacks,g=r?"install":"uninstall";if(u){for(var m in f)if(f[m].length>0){var w=u[m],S=w&&w[g];S&&S.call(this,m)}}},statics:{inject:function r(u){var f=u._events;if(f){var g={};a.each(f,function(m,w){var S=typeof m=="string",C=S?m:w,T=a.capitalize(C),P=C.substring(2).toLowerCase();g[P]=S?{}:m,C="_"+C,u["get"+T]=function(){return this[C]},u["set"+T]=function(R){var B=this[C];B&&this.off(P,B),R&&this.on(P,R),this[C]=R}}),u._eventTypes=g}return r.base.apply(this,arguments)}}},p=a.extend({_class:"PaperScope",initialize:function r(){Ft=this,this.settings=new a({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=r._id++,r._scopes[this._id]=this;var u=r.prototype;if(!this.support){var f=tn.getContext(1,1)||{};u.support={nativeDash:"setLineDash"in f||"mozDash"in f,nativeBlendModes:fi.nativeModes},tn.release(f)}if(!this.agent){var g=e.navigator.userAgent.toLowerCase(),m=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(g)||[])[0],w=m==="darwin"?"mac":m,S=u.agent=u.browser={platform:w};w&&(S[w]=!0),g.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(C,T,P,R,B){if(!S.chrome){var j=T==="opera"?R:/^(node|trident)$/.test(T)?B:P;S.version=j,S.versionNumber=parseFloat(j),T={trident:"msie",jsdom:"node"}[T]||T,S.name=T,S[T]=!0}}),S.chrome&&delete S.webkit,S.atom&&delete S.chrome}},version:"0.12.18",getView:function(){var r=this.project;return r&&r._view},getPaper:function(){return this},execute:function(r,u){var f=Ft.PaperScript.execute(r,this,u);return en.updateFocus(),f},install:function(r){var u=this;a.each(["project","view","tool"],function(g){a.define(r,g,{configurable:!0,get:function(){return u[g]}})});for(var f in this)!/^_/.test(f)&&this[f]&&(r[f]=this[f])},setup:function(r){return Ft=this,this.project=new we(r),this},createCanvas:function(r,u){return tn.getCanvas(r,u)},activate:function(){Ft=this},clear:function(){for(var r=this.projects,u=this.tools,f=r.length-1;f>=0;f--)r[f].remove();for(var f=u.length-1;f>=0;f--)u[f].remove()},remove:function(){this.clear(),delete p._scopes[this._id]},statics:new function(){function r(u){return u+="Attribute",function(f,g){return f[u](g)||f[u]("data-paper-"+g)}}return{_scopes:{},_id:0,get:function(u){return this._scopes[u]||null},getAttribute:r("get"),hasAttribute:r("has")}}}),v=a.extend(h,{initialize:function(r){this._scope=Ft,this._index=this._scope[this._list].push(this)-1,(r||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var r=this._scope[this._reference];return r&&r!==this&&r.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",r),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(a.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),_={findItemBoundsCollisions:function(r,u,f){function g(S){for(var C=new Array(S.length),T=0;T<S.length;T++){var P=S[T].getBounds();C[T]=[P.left,P.top,P.right,P.bottom]}return C}var m=g(r),w=!u||u===r?m:g(u);return this.findBoundsCollisions(m,w,f||0)},findCurveBoundsCollisions:function(r,u,f,g){function m(j){for(var I=Math.min,Y=Math.max,z=new Array(j.length),H=0;H<j.length;H++){var L=j[H];z[H]=[I(L[0],L[2],L[4],L[6]),I(L[1],L[3],L[5],L[7]),Y(L[0],L[2],L[4],L[6]),Y(L[1],L[3],L[5],L[7])]}return z}var w=m(r),S=!u||u===r?w:m(u);if(g){for(var C=this.findBoundsCollisions(w,S,f||0,!1,!0),T=this.findBoundsCollisions(w,S,f||0,!0,!0),P=[],R=0,B=C.length;R<B;R++)P[R]={hor:C[R],ver:T[R]};return P}return this.findBoundsCollisions(w,S,f||0)},findBoundsCollisions:function(r,u,f,g,m){var w=!u||r===u,S=w?r:r.concat(u),C=r.length,T=S.length;function P(We,$e,it){for(var je=0,De=We.length;je<De;){var tt=De+je>>>1;S[We[tt]][$e]<it?je=tt+1:De=tt}return je-1}for(var R=g?1:0,B=R+2,j=g?0:1,I=j+2,Y=new Array(T),z=0;z<T;z++)Y[z]=z;Y.sort(function(We,$e){return S[We][R]-S[$e][R]});for(var H=[],L=new Array(C),z=0;z<T;z++){var U=Y[z],A=S[U],V=w?U:U-C,q=U<C,J=w||!q,X=q?[]:null;if(H.length){var te=P(H,B,A[R]-f)+1;if(H.splice(0,te),w&&m){X=X.concat(H);for(var ie=0;ie<H.length;ie++){var se=H[ie];L[se].push(V)}}else for(var he=A[I],ne=A[j],ie=0;ie<H.length;ie++){var se=H[ie],ce=S[se],fe=se<C,ye=w||se>=C;(m||(q&&ye||J&&fe)&&he>=ce[j]-f&&ne<=ce[I]+f)&&(q&&ye&&X.push(w?se:se-C),J&&fe&&L[se].push(V))}}if(q&&(r===u&&X.push(U),L[U]=X),H.length){var xe=A[B],Ee=P(H,B,xe);H.splice(Ee+1,0,U)}else H.push(U)}for(var z=0;z<L.length;z++){var Ne=L[z];Ne&&Ne.sort(function($e,it){return $e-it})}return L}},b=a.extend({initialize:function(r){this.precision=a.pick(r,5),this.multiplier=Math.pow(10,this.precision)},number:function(r){return this.precision<16?Math.round(r*this.multiplier)/this.multiplier:r},pair:function(r,u,f){return this.number(r)+(f||",")+this.number(u)},point:function(r,u){return this.number(r.x)+(u||",")+this.number(r.y)},size:function(r,u){return this.number(r.width)+(u||",")+this.number(r.height)},rectangle:function(r,u){return this.point(r,u)+(u||",")+this.size(r,u)}});b.instance=new b;var E=new function(){var r=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],u=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],f=Math.abs,g=Math.sqrt,m=Math.pow,w=Math.log2||function(B){return Math.log(B)*Math.LOG2E},S=1e-12,C=112e-18;function T(B,j,I){return B<j?j:B>I?I:B}function P(B,j,I){function Y(te){var ie=te*134217729,se=te-ie,he=se+ie,ne=te-he;return[he,ne]}var z=j*j-B*I,H=j*j+B*I;if(f(z)*3<H){var L=Y(B),U=Y(j),A=Y(I),V=j*j,q=U[0]*U[0]-V+2*U[0]*U[1]+U[1]*U[1],J=B*I,X=L[0]*A[0]-J+L[0]*A[1]+L[1]*A[0]+L[1]*A[1];z=V-J+(q-X)}return z}function R(){var B=Math.max.apply(Math,arguments);return B&&(B<1e-8||B>1e8)?m(2,-Math.round(w(B))):0}return{EPSILON:S,MACHINE_EPSILON:C,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(g(2)-1)/3,isZero:function(B){return B>=-S&&B<=S},isMachineZero:function(B){return B>=-C&&B<=C},clamp:T,integrate:function(B,j,I,Y){for(var z=r[Y-2],H=u[Y-2],L=(I-j)*.5,U=L+j,A=0,V=Y+1>>1,q=Y&1?H[A++]*B(U):0;A<V;){var J=L*z[A];q+=H[A++]*(B(U+J)+B(U-J))}return L*q},findRoot:function(B,j,I,Y,z,H,L){for(var U=0;U<H;U++){var A=B(I),V=A/j(I),q=I-V;if(f(V)<L){I=q;break}A>0?(z=I,I=q<=Y?(Y+z)*.5:q):(Y=I,I=q>=z?(Y+z)*.5:q)}return T(I,Y,z)},solveQuadratic:function(B,j,I,Y,z,H){var L,U=1/0;if(f(B)<S){if(f(j)<S)return f(I)<S?-1:0;L=-I/j}else{j*=-.5;var A=P(B,j,I);if(A&&f(A)<C){var V=R(f(B),f(j),f(I));V&&(B*=V,j*=V,I*=V,A=P(B,j,I))}if(A>=-C){var q=A<0?0:g(A),J=j+(j<0?-q:q);J===0?(L=I/B,U=-L):(L=J/B,U=I/J)}}var X=0,te=z==null,ie=z-S,se=H+S;return isFinite(L)&&(te||L>ie&&L<se)&&(Y[X++]=te?L:T(L,z,H)),U!==L&&isFinite(U)&&(te||U>ie&&U<se)&&(Y[X++]=te?U:T(U,z,H)),X},solveCubic:function(B,j,I,Y,z,H,L){var U=R(f(B),f(j),f(I),f(Y)),A,V,q,J,X;U&&(B*=U,j*=U,I*=U,Y*=U);function te(Ee){A=Ee;var Ne=B*A;V=Ne+j,q=V*A+I,J=(Ne+V)*A+q,X=q*A+Y}if(f(B)<S)B=j,V=I,q=Y,A=1/0;else if(f(Y)<S)V=j,q=I,A=0;else{te(-(j/B)/3);var ie=X/B,se=m(f(ie),1/3),he=ie<0?-1:1,ne=-J/B,ce=ne>0?1.324717957244746*Math.max(se,g(ne)):se,fe=A-he*ce;if(fe!==A){do te(fe),fe=J===0?A:A-X/J/(1+C);while(he*fe>he*A);f(B)*A*A>f(Y/A)&&(q=-Y/A,V=(q-I)/A)}}var ye=E.solveQuadratic(B,V,q,z,H,L),xe=H==null;return isFinite(A)&&(ye===0||ye>0&&A!==z[0]&&A!==z[1])&&(xe||A>H-S&&A<L+S)&&(z[ye++]=xe?A:T(A,H,L)),ye}}},N={_id:1,_pools:{},get:function(r){if(r){var u=this._pools[r];return u||(u=this._pools[r]={_id:1}),u._id++}else return this._id++}},O=a.extend({_class:"Point",_readIndex:!0,initialize:function(u,f){var g=typeof u,m=this.__read,w=0;if(g==="number"){var S=typeof f=="number";this._set(u,S?f:u),m&&(w=S?2:1)}else if(g==="undefined"||u===null)this._set(0,0),m&&(w=u===null?1:0);else{var C=g==="string"?u.split(/[\s,]+/)||[]:u;w=1,Array.isArray(C)?this._set(+C[0],+(C.length>1?C[1]:C[0])):"x"in C?this._set(C.x||0,C.y||0):"width"in C?this._set(C.width||0,C.height||0):"angle"in C?(this._set(C.length||0,0),this.setAngle(C.angle||0)):(this._set(0,0),w=0)}return m&&(this.__read=w),this},set:"#initialize",_set:function(r,u){return this.x=r,this.y=u,this},equals:function(r){return this===r||r&&(this.x===r.x&&this.y===r.y||Array.isArray(r)&&this.x===r[0]&&this.y===r[1])||!1},clone:function(){return new O(this.x,this.y)},toString:function(){var r=b.instance;return"{ x: "+r.number(this.x)+", y: "+r.number(this.y)+" }"},_serialize:function(r){var u=r.formatter;return[u.number(this.x),u.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(r){if(this.isZero()){var u=this._angle||0;this._set(Math.cos(u)*r,Math.sin(u)*r)}else{var f=r/this.getLength();E.isZero(f)&&this.getAngle(),this._set(this.x*f,this.y*f)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(r){this.setAngleInRadians.call(this,r*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var r=O.read(arguments),u=this.getLength()*r.getLength();if(E.isZero(u))return NaN;var f=this.dot(r)/u;return Math.acos(f<-1?-1:f>1?1:f)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(r){if(this._angle=r,!this.isZero()){var u=this.getLength();this._set(Math.cos(r)*u,Math.sin(r)*u)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var r=O.read(arguments);return Math.atan2(this.cross(r),this.dot(r))*180/Math.PI},getDistance:function(){var r=arguments,u=O.read(r),f=u.x-this.x,g=u.y-this.y,m=f*f+g*g,w=a.read(r);return w?m:Math.sqrt(m)},normalize:function(r){r===t&&(r=1);var u=this.getLength(),f=u!==0?r/u:0,g=new O(this.x*f,this.y*f);return f>=0&&(g._angle=this._angle),g},rotate:function(r,u){if(r===0)return this.clone();r=r*Math.PI/180;var f=u?this.subtract(u):this,g=Math.sin(r),m=Math.cos(r);return f=new O(f.x*m-f.y*g,f.x*g+f.y*m),u?f.add(u):f},transform:function(r){return r?r._transformPoint(this):this},add:function(){var r=O.read(arguments);return new O(this.x+r.x,this.y+r.y)},subtract:function(){var r=O.read(arguments);return new O(this.x-r.x,this.y-r.y)},multiply:function(){var r=O.read(arguments);return new O(this.x*r.x,this.y*r.y)},divide:function(){var r=O.read(arguments);return new O(this.x/r.x,this.y/r.y)},modulo:function(){var r=O.read(arguments);return new O(this.x%r.x,this.y%r.y)},negate:function(){return new O(-this.x,-this.y)},isInside:function(){return K.read(arguments).contains(this)},isClose:function(){var r=arguments,u=O.read(r),f=a.read(r);return this.getDistance(u)<=f},isCollinear:function(){var r=O.read(arguments);return O.isCollinear(this.x,this.y,r.x,r.y)},isColinear:"#isCollinear",isOrthogonal:function(){var r=O.read(arguments);return O.isOrthogonal(this.x,this.y,r.x,r.y)},isZero:function(){var r=E.isZero;return r(this.x)&&r(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(r){return this.x*(r>1&&r<4?-1:1)>=0&&this.y*(r>2?-1:1)>=0},dot:function(){var r=O.read(arguments);return this.x*r.x+this.y*r.y},cross:function(){var r=O.read(arguments);return this.x*r.y-this.y*r.x},project:function(){var r=O.read(arguments),u=r.isZero()?0:this.dot(r)/r.dot(r);return new O(r.x*u,r.y*u)},statics:{min:function(){var r=arguments,u=O.read(r),f=O.read(r);return new O(Math.min(u.x,f.x),Math.min(u.y,f.y))},max:function(){var r=arguments,u=O.read(r),f=O.read(r);return new O(Math.max(u.x,f.x),Math.max(u.y,f.y))},random:function(){return new O(Math.random(),Math.random())},isCollinear:function(r,u,f,g){return Math.abs(r*g-u*f)<=Math.sqrt((r*r+u*u)*(f*f+g*g))*1e-8},isOrthogonal:function(r,u,f,g){return Math.abs(r*f+u*g)<=Math.sqrt((r*r+u*u)*(f*f+g*g))*1e-8}}},a.each(["round","ceil","floor","abs"],function(r){var u=Math[r];this[r]=function(){return new O(u(this.x),u(this.y))}},{})),Q=O.extend({initialize:function(u,f,g,m){this._x=u,this._y=f,this._owner=g,this._setter=m},_set:function(r,u,f){return this._x=r,this._y=u,f||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(r){this._x=r,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(r){this._y=r,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(r){this._owner._changeSelection(this._getSelection(),r)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),W=a.extend({_class:"Size",_readIndex:!0,initialize:function(u,f){var g=typeof u,m=this.__read,w=0;if(g==="number"){var S=typeof f=="number";this._set(u,S?f:u),m&&(w=S?2:1)}else if(g==="undefined"||u===null)this._set(0,0),m&&(w=u===null?1:0);else{var C=g==="string"?u.split(/[\s,]+/)||[]:u;w=1,Array.isArray(C)?this._set(+C[0],+(C.length>1?C[1]:C[0])):"width"in C?this._set(C.width||0,C.height||0):"x"in C?this._set(C.x||0,C.y||0):(this._set(0,0),w=0)}return m&&(this.__read=w),this},set:"#initialize",_set:function(r,u){return this.width=r,this.height=u,this},equals:function(r){return r===this||r&&(this.width===r.width&&this.height===r.height||Array.isArray(r)&&this.width===r[0]&&this.height===r[1])||!1},clone:function(){return new W(this.width,this.height)},toString:function(){var r=b.instance;return"{ width: "+r.number(this.width)+", height: "+r.number(this.height)+" }"},_serialize:function(r){var u=r.formatter;return[u.number(this.width),u.number(this.height)]},add:function(){var r=W.read(arguments);return new W(this.width+r.width,this.height+r.height)},subtract:function(){var r=W.read(arguments);return new W(this.width-r.width,this.height-r.height)},multiply:function(){var r=W.read(arguments);return new W(this.width*r.width,this.height*r.height)},divide:function(){var r=W.read(arguments);return new W(this.width/r.width,this.height/r.height)},modulo:function(){var r=W.read(arguments);return new W(this.width%r.width,this.height%r.height)},negate:function(){return new W(-this.width,-this.height)},isZero:function(){var r=E.isZero;return r(this.width)&&r(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(r,u){return new W(Math.min(r.width,u.width),Math.min(r.height,u.height))},max:function(r,u){return new W(Math.max(r.width,u.width),Math.max(r.height,u.height))},random:function(){return new W(Math.random(),Math.random())}}},a.each(["round","ceil","floor","abs"],function(r){var u=Math[r];this[r]=function(){return new W(u(this.width),u(this.height))}},{})),ee=W.extend({initialize:function(u,f,g,m){this._width=u,this._height=f,this._owner=g,this._setter=m},_set:function(r,u,f){return this._width=r,this._height=u,f||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(r){this._width=r,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(r){this._height=r,this._owner[this._setter](this)}}),K=a.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(u,f,g,m){var w=arguments,S=typeof u,C;if(S==="number"?(this._set(u,f,g,m),C=4):S==="undefined"||u===null?(this._set(0,0,0,0),C=u===null?1:0):w.length===1&&(Array.isArray(u)?(this._set.apply(this,u),C=1):u.x!==t||u.width!==t?(this._set(u.x||0,u.y||0,u.width||0,u.height||0),C=1):u.from===t&&u.to===t&&(this._set(0,0,0,0),a.readSupported(w,this)&&(C=1))),C===t){var T=O.readNamed(w,"from"),P=a.peek(w),R=T.x,B=T.y,j,I;if(P&&P.x!==t||a.hasNamed(w,"to")){var Y=O.readNamed(w,"to");j=Y.x-R,I=Y.y-B,j<0&&(R=Y.x,j=-j),I<0&&(B=Y.y,I=-I)}else{var z=W.read(w);j=z.width,I=z.height}this._set(R,B,j,I),C=w.__index}var H=w.__filtered;return H&&(this.__filtered=H),this.__read&&(this.__read=C),this},set:"#initialize",_set:function(r,u,f,g){return this.x=r,this.y=u,this.width=f,this.height=g,this},clone:function(){return new K(this.x,this.y,this.width,this.height)},equals:function(r){var u=a.isPlainValue(r)?K.read(arguments):r;return u===this||u&&this.x===u.x&&this.y===u.y&&this.width===u.width&&this.height===u.height||!1},toString:function(){var r=b.instance;return"{ x: "+r.number(this.x)+", y: "+r.number(this.y)+", width: "+r.number(this.width)+", height: "+r.number(this.height)+" }"},_serialize:function(r){var u=r.formatter;return[u.number(this.x),u.number(this.y),u.number(this.width),u.number(this.height)]},getPoint:function(r){var u=r?O:Q;return new u(this.x,this.y,this,"setPoint")},setPoint:function(){var r=O.read(arguments);this.x=r.x,this.y=r.y},getSize:function(r){var u=r?W:ee;return new u(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var r=W.read(arguments),u=this._sx,f=this._sy,g=r.width,m=r.height;u&&(this.x+=(this.width-g)*u),f&&(this.y+=(this.height-m)*f),this.width=g,this.height=m,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(r){if(!this._fw){var u=r-this.x;this.width-=this._sx===.5?u*2:u}this.x=r,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(r){if(!this._fh){var u=r-this.y;this.height-=this._sy===.5?u*2:u}this.y=r,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(r){if(!this._fw){var u=r-this.x;this.width=this._sx===.5?u*2:u}this.x=r-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(r){if(!this._fh){var u=r-this.y;this.height=this._sy===.5?u*2:u}this.y=r-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(r){this._fw||this._sx===.5?this.x=r-this.width/2:(this._sx&&(this.x+=(r-this.x)*2*this._sx),this.width=(r-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(r){this._fh||this._sy===.5?this.y=r-this.height/2:(this._sy&&(this.y+=(r-this.y)*2*this._sy),this.height=(r-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(r){var u=r?O:Q;return new u(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var r=O.read(arguments);return this.setCenterX(r.x),this.setCenterY(r.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(r){return r&&r.width!==t||(Array.isArray(r)?r:arguments).length===4?this._containsRectangle(K.read(arguments)):this._containsPoint(O.read(arguments))},_containsPoint:function(r){var u=r.x,f=r.y;return u>=this.x&&f>=this.y&&u<=this.x+this.width&&f<=this.y+this.height},_containsRectangle:function(r){var u=r.x,f=r.y;return u>=this.x&&f>=this.y&&u+r.width<=this.x+this.width&&f+r.height<=this.y+this.height},intersects:function(){var r=K.read(arguments),u=a.read(arguments)||0;return r.x+r.width>this.x-u&&r.y+r.height>this.y-u&&r.x<this.x+this.width+u&&r.y<this.y+this.height+u},intersect:function(){var r=K.read(arguments),u=Math.max(this.x,r.x),f=Math.max(this.y,r.y),g=Math.min(this.x+this.width,r.x+r.width),m=Math.min(this.y+this.height,r.y+r.height);return new K(u,f,g-u,m-f)},unite:function(){var r=K.read(arguments),u=Math.min(this.x,r.x),f=Math.min(this.y,r.y),g=Math.max(this.x+this.width,r.x+r.width),m=Math.max(this.y+this.height,r.y+r.height);return new K(u,f,g-u,m-f)},include:function(){var r=O.read(arguments),u=Math.min(this.x,r.x),f=Math.min(this.y,r.y),g=Math.max(this.x+this.width,r.x),m=Math.max(this.y+this.height,r.y);return new K(u,f,g-u,m-f)},expand:function(){var r=W.read(arguments),u=r.width,f=r.height;return new K(this.x-u/2,this.y-f/2,this.width+u,this.height+f)},scale:function(r,u){return this.expand(this.width*r-this.width,this.height*(u===t?r:u)-this.height)}},a.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(r,u){var f=r.join(""),g=/^[RL]/.test(f);u>=4&&(r[1]+=g?"Y":"X");var m=r[g?0:1],w=r[g?1:0],S="get"+m,C="get"+w,T="set"+m,P="set"+w,R="get"+f,B="set"+f;this[R]=function(j){var I=j?O:Q;return new I(this[S](),this[C](),this,B)},this[B]=function(){var j=O.read(arguments);this[T](j.x),this[P](j.y)}},{beans:!0})),ae=K.extend({initialize:function(u,f,g,m,w,S){this._set(u,f,g,m,!0),this._owner=w,this._setter=S},_set:function(r,u,f,g,m){return this._x=r,this._y=u,this._width=f,this._height=g,m||this._owner[this._setter](this),this}},new function(){var r=K.prototype;return a.each(["x","y","width","height"],function(u){var f=a.capitalize(u),g="_"+u;this["get"+f]=function(){return this[g]},this["set"+f]=function(m){this[g]=m,this._dontNotify||this._owner[this._setter](this)}},a.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(u){var f="set"+u;this[f]=function(){this._dontNotify=!0,r[f].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(u){var f=this._owner;f._changeSelection&&f._changeSelection(2,u)}}))}),le=a.extend({_class:"Matrix",initialize:function r(u,f){var g=arguments,m=g.length,w=!0;if(m>=6?this._set.apply(this,g):m===1||m===2?u instanceof r?this._set(u._a,u._b,u._c,u._d,u._tx,u._ty,f):Array.isArray(u)?this._set.apply(this,f?u.concat([f]):u):w=!1:m?w=!1:this.reset(),!w)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(r,u,f,g,m,w,S){return this._a=r,this._b=u,this._c=f,this._d=g,this._tx=m,this._ty=w,S||this._changed(),this},_serialize:function(r,u){return a.serialize(this.getValues(),r,!0,u)},_changed:function(){var r=this._owner;r&&(r._applyMatrix?r.transform(null,!0):r._changed(25))},clone:function(){return new le(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(r){return r===this||r&&this._a===r._a&&this._b===r._b&&this._c===r._c&&this._d===r._d&&this._tx===r._tx&&this._ty===r._ty},toString:function(){var r=b.instance;return"[["+[r.number(this._a),r.number(this._c),r.number(this._tx)].join(", ")+"], ["+[r.number(this._b),r.number(this._d),r.number(this._ty)].join(", ")+"]]"},reset:function(r){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,r||this._changed(),this},apply:function(r,u){var f=this._owner;return f?(f.transform(null,a.pick(r,!0),u),this.isIdentity()):!1},translate:function(){var r=O.read(arguments),u=r.x,f=r.y;return this._tx+=u*this._a+f*this._c,this._ty+=u*this._b+f*this._d,this._changed(),this},scale:function(){var r=arguments,u=O.read(r),f=O.read(r,0,{readNull:!0});return f&&this.translate(f),this._a*=u.x,this._b*=u.x,this._c*=u.y,this._d*=u.y,f&&this.translate(f.negate()),this._changed(),this},rotate:function(r){r*=Math.PI/180;var u=O.read(arguments,1),f=u.x,g=u.y,m=Math.cos(r),w=Math.sin(r),S=f-f*m+g*w,C=g-f*w-g*m,T=this._a,P=this._b,R=this._c,B=this._d;return this._a=m*T+w*R,this._b=m*P+w*B,this._c=-w*T+m*R,this._d=-w*P+m*B,this._tx+=S*T+C*R,this._ty+=S*P+C*B,this._changed(),this},shear:function(){var r=arguments,u=O.read(r),f=O.read(r,0,{readNull:!0});f&&this.translate(f);var g=this._a,m=this._b;return this._a+=u.y*this._c,this._b+=u.y*this._d,this._c+=u.x*g,this._d+=u.x*m,f&&this.translate(f.negate()),this._changed(),this},skew:function(){var r=arguments,u=O.read(r),f=O.read(r,0,{readNull:!0}),g=Math.PI/180,m=new O(Math.tan(u.x*g),Math.tan(u.y*g));return this.shear(m,f)},append:function(r,u){if(r){var f=this._a,g=this._b,m=this._c,w=this._d,S=r._a,C=r._c,T=r._b,P=r._d,R=r._tx,B=r._ty;this._a=S*f+T*m,this._c=C*f+P*m,this._b=S*g+T*w,this._d=C*g+P*w,this._tx+=R*f+B*m,this._ty+=R*g+B*w,u||this._changed()}return this},prepend:function(r,u){if(r){var f=this._a,g=this._b,m=this._c,w=this._d,S=this._tx,C=this._ty,T=r._a,P=r._c,R=r._b,B=r._d,j=r._tx,I=r._ty;this._a=T*f+P*g,this._c=T*m+P*w,this._b=R*f+B*g,this._d=R*m+B*w,this._tx=T*S+P*C+j,this._ty=R*S+B*C+I,u||this._changed()}return this},appended:function(r){return this.clone().append(r)},prepended:function(r){return this.clone().prepend(r)},invert:function(){var r=this._a,u=this._b,f=this._c,g=this._d,m=this._tx,w=this._ty,S=r*g-u*f,C=null;return S&&!isNaN(S)&&isFinite(m)&&isFinite(w)&&(this._a=g/S,this._b=-u/S,this._c=-f/S,this._d=r/S,this._tx=(f*w-g*m)/S,this._ty=(u*m-r*w)/S,C=this),C},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new le(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var r=this._a*this._d-this._c*this._b;return r&&!isNaN(r)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(r,u,f){return arguments.length<3?this._transformPoint(O.read(arguments)):this._transformCoordinates(r,u,f)},_transformPoint:function(r,u,f){var g=r.x,m=r.y;return u||(u=new O),u._set(g*this._a+m*this._c+this._tx,g*this._b+m*this._d+this._ty,f)},_transformCoordinates:function(r,u,f){for(var g=0,m=2*f;g<m;g+=2){var w=r[g],S=r[g+1];u[g]=w*this._a+S*this._c+this._tx,u[g+1]=w*this._b+S*this._d+this._ty}return u},_transformCorners:function(r){var u=r.x,f=r.y,g=u+r.width,m=f+r.height,w=[u,f,g,f,g,m,u,m];return this._transformCoordinates(w,w,4)},_transformBounds:function(r,u,f){for(var g=this._transformCorners(r),m=g.slice(0,2),w=m.slice(),S=2;S<8;S++){var C=g[S],T=S&1;C<m[T]?m[T]=C:C>w[T]&&(w[T]=C)}return u||(u=new K),u._set(m[0],m[1],w[0]-m[0],w[1]-m[1],f)},inverseTransform:function(){return this._inverseTransform(O.read(arguments))},_inverseTransform:function(r,u,f){var g=this._a,m=this._b,w=this._c,S=this._d,C=this._tx,T=this._ty,P=g*S-m*w,R=null;if(P&&!isNaN(P)&&isFinite(C)&&isFinite(T)){var B=r.x-this._tx,j=r.y-this._ty;u||(u=new O),R=u._set((B*S-j*w)/P,(j*g-B*m)/P,f)}return R},decompose:function(){var r=this._a,u=this._b,f=this._c,g=this._d,m=r*g-u*f,w=Math.sqrt,S=Math.atan2,C=180/Math.PI,T,P,R;if(r!==0||u!==0){var B=w(r*r+u*u);T=Math.acos(r/B)*(u>0?1:-1),P=[B,m/B],R=[S(r*f+u*g,B*B),0]}else if(f!==0||g!==0){var j=w(f*f+g*g);T=Math.asin(f/j)*(g>0?1:-1),P=[m/j,j],R=[0,S(r*f+u*g,j*j)]}else T=0,R=P=[0,0];return{translation:this.getTranslation(),rotation:T*C,scaling:new O(P),skewing:new O(R[0]*C,R[1]*C)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new O(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(r){this.isIdentity()||r.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},a.each(["a","b","c","d","tx","ty"],function(r){var u=a.capitalize(r),f="_"+r;this["get"+u]=function(){return this[f]},this["set"+u]=function(g){this[f]=g,this._changed()}},{})),ve=a.extend({_class:"Line",initialize:function(u,f,g,m,w){var S=!1;arguments.length>=4?(this._px=u,this._py=f,this._vx=g,this._vy=m,S=w):(this._px=u.x,this._py=u.y,this._vx=f.x,this._vy=f.y,S=g),S||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new O(this._px,this._py)},getVector:function(){return new O(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(r,u){return ve.intersect(this._px,this._py,this._vx,this._vy,r._px,r._py,r._vx,r._vy,!0,u)},getSide:function(r,u){return ve.getSide(this._px,this._py,this._vx,this._vy,r.x,r.y,!0,u)},getDistance:function(r){return Math.abs(this.getSignedDistance(r))},getSignedDistance:function(r){return ve.getSignedDistance(this._px,this._py,this._vx,this._vy,r.x,r.y,!0)},isCollinear:function(r){return O.isCollinear(this._vx,this._vy,r._vx,r._vy)},isOrthogonal:function(r){return O.isOrthogonal(this._vx,this._vy,r._vx,r._vy)},statics:{intersect:function(r,u,f,g,m,w,S,C,T,P){T||(f-=r,g-=u,S-=m,C-=w);var R=f*C-g*S;if(!E.isMachineZero(R)){var B=r-m,j=u-w,I=(S*j-C*B)/R,Y=(f*j-g*B)/R,z=1e-12,H=-z,L=1+z;if(P||H<I&&I<L&&H<Y&&Y<L)return P||(I=I<=0?0:I>=1?1:I),new O(r+I*f,u+I*g)}},getSide:function(r,u,f,g,m,w,S,C){S||(f-=r,g-=u);var T=m-r,P=w-u,R=T*g-P*f;return!C&&E.isMachineZero(R)&&(R=(T*f+T*f)/(f*f+g*g),R>=0&&R<=1&&(R=0)),R<0?-1:R>0?1:0},getSignedDistance:function(r,u,f,g,m,w,S){return S||(f-=r,g-=u),f===0?g>0?m-r:r-m:g===0?f<0?w-u:u-w:((m-r)*g-(w-u)*f)/(g>f?g*Math.sqrt(1+f*f/(g*g)):f*Math.sqrt(1+g*g/(f*f)))},getDistance:function(r,u,f,g,m,w,S){return Math.abs(ve.getSignedDistance(r,u,f,g,m,w,S))}}}),we=v.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(u){v.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Ut(null,null,this),this._view=en.create(this,u||tn.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(r,u){return a.serialize(this._children,r,!0,u)},_changed:function(r,u){if(r&1){var f=this._view;f&&(f._needsUpdate=!0,!f._requested&&f._autoUpdate&&f.requestUpdate())}var g=this._changes;if(g&&u){var m=this._changesById,w=u._id,S=m[w];S?S.flags|=r:g.push(m[w]={item:u,flags:r})}},clear:function(){for(var r=this._children,u=r.length-1;u>=0;u--)r[u].remove()},isEmpty:function(){return!this._children.length},remove:function r(){return r.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(r){this._currentStyle.set(r)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new He({project:this,insert:!0})},getSymbolDefinitions:function(){var r=[],u={};return this.getItems({class:Ie,match:function(f){var g=f._definition,m=g._id;return u[m]||(u[m]=!0,r.push(g)),!1}}),r},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var r=this._selectionItems,u=[];for(var f in r){var g=r[f],m=g._selection;m&1&&g.isInserted()?u.push(g):m||this._updateSelection(g)}return u},_updateSelection:function(r){var u=r._id,f=this._selectionItems;r._selection?f[u]!==r&&(this._selectionCount++,f[u]=r):f[u]===r&&(this._selectionCount--,delete f[u])},selectAll:function(){for(var r=this._children,u=0,f=r.length;u<f;u++)r[u].setFullySelected(!0)},deselectAll:function(){var r=this._selectionItems;for(var u in r)r[u].setFullySelected(!1)},addLayer:function(r){return this.insertLayer(t,r)},insertLayer:function(r,u){if(u instanceof He){u._remove(!1,!0),a.splice(this._children,[u],r,0),u._setProject(this,!0);var f=u._name;f&&u.setName(f),this._changes&&u._changed(5),this._activeLayer||(this._activeLayer=u)}else u=null;return u},_insertItem:function(r,u,f){return u=this.insertLayer(r,u)||(this._activeLayer||this._insertItem(t,new He(F.NO_INSERT),!0)).insertChild(r,u),f&&u.activate&&u.activate(),u},getItems:function(r){return F._getItems(this,r)},getItem:function(r){return F._getItems(this,r,null,null,!0)[0]||null},importJSON:function(r){this.activate();var u=this._activeLayer;return a.importJSON(r,u&&u.isEmpty()&&u)},removeOn:function(r){var u=this._removeSets;if(u){r==="mouseup"&&(u.mousedrag=null);var f=u[r];if(f){for(var g in f){var m=f[g];for(var w in u){var S=u[w];S&&S!=f&&delete S[m._id]}m.remove()}u[r]=null}}},draw:function(r,u,f){this._updateVersion++,r.save(),u.applyToContext(r);for(var g=this._children,m=new a({offset:new O(0,0),pixelRatio:f,viewMatrix:u.isIdentity()?null:u,matrices:[new le],updateMatrix:!0}),w=0,S=g.length;w<S;w++)g[w].draw(r,m);if(r.restore(),this._selectionCount>0){r.save(),r.strokeWidth=1;var C=this._selectionItems,T=this._scope.settings.handleSize,P=this._updateVersion;for(var R in C)C[R]._drawSelection(r,u,T,C,P);r.restore()}}}),F=a.extend(h,{statics:{extend:function r(u){return u._serializeFields&&(u._serializeFields=a.set({},this.prototype._serializeFields,u._serializeFields)),r.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new le,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var r=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return a.each(r,function(u){this._events[u]={install:function(f){this.getView()._countItemEvent(f,1)},uninstall:function(f){this.getView()._countItemEvent(f,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:r}})},{initialize:function(){},_initialize:function(r,u){var f=r&&a.isPlainObject(r),g=f&&r.internal===!0,m=this._matrix=new le,w=f&&r.project||Ft.project,S=Ft.settings;return this._id=g?null:N.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&S.applyMatrix,u&&m.translate(u),m._owner=this,this._style=new Ut(w._currentStyle,this,w),g||f&&r.insert==!1||!S.insertItems&&!(f&&r.insert==!0)?this._setProject(w):(f&&r.parent||w)._insertItem(t,this,!0),f&&r!==F.NO_INSERT&&r!==F.INSERT&&this.set(r,{internal:!0,insert:!0,project:!0,parent:!0}),f},_serialize:function(r,u){var f={},g=this;function m(w){for(var S in w){var C=g[S];a.equals(C,S==="leading"?w.fontSize*1.2:w[S])||(f[S]=a.serialize(C,r,S!=="data",u))}}return m(this._serializeFields),this instanceof ze||m(this._style._defaults),[this._class,f]},_changed:function(r){var u=this._symbol,f=this._parent||u,g=this._project;r&8&&(this._bounds=this._position=this._decomposed=t),r&16&&(this._globalMatrix=t),f&&r&72&&F._clearBoundsCache(f),r&2&&F._clearBoundsCache(this),g&&g._changed(r,this),u&&u._changed(r)},getId:function(){return this._id},getName:function(){return this._name},setName:function(r){if(this._name&&this._removeNamed(),r===+r+"")throw new Error("Names consisting only of numbers are not supported.");var u=this._getOwner();if(r&&u){var f=u._children,g=u._namedChildren;(g[r]=g[r]||[]).push(this),r in f||(f[r]=this)}this._name=r||t,this._changed(256)},getStyle:function(){return this._style},setStyle:function(r){this.getStyle().set(r)}},a.each(["locked","visible","blendMode","opacity","guide"],function(r){var u=a.capitalize(r),f="_"+r,g={locked:256,visible:265};this["get"+u]=function(){return this[f]},this["set"+u]=function(m){m!=this[f]&&(this[f]=m,this._changed(g[r]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(r){if(r!==this._selection){this._selection=r;var u=this._project;u&&(u._updateSelection(this),this._changed(257))}},_changeSelection:function(r,u){var f=this._selection;this.setSelection(u?f|r:f&~r)},isSelected:function(){if(this._selectChildren){for(var r=this._children,u=0,f=r.length;u<f;u++)if(r[u].isSelected())return!0}return!!(this._selection&1)},setSelected:function(r){if(this._selectChildren)for(var u=this._children,f=0,g=u.length;f<g;f++)u[f].setSelected(r);this._changeSelection(1,r)},isFullySelected:function(){var r=this._children,u=!!(this._selection&1);if(r&&u){for(var f=0,g=r.length;f<g;f++)if(!r[f].isFullySelected())return!1;return!0}return u},setFullySelected:function(r){var u=this._children;if(u)for(var f=0,g=u.length;f<g;f++)u[f].setFullySelected(r);this._changeSelection(1,r)},isClipMask:function(){return this._clipMask},setClipMask:function(r){this._clipMask!=(r=!!r)&&(this._clipMask=r,r&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(r){this._data=r},getPosition:function(r){var u=r?O:Q,f=this._position||(this._position=this._getPositionFromBounds());return new u(f.x,f.y,this,"setPosition")},setPosition:function(){this.translate(O.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(r){return this._pivot?this._matrix._transformPoint(this._pivot):(r||this.getBounds()).getCenter(!0)},getPivot:function(){var r=this._pivot;return r?new Q(r.x,r.y,this,"setPivot"):null},setPivot:function(){this._pivot=O.read(arguments,0,{clone:!0,readNull:!0}),this._position=t}},a.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(r,u){this[u]=function(f){return this.getBounds(f,r)}},{beans:!0,getBounds:function(r,u){var f=u||r instanceof le,g=a.set({},f?u:r,this._boundsOptions);(!g.stroke||this.getStrokeScaling())&&(g.cacheItem=this);var m=this._getCachedBounds(f&&r,g).rect;return arguments.length?m:new ae(m.x,m.y,m.width,m.height,this,"setBounds")},setBounds:function(){var r=K.read(arguments),u=this.getBounds(),f=this._matrix,g=new le,m=r.getCenter();g.translate(m),(r.width!=u.width||r.height!=u.height)&&(f.isInvertible()||(f.set(f._backup||new le().translate(f.getTranslation())),u=this.getBounds()),g.scale(u.width!==0?r.width/u.width:0,u.height!==0?r.height/u.height:0)),m=u.getCenter(),g.translate(-m.x,-m.y),this.transform(g)},_getBounds:function(r,u){var f=this._children;return!f||!f.length?new K:(F._updateBoundsCache(this,u.cacheItem),F._getBounds(f,r,u))},_getBoundsCacheKey:function(r,u){return[r.stroke?1:0,r.handle?1:0,u?1:0].join("")},_getCachedBounds:function(r,u,f){r=r&&r._orNullIfIdentity();var g=u.internal&&!f,m=u.cacheItem,w=g?null:this._matrix._orNullIfIdentity(),S=m&&(!r||r.equals(w))&&this._getBoundsCacheKey(u,g),C=this._bounds;if(F._updateBoundsCache(this._parent||this._symbol,m),S&&C&&S in C){var T=C[S];return{rect:T.rect.clone(),nonscaling:T.nonscaling}}var P=this._getBounds(r||w,u),R=P.rect||P,B=this._style,j=P.nonscaling||B.hasStroke()&&!B.getStrokeScaling();if(S){C||(this._bounds=C={});var T=C[S]={rect:R.clone(),nonscaling:j,internal:g}}return{rect:R,nonscaling:j}},_getStrokeMatrix:function(r,u){var f=this.getStrokeScaling()?null:u&&u.internal?this:this._parent||this._symbol&&this._symbol._item,g=f?f.getViewMatrix().invert():r;return g&&g._shiftless()},statics:{_updateBoundsCache:function(r,u){if(r&&u){var f=u._id,g=r._boundsCache=r._boundsCache||{ids:{},list:[]};g.ids[f]||(g.list.push(u),g.ids[f]=u)}},_clearBoundsCache:function(r){var u=r._boundsCache;if(u){r._bounds=r._position=r._boundsCache=t;for(var f=0,g=u.list,m=g.length;f<m;f++){var w=g[f];w!==r&&(w._bounds=w._position=t,w._boundsCache&&F._clearBoundsCache(w))}}},_getBounds:function(r,u,f){var g=1/0,m=-g,w=g,S=m,C=!1;f=f||{};for(var T=0,P=r.length;T<P;T++){var R=r[T];if(R._visible&&!R.isEmpty(!0)){var B=R._getCachedBounds(u&&u.appended(R._matrix),f,!0),j=B.rect;g=Math.min(j.x,g),w=Math.min(j.y,w),m=Math.max(j.x+j.width,m),S=Math.max(j.y+j.height,S),B.nonscaling&&(C=!0)}}return{rect:isFinite(g)?new K(g,w,m-g,S-w):new K,nonscaling:C}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var r=this._decompose();return r?r.rotation:0},setRotation:function(r){var u=this.getRotation();if(u!=null&&r!=null){var f=this._decomposed;this.rotate(r-u),f&&(f.rotation=r,this._decomposed=f)}},getScaling:function(){var r=this._decompose(),u=r&&r.scaling;return new Q(u?u.x:1,u?u.y:1,this,"setScaling")},setScaling:function(){var r=this.getScaling(),u=O.read(arguments,0,{clone:!0,readNull:!0});if(r&&u&&!r.equals(u)){var f=this.getRotation(),g=this._decomposed,m=new le,w=E.isZero;if(w(r.x)||w(r.y))m.translate(g.translation),f&&m.rotate(f),m.scale(u.x,u.y),this._matrix.set(m);else{var S=this.getPosition(!0);m.translate(S),f&&m.rotate(f),m.scale(u.x/r.x,u.y/r.y),f&&m.rotate(-f),m.translate(S.negate()),this.transform(m)}g&&(g.scaling=u,this._decomposed=g)}},getMatrix:function(){return this._matrix},setMatrix:function(){var r=this._matrix;r.set.apply(r,arguments)},getGlobalMatrix:function(r){var u=this._globalMatrix;if(u)for(var f=this._parent,g=[];f;){if(!f._globalMatrix){u=null;for(var m=0,w=g.length;m<w;m++)g[m]._globalMatrix=null;break}g.push(f),f=f._parent}if(!u){u=this._globalMatrix=this._matrix.clone();var f=this._parent;f&&u.prepend(f.getGlobalMatrix(!0))}return r?u:u.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(r){(this._applyMatrix=this._canApplyMatrix&&!!r)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(r,u){if(this._project!==r){this._project&&this._installEvents(!1),this._project=r;for(var f=this._children,g=0,m=f&&f.length;g<m;g++)f[g]._setProject(r);u=!0}u&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function r(u){r.base.call(this,u);for(var f=this._children,g=0,m=f&&f.length;g<m;g++)f[g]._installEvents(u)},getLayer:function(){for(var r=this;r=r._parent;)if(r instanceof He)return r;return null},getParent:function(){return this._parent},setParent:function(r){return r.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(r){this.removeChildren(),this.addChildren(r)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var r=this._getOwner();return r&&r._children[this._index+1]||null},getPreviousSibling:function(){var r=this._getOwner();return r&&r._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(r){var u=this._parent,f=u&&u._children;f&&u.insertChildren(r in f?r:t,[this])},equals:function(r){return r===this||r&&this._class===r._class&&this._style.equals(r._style)&&this._matrix.equals(r._matrix)&&this._locked===r._locked&&this._visible===r._visible&&this._blendMode===r._blendMode&&this._opacity===r._opacity&&this._clipMask===r._clipMask&&this._guide===r._guide&&this._equals(r)||!1},_equals:function(r){return a.equals(this._children,r._children)},clone:function(r){var u=new this.constructor(F.NO_INSERT),f=this._children,g=a.pick(r?r.insert:t,r===t||r===!0),m=a.pick(r?r.deep:t,!0);f&&u.copyAttributes(this),(!f||m)&&u.copyContent(this),f||u.copyAttributes(this),g&&u.insertAbove(this);var w=this._name,S=this._parent;if(w&&S){for(var f=S._children,C=w,T=1;f[w];)w=C+" "+T++;w!==C&&u.setName(w)}return u},copyContent:function(r){for(var u=r._children,f=0,g=u&&u.length;f<g;f++)this.addChild(u[f].clone(!1),!0)},copyAttributes:function(r,u){this.setStyle(r._style);for(var f=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],g=0,m=f.length;g<m;g++){var w=f[g];r.hasOwnProperty(w)&&(this[w]=r[w])}u||this._matrix.set(r._matrix,!0),this.setApplyMatrix(r._applyMatrix),this.setPivot(r._pivot),this.setSelection(r._selection);var S=r._data,C=r._name;this._data=S?a.clone(S):null,C&&this.setName(C)},rasterize:function(r,u){var f,g,m;a.isPlainObject(r)?(f=r.resolution,g=r.insert,m=r.raster):(f=r,g=u),m||(m=new ut(F.NO_INSERT));var w=this.getStrokeBounds(),S=(f||this.getView().getResolution())/72,C=w.getTopLeft().floor(),T=w.getBottomRight().ceil(),P=new W(T.subtract(C)),R=P.multiply(S);if(m.setSize(R,!0),!R.isZero()){var B=m.getContext(!0),j=new le().scale(S).translate(C.negate());B.save(),j.applyToContext(B),this.draw(B,new a({matrices:[j]})),B.restore()}return m._matrix.set(new le().translate(C.add(P.divide(2))).scale(1/S)),(g===t||g)&&m.insertAbove(this),m},contains:function(){var r=this._matrix;return r.isInvertible()&&!!this._contains(r._inverseTransform(O.read(arguments)))},_contains:function(r){var u=this._children;if(u){for(var f=u.length-1;f>=0;f--)if(u[f].contains(r))return!0;return!1}return r.isInside(this.getInternalBounds())},isInside:function(){return K.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Xe.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(r,u){return r instanceof F?this._asPathItem().getIntersections(r._asPathItem(),null,u,!0).length>0:!1}},new function(){function r(){var g=arguments;return this._hitTest(O.read(g),dt.getOptions(g))}function u(){var g=arguments,m=O.read(g),w=dt.getOptions(g),S=[];return this._hitTest(m,new a({all:S},w)),S}function f(g,m,w,S){var C=this._children;if(C)for(var T=C.length-1;T>=0;T--){var P=C[T],R=P!==S&&P._hitTest(g,m,w);if(R&&!m.all)return R}return null}return we.inject({hitTest:r,hitTestAll:u,_hitTest:f}),{hitTest:r,hitTestAll:u,_hitTestChildren:f}},{_hitTest:function(r,u,f){if(this._locked||!this._visible||this._guide&&!u.guides||this.isEmpty())return null;var g=this._matrix,m=f?f.appended(g):this.getGlobalMatrix().prepend(this.getView()._matrix),w=Math.max(u.tolerance,1e-12),S=u._tolerancePadding=new W(Xe._getStrokePadding(w,g._shiftless().invert()));if(r=g._inverseTransform(r),!r||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(S.multiply(2))._containsPoint(r))return null;var C=!(u.guides&&!this._guide||u.selected&&!this.isSelected()||u.type&&u.type!==a.hyphenate(this._class)||u.class&&!(this instanceof u.class)),T=u.match,P=this,R,B;function j(A){return A&&T&&!T(A)&&(A=null),A&&u.all&&u.all.push(A),A}function I(A,V){var q=V?R["get"+V]():P.getPosition();if(r.subtract(q).divide(S).length<=1)return new dt(A,P,{name:V?a.hyphenate(V):A,point:q})}var Y=u.position,z=u.center,H=u.bounds;if(C&&this._parent&&(Y||z||H)){if((z||H)&&(R=this.getInternalBounds()),B=Y&&I("position")||z&&I("center","Center"),!B&&H)for(var L=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],U=0;U<8&&!B;U++)B=I("bounds",L[U]);B=j(B)}return B||(B=this._hitTestChildren(r,u,m)||C&&j(this._hitTestSelf(r,u,m,this.getStrokeScaling()?null:m._shiftless().invert()))||null),B&&B.point&&(B.point=g.transform(B.point)),B},_hitTestSelf:function(r,u){if(u.fill&&this.hasFill()&&this._contains(r))return new dt("fill",this)},matches:function(r,u){function f(S,C){for(var T in S)if(S.hasOwnProperty(T)){var P=S[T],R=C[T];if(a.isPlainObject(P)&&a.isPlainObject(R)){if(!f(P,R))return!1}else if(!a.equals(P,R))return!1}return!0}var g=typeof r;if(g==="object"){for(var m in r)if(r.hasOwnProperty(m)&&!this.matches(m,r[m]))return!1;return!0}else{if(g==="function")return r(this);if(r==="match")return u(this);var w=/^(empty|editable)$/.test(r)?this["is"+a.capitalize(r)]():r==="type"?a.hyphenate(this._class):this[r];if(r==="class"){if(typeof u=="function")return this instanceof u;w=this._class}if(typeof u=="function")return!!u(w);if(u){if(u.test)return u.test(w);if(a.isPlainObject(u))return f(u,w)}return a.equals(w,u)}},getItems:function(r){return F._getItems(this,r,this._matrix)},getItem:function(r){return F._getItems(this,r,this._matrix,null,!0)[0]||null},statics:{_getItems:function r(u,f,g,m,w){if(!m){var S=typeof f=="object"&&f,C=S&&S.overlapping,T=S&&S.inside,P=C||T,j=P&&K.read([P]);m={items:[],recursive:S&&S.recursive!==!1,inside:!!T,overlapping:!!C,rect:j,path:C&&new Xe.Rectangle({rectangle:j,insert:!1})},S&&(f=a.filter({},f,{recursive:!0,inside:!0,overlapping:!0}))}var R=u._children,B=m.items,j=m.rect;g=j&&(g||new le);for(var I=0,Y=R&&R.length;I<Y;I++){var z=R[I],H=g&&g.appended(z._matrix),L=!0;if(j){var P=z.getBounds(H);if(!j.intersects(P))continue;j.contains(P)||m.overlapping&&(P.contains(j)||m.path.intersects(z,H))||(L=!1)}if(L&&z.matches(f)&&(B.push(z),w)||(m.recursive!==!1&&r(z,f,H,m,w),w&&B.length>0))break}return B}}},{importJSON:function(r){var u=a.importJSON(r,this);return u!==this?this.addChild(u):u},addChild:function(r){return this.insertChild(t,r)},insertChild:function(r,u){var f=u?this.insertChildren(r,[u]):null;return f&&f[0]},addChildren:function(r){return this.insertChildren(this._children.length,r)},insertChildren:function(r,u){var f=this._children;if(f&&u&&u.length>0){u=a.slice(u);for(var g={},m=u.length-1;m>=0;m--){var w=u[m],S=w&&w._id;!w||g[S]?u.splice(m,1):(w._remove(!1,!0),g[S]=!0)}a.splice(f,u,r,0);for(var C=this._project,T=C._changes,m=0,P=u.length;m<P;m++){var w=u[m],R=w._name;w._parent=this,w._setProject(C,!0),R&&w.setName(R),T&&w._changed(5)}this._changed(11)}else u=null;return u},_insertItem:"#insertChild",_insertAt:function(r,u){var f=r&&r._getOwner(),g=r!==this&&f?this:null;return g&&(g._remove(!1,!0),f._insertItem(r._index+u,g)),g},insertAbove:function(r){return this._insertAt(r,1)},insertBelow:function(r){return this._insertAt(r,0)},sendToBack:function(){var r=this._getOwner();return r?r._insertItem(0,this):null},bringToFront:function(){var r=this._getOwner();return r?r._insertItem(t,this):null},appendTop:"#addChild",appendBottom:function(r){return this.insertChild(0,r)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(r){return r._insertItem(t,this)},copyTo:function(r){return this.clone(!1).addTo(r)},reduce:function(r){var u=this._children;if(u&&u.length===1){var f=u[0].reduce(r);return this._parent?(f.insertAbove(this),this.remove()):f.remove(),f}return this},_removeNamed:function(){var r=this._getOwner();if(r){var u=r._children,f=r._namedChildren,g=this._name,m=f[g],w=m?m.indexOf(this):-1;w!==-1&&(u[g]==this&&delete u[g],m.splice(w,1),m.length?u[g]=m[0]:delete f[g])}},_remove:function(r,u){var f=this._getOwner(),g=this._project,m=this._index;return this._style&&this._style._dispose(),f?(this._name&&this._removeNamed(),m!=null&&(g._activeLayer===this&&(g._activeLayer=this.getNextSibling()||this.getPreviousSibling()),a.splice(f._children,null,m,1)),this._installEvents(!1),r&&g._changes&&this._changed(5),u&&f._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(r){var u=r&&r.insertBelow(this);return u&&this.remove(),u},removeChildren:function(r,u){if(!this._children)return null;r=r||0,u=a.pick(u,this._children.length);for(var f=a.splice(this._children,null,r,u-r),g=f.length-1;g>=0;g--)f[g]._remove(!0,!1);return f.length>0&&this._changed(11),f},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var r=0,u=this._children.length;r<u;r++)this._children[r]._index=r;this._changed(11)}},isEmpty:function(r){var u=this._children,f=u?u.length:0;if(r){for(var g=0;g<f;g++)if(!u[g].isEmpty(r))return!1;return!0}return!f},isEditable:function(){for(var r=this;r;){if(!r._visible||r._locked)return!1;r=r._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(r){function u(S){var C=[];do C.unshift(S);while(S=S._parent);return C}for(var f=u(this),g=u(r),m=0,w=Math.min(f.length,g.length);m<w;m++)if(f[m]!=g[m])return f[m]._index<g[m]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(r){return this._getOrder(r)===-1},isBelow:function(r){return this._getOrder(r)===1},isParent:function(r){return this._parent===r},isChild:function(r){return r&&r._parent===this},isDescendant:function(r){for(var u=this;u=u._parent;)if(u===r)return!0;return!1},isAncestor:function(r){return r?r.isDescendant(this):!1},isSibling:function(r){return this._parent===r._parent},isGroupedWith:function(r){for(var u=this._parent;u;){if(u._parent&&/^(Group|Layer|CompoundPath)$/.test(u._class)&&r.isDescendant(u))return!0;u=u._parent}return!1}},a.each(["rotate","scale","shear","skew"],function(r){var u=r==="rotate";this[r]=function(){var f=arguments,g=(u?a:O).read(f),m=O.read(f,0,{readNull:!0});return this.transform(new le()[r](g,m||this.getPosition(!0)))}},{translate:function(){var r=new le;return this.transform(r.translate.apply(r,arguments))},transform:function(r,u,f){var g=this._matrix,m=r&&!r.isIdentity(),w=f&&this._canApplyMatrix||this._applyMatrix&&(m||!g.isIdentity()||u&&this._children);if(!m&&!w)return this;if(m){!r.isInvertible()&&g.isInvertible()&&(g._backup=g.getValues()),g.prepend(r,!0);var S=this._style,C=S.getFillColor(!0),T=S.getStrokeColor(!0);C&&C.transform(r),T&&T.transform(r)}if(w&&(w=this._transformContent(g,u,f))){var P=this._pivot;P&&g._transformPoint(P,P,!0),g.reset(!0),f&&this._canApplyMatrix&&(this._applyMatrix=!0)}var R=this._bounds,B=this._position;(m||w)&&this._changed(25);var j=m&&R&&r.decompose();if(j&&j.skewing.isZero()&&j.rotation%90===0){for(var I in R){var Y=R[I];if(Y.nonscaling)delete R[I];else if(w||!Y.internal){var z=Y.rect;r._transformBounds(z,z)}}this._bounds=R;var H=R[this._getBoundsCacheKey(this._boundsOptions||{})];H&&(this._position=this._getPositionFromBounds(H.rect))}else m&&B&&this._pivot&&(this._position=r._transformPoint(B,B));return this},_transformContent:function(r,u,f){var g=this._children;if(g){for(var m=0,w=g.length;m<w;m++)g[m].transform(r,u,f);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(O.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(O.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(O.read(arguments))},localToParent:function(){return this._matrix._transformPoint(O.read(arguments))},fitBounds:function(r,u){r=K.read(arguments);var f=this.getBounds(),g=f.height/f.width,m=r.height/r.width,w=(u?g>m:g<m)?r.width/f.width:r.height/f.height,S=new K(new O,new W(f.width*w,f.height*w));S.setCenter(r.getCenter()),this.setBounds(S)}}),{_setStyles:function(r,u,f){var g=this._style,m=this._matrix;if(g.hasFill()&&(r.fillStyle=g.getFillColor().toCanvasStyle(r,m)),g.hasStroke()){r.strokeStyle=g.getStrokeColor().toCanvasStyle(r,m),r.lineWidth=g.getStrokeWidth();var w=g.getStrokeJoin(),S=g.getStrokeCap(),C=g.getMiterLimit();if(w&&(r.lineJoin=w),S&&(r.lineCap=S),C&&(r.miterLimit=C),Ft.support.nativeDash){var T=g.getDashArray(),P=g.getDashOffset();T&&T.length&&("setLineDash"in r?(r.setLineDash(T),r.lineDashOffset=P):(r.mozDash=T,r.mozDashOffset=P))}}if(g.hasShadow()){var R=u.pixelRatio||1,B=f._shiftless().prepend(new le().scale(R,R)),j=B.transform(new O(g.getShadowBlur(),0)),I=B.transform(this.getShadowOffset());r.shadowColor=g.getShadowColor().toCanvasStyle(r),r.shadowBlur=j.getLength(),r.shadowOffsetX=I.x,r.shadowOffsetY=I.y}},draw:function(r,u,f){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var g=u.matrices,m=u.viewMatrix,w=this._matrix,S=g[g.length-1].appended(w);if(S.isInvertible()){m=m?m.appended(S):S,g.push(S),u.updateMatrix&&(this._globalMatrix=S);var C=this._blendMode,T=E.clamp(this._opacity,0,1),P=C==="normal",R=fi.nativeModes[C],B=P&&T===1||u.dontStart||u.clip||(R||P&&T<1)&&this._canComposite(),j=u.pixelRatio||1,I,Y,z;if(!B){var H=this.getStrokeBounds(m);if(!H.width||!H.height){g.pop();return}z=u.offset,Y=u.offset=H.getTopLeft().floor(),I=r,r=tn.getContext(H.getSize().ceil().add(1).multiply(j)),j!==1&&r.scale(j,j)}r.save();var L=f?f.appended(w):this._canScaleStroke&&!this.getStrokeScaling(!0)&&m,U=!B&&u.clipItem,A=!L||U;if(B?(r.globalAlpha=T,R&&(r.globalCompositeOperation=C)):A&&r.translate(-Y.x,-Y.y),A&&(B?w:m).applyToContext(r),U&&u.clipItem.draw(r,u.extend({clip:!0})),L){r.setTransform(j,0,0,j,0,0);var V=u.offset;V&&r.translate(-V.x,-V.y)}this._draw(r,u,m,L),r.restore(),g.pop(),u.clip&&!u.dontFinish&&r.clip(this.getFillRule()),B||(fi.process(C,r,I,T,Y.subtract(z).multiply(j)),tn.release(r),u.offset=z)}}},_isUpdated:function(r){var u=this._parent;if(u instanceof Ze)return u._isUpdated(r);var f=this._updateVersion===r;return!f&&u&&u._visible&&u._isUpdated(r)&&(this._updateVersion=r,f=!0),f},_drawSelection:function(r,u,f,g,m){var w=this._selection,S=w&1,C=w&2||S&&this._selectBounds,T=w&4;if(this._drawSelected||(S=!1),(S||C||T)&&this._isUpdated(m)){var P,R=this.getSelectedColor(!0)||(P=this.getLayer())&&P.getSelectedColor(!0),B=u.appended(this.getGlobalMatrix(!0)),j=f/2;if(r.strokeStyle=r.fillStyle=R?R.toCanvasStyle(r):"#009dec",S&&this._drawSelected(r,B,g),T){var I=this.getPosition(!0),Y=this._parent,z=Y?Y.localToGlobal(I):I,H=z.x,L=z.y;r.beginPath(),r.arc(H,L,j,0,Math.PI*2,!0),r.stroke();for(var U=[[0,-1],[1,0],[0,1],[-1,0]],A=j,V=f+1,q=0;q<4;q++){var J=U[q],X=J[0],te=J[1];r.moveTo(H+X*A,L+te*A),r.lineTo(H+X*V,L+te*V),r.stroke()}}if(C){var ie=B._transformCorners(this.getInternalBounds());r.beginPath();for(var q=0;q<8;q++)r[q?"lineTo":"moveTo"](ie[q],ie[++q]);r.closePath(),r.stroke();for(var q=0;q<8;q++)r.fillRect(ie[q]-j,ie[++q]-j,f,f)}}},_canComposite:function(){return!1}},a.each(["down","drag","up","move"],function(r){this["removeOn"+a.capitalize(r)]=function(){var u={};return u[r]=!0,this.removeOn(u)}},{removeOn:function(r){for(var u in r)if(r[u]){var f="mouse"+u,g=this._project,m=g._removeSets=g._removeSets||{};m[f]=m[f]||{},m[f][this._id]=this}return this}}),{tween:function(r,u,f){f||(f=u,u=r,r=null,f||(f=u,u=null));var g=f&&f.easing,m=f&&f.start,w=f!=null&&(typeof f=="number"?f:f.duration),S=new Fi(this,r,u,w,g,m);function C(T){S._handleFrame(T.time*1e3),S.running||this.off("frame",C)}return w&&this.on("frame",C),S},tweenTo:function(r,u){return this.tween(null,r,u)},tweenFrom:function(r,u){return this.tween(r,null,u)}}),ze=F.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(u){this._children=[],this._namedChildren={},this._initialize(u)||this.addChildren(Array.isArray(u)?u:arguments)},_changed:function r(u){r.base.call(this,u),u&2050&&(this._clipItem=t)},_getClipItem:function(){var r=this._clipItem;if(r===t){r=null;for(var u=this._children,f=0,g=u.length;f<g;f++)if(u[f]._clipMask){r=u[f];break}this._clipItem=r}return r},isClipped:function(){return!!this._getClipItem()},setClipped:function(r){var u=this.getFirstChild();u&&u.setClipMask(r)},_getBounds:function r(u,f){var g=this._getClipItem();return g?g._getCachedBounds(g._matrix.prepended(u),a.set({},f,{stroke:!1})):r.base.call(this,u,f)},_hitTestChildren:function r(u,f,g){var m=this._getClipItem();return(!m||m.contains(u))&&r.base.call(this,u,f,g,m)},_draw:function(r,u){var f=u.clip,g=!f&&this._getClipItem();u=u.extend({clipItem:g,clip:!1}),f?(r.beginPath(),u.dontStart=u.dontFinish=!0):g&&g.draw(r,u.extend({clip:!0}));for(var m=this._children,w=0,S=m.length;w<S;w++){var C=m[w];C!==g&&C.draw(r,u)}}}),He=ze.extend({_class:"Layer",initialize:function(){ze.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function r(){return this._parent?r.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),Je=F.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(u,f){this._initialize(u,f)},_equals:function(r){return this._type===r._type&&this._size.equals(r._size)&&a.equals(this._radius,r._radius)},copyContent:function(r){this.setType(r._type),this.setSize(r._size),this.setRadius(r._radius)},getType:function(){return this._type},setType:function(r){this._type=r},getShape:"#getType",setShape:"#setType",getSize:function(){var r=this._size;return new ee(r.width,r.height,this,"setSize")},setSize:function(){var r=W.read(arguments);if(!this._size)this._size=r.clone();else if(!this._size.equals(r)){var u=this._type,f=r.width,g=r.height;u==="rectangle"?this._radius.set(W.min(this._radius,r.divide(2).abs())):u==="circle"?(f=g=(f+g)/2,this._radius=f/2):u==="ellipse"&&this._radius._set(f/2,g/2),this._size._set(f,g),this._changed(9)}},getRadius:function(){var r=this._radius;return this._type==="circle"?r:new ee(r.width,r.height,this,"setRadius")},setRadius:function(r){var u=this._type;if(u==="circle"){if(r===this._radius)return;var f=r*2;this._radius=r,this._size._set(f,f)}else if(r=W.read(arguments),!this._radius)this._radius=r.clone();else{if(this._radius.equals(r))return;if(this._radius.set(r),u==="rectangle"){var f=W.max(this._size,r.multiply(2));this._size.set(f)}else u==="ellipse"&&this._size._set(r.width*2,r.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(r){var u=new Xe[a.capitalize(this._type)]({center:new O,size:this._size,radius:this._radius,insert:!1});return u.copyAttributes(this),Ft.settings.applyMatrix&&u.setApplyMatrix(!0),(r===t||r)&&u.insertAbove(this),u},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(r,u,f,g){var m=this._style,w=m.hasFill(),S=m.hasStroke(),C=u.dontFinish||u.clip,T=!g;if(w||S||C){var P=this._type,R=this._radius,B=P==="circle";if(u.dontStart||r.beginPath(),T&&B)r.arc(0,0,R,0,Math.PI*2,!0);else{var j=B?R:R.width,I=B?R:R.height,Y=this._size,z=Y.width,H=Y.height;if(T&&P==="rectangle"&&j===0&&I===0)r.rect(-z/2,-H/2,z,H);else{var L=z/2,U=H/2,A=1-.5522847498307936,V=j*A,q=I*A,J=[-L,-U+I,-L,-U+q,-L+V,-U,-L+j,-U,L-j,-U,L-V,-U,L,-U+q,L,-U+I,L,U-I,L,U-q,L-V,U,L-j,U,-L+j,U,-L+V,U,-L,U-q,-L,U-I];g&&g.transform(J,J,32),r.moveTo(J[0],J[1]),r.bezierCurveTo(J[2],J[3],J[4],J[5],J[6],J[7]),L!==j&&r.lineTo(J[8],J[9]),r.bezierCurveTo(J[10],J[11],J[12],J[13],J[14],J[15]),U!==I&&r.lineTo(J[16],J[17]),r.bezierCurveTo(J[18],J[19],J[20],J[21],J[22],J[23]),L!==j&&r.lineTo(J[24],J[25]),r.bezierCurveTo(J[26],J[27],J[28],J[29],J[30],J[31])}}r.closePath()}!C&&(w||S)&&(this._setStyles(r,u,f),w&&(r.fill(m.getFillRule()),r.shadowColor="rgba(0,0,0,0)"),S&&r.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(r,u){var f=new K(this._size).setCenter(0,0),g=this._style,m=u.stroke&&g.hasStroke()&&g.getStrokeWidth();return r&&(f=r._transformBounds(f)),m?f.expand(Xe._getStrokePadding(m,this._getStrokeMatrix(r,u))):f}},new function(){function r(f,g,m){var w=f._radius;if(!w.isZero())for(var S=f._size.divide(2),C=1;C<=4;C++){var T=new O(C>1&&C<4?-1:1,C>2?-1:1),P=T.multiply(S),R=P.subtract(T.multiply(w)),B=new K(m?P.add(T.multiply(m)):P,R);if(B.contains(g))return{point:R,quadrant:C}}}function u(f,g,m,w){var S=f.divide(g);return(!w||S.isInQuadrant(w))&&S.subtract(S.normalize()).multiply(g).divide(m).length<=1}return{_contains:function f(g){if(this._type==="rectangle"){var m=r(this,g);return m?g.subtract(m.point).divide(this._radius).getLength()<=1:f.base.call(this,g)}else return g.divide(this.size).getLength()<=.5},_hitTestSelf:function f(g,m,w,S){var C=!1,T=this._style,P=m.stroke&&T.hasStroke(),R=m.fill&&T.hasFill();if(P||R){var B=this._type,j=this._radius,I=P?T.getStrokeWidth()/2:0,Y=m._tolerancePadding.add(Xe._getStrokePadding(I,!T.getStrokeScaling()&&S));if(B==="rectangle"){var z=Y.multiply(2),H=r(this,g,z);if(H)C=u(g.subtract(H.point),j,Y,H.quadrant);else{var L=new K(this._size).setCenter(0,0),U=L.expand(z),A=L.expand(z.negate());C=U._containsPoint(g)&&!A._containsPoint(g)}}else C=u(g,j,Y)}return C?new dt(P?"stroke":"fill",this):f.base.apply(this,arguments)}}},{statics:new function(){function r(u,f,g,m,w){var S=a.create(Je.prototype);return S._type=u,S._size=g,S._radius=m,S._initialize(a.getNamed(w),f),S}return{Circle:function(){var u=arguments,f=O.readNamed(u,"center"),g=a.readNamed(u,"radius");return r("circle",f,new W(g*2),g,u)},Rectangle:function(){var u=arguments,f=K.readNamed(u,"rectangle"),g=W.min(W.readNamed(u,"radius"),f.getSize(!0).divide(2));return r("rectangle",f.getCenter(!0),f.getSize(!0),g,u)},Ellipse:function(){var u=arguments,f=Je._readEllipse(u),g=f.radius;return r("ellipse",f.center,g.multiply(2),g,u)},_readEllipse:function(u){var f,g;if(a.hasNamed(u,"radius"))f=O.readNamed(u,"center"),g=W.readNamed(u,"radius");else{var m=K.readNamed(u,"rectangle");f=m.getCenter(!0),g=m.getSize(!0).divide(2)}return{center:f,radius:g}}}}}),ut=F.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(u,f){if(!this._initialize(u,f!==t&&O.read(arguments))){var g,m=typeof u,w=m==="string"?s.getElementById(u):m==="object"?u:null;if(w&&w!==F.NO_INSERT){if(w.getContext||w.naturalHeight!=null)g=w;else if(w){var S=W.read(arguments);S.isZero()||(g=tn.getCanvas(S))}}g?this.setImage(g):this.setSource(u)}this._size||(this._size=new W,this._loaded=!1)},_equals:function(r){return this.getSource()===r.getSource()},copyContent:function(r){var u=r._image,f=r._canvas;if(u)this._setImage(u);else if(f){var g=tn.getCanvas(r._size);g.getContext("2d").drawImage(f,0,0),this._setImage(g)}this._crossOrigin=r._crossOrigin},getSize:function(){var r=this._size;return new ee(r?r.width:0,r?r.height:0,this,"setSize")},setSize:function(r,u){var f=W.read(arguments);if(f.equals(this._size))u&&this.clear();else if(f.width>0&&f.height>0){var g=!u&&this.getElement();this._setImage(tn.getCanvas(f)),g&&this.getContext(!0).drawImage(g,0,0,f.width,f.height)}else this._canvas&&tn.release(this._canvas),this._size=f.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(r){this.setSize(r,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(r){this.setSize(this.getWidth(),r)},getLoaded:function(){return this._loaded},isEmpty:function(){var r=this._size;return!r||r.width===0&&r.height===0},getResolution:function(){var r=this._matrix,u=new O(0,0).transform(r),f=new O(1,0).transform(r).subtract(u),g=new O(0,1).transform(r).subtract(u);return new W(72/f.getLength(),72/g.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(r){var u=this;function f(g){var m=u.getView(),w=g&&g.type||"load";m&&u.responds(w)&&(Ft=m._scope,u.emit(w,new Rr(g)))}this._setImage(r),this._loaded?setTimeout(f,0):r&&At.add(r,{load:function(g){u._setImage(r),f(g)},error:f})},_setImage:function(r){this._canvas&&tn.release(this._canvas),r&&r.getContext?(this._image=null,this._canvas=r,this._loaded=!0):(this._image=r,this._canvas=null,this._loaded=!!(r&&r.src&&r.complete)),this._size=new W(r?r.naturalWidth||r.width:0,r?r.naturalHeight||r.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var r=tn.getContext(this._size);try{this._image&&r.drawImage(this._image,0,0),this._canvas=r.canvas}catch{tn.release(r)}}return this._canvas},setCanvas:"#setImage",getContext:function(r){return this._context||(this._context=this.getCanvas().getContext("2d")),r&&(this._image=null,this._changed(1025)),this._context},setContext:function(r){this._context=r},getSource:function(){var r=this._image;return r&&r.src||this.toDataURL()},setSource:function(r){var u=new e.Image,f=this._crossOrigin;f&&(u.crossOrigin=f),r&&(u.src=r),this.setImage(u)},getCrossOrigin:function(){var r=this._image;return r&&r.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(r){this._crossOrigin=r;var u=this._image;u&&(u.crossOrigin=r)},getSmoothing:function(){return this._smoothing},setSmoothing:function(r){this._smoothing=typeof r=="string"?r:r?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var r=K.read(arguments),u=tn.getContext(r.getSize());return u.drawImage(this.getCanvas(),r.x,r.y,r.width,r.height,0,0,r.width,r.height),u.canvas},getSubRaster:function(){var r=K.read(arguments),u=new ut(F.NO_INSERT);return u._setImage(this.getSubCanvas(r)),u.translate(r.getCenter().subtract(this.getSize().divide(2))),u._matrix.prepend(this._matrix),u.insertAbove(this),u},toDataURL:function(){var r=this._image,u=r&&r.src;if(/^data:/.test(u))return u;var f=this.getCanvas();return f?f.toDataURL.apply(f,arguments):null},drawImage:function(r){var u=O.read(arguments,1);this.getContext(!0).drawImage(r,u.x,u.y)},getAverageColor:function(r){var u,f;if(r?r instanceof Be?(f=r,u=r.getBounds()):typeof r=="object"&&("width"in r?u=new K(r):"x"in r&&(u=new K(r.x-.5,r.y-.5,1,1))):u=this.getBounds(),!u)return null;var g=32,m=Math.min(u.width,g),w=Math.min(u.height,g),S=ut._sampleContext;S?S.clearRect(0,0,g+1,g+1):S=ut._sampleContext=tn.getContext(new W(g)),S.save();var C=new le().scale(m/u.width,w/u.height).translate(-u.x,-u.y);C.applyToContext(S),f&&f.draw(S,new a({clip:!0,matrices:[C]})),this._matrix.applyToContext(S);var T=this.getElement(),P=this._size;T&&S.drawImage(T,-P.width/2,-P.height/2),S.restore();for(var R=S.getImageData(.5,.5,Math.ceil(m),Math.ceil(w)).data,B=[0,0,0],j=0,I=0,Y=R.length;I<Y;I+=4){var z=R[I+3];j+=z,z/=255,B[0]+=R[I]*z,B[1]+=R[I+1]*z,B[2]+=R[I+2]*z}for(var I=0;I<3;I++)B[I]/=j;return j?pt.read(B):null},getPixel:function(){var r=O.read(arguments),u=this.getContext().getImageData(r.x,r.y,1,1).data;return new pt("rgb",[u[0]/255,u[1]/255,u[2]/255],u[3]/255)},setPixel:function(){var r=arguments,u=O.read(r),f=pt.read(r),g=f._convert("rgb"),m=f._alpha,w=this.getContext(!0),S=w.createImageData(1,1),C=S.data;C[0]=g[0]*255,C[1]=g[1]*255,C[2]=g[2]*255,C[3]=m!=null?m*255:255,w.putImageData(S,u.x,u.y)},clear:function(){var r=this._size;this.getContext(!0).clearRect(0,0,r.width+1,r.height+1)},createImageData:function(){var r=W.read(arguments);return this.getContext().createImageData(r.width,r.height)},getImageData:function(){var r=K.read(arguments);return r.isEmpty()&&(r=new K(this._size)),this.getContext().getImageData(r.x,r.y,r.width,r.height)},putImageData:function(r){var u=O.read(arguments,1);this.getContext(!0).putImageData(r,u.x,u.y)},setImageData:function(r){this.setSize(r),this.getContext(!0).putImageData(r,0,0)},_getBounds:function(r,u){var f=new K(this._size).setCenter(0,0);return r?r._transformBounds(f):f},_hitTestSelf:function(r){if(this._contains(r)){var u=this;return new dt("pixel",u,{offset:r.add(u._size.divide(2)).round(),color:{get:function(){return u.getPixel(this.offset)}}})}},_draw:function(r,u,f){var g=this.getElement();if(g&&g.width>0&&g.height>0){r.globalAlpha=E.clamp(this._opacity,0,1),this._setStyles(r,u,f);var m=this._smoothing,w=m==="off";_t.setPrefixed(r,w?"imageSmoothingEnabled":"imageSmoothingQuality",w?!1:m),r.drawImage(g,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),Ie=F.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(u,f){this._initialize(u,f!==t&&O.read(arguments,1))||this.setDefinition(u instanceof Ke?u:new Ke(u))},_equals:function(r){return this._definition===r._definition},copyContent:function(r){this.setDefinition(r._definition)},getDefinition:function(){return this._definition},setDefinition:function(r){this._definition=r,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(r,u){var f=this._definition._item;return f._getCachedBounds(f._matrix.prepended(r),u)},_hitTestSelf:function(r,u,f){var g=u.extend({all:!1}),m=this._definition._item._hitTest(r,g,f);return m&&(m.item=this),m},_draw:function(r,u){this._definition._item.draw(r,u)}}),Ke=a.extend({_class:"SymbolDefinition",initialize:function(u,f){this._id=N.get(),this.project=Ft.project,u&&this.setItem(u,f)},_serialize:function(r,u){return u.add(this,function(){return a.serialize([this._class,this._item],r,!1,u)})},_changed:function(r){r&8&&F._clearBoundsCache(this),r&1&&this.project._changed(r)},getItem:function(){return this._item},setItem:function(r,u){r._symbol&&(r=r.clone()),this._item&&(this._item._symbol=null),this._item=r,r.remove(),r.setSelected(!1),u||r.setPosition(new O),r._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(r){return new Ie(this,r)},clone:function(){return new Ke(this._item.clone(!1))},equals:function(r){return r===this||r&&this._item.equals(r._item)||!1}}),dt=a.extend({_class:"HitResult",initialize:function(u,f,g){this.type=u,this.item=f,g&&this.inject(g)},statics:{getOptions:function(r){var u=r&&a.read(r);return new a({type:null,tolerance:Ft.settings.hitTolerance,fill:!u,stroke:!u,segments:!u,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},u)}}}),Ve=a.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(u,f,g,m,w,S){var C=arguments.length,T,P,R,B;C>0&&(u==null||typeof u=="object"?C===1&&u&&"point"in u?(T=u.point,P=u.handleIn,R=u.handleOut,B=u.selection):(T=u,P=f,R=g,B=m):(T=[u,f],P=g!==t?[g,m]:null,R=w!==t?[w,S]:null)),new Bt(T,this,"_point"),new Bt(P,this,"_handleIn"),new Bt(R,this,"_handleOut"),B&&this.setSelection(B)},_serialize:function(r,u){var f=this._point,g=this._selection,m=g||this.hasHandles()?[f,this._handleIn,this._handleOut]:f;return g&&m.push(g),a.serialize(m,r,!0,u)},_changed:function(r){var u=this._path;if(u){var f=u._curves,g=this._index,m;f&&((!r||r===this._point||r===this._handleIn)&&(m=g>0?f[g-1]:u._closed?f[f.length-1]:null)&&m._changed(),(!r||r===this._point||r===this._handleOut)&&(m=f[g])&&m._changed()),u._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(O.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(O.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(O.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var r=this._handleIn,u=this._handleOut;return!r.isZero()&&!u.isZero()&&r.isCollinear(u)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(r){var u=this._selection,f=this._path;this._selection=r=r||0,f&&r!==u&&(f._updateSelection(this,u,r),f._changed(257))},_changeSelection:function(r,u){var f=this._selection;this.setSelection(u?f|r:f&~r)},isSelected:function(){return!!(this._selection&7)},setSelected:function(r){this._changeSelection(7,r)},getIndex:function(){return this._index!==t?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var r=this._path,u=this._index;return r?(u>0&&!r._closed&&u===r._segments.length-1&&u--,r.getCurves()[u]||null):null},getLocation:function(){var r=this.getCurve();return r?new wt(r,this===r._segment1?0:1):null},getNext:function(){var r=this._path&&this._path._segments;return r&&(r[this._index+1]||this._path._closed&&r[0])||null},smooth:function(r,u,f){var g=r||{},m=g.type,w=g.factor,S=this.getPrevious(),C=this.getNext(),T=(S||this)._point,P=this._point,R=(C||this)._point,B=T.getDistance(P),j=P.getDistance(R);if(!m||m==="catmull-rom"){var I=w===t?.5:w,Y=Math.pow(B,I),z=Y*Y,H=Math.pow(j,I),L=H*H;if(!u&&S){var U=2*L+3*H*Y+z,A=3*H*(H+Y);this.setHandleIn(A!==0?new O((L*T._x+U*P._x-z*R._x)/A-P._x,(L*T._y+U*P._y-z*R._y)/A-P._y):new O)}if(!f&&C){var U=2*z+3*Y*H+L,A=3*Y*(Y+H);this.setHandleOut(A!==0?new O((z*R._x+U*P._x-L*T._x)/A-P._x,(z*R._y+U*P._y-L*T._y)/A-P._y):new O)}}else if(m==="geometric"){if(S&&C){var V=T.subtract(R),q=w===t?.4:w,J=q*B/(B+j);u||this.setHandleIn(V.multiply(J)),f||this.setHandleOut(V.multiply(J-q))}}else throw new Error("Smoothing method '"+m+"' not supported.")},getPrevious:function(){var r=this._path&&this._path._segments;return r&&(r[this._index-1]||this._path._closed&&r[r.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var r=this._path;return r&&this._index===r._segments.length-1||!1},reverse:function(){var r=this._handleIn,u=this._handleOut,f=r.clone();r.set(u),u.set(f)},reversed:function(){return new Ve(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new Ve(this._point,this._handleIn,this._handleOut)},equals:function(r){return r===this||r&&this._class===r._class&&this._point.equals(r._point)&&this._handleIn.equals(r._handleIn)&&this._handleOut.equals(r._handleOut)||!1},toString:function(){var r=["point: "+this._point];return this._handleIn.isZero()||r.push("handleIn: "+this._handleIn),this._handleOut.isZero()||r.push("handleOut: "+this._handleOut),"{ "+r.join(", ")+" }"},transform:function(r){this._transformCoordinates(r,new Array(6),!0),this._changed()},interpolate:function(r,u,f){var g=1-f,m=f,w=r._point,S=u._point,C=r._handleIn,T=u._handleIn,P=u._handleOut,R=r._handleOut;this._point._set(g*w._x+m*S._x,g*w._y+m*S._y,!0),this._handleIn._set(g*C._x+m*T._x,g*C._y+m*T._y,!0),this._handleOut._set(g*R._x+m*P._x,g*R._y+m*P._y,!0),this._changed()},_transformCoordinates:function(r,u,f){var g=this._point,m=!f||!this._handleIn.isZero()?this._handleIn:null,w=!f||!this._handleOut.isZero()?this._handleOut:null,S=g._x,C=g._y,T=2;return u[0]=S,u[1]=C,m&&(u[T++]=m._x+S,u[T++]=m._y+C),w&&(u[T++]=w._x+S,u[T++]=w._y+C),r&&(r._transformCoordinates(u,u,T/2),S=u[0],C=u[1],f?(g._x=S,g._y=C,T=2,m&&(m._x=u[T++]-S,m._y=u[T++]-C),w&&(w._x=u[T++]-S,w._y=u[T++]-C)):(m||(u[T++]=S,u[T++]=C),w||(u[T++]=S,u[T++]=C))),u}}),Bt=O.extend({initialize:function(u,f,g){var m,w,S;if(!u)m=w=0;else if((m=u[0])!==t)w=u[1];else{var C=u;(m=C.x)===t&&(C=O.read(arguments),m=C.x),w=C.y,S=C.selected}this._x=m,this._y=w,this._owner=f,f[g]=this,S&&this.setSelected(!0)},_set:function(r,u){return this._x=r,this._y=u,this._owner._changed(this),this},getX:function(){return this._x},setX:function(r){this._x=r,this._owner._changed(this)},getY:function(){return this._y},setY:function(r){this._y=r,this._owner._changed(this)},isZero:function(){var r=E.isZero;return r(this._x)&&r(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(r){this._owner._changeSelection(this._getSelection(),r)},_getSelection:function(){var r=this._owner;return this===r._point?1:this===r._handleIn?2:this===r._handleOut?4:0}}),Le=a.extend({_class:"Curve",beans:!0,initialize:function(u,f,g,m,w,S,C,T){var P=arguments.length,R,B,j,I,Y,z;P===3?(this._path=u,R=f,B=g):P?P===1?"segment1"in u?(R=new Ve(u.segment1),B=new Ve(u.segment2)):"point1"in u?(j=u.point1,Y=u.handle1,z=u.handle2,I=u.point2):Array.isArray(u)&&(j=[u[0],u[1]],I=[u[6],u[7]],Y=[u[2]-u[0],u[3]-u[1]],z=[u[4]-u[6],u[5]-u[7]]):P===2?(R=new Ve(u),B=new Ve(f)):P===4?(j=u,Y=f,z=g,I=m):P===8&&(j=[u,f],I=[C,T],Y=[g-u,m-f],z=[w-C,S-T]):(R=new Ve,B=new Ve),this._segment1=R||new Ve(j,null,Y),this._segment2=B||new Ve(I,z,null)},_serialize:function(r,u){return a.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],r,!0,u)},_changed:function(){this._length=this._bounds=t},clone:function(){return new Le(this._segment1,this._segment2)},toString:function(){var r=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||r.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||r.push("handle2: "+this._segment2._handleIn),r.push("point2: "+this._segment2._point),"{ "+r.join(", ")+" }"},classify:function(){return Le.classify(this.getValues())},remove:function(){var r=!1;if(this._path){var u=this._segment2,f=u._handleOut;r=u.remove(),r&&this._segment1._handleOut.set(f)}return r},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(O.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(O.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(O.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(O.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var r=this._path&&this._path._curves;return r&&(r[this._segment1._index+1]||this._path._closed&&r[0])||null},getPrevious:function(){var r=this._path&&this._path._curves;return r&&(r[this._segment1._index-1]||this._path._closed&&r[r.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var r=this._path;return r&&this._segment1._index===r._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(r){this.getPoint1().setSelected(r),this.getHandle1().setSelected(r),this.getHandle2().setSelected(r),this.getPoint2().setSelected(r)},getValues:function(r){return Le.getValues(this._segment1,this._segment2,r)},getPoints:function(){for(var r=this.getValues(),u=[],f=0;f<8;f+=2)u.push(new O(r[f],r[f+1]));return u}},{getLength:function(){return this._length==null&&(this._length=Le.getLength(this.getValues(),0,1)),this._length},getArea:function(){return Le.getArea(this.getValues())},getLine:function(){return new ve(this._segment1._point,this._segment2._point)},getPart:function(r,u){return new Le(Le.getPart(this.getValues(),r,u))},getPartLength:function(r,u){return Le.getLength(this.getValues(),r,u)},divideAt:function(r){return this.divideAtTime(r&&r.curve===this?r.time:this.getTimeAt(r))},divideAtTime:function(r,u){var f=1e-8,g=1-f,m=null;if(r>=f&&r<=g){var w=Le.subdivide(this.getValues(),r),S=w[0],C=w[1],T=u||this.hasHandles(),P=this._segment1,R=this._segment2,B=this._path;T&&(P._handleOut._set(S[2]-S[0],S[3]-S[1]),R._handleIn._set(C[4]-C[6],C[5]-C[7]));var j=S[6],I=S[7],Y=new Ve(new O(j,I),T&&new O(S[4]-j,S[5]-I),T&&new O(C[2]-j,C[3]-I));B?(B.insert(P._index+1,Y),m=this.getNext()):(this._segment2=Y,this._changed(),m=new Le(Y,R))}return m},splitAt:function(r){var u=this._path;return u?u.splitAt(r):null},splitAtTime:function(r){return this.splitAt(this.getLocationAtTime(r))},divide:function(r,u){return this.divideAtTime(r===t?.5:u?r:this.getTimeAt(r))},split:function(r,u){return this.splitAtTime(r===t?.5:u?r:this.getTimeAt(r))},reversed:function(){return new Le(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(r,u,f,g){var m=r._point,w=r._handleOut,S=u._handleIn,C=u._point,T=m.x,P=m.y,R=C.x,B=C.y,j=g?[T,P,T,P,R,B,R,B]:[T,P,T+w._x,P+w._y,R+S._x,B+S._y,R,B];return f&&f._transformCoordinates(j,j,4),j},subdivide:function(r,u){var f=r[0],g=r[1],m=r[2],w=r[3],S=r[4],C=r[5],T=r[6],P=r[7];u===t&&(u=.5);var R=1-u,B=R*f+u*m,j=R*g+u*w,I=R*m+u*S,Y=R*w+u*C,z=R*S+u*T,H=R*C+u*P,L=R*B+u*I,U=R*j+u*Y,A=R*I+u*z,V=R*Y+u*H,q=R*L+u*A,J=R*U+u*V;return[[f,g,B,j,L,U,q,J],[q,J,A,V,z,H,T,P]]},getMonoCurves:function(r,u){var f=[],g=u?0:1,m=r[g+0],w=r[g+2],S=r[g+4],C=r[g+6];if(m>=w==w>=S&&w>=S==S>=C||Le.isStraight(r))f.push(r);else{var T=3*(w-S)-m+C,P=2*(m+S)-4*w,R=w-m,B=1e-8,j=1-B,I=[],Y=E.solveQuadratic(T,P,R,I,B,j);if(!Y)f.push(r);else{I.sort();var z=I[0],H=Le.subdivide(r,z);f.push(H[0]),Y>1&&(z=(I[1]-z)/(1-z),H=Le.subdivide(H[1],z),f.push(H[0])),f.push(H[1])}}return f},solveCubic:function(r,u,f,g,m,w){var S=r[u],C=r[u+2],T=r[u+4],P=r[u+6],R=0;if(!(S<f&&P<f&&C<f&&T<f||S>f&&P>f&&C>f&&T>f)){var B=3*(C-S),j=3*(T-C)-B,I=P-S-B-j;R=E.solveCubic(I,j,B,S-f,g,m,w)}return R},getTimeOf:function(r,u){var f=new O(r[0],r[1]),g=new O(r[6],r[7]),m=1e-12,w=1e-7,S=u.isClose(f,m)?0:u.isClose(g,m)?1:null;if(S===null)for(var C=[u.x,u.y],T=[],P=0;P<2;P++)for(var R=Le.solveCubic(r,P,C[P],T,0,1),B=0;B<R;B++){var j=T[B];if(u.isClose(Le.getPoint(r,j),w))return j}return u.isClose(f,w)?0:u.isClose(g,w)?1:null},getNearestTime:function(r,u){if(Le.isStraight(r)){var f=r[0],g=r[1],m=r[6],w=r[7],S=m-f,C=w-g,T=S*S+C*C;if(T===0)return 0;var P=((u.x-f)*S+(u.y-g)*C)/T;return P<1e-12?0:P>.999999999999?1:Le.getTimeOf(r,new O(f+P*S,g+P*C))}var R=100,B=1/0,j=0;function I(H){if(H>=0&&H<=1){var L=u.getDistance(Le.getPoint(r,H),!0);if(L<B)return B=L,j=H,!0}}for(var Y=0;Y<=R;Y++)I(Y/R);for(var z=1/(R*2);z>1e-8;)!I(j-z)&&!I(j+z)&&(z/=2);return j},getPart:function(r,u,f){var g=u>f;if(g){var m=u;u=f,f=m}return u>0&&(r=Le.subdivide(r,u)[1]),f<1&&(r=Le.subdivide(r,(f-u)/(1-u))[0]),g?[r[6],r[7],r[4],r[5],r[2],r[3],r[0],r[1]]:r},isFlatEnough:function(r,u){var f=r[0],g=r[1],m=r[2],w=r[3],S=r[4],C=r[5],T=r[6],P=r[7],R=3*m-2*f-T,B=3*w-2*g-P,j=3*S-2*T-f,I=3*C-2*P-g;return Math.max(R*R,j*j)+Math.max(B*B,I*I)<=16*u*u},getArea:function(r){var u=r[0],f=r[1],g=r[2],m=r[3],w=r[4],S=r[5],C=r[6],T=r[7];return 3*((T-f)*(g+w)-(C-u)*(m+S)+m*(u-w)-g*(f-S)+T*(w+u/3)-C*(S+f/3))/20},getBounds:function(r){for(var u=r.slice(0,2),f=u.slice(),g=[0,0],m=0;m<2;m++)Le._addBounds(r[m],r[m+2],r[m+4],r[m+6],m,0,u,f,g);return new K(u[0],u[1],f[0]-u[0],f[1]-u[1])},_addBounds:function(r,u,f,g,m,w,S,C,T){function P(q,J){var X=q-J,te=q+J;X<S[m]&&(S[m]=X),te>C[m]&&(C[m]=te)}w/=2;var R=S[m]+w,B=C[m]-w;if(r<R||u<R||f<R||g<R||r>B||u>B||f>B||g>B)if(u<r!=u<g&&f<r!=f<g)P(r,0),P(g,0);else{var j=3*(u-f)-r+g,I=2*(r+f)-4*u,Y=u-r,z=E.solveQuadratic(j,I,Y,T),H=1e-8,L=1-H;P(g,0);for(var U=0;U<z;U++){var A=T[U],V=1-A;H<=A&&A<=L&&P(V*V*V*r+3*V*V*A*u+3*V*A*A*f+A*A*A*g,w)}}}}},a.each(["getBounds","getStrokeBounds","getHandleBounds"],function(r){this[r]=function(){this._bounds||(this._bounds={});var u=this._bounds[r];return u||(u=this._bounds[r]=Xe[r]([this._segment1,this._segment2],!1,this._path)),u.clone()}},{}),a.each({isStraight:function(r,u,f,g){if(u.isZero()&&f.isZero())return!0;var m=g.subtract(r);if(m.isZero())return!1;if(m.isCollinear(u)&&m.isCollinear(f)){var w=new ve(r,g),S=1e-7;if(w.getDistance(r.add(u))<S&&w.getDistance(g.add(f))<S){var C=m.dot(m),T=m.dot(u)/C,P=m.dot(f)/C;return T>=0&&T<=1&&P<=0&&P>=-1}}return!1},isLinear:function(r,u,f,g){var m=g.subtract(r).divide(3);return u.equals(m)&&f.negate().equals(m)}},function(r,u){this[u]=function(f){var g=this._segment1,m=this._segment2;return r(g._point,g._handleOut,m._handleIn,m._point,f)},this.statics[u]=function(f,g){var m=f[0],w=f[1],S=f[6],C=f[7];return r(new O(m,w),new O(f[2]-m,f[3]-w),new O(f[4]-S,f[5]-C),new O(S,C),g)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(r){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(r||0)},isCollinear:function(r){return r&&this.isStraight()&&r.isStraight()&&this.getLine().isCollinear(r.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(r,u){return this.getLocationAtTime(u?r:this.getTimeAt(r))},getLocationAtTime:function(r){return r!=null&&r>=0&&r<=1?new wt(this,r):null},getTimeAt:function(r,u){return Le.getTimeAt(this.getValues(),r,u)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var r=O.read(arguments);return r.isZero()?[]:Le.getTimesWithTangent(this.getValues(),r)},getOffsetAtTime:function(r){return this.getPartLength(0,r)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(O.read(arguments)))},getOffsetOf:function(){var r=this.getLocationOf.apply(this,arguments);return r?r.getOffset():null},getTimeOf:function(){return Le.getTimeOf(this.getValues(),O.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var r=O.read(arguments),u=this.getValues(),f=Le.getNearestTime(u,r),g=Le.getPoint(u,f);return new wt(this,f,g,null,r.getDistance(g))},getNearestPoint:function(){var r=this.getNearestLocation.apply(this,arguments);return r&&r.getPoint()}},new function(){var r=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return a.each(r,function(u){this[u+"At"]=function(f,g){var m=this.getValues();return Le[u](m,g?f:Le.getTimeAt(m,f))},this[u+"AtTime"]=function(f){return Le[u](this.getValues(),f)}},{statics:{_evaluateMethods:r}})},new function(){function r(g){var m=g[0],w=g[1],S=g[2],C=g[3],T=g[4],P=g[5],R=g[6],B=g[7],j=9*(S-T)+3*(R-m),I=6*(m+T)-12*S,Y=3*(S-m),z=9*(C-P)+3*(B-w),H=6*(w+P)-12*C,L=3*(C-w);return function(U){var A=(j*U+I)*U+Y,V=(z*U+H)*U+L;return Math.sqrt(A*A+V*V)}}function u(g,m){return Math.max(2,Math.min(16,Math.ceil(Math.abs(m-g)*32)))}function f(g,m,w,S){if(m==null||m<0||m>1)return null;var C=g[0],T=g[1],P=g[2],R=g[3],B=g[4],j=g[5],I=g[6],Y=g[7],z=E.isZero;z(P-C)&&z(R-T)&&(P=C,R=T),z(B-I)&&z(j-Y)&&(B=I,j=Y);var H=3*(P-C),L=3*(B-P)-H,U=I-C-H-L,A=3*(R-T),V=3*(j-R)-A,q=Y-T-A-V,J,X;if(w===0)J=m===0?C:m===1?I:((U*m+L)*m+H)*m+C,X=m===0?T:m===1?Y:((q*m+V)*m+A)*m+T;else{var te=1e-8,ie=1-te;if(m<te?(J=H,X=A):m>ie?(J=3*(I-B),X=3*(Y-j)):(J=(3*U*m+2*L)*m+H,X=(3*q*m+2*V)*m+A),S){J===0&&X===0&&(m<te||m>ie)&&(J=B-P,X=j-R);var se=Math.sqrt(J*J+X*X);se&&(J/=se,X/=se)}if(w===3){var B=6*U*m+2*L,j=6*q*m+2*V,he=Math.pow(J*J+X*X,3/2);J=he!==0?(J*j-X*B)/he:0,X=0}}return w===2?new O(X,-J):new O(J,X)}return{statics:{classify:function(g){var m=g[0],w=g[1],S=g[2],C=g[3],T=g[4],P=g[5],R=g[6],B=g[7],j=m*(B-P)+w*(T-R)+R*P-B*T,I=S*(w-B)+C*(R-m)+m*B-w*R,Y=T*(C-w)+P*(m-S)+S*w-C*m,z=3*Y,H=z-I,L=H-I+j,U=Math.sqrt(L*L+H*H+z*z),A=U!==0?1/U:0,V=E.isZero,q="serpentine";L*=A,H*=A,z*=A;function J(se,he,ne){var ce=he!==t,fe=ce&&he>0&&he<1,ye=ce&&ne>0&&ne<1;return ce&&(!(fe||ye)||se==="loop"&&!(fe&&ye))&&(se="arch",fe=ye=!1),{type:se,roots:fe||ye?fe&&ye?he<ne?[he,ne]:[ne,he]:[fe?he:ne]:null}}if(V(L))return V(H)?J(V(z)?"line":"quadratic"):J(q,z/(3*H));var X=3*H*H-4*L*z;if(V(X))return J("cusp",H/(2*L));var te=X>0?Math.sqrt(X/3):Math.sqrt(-X),ie=2*L;return J(X>0?q:"loop",(H+te)/ie,(H-te)/ie)},getLength:function(g,m,w,S){if(m===t&&(m=0),w===t&&(w=1),Le.isStraight(g)){var C=g;w<1&&(C=Le.subdivide(C,w)[0],m/=w),m>0&&(C=Le.subdivide(C,m)[1]);var T=C[6]-C[0],P=C[7]-C[1];return Math.sqrt(T*T+P*P)}return E.integrate(S||r(g),m,w,u(m,w))},getTimeAt:function(g,m,w){if(w===t&&(w=m<0?1:0),m===0)return w;var S=Math.abs,C=1e-12,T=m>0,P=T?w:0,R=T?1:w,B=r(g),j=Le.getLength(g,P,R,B),I=S(m)-j;if(S(I)<C)return T?R:P;if(I>C)return null;var Y=m/j,z=0;function H(L){return z+=E.integrate(B,w,L,u(w,L)),w=L,z-m}return E.findRoot(H,B,w+Y,P,R,32,1e-12)},getPoint:function(g,m){return f(g,m,0,!1)},getTangent:function(g,m){return f(g,m,1,!0)},getWeightedTangent:function(g,m){return f(g,m,1,!1)},getNormal:function(g,m){return f(g,m,2,!0)},getWeightedNormal:function(g,m){return f(g,m,2,!1)},getCurvature:function(g,m){return f(g,m,3,!1).x},getPeaks:function(g){var m=g[0],w=g[1],S=g[2],C=g[3],T=g[4],P=g[5],R=g[6],B=g[7],j=-m+3*S-3*T+R,I=3*m-6*S+3*T,Y=-3*m+3*S,z=-w+3*C-3*P+B,H=3*w-6*C+3*P,L=-3*w+3*C,U=1e-8,A=1-U,V=[];return E.solveCubic(9*(j*j+z*z),9*(j*I+H*z),2*(I*I+H*H)+3*(Y*j+L*z),Y*I+H*L,V,U,A),V.sort()}}}},new function(){function r(I,Y,z,H,L,U,A){var V=!A&&z.getPrevious()===L,q=!A&&z!==L&&z.getNext()===L,J=1e-8,X=1-J;if(H!==null&&H>=(V?J:0)&&H<=(q?X:1)&&U!==null&&U>=(q?J:0)&&U<=(V?X:1)){var te=new wt(z,H,null,A),ie=new wt(L,U,null,A);te._intersection=ie,ie._intersection=te,(!Y||Y(te))&&wt.insert(I,te,!0)}}function u(I,Y,z,H,L,U,A,V,q,J,X,te,ie){if(++q>=4096||++V>=40)return q;var se=1e-9,he=Y[0],ne=Y[1],ce=Y[6],fe=Y[7],ye=ve.getSignedDistance,xe=ye(he,ne,ce,fe,Y[2],Y[3]),Ee=ye(he,ne,ce,fe,Y[4],Y[5]),Ne=xe*Ee>0?3/4:4/9,We=Ne*Math.min(0,xe,Ee),$e=Ne*Math.max(0,xe,Ee),it=ye(he,ne,ce,fe,I[0],I[1]),je=ye(he,ne,ce,fe,I[2],I[3]),De=ye(he,ne,ce,fe,I[4],I[5]),tt=ye(he,ne,ce,fe,I[6],I[7]),at=f(it,je,De,tt),st=at[0],xt=at[1],vt,ot;if(xe===0&&Ee===0&&it===0&&je===0&&De===0&&tt===0||(vt=g(st,xt,We,$e))==null||(ot=g(st.reverse(),xt.reverse(),We,$e))==null)return q;var Lt=J+(X-J)*vt,bt=J+(X-J)*ot;if(Math.max(ie-te,bt-Lt)<se){var pn=(Lt+bt)/2,sn=(te+ie)/2;r(L,U,A?H:z,A?sn:pn,A?z:H,A?pn:sn)}else{I=Le.getPart(I,vt,ot);var Sn=ie-te;if(ot-vt>.8)if(bt-Lt>Sn){var ln=Le.subdivide(I,.5),pn=(Lt+bt)/2;q=u(Y,ln[0],H,z,L,U,!A,V,q,te,ie,Lt,pn),q=u(Y,ln[1],H,z,L,U,!A,V,q,te,ie,pn,bt)}else{var ln=Le.subdivide(Y,.5),sn=(te+ie)/2;q=u(ln[0],I,H,z,L,U,!A,V,q,te,sn,Lt,bt),q=u(ln[1],I,H,z,L,U,!A,V,q,sn,ie,Lt,bt)}else Sn===0||Sn>=se?q=u(Y,I,H,z,L,U,!A,V,q,te,ie,Lt,bt):q=u(I,Y,z,H,L,U,A,V,q,Lt,bt,te,ie)}return q}function f(I,Y,z,H){var L=[0,I],U=[1/3,Y],A=[2/3,z],V=[1,H],q=Y-(2*I+H)/3,J=z-(I+2*H)/3,X;if(q*J<0)X=[[L,U,V],[L,A,V]];else{var te=q/J;X=[te>=2?[L,U,V]:te<=.5?[L,A,V]:[L,U,A,V],[L,V]]}return(q||J)<0?X.reverse():X}function g(I,Y,z,H){return I[0][1]<z?m(I,!0,z):Y[0][1]>H?m(Y,!1,H):I[0][0]}function m(I,Y,z){for(var H=I[0][0],L=I[0][1],U=1,A=I.length;U<A;U++){var V=I[U][0],q=I[U][1];if(Y?q>=z:q<=z)return q===z?V:H+(z-L)*(V-H)/(q-L);H=V,L=q}return null}function w(I,Y,z,H,L){var U=E.isZero;if(U(H)&&U(L)){var A=Le.getTimeOf(I,new O(Y,z));return A===null?[]:[A]}for(var V=Math.atan2(-L,H),q=Math.sin(V),J=Math.cos(V),X=[],te=[],ie=0;ie<8;ie+=2){var se=I[ie]-Y,he=I[ie+1]-z;X.push(se*J-he*q,se*q+he*J)}return Le.solveCubic(X,1,0,te,0,1),te}function S(I,Y,z,H,L,U,A){for(var V=Y[0],q=Y[1],J=Y[6],X=Y[7],te=w(I,V,q,J-V,X-q),ie=0,se=te.length;ie<se;ie++){var he=te[ie],ne=Le.getPoint(I,he),ce=Le.getTimeOf(Y,ne);ce!==null&&r(L,U,A?H:z,A?ce:he,A?z:H,A?he:ce)}}function C(I,Y,z,H,L,U){var A=ve.intersect(I[0],I[1],I[6],I[7],Y[0],Y[1],Y[6],Y[7]);A&&r(L,U,z,Le.getTimeOf(I,A),H,Le.getTimeOf(Y,A))}function T(I,Y,z,H,L,U){var A=1e-12,V=Math.min,q=Math.max;if(q(I[0],I[2],I[4],I[6])+A>V(Y[0],Y[2],Y[4],Y[6])&&V(I[0],I[2],I[4],I[6])-A<q(Y[0],Y[2],Y[4],Y[6])&&q(I[1],I[3],I[5],I[7])+A>V(Y[1],Y[3],Y[5],Y[7])&&V(I[1],I[3],I[5],I[7])-A<q(Y[1],Y[3],Y[5],Y[7])){var J=B(I,Y);if(J)for(var X=0;X<2;X++){var te=J[X];r(L,U,z,te[0],H,te[1],!0)}else{var ie=Le.isStraight(I),se=Le.isStraight(Y),he=ie&&se,ne=ie&&!se,ce=L.length;if((he?C:ie||se?S:u)(ne?Y:I,ne?I:Y,ne?H:z,ne?z:H,L,U,ne,0,0,0,1,0,1),!he||L.length===ce)for(var X=0;X<4;X++){var fe=X>>1,ye=X&1,xe=fe*6,Ee=ye*6,Ne=new O(I[xe],I[xe+1]),We=new O(Y[Ee],Y[Ee+1]);Ne.isClose(We,A)&&r(L,U,z,fe,H,ye)}}}return L}function P(I,Y,z,H){var L=Le.classify(I);if(L.type==="loop"){var U=L.roots;r(z,H,Y,U[0],Y,U[1])}return z}function R(I,Y,z,H,L,U){var A=1e-7,V=!Y;V&&(Y=I);for(var q=I.length,J=Y.length,X=new Array(q),te=V?X:new Array(J),ie=[],se=0;se<q;se++)X[se]=I[se].getValues(H);if(!V)for(var se=0;se<J;se++)te[se]=Y[se].getValues(L);for(var he=_.findCurveBoundsCollisions(X,te,A),ne=0;ne<q;ne++){var ce=I[ne],fe=X[ne];V&&P(fe,ce,ie,z);var ye=he[ne];if(ye)for(var xe=0;xe<ye.length;xe++){if(U&&ie.length)return ie;var Ee=ye[xe];if(!V||Ee>ne){var Ne=Y[Ee],We=te[Ee];T(fe,We,ce,Ne,ie,z)}}}return ie}function B(I,Y){function z(tt){var at=tt[6]-tt[0],st=tt[7]-tt[1];return at*at+st*st}var H=Math.abs,L=ve.getDistance,U=1e-8,A=1e-7,V=Le.isStraight(I),q=Le.isStraight(Y),J=V&&q,X=z(I)<z(Y),te=X?Y:I,ie=X?I:Y,se=te[0],he=te[1],ne=te[6]-se,ce=te[7]-he;if(L(se,he,ne,ce,ie[0],ie[1],!0)<A&&L(se,he,ne,ce,ie[6],ie[7],!0)<A)!J&&L(se,he,ne,ce,te[2],te[3],!0)<A&&L(se,he,ne,ce,te[4],te[5],!0)<A&&L(se,he,ne,ce,ie[2],ie[3],!0)<A&&L(se,he,ne,ce,ie[4],ie[5],!0)<A&&(V=q=J=!0);else if(J)return null;if(V^q)return null;for(var fe=[I,Y],ye=[],xe=0;xe<4&&ye.length<2;xe++){var Ee=xe&1,Ne=Ee^1,We=xe>>1,$e=Le.getTimeOf(fe[Ee],new O(fe[Ne][We?6:0],fe[Ne][We?7:1]));if($e!=null){var it=Ee?[We,$e]:[$e,We];(!ye.length||H(it[0]-ye[0][0])>U&&H(it[1]-ye[0][1])>U)&&ye.push(it)}if(xe>2&&!ye.length)break}if(ye.length!==2)ye=null;else if(!J){var je=Le.getPart(I,ye[0][0],ye[1][0]),De=Le.getPart(Y,ye[0][1],ye[1][1]);(H(De[2]-je[2])>A||H(De[3]-je[3])>A||H(De[4]-je[4])>A||H(De[5]-je[5])>A)&&(ye=null)}return ye}function j(I,Y){var z=I[0],H=I[1],L=I[2],U=I[3],A=I[4],V=I[5],q=I[6],J=I[7],X=Y.normalize(),te=X.x,ie=X.y,se=3*q-9*A+9*L-3*z,he=3*J-9*V+9*U-3*H,ne=6*A-12*L+6*z,ce=6*V-12*U+6*H,fe=3*L-3*z,ye=3*U-3*H,xe=2*se*ie-2*he*te,Ee=[];if(Math.abs(xe)<E.CURVETIME_EPSILON){var Ne=se*ye-he*fe,xe=se*ce-he*ne;if(xe!=0){var We=-Ne/xe;We>=0&&We<=1&&Ee.push(We)}}else{var $e=(ne*ne-4*se*fe)*ie*ie+(-2*ne*ce+4*he*fe+4*se*ye)*te*ie+(ce*ce-4*he*ye)*te*te,it=ne*ie-ce*te;if($e>=0&&xe!=0){var je=Math.sqrt($e),De=-(it+je)/xe,tt=(-it+je)/xe;De>=0&&De<=1&&Ee.push(De),tt>=0&&tt<=1&&Ee.push(tt)}}return Ee}return{getIntersections:function(I){var Y=this.getValues(),z=I&&I!==this&&I.getValues();return z?T(Y,z,this,I,[]):P(Y,this,[])},statics:{getOverlaps:B,getIntersections:R,getCurveLineIntersections:w,getTimesWithTangent:j}}}),wt=a.extend({_class:"CurveLocation",initialize:function(u,f,g,m,w){if(f>=.99999999){var S=u.getNext();S&&(f=0,u=S)}this._setCurve(u),this._time=f,this._point=g||u.getPointAtTime(f),this._overlap=m,this._distance=w,this._intersection=this._next=this._previous=null},_setPath:function(r){this._path=r,this._version=r?r._version:0},_setCurve:function(r){this._setPath(r._path),this._curve=r,this._segment=null,this._segment1=r._segment1,this._segment2=r._segment2},_setSegment:function(r){var u=r.getCurve();u?this._setCurve(u):(this._setPath(r._path),this._segment1=r,this._segment2=null),this._segment=r,this._time=r===this._segment1?0:1,this._point=r._point.clone()},getSegment:function(){var r=this._segment;if(!r){var u=this.getCurve(),f=this.getTime();f===0?r=u._segment1:f===1?r=u._segment2:f!=null&&(r=u.getPartLength(0,f)<u.getPartLength(f,1)?u._segment1:u._segment2),this._segment=r}return r},getCurve:function(){var r=this._path,u=this;r&&r._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function f(g){var m=g&&g.getCurve();if(m&&(u._time=m.getTimeOf(u._point))!=null)return u._setCurve(m),m}return this._curve||f(this._segment)||f(this._segment1)||f(this._segment2.getPrevious())},getPath:function(){var r=this.getCurve();return r&&r._path},getIndex:function(){var r=this.getCurve();return r&&r.getIndex()},getTime:function(){var r=this.getCurve(),u=this._time;return r&&u==null?this._time=r.getTimeOf(this._point):u},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var r=this._offset;if(r==null){r=0;var u=this.getPath(),f=this.getIndex();if(u&&f!=null)for(var g=u.getCurves(),m=0;m<f;m++)r+=g[m].getLength();this._offset=r+=this.getCurveOffset()}return r},getCurveOffset:function(){var r=this._curveOffset;if(r==null){var u=this.getCurve(),f=this.getTime();this._curveOffset=r=f!=null&&u&&u.getPartLength(0,f)}return r},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var r=this.getCurve(),u=r&&r.divideAtTime(this.getTime());return u&&this._setSegment(u._segment1),u},split:function(){var r=this.getCurve(),u=r._path,f=r&&r.splitAtTime(this.getTime());return f&&this._setSegment(u.getLastSegment()),f},equals:function(r,u){var f=this===r;if(!f&&r instanceof wt){var g=this.getCurve(),m=r.getCurve(),w=g._path,S=m._path;if(w===S){var C=Math.abs,T=1e-7,P=C(this.getOffset()-r.getOffset()),R=!u&&this._intersection,B=!u&&r._intersection;f=(P<T||w&&C(w.getLength()-P)<T)&&(!R&&!B||R&&B&&R.equals(B,!0))}}return f},toString:function(){var r=[],u=this.getPoint(),f=b.instance;u&&r.push("point: "+u);var g=this.getIndex();g!=null&&r.push("index: "+g);var m=this.getTime();return m!=null&&r.push("time: "+f.number(m)),this._distance!=null&&r.push("distance: "+f.number(this._distance)),"{ "+r.join(", ")+" }"},isTouching:function(){var r=this._intersection;if(r&&this.getTangent().isCollinear(r.getTangent())){var u=this.getCurve(),f=r.getCurve();return!(u.isStraight()&&f.isStraight()&&u.getLine().intersect(f.getLine()))}return!1},isCrossing:function(){var r=this._intersection;if(!r)return!1;var u=this.getTime(),f=r.getTime(),g=1e-8,m=1-g,w=u>=g&&u<=m,S=f>=g&&f<=m;if(w&&S)return!this.isTouching();var C=this.getCurve(),T=C&&u<g?C.getPrevious():C,P=r.getCurve(),R=P&&f<g?P.getPrevious():P;if(u>m&&(C=C.getNext()),f>m&&(P=P.getNext()),!T||!C||!R||!P)return!1;var B=[];function j(te,ie){var se=te.getValues(),he=Le.classify(se).roots||Le.getPeaks(se),ne=he.length,ce=Le.getLength(se,ie&&ne?he[ne-1]:0,!ie&&ne?he[0]:1);B.push(ne?ce:ce/32)}function I(te,ie,se){return ie<se?te>ie&&te<se:te>ie||te<se}w||(j(T,!0),j(C,!1)),S||(j(R,!0),j(P,!1));var Y=this.getPoint(),z=Math.min.apply(Math,B),H=w?C.getTangentAtTime(u):C.getPointAt(z).subtract(Y),L=w?H.negate():T.getPointAt(-z).subtract(Y),U=S?P.getTangentAtTime(f):P.getPointAt(z).subtract(Y),A=S?U.negate():R.getPointAt(-z).subtract(Y),V=L.getAngle(),q=H.getAngle(),J=A.getAngle(),X=U.getAngle();return!!(w?I(V,J,X)^I(q,J,X)&&I(V,X,J)^I(q,X,J):I(J,V,q)^I(X,V,q)&&I(J,q,V)^I(X,q,V))},hasOverlap:function(){return!!this._overlap}},a.each(Le._evaluateMethods,function(r){var u=r+"At";this[r]=function(){var f=this.getCurve(),g=this.getTime();return g!=null&&f&&f[u](g,!0)}},{preserve:!0}),new function(){function r(u,f,g){var m=u.length,w=0,S=m-1;function C(Y,z){for(var H=Y+z;H>=-1&&H<=m;H+=z){var L=u[(H%m+m)%m];if(!f.getPoint().isClose(L.getPoint(),1e-7))break;if(f.equals(L))return L}return null}for(;w<=S;){var T=w+S>>>1,P=u[T],R;if(g&&(R=f.equals(P)?P:C(T,-1)||C(T,1)))return f._overlap&&(R._overlap=R._intersection._overlap=!0),R;var B=f.getPath(),j=P.getPath(),I=B!==j?B._id-j._id:f.getIndex()+f.getTime()-(P.getIndex()+P.getTime());I<0?S=T-1:w=T+1}return u.splice(w,0,f),f}return{statics:{insert:r,expand:function(u){for(var f=u.slice(),g=u.length-1;g>=0;g--)r(f,u[g]._intersection,!1);return f}}}}),Be=F.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(r){var u,f,g;if(a.isPlainObject(r)?(f=r.segments,u=r.pathData):Array.isArray(r)?f=r:typeof r=="string"&&(u=r),f){var m=f[0];g=m&&Array.isArray(m[0])}else u&&(g=(u.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(u));var w=g?Ze:Xe;return new w(r)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(r){this.isClockwise()!=(r=!!r)&&this.reverse()},setPathData:function(r){var u=r&&r.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),f,g=!1,m,w,S=new O,C=new O;function T(A,V){var q=+f[A];return g&&(q+=S[V]),q}function P(A){return new O(T(A,"x"),T(A+1,"y"))}this.clear();for(var R=0,B=u&&u.length;R<B;R++){var j=u[R],I=j[0],Y=I.toLowerCase();f=j.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var z=f&&f.length;switch(g=I===Y,m==="z"&&!/[mz]/.test(Y)&&this.moveTo(S),Y){case"m":case"l":for(var H=Y==="m",L=0;L<z;L+=2)this[H?"moveTo":"lineTo"](S=P(L)),H&&(C=S,H=!1);w=S;break;case"h":case"v":var U=Y==="h"?"x":"y";S=S.clone();for(var L=0;L<z;L++)S[U]=T(L,U),this.lineTo(S);w=S;break;case"c":for(var L=0;L<z;L+=6)this.cubicCurveTo(P(L),w=P(L+2),S=P(L+4));break;case"s":for(var L=0;L<z;L+=4)this.cubicCurveTo(/[cs]/.test(m)?S.multiply(2).subtract(w):S,w=P(L),S=P(L+2)),m=Y;break;case"q":for(var L=0;L<z;L+=4)this.quadraticCurveTo(w=P(L),S=P(L+2));break;case"t":for(var L=0;L<z;L+=2)this.quadraticCurveTo(w=/[qt]/.test(m)?S.multiply(2).subtract(w):S,S=P(L)),m=Y;break;case"a":for(var L=0;L<z;L+=7)this.arcTo(S=P(L+5),new W(+f[L],+f[L+1]),+f[L+2],+f[L+4],+f[L+3]);break;case"z":this.closePath(1e-12),S=C;break}m=Y}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(r){var u=r.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(r):{};return u.onPath||!!(this.getFillRule()==="evenodd"?u.windingL&1||u.windingR&1:u.winding)},getIntersections:function(r,u,f,g){var m=this===r||!r,w=this._matrix._orNullIfIdentity(),S=m?w:(f||r._matrix)._orNullIfIdentity();return m||this.getBounds(w).intersects(r.getBounds(S),1e-12)?Le.getIntersections(this.getCurves(),!m&&r.getCurves(),u,w,S,g):[]},getCrossings:function(r){return this.getIntersections(r,function(u){return u.isCrossing()})},getNearestLocation:function(){for(var r=O.read(arguments),u=this.getCurves(),f=1/0,g=null,m=0,w=u.length;m<w;m++){var S=u[m].getNearestLocation(r);S._distance<f&&(f=S._distance,g=S)}return g},getNearestPoint:function(){var r=this.getNearestLocation.apply(this,arguments);return r&&r.getPoint()},interpolate:function(r,u,f){var g=!this._children,m=g?"_segments":"_children",w=r[m],S=u[m],C=this[m];if(!w||!S||w.length!==S.length)throw new Error("Invalid operands in interpolate() call: "+r+", "+u);var T=C.length,P=S.length;if(T<P)for(var R=g?Ve:Xe,B=T;B<P;B++)this.add(new R);else T>P&&this[g?"removeSegments":"removeChildren"](P,T);for(var B=0;B<P;B++)C[B].interpolate(w[B],S[B],f);g&&(this.setClosed(r._closed),this._changed(9))},compare:function(r){var u=!1;if(r){var f=this._children||[this],g=r._children?r._children.slice():[r],m=f.length,w=g.length,S=[],C=0;u=!0;for(var T=_.findItemBoundsCollisions(f,g,E.GEOMETRIC_EPSILON),P=m-1;P>=0&&u;P--){var R=f[P];u=!1;var B=T[P];if(B)for(var j=B.length-1;j>=0&&!u;j--)R.compare(g[B[j]])&&(S[B[j]]||(S[B[j]]=!0,C++),u=!0)}u=u&&C===w}return u}}),Xe=Be.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(u){this._closed=!1,this._segments=[],this._version=0;var f=arguments,g=Array.isArray(u)?typeof u[0]=="object"?u:f:u&&u.size===t&&(u.x!==t||u.point!==t)?f:null;g&&g.length>0?this.setSegments(g):(this._curves=t,this._segmentSelection=0,!g&&typeof u=="string"&&(this.setPathData(u),u=null)),this._initialize(!g&&u)},_equals:function(r){return this._closed===r._closed&&a.equals(this._segments,r._segments)},copyContent:function(r){this.setSegments(r._segments),this._closed=r._closed},_changed:function r(u){if(r.base.call(this,u),u&8){if(this._length=this._area=t,u&32)this._version++;else if(this._curves)for(var f=0,g=this._curves.length;f<g;f++)this._curves[f]._changed()}else u&64&&(this._bounds=t)},getStyle:function(){var r=this._parent;return(r instanceof Ze?r:this)._style},getSegments:function(){return this._segments},setSegments:function(r){var u=this.isFullySelected(),f=r&&r.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=t,f){var g=r[f-1];typeof g=="boolean"&&(this.setClosed(g),f--),this._add(Ve.readList(r,0,{},f))}u&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var r=this._curves,u=this._segments;if(!r){var f=this._countCurves();r=this._curves=new Array(f);for(var g=0;g<f;g++)r[g]=new Le(this,u[g],u[g+1]||u[0])}return r},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var r=this.getCurves();return r[r.length-1]},isClosed:function(){return this._closed},setClosed:function(r){if(this._closed!=(r=!!r)){if(this._closed=r,this._curves){var u=this._curves.length=this._countCurves();r&&(this._curves[u-1]=new Le(this,this._segments[u-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(r,u){var f=this._segments,g=f.length,m=new b(u),w=new Array(6),S=!0,C,T,P,R,B,j,I,Y,z=[];function H(U,A){if(U._transformCoordinates(r,w),C=w[0],T=w[1],S)z.push("M"+m.pair(C,T)),S=!1;else if(B=w[2],j=w[3],B===C&&j===T&&I===P&&Y===R){if(!A){var V=C-P,q=T-R;z.push(V===0?"v"+m.number(q):q===0?"h"+m.number(V):"l"+m.pair(V,q))}}else z.push("c"+m.pair(I-P,Y-R)+" "+m.pair(B-P,j-R)+" "+m.pair(C-P,T-R));P=C,R=T,I=w[4],Y=w[5]}if(!g)return"";for(var L=0;L<g;L++)H(f[L]);return this._closed&&g>0&&(H(f[0],!0),z.push("z")),z.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(r){for(var u=this._segments,f=new Array(6),g=0,m=u.length;g<m;g++)u[g]._transformCoordinates(r,f,!0);return!0},_add:function(r,S){for(var f=this._segments,g=this._curves,m=r.length,w=S==null,S=w?f.length:S,C=0;C<m;C++){var T=r[C];T._path&&(T=r[C]=T.clone()),T._path=this,T._index=S+C,T._selection&&this._updateSelection(T,0,T._selection)}if(w)a.push(f,r);else{f.splice.apply(f,[S,0].concat(r));for(var C=S+m,P=f.length;C<P;C++)f[C]._index=C}if(g){var R=this._countCurves(),B=S>0&&S+m-1===R?S-1:S,j=B,I=Math.min(B+m,R);r._curves&&(g.splice.apply(g,[B,0].concat(r._curves)),j+=r._curves.length);for(var C=j;C<I;C++)g.splice(C,0,new Le(this,null,null));this._adjustCurves(B,I)}return this._changed(41),r},_adjustCurves:function(r,u){for(var f=this._segments,g=this._curves,m,w=r;w<u;w++)m=g[w],m._path=this,m._segment1=f[w],m._segment2=f[w+1]||f[0],m._changed();(m=g[this._closed&&!r?f.length-1:r-1])&&(m._segment2=f[r]||f[0],m._changed()),(m=g[u])&&(m._segment1=f[u],m._changed())},_countCurves:function(){var r=this._segments.length;return!this._closed&&r>0?r-1:r},add:function(r){var u=arguments;return u.length>1&&typeof r!="number"?this._add(Ve.readList(u)):this._add([Ve.read(u)])[0]},insert:function(r,u){var f=arguments;return f.length>2&&typeof u!="number"?this._add(Ve.readList(f,1),r):this._add([Ve.read(f,1)],r)[0]},addSegment:function(){return this._add([Ve.read(arguments)])[0]},insertSegment:function(r){return this._add([Ve.read(arguments,1)],r)[0]},addSegments:function(r){return this._add(Ve.readList(r))},insertSegments:function(r,u){return this._add(Ve.readList(u),r)},removeSegment:function(r){return this.removeSegments(r,r+1)[0]||null},removeSegments:function(r,u,f){r=r||0,u=a.pick(u,this._segments.length);var g=this._segments,m=this._curves,w=g.length,S=g.splice(r,u-r),C=S.length;if(!C)return S;for(var T=0;T<C;T++){var P=S[T];P._selection&&this._updateSelection(P,P._selection,0),P._index=P._path=null}for(var T=r,R=g.length;T<R;T++)g[T]._index=T;if(m){for(var B=r>0&&u===w+(this._closed?1:0)?r-1:r,m=m.splice(B,C),T=m.length-1;T>=0;T--)m[T]._path=null;f&&(S._curves=m.slice(1)),this._adjustCurves(B,B)}return this._changed(41),S},clear:"#removeSegments",hasHandles:function(){for(var r=this._segments,u=0,f=r.length;u<f;u++)if(r[u].hasHandles())return!0;return!1},clearHandles:function(){for(var r=this._segments,u=0,f=r.length;u<f;u++)r[u].clearHandles()},getLength:function(){if(this._length==null){for(var r=this.getCurves(),u=0,f=0,g=r.length;f<g;f++)u+=r[f].getLength();this._length=u}return this._length},getArea:function(){var r=this._area;if(r==null){var u=this._segments,f=this._closed;r=0;for(var g=0,m=u.length;g<m;g++){var w=g+1===m;r+=Le.getArea(Le.getValues(u[g],u[w?0:g+1],null,w&&!f))}this._area=r}return r},isFullySelected:function(){var r=this._segments.length;return this.isSelected()&&r>0&&this._segmentSelection===r*7},setFullySelected:function(r){r&&this._selectSegments(!0),this.setSelected(r)},setSelection:function r(u){u&1||this._selectSegments(!1),r.base.call(this,u)},_selectSegments:function(r){var u=this._segments,f=u.length,g=r?7:0;this._segmentSelection=g*f;for(var m=0;m<f;m++)u[m]._selection=g},_updateSelection:function(r,u,f){r._selection=f;var g=this._segmentSelection+=f-u;g>0&&this.setSelected(!0)},divideAt:function(r){var u=this.getLocationAt(r),f;return u&&(f=u.getCurve().divideAt(u.getCurveOffset()))?f._segment1:null},splitAt:function(r){var u=this.getLocationAt(r),f=u&&u.index,g=u&&u.time,m=1e-8,w=1-m;g>w&&(f++,g=0);var S=this.getCurves();if(f>=0&&f<S.length){g>=m&&S[f++].divideAtTime(g);var C=this.removeSegments(f,this._segments.length,!0),T;return this._closed?(this.setClosed(!1),T=this):(T=new Xe(F.NO_INSERT),T.insertAbove(this),T.copyAttributes(this)),T._add(C,0),this.addSegment(C[0]),T}return null},split:function(r,u){var f,g=u===t?r:(f=this.getCurves()[r])&&f.getLocationAtTime(u);return g!=null?this.splitAt(g):null},join:function(r,u){var f=u||0;if(r&&r!==this){var g=r._segments,m=this.getLastSegment(),w=r.getLastSegment();if(!w)return this;m&&m._point.isClose(w._point,f)&&r.reverse();var S=r.getFirstSegment();if(m&&m._point.isClose(S._point,f))m.setHandleOut(S._handleOut),this._add(g.slice(1));else{var C=this.getFirstSegment();C&&C._point.isClose(S._point,f)&&r.reverse(),w=r.getLastSegment(),C&&C._point.isClose(w._point,f)?(C.setHandleIn(w._handleIn),this._add(g.slice(0,g.length-1),0)):this._add(g.slice())}r._closed&&this._add([g[0]]),r.remove()}var T=this.getFirstSegment(),P=this.getLastSegment();return T!==P&&T._point.isClose(P._point,f)&&(T.setHandleIn(P._handleIn),P.remove(),this.setClosed(!0)),this},reduce:function(r){for(var u=this.getCurves(),f=r&&r.simplify,g=f?1e-7:0,m=u.length-1;m>=0;m--){var w=u[m];!w.hasHandles()&&(!w.hasLength(g)||f&&w.isCollinear(w.getNext()))&&w.remove()}return this},reverse:function(){this._segments.reverse();for(var r=0,u=this._segments.length;r<u;r++){var f=this._segments[r],g=f._handleIn;f._handleIn=f._handleOut,f._handleOut=g,f._index=r}this._curves=null,this._changed(9)},flatten:function(r){for(var u=new be(this,r||.25,256,!0),f=u.parts,g=f.length,m=[],w=0;w<g;w++)m.push(new Ve(f[w].curve.slice(0,2)));!this._closed&&g>0&&m.push(new Ve(f[g-1].curve.slice(6))),this.setSegments(m)},simplify:function(r){var u=new Fe(this).fit(r||2.5);return u&&this.setSegments(u),!!u},smooth:function(r){var u=this,f=r||{},g=f.type||"asymmetric",m=this._segments,w=m.length,S=this._closed;function C(st,xt){var vt=st&&st.index;if(vt!=null){var ot=st.path;if(ot&&ot!==u)throw new Error(st._class+" "+vt+" of "+ot+" is not part of "+u);xt&&st instanceof Le&&vt++}else vt=typeof st=="number"?st:xt;return Math.min(vt<0&&S?vt%w:vt<0?vt+w:vt,w-1)}var T=S&&f.from===t&&f.to===t,P=C(f.from,0),R=C(f.to,w-1);if(P>R)if(S)P-=w;else{var B=P;P=R,R=B}if(/^(?:asymmetric|continuous)$/.test(g)){var j=g==="asymmetric",I=Math.min,Y=R-P+1,z=Y-1,H=T?I(Y,4):1,L=H,U=H,A=[];if(S||(L=I(1,P),U=I(1,w-R-1)),z+=L+U,z<=1)return;for(var V=0,q=P-L;V<=z;V++,q++)A[V]=m[(q<0?q+w:q)%w]._point;for(var J=A[0]._x+2*A[1]._x,X=A[0]._y+2*A[1]._y,te=2,ie=z-1,se=[J],he=[X],ne=[te],ce=[],fe=[],V=1;V<z;V++){var ye=V<ie,xe=ye||j?1:2,Ee=ye?4:j?2:7,Ne=ye?4:j?3:8,We=ye?2:j?0:1,$e=xe/te;te=ne[V]=Ee-$e,J=se[V]=Ne*A[V]._x+We*A[V+1]._x-$e*J,X=he[V]=Ne*A[V]._y+We*A[V+1]._y-$e*X}ce[ie]=se[ie]/ne[ie],fe[ie]=he[ie]/ne[ie];for(var V=z-2;V>=0;V--)ce[V]=(se[V]-ce[V+1])/ne[V],fe[V]=(he[V]-fe[V+1])/ne[V];ce[z]=(3*A[z]._x-ce[ie])/2,fe[z]=(3*A[z]._y-fe[ie])/2;for(var V=L,it=z-U,q=P;V<=it;V++,q++){var je=m[q<0?q+w:q],De=je._point,tt=ce[V]-De._x,at=fe[V]-De._y;(T||V<it)&&je.setHandleOut(tt,at),(T||V>L)&&je.setHandleIn(-tt,-at)}}else for(var V=P;V<=R;V++)m[V<0?V+w:V].smooth(f,!T&&V===P,!T&&V===R)},toShape:function(r){if(!this._closed)return null;var u=this._segments,f,g,m,w;function S(j,I){var Y=u[j],z=Y.getNext(),H=u[I],L=H.getNext();return Y._handleOut.isZero()&&z._handleIn.isZero()&&H._handleOut.isZero()&&L._handleIn.isZero()&&z._point.subtract(Y._point).isCollinear(L._point.subtract(H._point))}function C(j){var I=u[j],Y=I.getPrevious(),z=I.getNext();return Y._handleOut.isZero()&&I._handleIn.isZero()&&I._handleOut.isZero()&&z._handleIn.isZero()&&I._point.subtract(Y._point).isOrthogonal(z._point.subtract(I._point))}function T(j){var I=u[j],Y=I.getNext(),z=I._handleOut,H=Y._handleIn,L=.5522847498307936;if(z.isOrthogonal(H)){var U=I._point,A=Y._point,V=new ve(U,z,!0).intersect(new ve(A,H,!0),!0);return V&&E.isZero(z.getLength()/V.subtract(U).getLength()-L)&&E.isZero(H.getLength()/V.subtract(A).getLength()-L)}return!1}function P(j,I){return u[j]._point.getDistance(u[I]._point)}if(!this.hasHandles()&&u.length===4&&S(0,2)&&S(1,3)&&C(1)?(f=Je.Rectangle,g=new W(P(0,3),P(0,1)),w=u[1]._point.add(u[2]._point).divide(2)):u.length===8&&T(0)&&T(2)&&T(4)&&T(6)&&S(1,5)&&S(3,7)?(f=Je.Rectangle,g=new W(P(1,6),P(0,3)),m=g.subtract(new W(P(0,7),P(1,2))).divide(2),w=u[3]._point.add(u[4]._point).divide(2)):u.length===4&&T(0)&&T(1)&&T(2)&&T(3)&&(E.isZero(P(0,2)-P(1,3))?(f=Je.Circle,m=P(0,2)/2):(f=Je.Ellipse,m=new W(P(2,0)/2,P(3,1)/2)),w=u[1]._point),f){var R=this.getPosition(!0),B=new f({center:R,size:g,radius:m,insert:!1});return B.copyAttributes(this,!0),B._matrix.prepend(this._matrix),B.rotate(w.subtract(R).getAngle()+90),(r===t||r)&&B.insertAbove(this),B}return null},toPath:"#clone",compare:function r(u){if(!u||u instanceof Ze)return r.base.call(this,u);var f=this.getCurves(),g=u.getCurves(),m=f.length,w=g.length;if(!m||!w)return m==w;for(var S=f[0].getValues(),C=[],T=0,P,R=0,B,j=0;j<w;j++){var H=g[j].getValues();C.push(H);var I=Le.getOverlaps(S,H);if(I){P=!j&&I[0][0]>0?w-1:j,B=I[0][1];break}}for(var Y=Math.abs,z=1e-8,H=C[P],L;S&&H;){var I=Le.getOverlaps(S,H);if(I){var U=I[0][0];if(Y(U-R)<z){R=I[1][0],R===1&&(S=++T<m?f[T].getValues():null,R=0);var A=I[0][1];if(Y(A-B)<z){if(L||(L=[P,A]),B=I[1][1],B===1&&(++P>=w&&(P=0),H=C[P]||g[P].getValues(),B=0),!S)return L[0]===P&&L[1]===B;continue}}}break}return!1},_hitTestSelf:function(r,u,f,g){var m=this,w=this.getStyle(),S=this._segments,C=S.length,T=this._closed,P=u._tolerancePadding,R=P,B,j,I,Y,z,H,L=u.stroke&&w.hasStroke(),U=u.fill&&w.hasFill(),A=u.curves,V=L?w.getStrokeWidth()/2:U&&u.tolerance>0||A?0:null;V!==null&&(V>0?(B=w.getStrokeJoin(),j=w.getStrokeCap(),I=w.getMiterLimit(),R=R.add(Xe._getStrokePadding(V,g))):B=j="round");function q(ce,fe){return r.subtract(ce).divide(fe).length<=1}function J(ce,fe,ye){if(!u.selected||fe.isSelected()){var xe=ce._point;if(fe!==xe&&(fe=fe.add(xe)),q(fe,R))return new dt(ye,m,{segment:ce,point:fe})}}function X(ce,fe){return(fe||u.segments)&&J(ce,ce._point,"segment")||!fe&&u.handles&&(J(ce,ce._handleIn,"handle-in")||J(ce,ce._handleOut,"handle-out"))}function te(ce){Y.add(ce)}function ie(ce){var fe=T||ce._index>0&&ce._index<C-1;if((fe?B:j)==="round")return q(ce._point,R);if(Y=new Xe({internal:!0,closed:!0}),fe?ce.isSmooth()||Xe._addBevelJoin(ce,B,V,I,null,g,te,!0):j==="square"&&Xe._addSquareCap(ce,j,V,null,g,te,!0),!Y.isEmpty()){var ye;return Y.contains(r)||(ye=Y.getNearestLocation(r))&&q(ye.getPoint(),P)}}if(u.ends&&!u.segments&&!T){if(H=X(S[0],!0)||X(S[C-1],!0))return H}else if(u.segments||u.handles){for(var se=0;se<C;se++)if(H=X(S[se]))return H}if(V!==null){if(z=this.getNearestLocation(r),z){var he=z.getTime();he===0||he===1&&C>1?ie(z.getSegment())||(z=null):q(z.getPoint(),R)||(z=null)}if(!z&&B==="miter"&&C>1)for(var se=0;se<C;se++){var ne=S[se];if(r.getDistance(ne._point)<=I*V&&ie(ne)){z=ne.getLocation();break}}}return!z&&U&&this._contains(r)||z&&!L&&!A?new dt("fill",this):z?new dt(L?"stroke":"curve",this,{location:z,point:z.getPoint()}):null}},a.each(Le._evaluateMethods,function(r){this[r+"At"]=function(u){var f=this.getLocationAt(u);return f&&f[r]()}},{beans:!1,getLocationOf:function(){for(var r=O.read(arguments),u=this.getCurves(),f=0,g=u.length;f<g;f++){var m=u[f].getLocationOf(r);if(m)return m}return null},getOffsetOf:function(){var r=this.getLocationOf.apply(this,arguments);return r?r.getOffset():null},getLocationAt:function(r){if(typeof r=="number"){for(var u=this.getCurves(),f=0,g=0,m=u.length;g<m;g++){var w=f,S=u[g];if(f+=S.getLength(),f>r)return S.getLocationAt(r-w)}if(u.length>0&&r<=this.getLength())return new wt(u[u.length-1],1)}else if(r&&r.getPath&&r.getPath()===this)return r;return null},getOffsetsWithTangent:function(){var r=O.read(arguments);if(r.isZero())return[];for(var u=[],f=0,g=this.getCurves(),m=0,w=g.length;m<w;m++){for(var S=g[m],C=S.getTimesWithTangent(r),T=0,P=C.length;T<P;T++){var R=f+S.getOffsetAtTime(C[T]);u.indexOf(R)<0&&u.push(R)}f+=S.length}return u}}),new function(){function r(f,g,m,w){if(w<=0)return;var S=w/2,C=w-2,T=S-1,P=new Array(6),R,B;function j(U){var A=P[U],V=P[U+1];(R!=A||B!=V)&&(f.beginPath(),f.moveTo(R,B),f.lineTo(A,V),f.stroke(),f.beginPath(),f.arc(A,V,S,0,Math.PI*2,!0),f.fill())}for(var I=0,Y=g.length;I<Y;I++){var z=g[I],H=z._selection;if(z._transformCoordinates(m,P),R=P[0],B=P[1],H&2&&j(2),H&4&&j(4),f.fillRect(R-S,B-S,w,w),C>0&&!(H&1)){var L=f.fillStyle;f.fillStyle="#ffffff",f.fillRect(R-T,B-T,C,C),f.fillStyle=L}}}function u(f,g,m){var w=g._segments,S=w.length,C=new Array(6),T=!0,P,R,B,j,I,Y,z,H;function L(A){if(m)A._transformCoordinates(m,C),P=C[0],R=C[1];else{var V=A._point;P=V._x,R=V._y}if(T)f.moveTo(P,R),T=!1;else{if(m)I=C[2],Y=C[3];else{var q=A._handleIn;I=P+q._x,Y=R+q._y}I===P&&Y===R&&z===B&&H===j?f.lineTo(P,R):f.bezierCurveTo(z,H,I,Y,P,R)}if(B=P,j=R,m)z=C[4],H=C[5];else{var q=A._handleOut;z=B+q._x,H=j+q._y}}for(var U=0;U<S;U++)L(w[U]);g._closed&&S>0&&L(w[0])}return{_draw:function(f,g,m,w){var S=g.dontStart,C=g.dontFinish||g.clip,T=this.getStyle(),P=T.hasFill(),R=T.hasStroke(),B=T.getDashArray(),j=!Ft.support.nativeDash&&R&&B&&B.length;S||f.beginPath(),(P||R&&!j||C)&&(u(f,this,w),this._closed&&f.closePath());function I(A){return B[(A%j+j)%j]}if(!C&&(P||R)&&(this._setStyles(f,g,m),P&&(f.fill(T.getFillRule()),f.shadowColor="rgba(0,0,0,0)"),R)){if(j){S||f.beginPath();for(var Y=new be(this,.25,32,!1,w),z=Y.length,H=-T.getDashOffset(),L,U=0;H>0;)H-=I(U--)+I(U--);for(;H<z;)L=H+I(U++),(H>0||L>0)&&Y.drawPart(f,Math.max(H,0),Math.max(L,0)),H=L+I(U++)}f.stroke()}},_drawSelected:function(f,g){f.beginPath(),u(f,this,g),f.stroke(),r(f,this._segments,g,Ft.settings.handleSize)}}},new function(){function r(u){var f=u._segments;if(!f.length)throw new Error("Use a moveTo() command first");return f[f.length-1]}return{moveTo:function(){var u=this._segments;u.length===1&&this.removeSegment(0),u.length||this._add([new Ve(O.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new Ve(O.read(arguments))])},cubicCurveTo:function(){var u=arguments,f=O.read(u),g=O.read(u),m=O.read(u),w=r(this);w.setHandleOut(f.subtract(w._point)),this._add([new Ve(m,g.subtract(m))])},quadraticCurveTo:function(){var u=arguments,f=O.read(u),g=O.read(u),m=r(this)._point;this.cubicCurveTo(f.add(m.subtract(f).multiply(1/3)),f.add(g.subtract(f).multiply(1/3)),g)},curveTo:function(){var u=arguments,f=O.read(u),g=O.read(u),m=a.pick(a.read(u),.5),w=1-m,S=r(this)._point,C=f.subtract(S.multiply(w*w)).subtract(g.multiply(m*m)).divide(2*m*w);if(C.isNaN())throw new Error("Cannot put a curve through points with parameter = "+m);this.quadraticCurveTo(C,g)},arcTo:function(){var u=arguments,f=Math.abs,g=Math.sqrt,m=r(this),w=m._point,S=O.read(u),C,T=a.peek(u),P=a.pick(T,!0),R,B,j,I;if(typeof P=="boolean")var Y=w.add(S).divide(2),C=Y.add(Y.subtract(w).rotate(P?-90:90));else if(a.remain(u)<=2)C=S,S=O.read(u);else if(!w.equals(S)){var z=W.read(u),H=E.isZero;if(H(z.width)||H(z.height))return this.lineTo(S);var L=a.read(u),P=!!a.read(u),U=!!a.read(u),Y=w.add(S).divide(2),A=w.subtract(Y).rotate(-L),V=A.x,q=A.y,J=f(z.width),X=f(z.height),te=J*J,ie=X*X,se=V*V,he=q*q,ne=g(se/te+he/ie);if(ne>1&&(J*=ne,X*=ne,te=J*J,ie=X*X),ne=(te*ie-te*he-ie*se)/(te*he+ie*se),f(ne)<1e-12&&(ne=0),ne<0)throw new Error("Cannot create an arc with the given arguments");R=new O(J*q/X,-X*V/J).multiply((U===P?-1:1)*g(ne)).rotate(L).add(Y),I=new le().translate(R).rotate(L).scale(J,X),j=I._inverseTransform(w),B=j.getDirectedAngle(I._inverseTransform(S)),!P&&B>0?B-=360:P&&B<0&&(B+=360)}if(C){var ce=new ve(w.add(C).divide(2),C.subtract(w).rotate(90),!0),fe=new ve(C.add(S).divide(2),S.subtract(C).rotate(90),!0),ye=new ve(w,S),xe=ye.getSide(C);if(R=ce.intersect(fe,!0),!R){if(!xe)return this.lineTo(S);throw new Error("Cannot create an arc with the given arguments")}j=w.subtract(R),B=j.getDirectedAngle(S.subtract(R));var Ee=ye.getSide(R,!0);Ee===0?B=xe*f(B):xe===Ee&&(B+=B<0?360:-360)}if(B){for(var Ne=1e-5,We=f(B),$e=We>=360?4:Math.ceil((We-Ne)/90),it=B/$e,je=it*Math.PI/360,De=4/3*Math.sin(je)/(1+Math.cos(je)),tt=[],at=0;at<=$e;at++){var A=S,st=null;if(at<$e&&(st=j.rotate(90).multiply(De),I?(A=I._transformPoint(j),st=I._transformPoint(j.add(st)).subtract(A)):A=R.add(j)),!at)m.setHandleOut(st);else{var xt=j.rotate(-90).multiply(De);I&&(xt=I._transformPoint(j.add(xt)).subtract(A)),tt.push(new Ve(A,xt,st))}j=j.rotate(it)}this._add(tt)}},lineBy:function(){var u=O.read(arguments),f=r(this)._point;this.lineTo(f.add(u))},curveBy:function(){var u=arguments,f=O.read(u),g=O.read(u),m=a.read(u),w=r(this)._point;this.curveTo(w.add(f),w.add(g),m)},cubicCurveBy:function(){var u=arguments,f=O.read(u),g=O.read(u),m=O.read(u),w=r(this)._point;this.cubicCurveTo(w.add(f),w.add(g),w.add(m))},quadraticCurveBy:function(){var u=arguments,f=O.read(u),g=O.read(u),m=r(this)._point;this.quadraticCurveTo(m.add(f),m.add(g))},arcBy:function(){var u=arguments,f=r(this)._point,g=f.add(O.read(u)),m=a.pick(a.peek(u),!0);typeof m=="boolean"?this.arcTo(g,m):this.arcTo(g,f.add(O.read(u)))},closePath:function(u){this.setClosed(!0),this.join(this,u)}}},{_getBounds:function(r,u){var f=u.handle?"getHandleBounds":u.stroke?"getStrokeBounds":"getBounds";return Xe[f](this._segments,this._closed,this,r,u)},statics:{getBounds:function(r,u,f,g,m,w){var S=r[0];if(!S)return new K;var C=new Array(6),T=S._transformCoordinates(g,new Array(6)),P=T.slice(0,2),R=P.slice(),B=new Array(2);function j(z){z._transformCoordinates(g,C);for(var H=0;H<2;H++)Le._addBounds(T[H],T[H+4],C[H+2],C[H],H,w?w[H]:0,P,R,B);var L=T;T=C,C=L}for(var I=1,Y=r.length;I<Y;I++)j(r[I]);return u&&j(S),new K(P[0],P[1],R[0]-P[0],R[1]-P[1])},getStrokeBounds:function(r,u,f,g,m){var w=f.getStyle(),S=w.hasStroke(),C=w.getStrokeWidth(),T=S&&f._getStrokeMatrix(g,m),P=S&&Xe._getStrokePadding(C,T),R=Xe.getBounds(r,u,f,g,m,P);if(!S)return R;var B=C/2,j=w.getStrokeJoin(),I=w.getStrokeCap(),Y=w.getMiterLimit(),z=new K(new W(P));function H(J){R=R.include(J)}function L(J){R=R.unite(z.setCenter(J._point.transform(g)))}function U(J,X){X==="round"||J.isSmooth()?L(J):Xe._addBevelJoin(J,X,B,Y,g,T,H)}function A(J,X){X==="round"?L(J):Xe._addSquareCap(J,X,B,g,T,H)}var V=r.length-(u?0:1);if(V>0){for(var q=1;q<V;q++)U(r[q],j);u?U(r[0],j):(A(r[0],I),A(r[r.length-1],I))}return R},_getStrokePadding:function(r,u){if(!u)return[r,r];var f=new O(r,0).transform(u),g=new O(0,r).transform(u),m=f.getAngleInRadians(),w=f.getLength(),S=g.getLength(),C=Math.sin(m),T=Math.cos(m),P=Math.tan(m),R=Math.atan2(S*P,w),B=Math.atan2(S,P*w);return[Math.abs(w*Math.cos(R)*T+S*Math.sin(R)*C),Math.abs(S*Math.sin(B)*T+w*Math.cos(B)*C)]},_addBevelJoin:function(r,u,f,g,m,w,S,C){var T=r.getCurve(),P=T.getPrevious(),R=T.getPoint1().transform(m),B=P.getNormalAtTime(1).multiply(f).transform(w),j=T.getNormalAtTime(0).multiply(f).transform(w),I=B.getDirectedAngle(j);if((I<0||I>=180)&&(B=B.negate(),j=j.negate()),C&&S(R),S(R.add(B)),u==="miter"){var Y=new ve(R.add(B),new O(-B.y,B.x),!0).intersect(new ve(R.add(j),new O(-j.y,j.x),!0),!0);Y&&R.getDistance(Y)<=g*f&&S(Y)}S(R.add(j))},_addSquareCap:function(r,u,f,g,m,w,S){var C=r._point.transform(g),T=r.getLocation(),P=T.getNormal().multiply(T.getTime()===0?f:-f).transform(m);u==="square"&&(S&&(w(C.subtract(P)),w(C.add(P))),C=C.add(P.rotate(-90))),w(C.add(P)),w(C.subtract(P))},getHandleBounds:function(r,u,f,g,m){var w=f.getStyle(),S=m.stroke&&w.hasStroke(),C,T;if(S){var P=f._getStrokeMatrix(g,m),R=w.getStrokeWidth()/2,B=R;w.getStrokeJoin()==="miter"&&(B=R*w.getMiterLimit()),w.getStrokeCap()==="square"&&(B=Math.max(B,R*Math.SQRT2)),C=Xe._getStrokePadding(R,P),T=Xe._getStrokePadding(B,P)}for(var j=new Array(6),I=1/0,Y=-I,z=I,H=Y,L=0,U=r.length;L<U;L++){var A=r[L];A._transformCoordinates(g,j);for(var V=0;V<6;V+=2){var q=V?C:T,J=q?q[0]:0,X=q?q[1]:0,te=j[V],ie=j[V+1],se=te-J,he=te+J,ne=ie-X,ce=ie+X;se<I&&(I=se),he>Y&&(Y=he),ne<z&&(z=ne),ce>H&&(H=ce)}}return new K(I,z,Y-I,H-z)}}});Xe.inject({statics:new function(){var r=.5522847498307936,u=[new Ve([-1,0],[0,r],[0,-r]),new Ve([0,-1],[-r,0],[r,0]),new Ve([1,0],[0,-r],[0,r]),new Ve([0,1],[r,0],[-r,0])];function f(m,w,S){var C=a.getNamed(S),T=new Xe(C&&(C.insert==!0?F.INSERT:C.insert==!1?F.NO_INSERT:null));return T._add(m),T._closed=w,T.set(C,F.INSERT)}function g(m,w,S){for(var C=new Array(4),T=0;T<4;T++){var P=u[T];C[T]=new Ve(P._point.multiply(w).add(m),P._handleIn.multiply(w),P._handleOut.multiply(w))}return f(C,!0,S)}return{Line:function(){var m=arguments;return f([new Ve(O.readNamed(m,"from")),new Ve(O.readNamed(m,"to"))],!1,m)},Circle:function(){var m=arguments,w=O.readNamed(m,"center"),S=a.readNamed(m,"radius");return g(w,new W(S),m)},Rectangle:function(){var m=arguments,w=K.readNamed(m,"rectangle"),S=W.readNamed(m,"radius",0,{readNull:!0}),C=w.getBottomLeft(!0),T=w.getTopLeft(!0),P=w.getTopRight(!0),R=w.getBottomRight(!0),B;if(!S||S.isZero())B=[new Ve(C),new Ve(T),new Ve(P),new Ve(R)];else{S=W.min(S,w.getSize(!0).divide(2));var j=S.width,I=S.height,Y=j*r,z=I*r;B=[new Ve(C.add(j,0),null,[-Y,0]),new Ve(C.subtract(0,I),[0,z]),new Ve(T.add(0,I),null,[0,-z]),new Ve(T.add(j,0),[-Y,0],null),new Ve(P.subtract(j,0),null,[Y,0]),new Ve(P.add(0,I),[0,-z],null),new Ve(R.subtract(0,I),null,[0,z]),new Ve(R.subtract(j,0),[Y,0])]}return f(B,!0,m)},RoundRectangle:"#Rectangle",Ellipse:function(){var m=arguments,w=Je._readEllipse(m);return g(w.center,w.radius,m)},Oval:"#Ellipse",Arc:function(){var m=arguments,w=O.readNamed(m,"from"),S=O.readNamed(m,"through"),C=O.readNamed(m,"to"),T=a.getNamed(m),P=new Xe(T&&T.insert==!1&&F.NO_INSERT);return P.moveTo(w),P.arcTo(S,C),P.set(T)},RegularPolygon:function(){for(var m=arguments,w=O.readNamed(m,"center"),S=a.readNamed(m,"sides"),C=a.readNamed(m,"radius"),T=360/S,P=S%3===0,R=new O(0,P?-C:C),B=P?-1:.5,j=new Array(S),I=0;I<S;I++)j[I]=new Ve(w.add(R.rotate((I+B)*T)));return f(j,!0,m)},Star:function(){for(var m=arguments,w=O.readNamed(m,"center"),S=a.readNamed(m,"points")*2,C=a.readNamed(m,"radius1"),T=a.readNamed(m,"radius2"),P=360/S,R=new O(0,-1),B=new Array(S),j=0;j<S;j++)B[j]=new Ve(w.add(R.rotate(P*j).multiply(j%2?T:C)));return f(B,!0,m)}}}});var Ze=Be.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(u){this._children=[],this._namedChildren={},this._initialize(u)||(typeof u=="string"?this.setPathData(u):this.addChildren(Array.isArray(u)?u:arguments))},insertChildren:function r(u,f){var g=f,m=g[0];m&&typeof m[0]=="number"&&(g=[g]);for(var w=f.length-1;w>=0;w--){var S=g[w];g===f&&!(S instanceof Xe)&&(g=a.slice(g)),Array.isArray(S)?g[w]=new Xe({segments:S,insert:!1}):S instanceof Ze&&(g.splice.apply(g,[w,1].concat(S.removeChildren())),S.remove())}return r.base.call(this,u,g)},reduce:function r(u){for(var f=this._children,g=f.length-1;g>=0;g--){var m=f[g].reduce(u);m.isEmpty()&&m.remove()}if(!f.length){var m=new Xe(F.NO_INSERT);return m.copyAttributes(this),m.insertAbove(this),this.remove(),m}return r.base.call(this)},isClosed:function(){for(var r=this._children,u=0,f=r.length;u<f;u++)if(!r[u]._closed)return!1;return!0},setClosed:function(r){for(var u=this._children,f=0,g=u.length;f<g;f++)u[f].setClosed(r)},getFirstSegment:function(){var r=this.getFirstChild();return r&&r.getFirstSegment()},getLastSegment:function(){var r=this.getLastChild();return r&&r.getLastSegment()},getCurves:function(){for(var r=this._children,u=[],f=0,g=r.length;f<g;f++)a.push(u,r[f].getCurves());return u},getFirstCurve:function(){var r=this.getFirstChild();return r&&r.getFirstCurve()},getLastCurve:function(){var r=this.getLastChild();return r&&r.getLastCurve()},getArea:function(){for(var r=this._children,u=0,f=0,g=r.length;f<g;f++)u+=r[f].getArea();return u},getLength:function(){for(var r=this._children,u=0,f=0,g=r.length;f<g;f++)u+=r[f].getLength();return u},getPathData:function(r,u){for(var f=this._children,g=[],m=0,w=f.length;m<w;m++){var S=f[m],C=S._matrix;g.push(S.getPathData(r&&!C.isIdentity()?r.appended(C):r,u))}return g.join("")},_hitTestChildren:function r(u,f,g){return r.base.call(this,u,f.class===Xe||f.type==="path"?f:a.set({},f,{fill:!1}),g)},_draw:function(r,u,f,g){var m=this._children;if(m.length){u=u.extend({dontStart:!0,dontFinish:!0}),r.beginPath();for(var w=0,S=m.length;w<S;w++)m[w].draw(r,u,g);if(!u.clip){this._setStyles(r,u,f);var C=this._style;C.hasFill()&&(r.fill(C.getFillRule()),r.shadowColor="rgba(0,0,0,0)"),C.hasStroke()&&r.stroke()}}},_drawSelected:function(r,u,f){for(var g=this._children,m=0,w=g.length;m<w;m++){var S=g[m],C=S._matrix;f[S._id]||S._drawSelected(r,C.isIdentity()?u:u.appended(C))}}},new function(){function r(u,f){var g=u._children;if(f&&!g.length)throw new Error("Use a moveTo() command first");return g[g.length-1]}return a.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(u){this[u]=function(){var f=r(this,!0);f[u].apply(f,arguments)}},{moveTo:function(){var u=r(this),f=u&&u.isEmpty()?u:new Xe(F.NO_INSERT);f!==u&&this.addChild(f),f.moveTo.apply(f,arguments)},moveBy:function(){var u=r(this,!0),f=u&&u.getLastSegment(),g=O.read(arguments);this.moveTo(f?g.add(f._point):g)},closePath:function(u){r(this,!0).closePath(u)}})},a.each(["reverse","flatten","simplify","smooth"],function(r){this[r]=function(u){for(var f=this._children,g,m=0,w=f.length;m<w;m++)g=f[m][r](u)||g;return g}},{}));Be.inject(new function(){var r=Math.min,u=Math.max,f=Math.abs,g={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function m(L){return L._children||[L]}function w(L,U){var A=L.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(U){for(var V=m(A),q=0,J=V.length;q<J;q++){var L=V[q];!L._closed&&!L.isEmpty()&&(L.closePath(1e-12),L.getFirstSegment().setHandleIn(0,0),L.getLastSegment().setHandleOut(0,0))}A=A.resolveCrossings().reorient(A.getFillRule()==="nonzero",!0)}return A}function S(L,U,A,V,q){var J=new Ze(F.NO_INSERT);return J.addChildren(L,!0),J=J.reduce({simplify:U}),q&&q.insert==!1||J.insertAbove(V&&A.isSibling(V)&&A.getIndex()<V.getIndex()?V:A),J.copyAttributes(A,!0),J}function C(L){return L.hasOverlap()||L.isCrossing()}function T(L,U,A,V){if(V&&(V.trace==!1||V.stroke)&&/^(subtract|intersect)$/.test(A))return P(L,U,A);var q=w(L,!0),J=U&&L!==U&&w(U,!0),X=g[A];X[A]=!0,J&&(X.subtract||X.exclude)^(J.isClockwise()^q.isClockwise())&&J.reverse();var te=I(wt.expand(q.getIntersections(J,C))),ie=m(q),se=J&&m(J),he=[],ne=[],ce;function fe(st){for(var xt=0,vt=st.length;xt<vt;xt++){var ot=st[xt];a.push(he,ot._segments),a.push(ne,ot.getCurves()),ot._overlapsOnly=!0}}function ye(st){for(var xt=[],vt=0,ot=st&&st.length;vt<ot;vt++)xt.push(ne[st[vt]]);return xt}if(te.length){fe(ie),se&&fe(se);for(var xe=new Array(ne.length),Ee=0,Ne=ne.length;Ee<Ne;Ee++)xe[Ee]=ne[Ee].getValues();for(var We=_.findCurveBoundsCollisions(xe,xe,0,!0),$e={},Ee=0;Ee<ne.length;Ee++){var it=ne[Ee],je=it._path._id,De=$e[je]=$e[je]||{};De[it.getIndex()]={hor:ye(We[Ee].hor),ver:ye(We[Ee].ver)}}for(var Ee=0,Ne=te.length;Ee<Ne;Ee++)z(te[Ee]._segment,q,J,$e,X);for(var Ee=0,Ne=he.length;Ee<Ne;Ee++){var tt=he[Ee],at=tt._intersection;tt._winding||z(tt,q,J,$e,X),at&&at._overlap||(tt._path._overlapsOnly=!1)}ce=H(he,X)}else ce=j(se?ie.concat(se):ie.slice(),function(st){return!!X[st]});return S(ce,!0,L,U,V)}function P(L,U,A){var V=w(L),q=w(U),J=V.getIntersections(q,C),X=A==="subtract",te=A==="divide",ie={},se=[];function he(fe){if(!ie[fe._id]&&(te||q.contains(fe.getPointAt(fe.getLength()/2))^X))return se.unshift(fe),ie[fe._id]=!0}for(var ne=J.length-1;ne>=0;ne--){var ce=J[ne].split();ce&&(he(ce)&&ce.getFirstSegment().setHandleIn(0,0),V.getLastSegment().setHandleOut(0,0))}return he(V),S(se,!1,L,U)}function R(L,U){for(var A=L;A;){if(A===U)return;A=A._previous}for(;L._next&&L._next!==U;)L=L._next;if(!L._next){for(;U._previous;)U=U._previous;L._next=U,U._previous=L}}function B(L){for(var U=L.length-1;U>=0;U--)L[U].clearHandles()}function j(L,U,A){var V=L&&L.length;if(V){var q=a.each(L,function(We,$e){this[We._id]={container:null,winding:We.isClockwise()?1:-1,index:$e}},{}),J=L.slice().sort(function(We,$e){return f($e.getArea())-f(We.getArea())}),X=J[0],te=_.findItemBoundsCollisions(J,null,E.GEOMETRIC_EPSILON);A==null&&(A=X.isClockwise());for(var ie=0;ie<V;ie++){var se=J[ie],he=q[se._id],ne=0,ce=te[ie];if(ce){for(var fe=null,ye=ce.length-1;ye>=0;ye--)if(ce[ye]<ie){fe=fe||se.getInteriorPoint();var xe=J[ce[ye]];if(xe.contains(fe)){var Ee=q[xe._id];ne=Ee.winding,he.winding+=ne,he.container=Ee.exclude?Ee.container:xe;break}}}if(U(he.winding)===U(ne))he.exclude=!0,L[he.index]=null;else{var Ne=he.container;se.setClockwise(Ne?!Ne.isClockwise():A)}}}return L}function I(L,U,A){var V=U&&[],q=1e-8,J=1-q,X=!1,te=A||[],ie=A&&{},se,he,ne;function ce(xt){return xt._path._id+"."+xt._segment1._index}for(var fe=(A&&A.length)-1;fe>=0;fe--){var ye=A[fe];ye._path&&(ie[ce(ye)]=!0)}for(var fe=L.length-1;fe>=0;fe--){var xe=L[fe],Ee=xe._time,Ne=Ee,We=U&&!U(xe),ye=xe._curve,$e;if(ye&&(ye!==he?(X=!ye.hasHandles()||ie&&ie[ce(ye)],se=[],ne=null,he=ye):ne>=q&&(Ee/=ne)),We){se&&se.push(xe);continue}else U&&V.unshift(xe);if(ne=Ne,Ee<q)$e=ye._segment1;else if(Ee>J)$e=ye._segment2;else{var it=ye.divideAtTime(Ee,!0);X&&te.push(ye,it),$e=it._segment1;for(var je=se.length-1;je>=0;je--){var De=se[je];De._time=(De._time-Ee)/(1-Ee)}}xe._setSegment($e);var tt=$e._intersection,at=xe._intersection;if(tt){R(tt,at);for(var st=tt;st;)R(st._intersection,tt),st=st._next}else $e._intersection=at}return A||B(te),V||L}function Y(L,U,A,V,q){var J=Array.isArray(U)?U:U[A?"hor":"ver"],X=A?1:0,te=X^1,ie=[L.x,L.y],se=ie[X],he=ie[te],ne=1e-9,ce=1e-6,fe=se-ne,ye=se+ne,xe=0,Ee=0,Ne=0,We=0,$e=!1,it=!1,je=1,De=[],tt,at;function st(qe){var Ht=qe[te+0],an=qe[te+6];if(!(he<r(Ht,an)||he>u(Ht,an))){var qt=qe[X+0],er=qe[X+2],Nr=qe[X+4],hr=qe[X+6];if(Ht===an){(qt<ye&&hr>fe||hr<ye&&qt>fe)&&($e=!0);return}var Wn=he===Ht?0:he===an||fe>u(qt,er,Nr,hr)||ye<r(qt,er,Nr,hr)?1:Le.solveCubic(qe,te,he,De,0,1)>0?De[0]:1,Cn=Wn===0?qt:Wn===1?hr:Le.getPoint(qe,Wn)[A?"y":"x"],On=Ht>an?1:-1,tr=tt[te]>tt[te+6]?1:-1,vn=tt[X+6];return he!==Ht?(Cn<fe?Ne+=On:Cn>ye?We+=On:$e=!0,Cn>se-ce&&Cn<se+ce&&(je/=2)):(On!==tr?qt<fe?Ne+=On:qt>ye&&(We+=On):qt!=vn&&(vn<ye&&Cn>ye?(We+=On,$e=!0):vn>fe&&Cn<fe&&(Ne+=On,$e=!0)),je/=4),tt=qe,!q&&Cn>fe&&Cn<ye&&Le.getTangent(qe,Wn)[A?"x":"y"]===0&&Y(L,U,!A,V,!0)}}function xt(qe){var Ht=qe[te+0],an=qe[te+2],qt=qe[te+4],er=qe[te+6];if(he<=u(Ht,an,qt,er)&&he>=r(Ht,an,qt,er)){for(var Nr=qe[X+0],hr=qe[X+2],Wn=qe[X+4],Cn=qe[X+6],On=fe>u(Nr,hr,Wn,Cn)||ye<r(Nr,hr,Wn,Cn)?[qe]:Le.getMonoCurves(qe,A),tr,vn=0,Nn=On.length;vn<Nn;vn++)if(tr=st(On[vn]))return tr}}for(var vt=0,ot=J.length;vt<ot;vt++){var Lt=J[vt],bt=Lt._path,pn=Lt.getValues(),sn;if((!vt||J[vt-1]._path!==bt)&&(tt=null,bt._closed||(at=Le.getValues(bt.getLastCurve().getSegment2(),Lt.getSegment1(),null,!V),at[te]!==at[te+6]&&(tt=at)),!tt)){tt=pn;for(var Sn=bt.getLastCurve();Sn&&Sn!==Lt;){var ln=Sn.getValues();if(ln[te]!==ln[te+6]){tt=ln;break}Sn=Sn.getPrevious()}}if(sn=xt(pn))return sn;if(vt+1===ot||J[vt+1]._path!==bt){if(at&&(sn=xt(at)))return sn;$e&&!Ne&&!We&&(Ne=We=bt.isClockwise(V)^A?1:-1),xe+=Ne,Ee+=We,Ne=We=0,$e&&(it=!0,$e=!1),at=null}}return xe=f(xe),Ee=f(Ee),{winding:u(xe,Ee),windingL:xe,windingR:Ee,quality:je,onPath:it}}function z(L,U,A,V,q){var J=[],X=L,te=0,ne;do{var ie=L.getCurve();if(ie){var se=ie.getLength();J.push({segment:L,curve:ie,length:se}),te+=se}L=L.getNext()}while(L&&!L._intersection&&L!==X);for(var he=[.5,.25,.75],ne={winding:0,quality:-1},ce=.001,fe=1-ce,ye=0;ye<he.length&&ne.quality<.5;ye++)for(var se=te*he[ye],xe=0,Ee=J.length;xe<Ee;xe++){var Ne=J[xe],We=Ne.length;if(se<=We){var ie=Ne.curve,$e=ie._path,it=$e._parent,je=it instanceof Ze?it:$e,De=E.clamp(ie.getTimeAt(se),ce,fe),tt=ie.getPointAtTime(De),at=f(ie.getTangentAtTime(De).y)<Math.SQRT1_2,st=null;if(q.subtract&&A){var xt=je===U?A:U,vt=xt._getWinding(tt,at,!0);if(je===U&&vt.winding||je===A&&!vt.winding){if(vt.quality<1)continue;st={winding:0,quality:1}}}st=st||Y(tt,V[$e._id][ie.getIndex()],at,!0),st.quality>ne.quality&&(ne=st);break}se-=We}for(var xe=J.length-1;xe>=0;xe--)J[xe].segment._winding=ne}function H(L,U){var A=[],V;function q(ot){var Lt;return!!(ot&&!ot._visited&&(!U||U[(Lt=ot._winding||{}).winding]&&!(U.unite&&Lt.winding===2&&Lt.windingL&&Lt.windingR)))}function J(ot){if(ot){for(var Lt=0,bt=V.length;Lt<bt;Lt++)if(ot===V[Lt])return!0}return!1}function X(ot){for(var Lt=ot._segments,bt=0,pn=Lt.length;bt<pn;bt++)Lt[bt]._visited=!0}function te(ot,Lt){var bt=ot._intersection,pn=bt,sn=[];Lt&&(V=[ot]);function Sn(ln,qe){for(;ln&&ln!==qe;){var Ht=ln._segment,an=Ht&&Ht._path;if(an){var qt=Ht.getNext()||an.getFirstSegment(),er=qt._intersection;Ht!==ot&&(J(Ht)||J(qt)||qt&&q(Ht)&&(q(qt)||er&&q(er._segment)))&&sn.push(Ht),Lt&&V.push(Ht)}ln=ln._next}}if(bt){for(Sn(bt);bt&&bt._previous;)bt=bt._previous;Sn(bt,pn)}return sn}L.sort(function(ot,Lt){var bt=ot._intersection,pn=Lt._intersection,sn=!!(bt&&bt._overlap),Sn=!!(pn&&pn._overlap),ln=ot._path,qe=Lt._path;return sn^Sn?sn?1:-1:!bt^!pn?bt?1:-1:ln!==qe?ln._id-qe._id:ot._index-Lt._index});for(var ie=0,se=L.length;ie<se;ie++){var he=L[ie],ne=q(he),ce=null,fe=!1,ye=!0,xe=[],Ee,Ne,We;if(ne&&he._path._overlapsOnly){var $e=he._path,it=he._intersection._segment._path;$e.compare(it)&&($e.getArea()&&A.push($e.clone(!1)),X($e),X(it),ne=!1)}for(;ne;){var je=!ce,De=te(he,je),tt=De.shift(),fe=!je&&(J(he)||J(tt)),at=!fe&&tt;if(je&&(ce=new Xe(F.NO_INSERT),Ee=null),fe){(he.isFirst()||he.isLast())&&(ye=he._path._closed),he._visited=!0;break}if(at&&Ee&&(xe.push(Ee),Ee=null),Ee||(at&&De.push(he),Ee={start:ce._segments.length,crossings:De,visited:Ne=[],handleIn:We}),at&&(he=tt),!q(he)){ce.removeSegments(Ee.start);for(var st=0,xt=Ne.length;st<xt;st++)Ne[st]._visited=!1;Ne.length=0;do he=Ee&&Ee.crossings.shift(),(!he||!he._path)&&(he=null,Ee=xe.pop(),Ee&&(Ne=Ee.visited,We=Ee.handleIn));while(Ee&&!q(he));if(!he)break}var vt=he.getNext();ce.add(new Ve(he._point,We,vt&&he._handleOut)),he._visited=!0,Ne.push(he),he=vt||he._path.getFirstSegment(),We=vt&&vt._handleIn}fe&&(ye&&(ce.getFirstSegment().setHandleIn(We),ce.setClosed(ye)),ce.getArea()!==0&&A.push(ce))}return A}return{_getWinding:function(L,U,A){return Y(L,this.getCurves(),U,A)},unite:function(L,U){return T(this,L,"unite",U)},intersect:function(L,U){return T(this,L,"intersect",U)},subtract:function(L,U){return T(this,L,"subtract",U)},exclude:function(L,U){return T(this,L,"exclude",U)},divide:function(L,U){return U&&(U.trace==!1||U.stroke)?P(this,L,"divide"):S([this.subtract(L,U),this.intersect(L,U)],!0,this,L,U)},resolveCrossings:function(){var L=this._children,U=L||[this];function A(Ee,Ne){var We=Ee&&Ee._intersection;return We&&We._overlap&&We._path===Ne}var V=!1,q=!1,J=this.getIntersections(null,function(Ee){return Ee.hasOverlap()&&(V=!0)||Ee.isCrossing()&&(q=!0)}),X=V&&q&&[];if(J=wt.expand(J),V)for(var te=I(J,function(Ee){return Ee.hasOverlap()},X),ie=te.length-1;ie>=0;ie--){var se=te[ie],he=se._path,ne=se._segment,ce=ne.getPrevious(),fe=ne.getNext();A(ce,he)&&A(fe,he)&&(ne.remove(),ce._handleOut._set(0,0),fe._handleIn._set(0,0),ce!==ne&&!ce.getCurve().hasLength()&&(fe._handleIn.set(ce._handleIn),ce.remove()))}q&&(I(J,V&&function(Ee){var Ne=Ee.getCurve(),We=Ee.getSegment(),$e=Ee._intersection,it=$e._curve,je=$e._segment;if(Ne&&it&&Ne._path&&it._path)return!0;We&&(We._intersection=null),je&&(je._intersection=null)},X),X&&B(X),U=H(a.each(U,function(Ee){a.push(this,Ee._segments)},[])));var ye=U.length,xe;return ye>1&&L?(U!==L&&this.setChildren(U),xe=this):ye===1&&!L&&(U[0]!==this&&this.setSegments(U[0].removeSegments()),xe=this),xe||(xe=new Ze(F.NO_INSERT),xe.addChildren(U),xe=xe.reduce(),xe.copyAttributes(this),this.replaceWith(xe)),xe},reorient:function(L,U){var A=this._children;return A&&A.length?this.setChildren(j(this.removeChildren(),function(V){return!!(L?V:V&1)},U)):U!==t&&this.setClockwise(U),this},getInteriorPoint:function(){var L=this.getBounds(),U=L.getCenter(!0);if(!this.contains(U)){for(var A=this.getCurves(),V=U.y,q=[],J=[],X=0,te=A.length;X<te;X++){var ie=A[X].getValues(),se=ie[1],he=ie[3],ne=ie[5],ce=ie[7];if(V>=r(se,he,ne,ce)&&V<=u(se,he,ne,ce))for(var fe=Le.getMonoCurves(ie),ye=0,xe=fe.length;ye<xe;ye++){var Ee=fe[ye],Ne=Ee[1],We=Ee[7];if(Ne!==We&&(V>=Ne&&V<=We||V>=We&&V<=Ne)){var $e=V===Ne?Ee[0]:V===We?Ee[6]:Le.solveCubic(Ee,1,V,J,0,1)===1?Le.getPoint(Ee,J[0]).x:(Ee[0]+Ee[6])/2;q.push($e)}}}q.length>1&&(q.sort(function(it,je){return it-je}),U.x=(q[0]+q[1])/2)}return U}}});var be=a.extend({_class:"PathFlattener",initialize:function(r,u,f,g,m){var w=[],S=[],C=0,T=1/(f||32),P=r._segments,R=P[0],B;function j(H,L){var U=Le.getValues(H,L,m);w.push(U),I(U,H._index,0,1)}function I(H,L,U,A){if(A-U>T&&!(g&&Le.isStraight(H))&&!Le.isFlatEnough(H,u||.25)){var V=Le.subdivide(H,.5),q=(U+A)/2;I(V[0],L,U,q),I(V[1],L,q,A)}else{var J=H[6]-H[0],X=H[7]-H[1],te=Math.sqrt(J*J+X*X);te>0&&(C+=te,S.push({offset:C,curve:H,index:L,time:A}))}}for(var Y=1,z=P.length;Y<z;Y++)B=P[Y],j(R,B),R=B;r._closed&&j(B||R,P[0]),this.curves=w,this.parts=S,this.length=C,this.index=0},_get:function(r){for(var u=this.parts,f=u.length,g,m=this.index;g=m,!(!m||u[--m].offset<r););for(;g<f;g++){var w=u[g];if(w.offset>=r){this.index=g;var S=u[g-1],C=S&&S.index===w.index?S.time:0,T=S?S.offset:0;return{index:w.index,time:C+(w.time-C)*(r-T)/(w.offset-T)}}}return{index:u[f-1].index,time:1}},drawPart:function(r,u,f){for(var g=this._get(u),m=this._get(f),w=g.index,S=m.index;w<=S;w++){var C=Le.getPart(this.curves[w],w===g.index?g.time:0,w===m.index?m.time:1);w===g.index&&r.moveTo(C[0],C[1]),r.bezierCurveTo.apply(r,C.slice(2))}}},a.each(Le._evaluateMethods,function(r){this[r+"At"]=function(u){var f=this._get(u);return Le[r](this.curves[f.index],f.time)}},{})),Fe=a.extend({initialize:function(r){for(var u=this.points=[],f=r._segments,g=r._closed,m=0,w,S=f.length;m<S;m++){var C=f[m].point;(!w||!w.equals(C))&&u.push(w=C.clone())}g&&(u.unshift(u[u.length-1]),u.push(u[1])),this.closed=g},fit:function(r){var u=this.points,f=u.length,g=null;return f>0&&(g=[new Ve(u[0])],f>1&&(this.fitCubic(g,r,0,f-1,u[1].subtract(u[0]),u[f-2].subtract(u[f-1])),this.closed&&(g.shift(),g.pop()))),g},fitCubic:function(r,u,f,g,m,w){var S=this.points;if(g-f===1){var C=S[f],T=S[g],P=C.getDistance(T)/3;this.addCurve(r,[C,C.add(m.normalize(P)),T.add(w.normalize(P)),T]);return}for(var R=this.chordLengthParameterize(f,g),B=Math.max(u,u*u),j,I=!0,Y=0;Y<=4;Y++){var z=this.generateBezier(f,g,R,m,w),H=this.findMaxError(f,g,z,R);if(H.error<u&&I){this.addCurve(r,z);return}if(j=H.index,H.error>=B)break;I=this.reparameterize(f,g,R,z),B=H.error}var L=S[j-1].subtract(S[j+1]);this.fitCubic(r,u,f,j,m,L),this.fitCubic(r,u,j,g,L.negate(),w)},addCurve:function(r,u){var f=r[r.length-1];f.setHandleOut(u[1].subtract(u[0])),r.push(new Ve(u[3],u[2].subtract(u[3])))},generateBezier:function(r,u,f,g,m){for(var w=1e-12,S=Math.abs,C=this.points,T=C[r],P=C[u],R=[[0,0],[0,0]],B=[0,0],j=0,I=u-r+1;j<I;j++){var Y=f[j],z=1-Y,H=3*Y*z,L=z*z*z,U=H*z,A=H*Y,V=Y*Y*Y,q=g.normalize(U),J=m.normalize(A),X=C[r+j].subtract(T.multiply(L+U)).subtract(P.multiply(A+V));R[0][0]+=q.dot(q),R[0][1]+=q.dot(J),R[1][0]=R[0][1],R[1][1]+=J.dot(J),B[0]+=q.dot(X),B[1]+=J.dot(X)}var te=R[0][0]*R[1][1]-R[1][0]*R[0][1],ie,se;if(S(te)>w){var he=R[0][0]*B[1]-R[1][0]*B[0],ne=B[0]*R[1][1]-B[1]*R[0][1];ie=ne/te,se=he/te}else{var ce=R[0][0]+R[0][1],fe=R[1][0]+R[1][1];ie=se=S(ce)>w?B[0]/ce:S(fe)>w?B[1]/fe:0}var ye=P.getDistance(T),xe=w*ye,Ee,Ne;if(ie<xe||se<xe)ie=se=ye/3;else{var We=P.subtract(T);Ee=g.normalize(ie),Ne=m.normalize(se),Ee.dot(We)-Ne.dot(We)>ye*ye&&(ie=se=ye/3,Ee=Ne=null)}return[T,T.add(Ee||g.normalize(ie)),P.add(Ne||m.normalize(se)),P]},reparameterize:function(r,u,f,g){for(var m=r;m<=u;m++)f[m-r]=this.findRoot(g,this.points[m],f[m-r]);for(var m=1,w=f.length;m<w;m++)if(f[m]<=f[m-1])return!1;return!0},findRoot:function(r,u,f){for(var g=[],m=[],w=0;w<=2;w++)g[w]=r[w+1].subtract(r[w]).multiply(3);for(var w=0;w<=1;w++)m[w]=g[w+1].subtract(g[w]).multiply(2);var S=this.evaluate(3,r,f),C=this.evaluate(2,g,f),T=this.evaluate(1,m,f),P=S.subtract(u),R=C.dot(C)+P.dot(T);return E.isMachineZero(R)?f:f-P.dot(C)/R},evaluate:function(r,u,f){for(var g=u.slice(),m=1;m<=r;m++)for(var w=0;w<=r-m;w++)g[w]=g[w].multiply(1-f).add(g[w+1].multiply(f));return g[0]},chordLengthParameterize:function(r,u){for(var f=[0],g=r+1;g<=u;g++)f[g-r]=f[g-r-1]+this.points[g].getDistance(this.points[g-1]);for(var g=1,m=u-r;g<=m;g++)f[g]/=f[m];return f},findMaxError:function(r,u,f,g){for(var m=Math.floor((u-r+1)/2),w=0,S=r+1;S<u;S++){var C=this.evaluate(3,f,g[S-r]),T=C.subtract(this.points[S]),P=T.x*T.x+T.y*T.y;P>=w&&(w=P,m=S)}return{error:w,index:m}}}),yt=F.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(u){this._content="",this._lines=[];var f=u&&a.isPlainObject(u)&&u.x===t&&u.y===t;this._initialize(f&&u,!f&&O.read(arguments))},_equals:function(r){return this._content===r._content},copyContent:function(r){this.setContent(r._content)},getContent:function(){return this._content},setContent:function(r){this._content=""+r,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Ct=yt.extend({_class:"PointText",initialize:function(){yt.apply(this,arguments)},getPoint:function(){var r=this._matrix.getTranslation();return new Q(r.x,r.y,this,"setPoint")},setPoint:function(){var r=O.read(arguments);this.translate(r.subtract(this._matrix.getTranslation()))},_draw:function(r,u,f){if(this._content){this._setStyles(r,u,f);var g=this._lines,m=this._style,w=m.hasFill(),S=m.hasStroke(),C=m.getLeading(),T=r.shadowColor;r.font=m.getFontStyle(),r.textAlign=m.getJustification();for(var P=0,R=g.length;P<R;P++){r.shadowColor=T;var B=g[P];w&&(r.fillText(B,0,0),r.shadowColor="rgba(0,0,0,0)"),S&&r.strokeText(B,0,0),r.translate(0,C)}}},_getBounds:function(r,u){var f=this._style,g=this._lines,m=g.length,w=f.getJustification(),S=f.getLeading(),C=this.getView().getTextWidth(f.getFontStyle(),g),T=0;w!=="left"&&(T-=C/(w==="center"?2:1));var P=new K(T,m?-.75*S:0,C,m*S);return r?r._transformBounds(P,P):P}}),pt=a.extend(new function(){var r={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},u={},f={transparent:[0,0,0,0]},g;function m(C){var T=C.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||C.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),P="rgb",R;if(T){var B=T[4]?4:3;R=new Array(B);for(var j=0;j<B;j++){var I=T[j+1];R[j]=parseInt(I.length==1?I+I:I,16)/255}}else if(T=C.match(/^(rgb|hsl)a?\((.*)\)$/)){P=T[1],R=T[2].trim().split(/[,\s]+/g);for(var Y=P==="hsl",j=0,z=Math.min(R.length,4);j<z;j++){var H=R[j],I=parseFloat(H);if(Y)if(j===0){var L=H.match(/([a-z]*)$/)[1];I*={turn:360,rad:180/Math.PI,grad:.9}[L]||1}else j<3&&(I/=100);else j<3&&(I/=/%$/.test(H)?100:255);R[j]=I}}else{var U=f[C];if(!U)if(n){g||(g=tn.getContext(1,1,{willReadFrequently:!0}),g.globalCompositeOperation="copy"),g.fillStyle="rgba(0,0,0,0)",g.fillStyle=C,g.fillRect(0,0,1,1);var A=g.getImageData(0,0,1,1).data;U=f[C]=[A[0]/255,A[1]/255,A[2]/255]}else U=[0,0,0];R=U.slice()}return[P,R]}var w=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],S={"rgb-hsb":function(C,T,P){var R=Math.max(C,T,P),B=Math.min(C,T,P),j=R-B,I=j===0?0:(R==C?(T-P)/j+(T<P?6:0):R==T?(P-C)/j+2:(C-T)/j+4)*60;return[I,R===0?0:j/R,R]},"hsb-rgb":function(C,T,P){C=(C/60%6+6)%6;var B=Math.floor(C),R=C-B,B=w[B],j=[P,P*(1-T),P*(1-T*R),P*(1-T*(1-R))];return[j[B[0]],j[B[1]],j[B[2]]]},"rgb-hsl":function(C,T,P){var R=Math.max(C,T,P),B=Math.min(C,T,P),j=R-B,I=j===0,Y=I?0:(R==C?(T-P)/j+(T<P?6:0):R==T?(P-C)/j+2:(C-T)/j+4)*60,z=(R+B)/2,H=I?0:z<.5?j/(R+B):j/(2-R-B);return[Y,H,z]},"hsl-rgb":function(C,T,P){if(C=(C/360%1+1)%1,T===0)return[P,P,P];for(var R=[C+1/3,C,C-1/3],B=P<.5?P*(1+T):P+T-P*T,j=2*P-B,I=[],Y=0;Y<3;Y++){var z=R[Y];z<0&&(z+=1),z>1&&(z-=1),I[Y]=6*z<1?j+(B-j)*6*z:2*z<1?B:3*z<2?j+(B-j)*(2/3-z)*6:j}return I},"rgb-gray":function(C,T,P){return[C*.2989+T*.587+P*.114]},"gray-rgb":function(C){return[C,C,C]},"gray-hsb":function(C){return[0,0,C]},"gray-hsl":function(C){return[0,0,C]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return a.each(r,function(C,T){u[T]=[],a.each(C,function(P,R){var B=a.capitalize(P),j=/^(hue|saturation)$/.test(P),I=u[T][R]=T==="gradient"?P==="gradient"?function(Y){var z=this._components[0];return Y=Mt.read(Array.isArray(Y)?Y:arguments,0,{readNull:!0}),z!==Y&&(z&&z._removeOwner(this),Y&&Y._addOwner(this)),Y}:function(){return O.read(arguments,0,{readNull:P==="highlight",clone:!0})}:function(Y){return Y==null||isNaN(Y)?0:+Y};this["get"+B]=function(){return this._type===T||j&&/^hs[bl]$/.test(this._type)?this._components[R]:this._convert(T)[R]},this["set"+B]=function(Y){this._type!==T&&!(j&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(T),this._properties=r[T],this._type=T),this._components[R]=I.call(this,Y),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function C(T){var P=arguments,R=this.__read,B=0,j,I,Y,z;Array.isArray(T)&&(P=T,T=P[0]);var H=T!=null&&typeof T;if(H==="string"&&T in r&&(j=T,T=P[1],Array.isArray(T)?(I=T,Y=P[2]):(R&&(B=1),P=a.slice(P,1),H=typeof T)),!I){if(z=H==="number"?P:H==="object"&&T.length!=null?T:null,z){j||(j=z.length>=3?"rgb":"gray");var L=r[j].length;Y=z[L],R&&(B+=z===arguments?L+(Y!=null?1:0):1),z.length>L&&(z=a.slice(z,0,L))}else if(H==="string"){var U=m(T);j=U[0],I=U[1],I.length===4&&(Y=I[3],I.length--)}else if(H==="object")if(T.constructor===C){if(j=T._type,I=T._components.slice(),Y=T._alpha,j==="gradient")for(var A=1,V=I.length;A<V;A++){var q=I[A];q&&(I[A]=q.clone())}}else if(T.constructor===Mt)j="gradient",z=P;else{j="hue"in T?"lightness"in T?"hsl":"hsb":"gradient"in T||"stops"in T||"radial"in T?"gradient":"gray"in T?"gray":"rgb";var J=r[j],X=u[j];this._components=I=[];for(var A=0,V=J.length;A<V;A++){var te=T[J[A]];te==null&&!A&&j==="gradient"&&"stops"in T&&(te={stops:T.stops,radial:T.radial}),te=X[A].call(this,te),te!=null&&(I[A]=te)}Y=T.alpha}R&&j&&(B=1)}if(this._type=j||"rgb",!I){this._components=I=[];for(var X=u[this._type],A=0,V=X.length;A<V;A++){var te=X[A].call(this,z&&z[A]);te!=null&&(I[A]=te)}}return this._components=I,this._properties=r[this._type],this._alpha=Y,R&&(this.__read=B),this},set:"#initialize",_serialize:function(C,T){var P=this.getComponents();return a.serialize(/^(gray|rgb)$/.test(this._type)?P:[this._type].concat(P),C,!0,T)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(C){var T;return this._type===C?this._components.slice():(T=S[this._type+"-"+C])?T.apply(this,this._components):S["rgb-"+C].apply(this,S[this._type+"-rgb"].apply(this,this._components))},convert:function(C){return new pt(C,this._convert(C),this._alpha)},getType:function(){return this._type},setType:function(C){this._components=this._convert(C),this._properties=r[C],this._type=C},getComponents:function(){var C=this._components.slice();return this._alpha!=null&&C.push(this._alpha),C},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(C){this._alpha=C==null?null:Math.min(Math.max(C,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(C){var T=a.isPlainValue(C,!0)?pt.read(arguments):C;return T===this||T&&this._class===T._class&&this._type===T._type&&this.getAlpha()===T.getAlpha()&&a.equals(this._components,T._components)||!1},toString:function(){for(var C=this._properties,T=[],P=this._type==="gradient",R=b.instance,B=0,j=C.length;B<j;B++){var I=this._components[B];I!=null&&T.push(C[B]+": "+(P?I:R.number(I)))}return this._alpha!=null&&T.push("alpha: "+R.number(this._alpha)),"{ "+T.join(", ")+" }"},toCSS:function(C){var T=this._convert("rgb"),P=C||this._alpha==null?1:this._alpha;function R(B){return Math.round((B<0?0:B>1?1:B)*255)}return T=[R(T[0]),R(T[1]),R(T[2])],P<1&&T.push(P<0?0:P),C?"#"+((1<<24)+(T[0]<<16)+(T[1]<<8)+T[2]).toString(16).slice(1):(T.length==4?"rgba(":"rgb(")+T.join(",")+")"},toCanvasStyle:function(C,T){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var P=this._components,R=P[0],B=R._stops,j=P[1],I=P[2],Y=P[3],z=T&&T.inverted(),H;if(z&&(j=z._transformPoint(j),I=z._transformPoint(I),Y&&(Y=z._transformPoint(Y))),R._radial){var L=I.getDistance(j);if(Y){var U=Y.subtract(j);U.getLength()>L&&(Y=j.add(U.normalize(L-.1)))}var A=Y||j;H=C.createRadialGradient(A.x,A.y,0,j.x,j.y,L)}else H=C.createLinearGradient(j.x,j.y,I.x,I.y);for(var V=0,q=B.length;V<q;V++){var J=B[V],X=J._offset;H.addColorStop(X??V/(q-1),J._color.toCanvasStyle())}return this._canvasStyle=H},transform:function(C){if(this._type==="gradient"){for(var T=this._components,P=1,R=T.length;P<R;P++){var B=T[P];C._transformPoint(B,B,!0)}this._changed()}},statics:{_types:r,random:function(){var C=Math.random;return new pt(C(),C(),C())},_setOwner:function(C,T,P){return C&&(C._owner&&T&&C._owner!==T&&(C=C.clone()),!C._owner^!T&&(C._owner=T||null,C._setter=P||null)),C}}})},new function(){var r={add:function(u,f){return u+f},subtract:function(u,f){return u-f},multiply:function(u,f){return u*f},divide:function(u,f){return u/f}};return a.each(r,function(u,f){this[f]=function(g){g=pt.read(arguments);for(var m=this._type,w=this._components,S=g._convert(m),C=0,T=w.length;C<T;C++)S[C]=u(w[C],S[C]);return new pt(m,S,this._alpha!=null?u(this._alpha,g.getAlpha()):null)}},{})}),Mt=a.extend({_class:"Gradient",initialize:function(u,f){this._id=N.get(),u&&a.isPlainObject(u)&&(this.set(u),u=f=null),this._stops==null&&this.setStops(u||["white","black"]),this._radial==null&&this.setRadial(typeof f=="string"&&f==="radial"||f||!1)},_serialize:function(r,u){return u.add(this,function(){return a.serialize([this._stops,this._radial],r,!0,u)})},_changed:function(){for(var r=0,u=this._owners&&this._owners.length;r<u;r++)this._owners[r]._changed()},_addOwner:function(r){this._owners||(this._owners=[]),this._owners.push(r)},_removeOwner:function(r){var u=this._owners?this._owners.indexOf(r):-1;u!=-1&&(this._owners.splice(u,1),this._owners.length||(this._owners=t))},clone:function(){for(var r=[],u=0,f=this._stops.length;u<f;u++)r[u]=this._stops[u].clone();return new Mt(r,this._radial)},getStops:function(){return this._stops},setStops:function(r){if(r.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var u=this._stops;if(u)for(var f=0,g=u.length;f<g;f++)u[f]._owner=t;u=this._stops=zt.readList(r,0,{clone:!0});for(var f=0,g=u.length;f<g;f++)u[f]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(r){this._radial=r,this._changed()},equals:function(r){if(r===this)return!0;if(r&&this._class===r._class){var u=this._stops,f=r._stops,g=u.length;if(g===f.length){for(var m=0;m<g;m++)if(!u[m].equals(f[m]))return!1;return!0}}return!1}}),zt=a.extend({_class:"GradientStop",initialize:function(u,f){var g=u,m=f;typeof u=="object"&&f===t&&(Array.isArray(u)&&typeof u[0]!="number"?(g=u[0],m=u[1]):("color"in u||"offset"in u||"rampPoint"in u)&&(g=u.color,m=u.offset||u.rampPoint||0)),this.setColor(g),this.setOffset(m)},clone:function(){return new zt(this._color.clone(),this._offset)},_serialize:function(r,u){var f=this._color,g=this._offset;return a.serialize(g==null?[f]:[f,g],r,!0,u)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(r){this._offset=r,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){pt._setOwner(this._color,null),this._color=pt._setOwner(pt.read(arguments,0),this,"setColor"),this._changed()},equals:function(r){return r===this||r&&this._class===r._class&&this._color.equals(r._color)&&this._offset==r._offset||!1}}),Ut=a.extend(new function(){var r={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new O,selectedColor:null},u=a.set({},r,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),f=a.set({},u,{fillColor:new pt}),g={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},m={beans:!0},w={_class:"Style",beans:!0,initialize:function(C,T,P){this._values={},this._owner=T,this._project=T&&T._project||P||Ft.project,this._defaults=!T||T instanceof ze?u:T instanceof yt?f:r,C&&this.set(C)}};return a.each(u,function(S,C){var T=/Color$/.test(C),P=C==="shadowOffset",R=a.capitalize(C),B=g[C],j="set"+R,I="get"+R;w[j]=function(Y){var z=this._owner,H=z&&z._children,L=H&&H.length>0&&!(z instanceof Ze);if(L)for(var U=0,A=H.length;U<A;U++)H[U]._style[j](Y);if((C==="selectedColor"||!L)&&C in this._defaults){var V=this._values[C];V!==Y&&(T&&(V&&(pt._setOwner(V,null),V._canvasStyle=null),Y&&Y.constructor===pt&&(Y=pt._setOwner(Y,z,L&&j))),this._values[C]=Y,z&&z._changed(B||129))}},w[I]=function(Y){var z=this._owner,H=z&&z._children,L=H&&H.length>0&&!(z instanceof Ze),U;if(L&&!Y)for(var A=0,V=H.length;A<V;A++){var q=H[A]._style[I]();if(!A)U=q;else if(!a.equals(U,q))return t}else if(C in this._defaults){var U=this._values[C];if(U===t)U=this._defaults[C],U&&U.clone&&(U=U.clone());else{var J=T?pt:P?O:null;J&&!(U&&U.constructor===J)&&(this._values[C]=U=J.read([U],0,{readNull:!0,clone:!0}))}}return U&&T&&(U=pt._setOwner(U,z,L&&j)),U},m[I]=function(Y){return this._style[I](Y)},m[j]=function(Y){this._style[j](Y)}}),a.each({Font:"FontFamily",WindingRule:"FillRule"},function(S,C){var T="get"+C,P="set"+C;w[T]=m[T]="#get"+S,w[P]=m[P]="#set"+S}),F.inject(m),w},{set:function(r){var u=r instanceof Ut,f=u?r._values:r;if(f){for(var g in f)if(g in this._defaults){var m=f[g];this[g]=m&&u&&m.clone?m.clone():m}}},equals:function(r){function u(f,g,m){var w=f._values,S=g._values,C=g._defaults;for(var T in w){var P=w[T],R=S[T];if(!(m&&T in S)&&!a.equals(P,R===t?C[T]:R))return!1}return!0}return r===this||r&&this._class===r._class&&u(this,r)&&u(r,this,!0)||!1},_dispose:function(){var r;r=this.getFillColor(),r&&(r._canvasStyle=null),r=this.getStrokeColor(),r&&(r._canvasStyle=null),r=this.getShadowColor(),r&&(r._canvasStyle=null)},hasFill:function(){var r=this.getFillColor();return!!r&&r.alpha>0},hasStroke:function(){var r=this.getStrokeColor();return!!r&&r.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var r=this.getShadowColor();return!!r&&r.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var r=this.getFontSize();return this.getFontWeight()+" "+r+(/[a-z]/i.test(r+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function r(){var u=r.base.call(this),f=this.getFontSize();return/pt|em|%|px/.test(f)&&(f=this.getView().getPixelSize(f)),u??f*1.2}}),_t=new function(){function r(u,f,g,m){for(var w=["","webkit","moz","Moz","ms","o"],S=f[0].toUpperCase()+f.substring(1),C=0;C<6;C++){var T=w[C],P=T?T+S:f;if(P in u){if(g)u[P]=m;else return u[P];break}}}return{getStyles:function(u){var f=u&&u.nodeType!==9?u.ownerDocument:u,g=f&&f.defaultView;return g&&g.getComputedStyle(u,"")},getBounds:function(u,f){var g=u.ownerDocument,m=g.body,w=g.documentElement,S;try{S=u.getBoundingClientRect()}catch{S={left:0,top:0,width:0,height:0}}var C=S.left-(w.clientLeft||m.clientLeft||0),T=S.top-(w.clientTop||m.clientTop||0);if(!f){var P=g.defaultView;C+=P.pageXOffset||w.scrollLeft||m.scrollLeft,T+=P.pageYOffset||w.scrollTop||m.scrollTop}return new K(C,T,S.width,S.height)},getViewportBounds:function(u){var f=u.ownerDocument,g=f.defaultView,m=f.documentElement;return new K(0,0,g.innerWidth||m.clientWidth,g.innerHeight||m.clientHeight)},getOffset:function(u,f){return _t.getBounds(u,f).getPoint()},getSize:function(u){return _t.getBounds(u,!0).getSize()},isInvisible:function(u){return _t.getSize(u).equals(new W(0,0))},isInView:function(u){return!_t.isInvisible(u)&&_t.getViewportBounds(u).intersects(_t.getBounds(u,!0))},isInserted:function(u){return s.body.contains(u)},getPrefixed:function(u,f){return u&&r(u,f)},setPrefixed:function(u,f,g){if(typeof f=="object")for(var m in f)r(u,m,!0,f[m]);else r(u,f,!0,g)}}},At={add:function(r,u){if(r)for(var f in u)for(var g=u[f],m=f.split(/[\s,]+/g),w=0,S=m.length;w<S;w++){var C=m[w],T=r===s&&(C==="touchstart"||C==="touchmove")?{passive:!1}:!1;r.addEventListener(C,g,T)}},remove:function(r,u){if(r)for(var f in u)for(var g=u[f],m=f.split(/[\s,]+/g),w=0,S=m.length;w<S;w++)r.removeEventListener(m[w],g,!1)},getPoint:function(r){var u=r.targetTouches?r.targetTouches.length?r.targetTouches[0]:r.changedTouches[0]:r;return new O(u.pageX||u.clientX+s.documentElement.scrollLeft,u.pageY||u.clientY+s.documentElement.scrollTop)},getTarget:function(r){return r.target||r.srcElement},getRelatedTarget:function(r){return r.relatedTarget||r.toElement},getOffset:function(r,u){return At.getPoint(r).subtract(_t.getOffset(u||At.getTarget(r)))}};At.requestAnimationFrame=new function(){var r=_t.getPrefixed(n,"requestAnimationFrame"),u=!1,f=[],g;function m(){var w=f;f=[];for(var S=0,C=w.length;S<C;S++)w[S]();u=r&&f.length,u&&r(m)}return function(w){f.push(w),r?u||(r(m),u=!0):g||(g=setInterval(m,1e3/60))}};var en=a.extend(h,{_class:"View",initialize:function r(u,f){function g(B){return f[B]||parseInt(f.getAttribute(B),10)}function m(){var B=_t.getSize(f);return B.isNaN()||B.isZero()?new W(g("width"),g("height")):B}var w;if(n&&f){this._id=f.getAttribute("id"),this._id==null&&f.setAttribute("id",this._id="paper-view-"+r._id++),At.add(f,this._viewEvents);var S="none";if(_t.setPrefixed(f.style,{userDrag:S,userSelect:S,touchCallout:S,contentZooming:S,tapHighlightColor:"rgba(0,0,0,0)"}),p.hasAttribute(f,"resize")){var C=this;At.add(n,this._windowEvents={resize:function(){C.setViewSize(m())}})}if(w=m(),p.hasAttribute(f,"stats")&&typeof Stats<"u"){this._stats=new Stats;var T=this._stats.domElement,P=T.style,R=_t.getOffset(f);P.position="absolute",P.left=R.x+"px",P.top=R.y+"px",s.body.appendChild(T)}}else w=new W(f),f=null;this._project=u,this._scope=u._scope,this._element=f,this._pixelRatio||(this._pixelRatio=n&&n.devicePixelRatio||1),this._setElementSize(w.width,w.height),this._viewSize=w,r._views.push(this),r._viewsById[this._id]=this,(this._matrix=new le)._owner=this,r._focused||(r._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!Ft.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;en._focused===this&&(en._focused=null),en._views.splice(en._views.indexOf(this),1),delete en._viewsById[this._id];var r=this._project;return r._view===this&&(r._view=null),At.remove(this._element,this._viewEvents),At.remove(n,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:a.each(F._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(r){this[r]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(r){this._autoUpdate=r,r&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var r=this;At.requestAnimationFrame(function(){if(r._requested=!1,r._animate){r.requestUpdate();var u=r._element;(!_t.getPrefixed(s,"hidden")||p.getAttribute(u,"keepalive")==="true")&&_t.isInView(u)&&r._handleFrame()}r._autoUpdate&&r.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){Ft=this._scope;var r=Date.now()/1e3,u=this._last?r-this._last:0;this._last=r,this.emit("frame",new a({delta:u,time:this._time+=u,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(r,u){var f=this._frameItems;u?(f[r._id]={item:r,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete f[r._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(r){for(var u in this._frameItems){var f=this._frameItems[u];f.item.emit("frame",new a(r,{time:f.time+=r.delta,count:f.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=t},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var r=this._viewSize;return new ee(r.width,r.height,this,"setViewSize")},setViewSize:function(){var r=W.read(arguments),u=r.subtract(this._viewSize);u.isZero()||(this._setElementSize(r.width,r.height),this._viewSize.set(r),this._changed(),this.emit("resize",{size:r,delta:u}),this._autoUpdate&&this.update())},_setElementSize:function(r,u){var f=this._element;f&&(f.width!==r&&(f.width=r),f.height!==u&&(f.height=u))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new K(new O,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return _t.isInView(this._element)},isInserted:function(){return _t.isInserted(this._element)},getPixelSize:function(r){var u=this._element,f;if(u){var g=u.parentNode,m=s.createElement("div");m.style.fontSize=r,g.appendChild(m),f=parseFloat(_t.getStyles(m).fontSize),g.removeChild(m)}else f=parseFloat(f);return f},getTextWidth:function(r,u){return 0}},a.each(["rotate","scale","shear","skew"],function(r){var u=r==="rotate";this[r]=function(){var f=arguments,g=(u?a:O).read(f),m=O.read(f,0,{readNull:!0});return this.transform(new le()[r](g,m||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var r=new le;return this.transform(r.translate.apply(r,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var r=O.read(arguments);this.translate(this.getCenter().subtract(r))},getZoom:function(){var r=this._decompose().scaling;return(r.x+r.y)/2},setZoom:function(r){this.transform(new le().scale(r/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(r){var u=this.getRotation();u!=null&&r!=null&&this.rotate(r-u)},getScaling:function(){var r=this._decompose().scaling;return new Q(r.x,r.y,this,"setScaling")},setScaling:function(){var r=this.getScaling(),u=O.read(arguments,0,{clone:!0,readNull:!0});r&&u&&this.scale(u.x/r.x,u.y/r.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var r=this._matrix;r.set.apply(r,arguments)},transform:function(r){this._matrix.append(r)},scrollBy:function(){this.translate(O.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(O.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(O.read(arguments))},getEventPoint:function(r){return this.viewToProject(At.getOffset(r,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(r,u){s&&typeof u=="string"&&(u=s.getElementById(u));var f=n?oa:en;return new f(r,u)}}},new function(){if(!n)return;var r,u,f=!1,g=!1;function m(ne){var ce=At.getTarget(ne);return ce.getAttribute&&en._viewsById[ce.getAttribute("id")]}function w(){var ne=en._focused;if(!ne||!ne.isVisible()){for(var ce=0,fe=en._views.length;ce<fe;ce++)if((ne=en._views[ce]).isVisible()){en._focused=u=ne;break}}}function S(ne,ce,fe){ne._handleMouseEvent("mousemove",ce,fe)}var C=n.navigator,T,P,R;C.pointerEnabled||C.msPointerEnabled?(T="pointerdown MSPointerDown",P="pointermove MSPointerMove",R="pointerup pointercancel MSPointerUp MSPointerCancel"):(T="touchstart",P="touchmove",R="touchend touchcancel","ontouchstart"in n&&C.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(T+=" mousedown",P+=" mousemove",R+=" mouseup"));var B={},j={mouseout:function(ne){var ce=en._focused,fe=At.getRelatedTarget(ne);if(ce&&(!fe||fe.nodeName==="HTML")){var ye=At.getOffset(ne,ce._element),xe=ye.x,Ee=Math.abs,Ne=Ee(xe),We=1<<25,$e=Ne-We;ye.x=Ee($e)<Ne?$e*(xe<0?-1:1):xe,S(ce,ne,ce.viewToProject(ye))}},scroll:w};B[T]=function(ne){var ce=en._focused=m(ne);f||(f=!0,ce._handleMouseEvent("mousedown",ne))},j[P]=function(ne){var ce=en._focused;if(!g){var fe=m(ne);fe?ce!==fe&&(ce&&S(ce,ne),r||(r=ce),ce=en._focused=u=fe):u&&u===ce&&(r&&!r.isInserted()&&(r=null),ce=en._focused=r,r=null,w())}ce&&S(ce,ne)},j[T]=function(){g=!0},j[R]=function(ne){var ce=en._focused;ce&&f&&ce._handleMouseEvent("mouseup",ne),g=f=!1},At.add(s,j),At.add(n,{load:w});var I=!1,Y=!1,z={doubleclick:"click",mousedrag:"mousemove"},H=!1,L,U,A,V,q,J,X,te;function ie(ne,ce,fe,ye,xe,Ee,Ne){var We=!1,$e;function it(je,De){if(je.responds(De)){if($e||($e=new la(De,ye,xe,ce||je,Ee?xe.subtract(Ee):null)),je.emit(De,$e)&&(I=!0,$e.prevented&&(Y=!0),$e.stopped))return We=!0}else{var tt=z[De];if(tt)return it(je,tt)}}for(;ne&&ne!==Ne&&!it(ne,fe);)ne=ne._parent;return We}function se(ne,ce,fe,ye,xe,Ee){return ne._project.removeOn(fe),Y=I=!1,q&&ie(q,null,fe,ye,xe,Ee)||ce&&ce!==q&&!ce.isDescendant(q)&&ie(ce,null,fe==="mousedrag"?"mousemove":fe,ye,xe,Ee,q)||ie(ne,q||ce||ne,fe,ye,xe,Ee)}var he={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:B,_handleMouseEvent:function(ne,ce,fe){var ye=this._itemEvents,xe=ye.native[ne],Ee=ne==="mousemove",Ne=this._scope.tool,We=this;function $e(xt){return ye.virtual[xt]||We.responds(xt)||Ne&&Ne.responds(xt)}Ee&&f&&$e("mousedrag")&&(ne="mousedrag"),fe||(fe=this.getEventPoint(ce));var it=this.getBounds().contains(fe),je=xe&&it&&We._project.hitTest(fe,{tolerance:0,fill:!0,stroke:!0}),De=je&&je.item||null,tt=!1,at={};if(at[ne.substr(5)]=!0,xe&&De!==V&&(V&&ie(V,null,"mouseleave",ce,fe),De&&ie(De,null,"mouseenter",ce,fe),V=De),H^it&&(ie(this,null,it?"mouseenter":"mouseleave",ce,fe),tt=!0),(it||at.drag)&&!fe.equals(U)&&(se(this,De,Ee?ne:"mousemove",ce,fe,U),tt=!0),H=it,at.down&&it||at.up&&L){if(se(this,De,ne,ce,fe,L),at.down){if(te=De===J&&Date.now()-X<300,A=J=De,!Y&&De){for(var st=De;st&&!st.responds("mousedrag");)st=st._parent;st&&(q=De)}L=fe}else at.up&&(!Y&&De===A&&(X=Date.now(),se(this,De,te?"doubleclick":"click",ce,fe,L),te=!1),A=q=null);H=!1,tt=!0}U=fe,tt&&Ne&&(I=Ne._handleMouseEvent(ne,ce,fe,at)||I),ce.cancelable!==!1&&(I&&!at.move||at.down&&$e("mouseup"))&&ce.preventDefault()},_handleKeyEvent:function(ne,ce,fe,ye){var xe=this._scope,Ee=xe.tool,Ne;function We($e){$e.responds(ne)&&(Ft=xe,$e.emit(ne,Ne=Ne||new Es(ne,ce,fe,ye)))}this.isVisible()&&(We(this),Ee&&Ee.responds(ne)&&We(Ee))},_countItemEvent:function(ne,ce){var fe=this._itemEvents,ye=fe.native,xe=fe.virtual;for(var Ee in he)ye[Ee]=(ye[Ee]||0)+(he[Ee][ne]||0)*ce;xe[ne]=(xe[ne]||0)+ce},statics:{updateFocus:w,_resetState:function(){f=g=I=H=!1,r=u=L=U=A=V=q=J=X=te=null}}}}),oa=en.extend({_class:"CanvasView",initialize:function(u,f){if(!(f instanceof n.HTMLCanvasElement)){var g=W.read(arguments,1);if(g.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+a.slice(arguments,1));f=tn.getCanvas(g)}var m=this._context=f.getContext("2d");if(m.save(),this._pixelRatio=1,!/^off|false$/.test(p.getAttribute(f,"hidpi"))){var w=n.devicePixelRatio||1,S=_t.getPrefixed(m,"backingStorePixelRatio")||1;this._pixelRatio=w/S}en.call(this,u,f),this._needsUpdate=!0},remove:function r(){return this._context.restore(),r.base.call(this)},_setElementSize:function r(u,f){var g=this._pixelRatio;if(r.base.call(this,u*g,f*g),g!==1){var m=this._element,w=this._context;if(!p.hasAttribute(m,"resize")){var S=m.style;S.width=u+"px",S.height=f+"px"}w.restore(),w.save(),w.scale(g,g)}},getContext:function(){return this._context},getPixelSize:function r(u){var f=Ft.agent,g;if(f&&f.firefox)g=r.base.call(this,u);else{var m=this._context,w=m.font;m.font=u+" serif",g=parseFloat(m.font),m.font=w}return g},getTextWidth:function(r,u){var f=this._context,g=f.font,m=0;f.font=r;for(var w=0,S=u.length;w<S;w++)m=Math.max(m,f.measureText(u[w]).width);return f.font=g,m},update:function(){if(!this._needsUpdate)return!1;var r=this._project,u=this._context,f=this._viewSize;return u.clearRect(0,0,f.width+1,f.height+1),r&&r.draw(u,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Rr=a.extend({_class:"Event",initialize:function(u){this.event=u,this.type=u&&u.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Di.modifiers}}),Es=Rr.extend({_class:"KeyEvent",initialize:function(u,f,g,m){this.type=u,this.event=f,this.key=g,this.character=m},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Di=new function(){var r={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},u={tab:"	",space:" ",enter:"\r"},f={},g={},m,w,S=new a({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var P=Ft&&Ft.agent;return P&&P.mac?this.meta:this.control}}});function C(P){var R=P.key||P.keyIdentifier;return R=/^U\+/.test(R)?String.fromCharCode(parseInt(R.substr(2),16)):/^Arrow[A-Z]/.test(R)?R.substr(5):R==="Unidentified"||R===t?String.fromCharCode(P.keyCode):R,r[R]||(R.length>1?a.hyphenate(R):R.toLowerCase())}function T(P,R,B,j){var I=en._focused,Y;if(f[R]=P,P?g[R]=B:delete g[R],R.length>1&&(Y=a.camelize(R))in S){S[Y]=P;var z=Ft&&Ft.agent;if(Y==="meta"&&z&&z.mac)if(P)m={};else{for(var H in m)H in g&&T(!1,H,m[H],j);m=null}}else P&&m&&(m[R]=B);I&&I._handleKeyEvent(P?"keydown":"keyup",j,R,B)}return At.add(s,{keydown:function(P){var R=C(P),B=Ft&&Ft.agent;R.length>1||B&&B.chrome&&(P.altKey||B.mac&&P.metaKey||!B.mac&&P.ctrlKey)?T(!0,R,u[R]||(R.length>1?"":R),P):w=R},keypress:function(P){if(w){var R=C(P),B=P.charCode,j=B>=32?String.fromCharCode(B):R.length>1?"":R;R!==w&&(R=j.toLowerCase()),T(!0,R,j,P),w=null}},keyup:function(P){var R=C(P);R in g&&T(!1,R,g[R],P)}}),At.add(n,{blur:function(P){for(var R in g)T(!1,R,g[R],P)}}),{modifiers:S,isDown:function(P){return!!f[P]}}},la=Rr.extend({_class:"MouseEvent",initialize:function(u,f,g,m,w){this.type=u,this.event=f,this.point=g,this.target=m,this.delta=w},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Fr=Rr.extend({_class:"ToolEvent",_item:null,initialize:function(u,f,g){this.tool=u,this.type=f,this.event=g},_choosePoint:function(r,u){return r||(u?u.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(r){this._point=r},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(r){this._lastPoint=r},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(r){this._downPoint=r},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(r){this._middlePoint=r},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(r){this._delta=r},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(r){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=r},getItem:function(){if(!this._item){var r=this.tool._scope.project.hitTest(this.getPoint());if(r){for(var u=r.item,f=u._parent;/^(Group|CompoundPath)$/.test(f._class);)u=f,f=f._parent;this._item=u}}return this._item},setItem:function(r){this._item=r},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Ri=v.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(u){v.call(this),this._moveCount=-1,this._downCount=-1,this.set(u)},getMinDistance:function(){return this._minDistance},setMinDistance:function(r){this._minDistance=r,r!=null&&this._maxDistance!=null&&r>this._maxDistance&&(this._maxDistance=r)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(r){this._maxDistance=r,this._minDistance!=null&&r!=null&&r<this._minDistance&&(this._minDistance=r)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(r){this._minDistance=this._maxDistance=r},_handleMouseEvent:function(r,u,f,g){Ft=this._scope,g.drag&&!this.responds(r)&&(r="mousemove");var m=g.move||g.drag,w=this.responds(r),S=!1,C=this;function T(R,B){var j=f,I=m?C._point:C._downPoint||j;if(m){if(C._moveCount>=0&&j.equals(I))return!1;if(I&&(R!=null||B!=null)){var Y=j.subtract(I),z=Y.getLength();if(z<(R||0))return!1;B&&(j=I.add(Y.normalize(Math.min(z,B))))}C._moveCount++}return C._point=j,C._lastPoint=I||j,g.down&&(C._moveCount=-1,C._downPoint=j,C._downCount++),!0}function P(){w&&(S=C.emit(r,new Fr(C,r,u))||S)}if(g.down)T(),P();else if(g.up)T(null,this._maxDistance),P();else if(w)for(;T(this._minDistance,this._maxDistance);)P();return S}}),Fi=a.extend(h,{_class:"Tween",statics:{easings:new a({linear:function(r){return r},easeInQuad:function(r){return r*r},easeOutQuad:function(r){return r*(2-r)},easeInOutQuad:function(r){return r<.5?2*r*r:-1+2*(2-r)*r},easeInCubic:function(r){return r*r*r},easeOutCubic:function(r){return--r*r*r+1},easeInOutCubic:function(r){return r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1},easeInQuart:function(r){return r*r*r*r},easeOutQuart:function(r){return 1- --r*r*r*r},easeInOutQuart:function(r){return r<.5?8*r*r*r*r:1-8*--r*r*r*r},easeInQuint:function(r){return r*r*r*r*r},easeOutQuint:function(r){return 1+--r*r*r*r*r},easeInOutQuint:function(r){return r<.5?16*r*r*r*r*r:1+16*--r*r*r*r*r}})},initialize:function r(u,f,g,m,w,S){this.object=u;var C=typeof w,T=C==="function";this.type=T?C:C==="string"?w:"linear",this.easing=T?w:r.easings[this.type],this.duration=m,this.running=!1,this._then=null,this._startTime=null;var P=f||g;this._keys=P?Object.keys(P):[],this._parsedKeys=this._parseKeys(this._keys),this._from=P&&this._getState(f),this._to=P&&this._getState(g),S!==!1&&this.start()},then:function(r){return this._then=r,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(r){if(this.running){r>=1&&(r=1,this.running=!1);for(var u=this.easing(r),f=this._keys,g=function(R){return typeof R=="function"?R(u,r):R},m=0,w=f&&f.length;m<w;m++){var S=f[m],C=g(this._from[S]),T=g(this._to[S]),P=C&&T&&C.__add&&T.__add?T.__subtract(C).__multiply(u).__add(C):(T-C)*u+C;this._setProperty(this._parsedKeys[S],P)}this.responds("update")&&this.emit("update",new a({progress:r,factor:u})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(r){var u=this._startTime,f=u?(r-u)/this.duration:0;u||(this._startTime=r),this.update(f)},_getState:function(r){for(var u=this._keys,f={},g=0,m=u.length;g<m;g++){var w=u[g],S=this._parsedKeys[w],C=this._getProperty(S),T;if(r){var P=this._resolveValue(C,r[w]);this._setProperty(S,P),T=this._getProperty(S),T=T&&T.clone?T.clone():T,this._setProperty(S,C)}else T=C&&C.clone?C.clone():C;f[w]=T}return f},_resolveValue:function(r,u){if(u){if(Array.isArray(u)&&u.length===2){var f=u[0];return f&&f.match&&f.match(/^[+\-\*\/]=/)?this._calculate(r,f[0],u[1]):u}else if(typeof u=="string"){var g=u.match(/^[+\-*/]=(.*)/);if(g){var m=JSON.parse(g[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(r,u[0],m)}}}return u},_calculate:function(r,u,f){return Ft.PaperScript.calculateBinary(r,u,f)},_parseKeys:function(r){for(var u={},f=0,g=r.length;f<g;f++){var m=r[f],w=m.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");u[m]=w.split("/")}return u},_getProperty:function(r,u){for(var f=this.object,g=0,m=r.length-(u||0);g<m&&f;g++)f=f[r[g]];return f},_setProperty:function(r,u){var f=this._getProperty(r,1);f&&(f[r[r.length-1]]=u)}}),qr={request:function(r){var u=new e.XMLHttpRequest;return u.open((r.method||"get").toUpperCase(),r.url,a.pick(r.async,!0)),r.mimeType&&u.overrideMimeType(r.mimeType),u.onload=function(){var f=u.status;f===0||f===200?r.onLoad&&r.onLoad.call(u,u.responseText):u.onerror()},u.onerror=function(){var f=u.status,g='Could not load "'+r.url+'" (Status: '+f+")";if(r.onError)r.onError(g,f);else throw new Error(g)},u.send(null)}},tn=a.exports.CanvasProvider={canvases:[],getCanvas:function(r,u,f){if(!n)return null;var g,m=!0;typeof r=="object"&&(u=r.height,r=r.width),this.canvases.length?g=this.canvases.pop():(g=s.createElement("canvas"),m=!1);var w=g.getContext("2d",f||{});if(!w)throw new Error("Canvas "+g+" is unable to provide a 2D context.");return g.width===r&&g.height===u?m&&w.clearRect(0,0,r+1,u+1):(g.width=r,g.height=u),w.save(),g},getContext:function(r,u,f){var g=this.getCanvas(r,u,f);return g?g.getContext("2d",f||{}):null},release:function(r){var u=r&&r.canvas?r.canvas:r;u&&u.getContext&&(u.getContext("2d").restore(),this.canvases.push(u))}},fi=new function(){var r=Math.min,u=Math.max,f=Math.abs,g,m,w,S,C,T,P,R,B,j,I;function Y(q,J,X){return .2989*q+.587*J+.114*X}function z(q,J,X,se){var ie=se-Y(q,J,X);B=q+ie,j=J+ie,I=X+ie;var se=Y(B,j,I),he=r(B,j,I),ne=u(B,j,I);if(he<0){var ce=se-he;B=se+(B-se)*se/ce,j=se+(j-se)*se/ce,I=se+(I-se)*se/ce}if(ne>255){var fe=255-se,ye=ne-se;B=se+(B-se)*fe/ye,j=se+(j-se)*fe/ye,I=se+(I-se)*fe/ye}}function H(q,J,X){return u(q,J,X)-r(q,J,X)}function L(q,J,X,te){var ie=[q,J,X],se=u(q,J,X),he=r(q,J,X),ne;he=he===q?0:he===J?1:2,se=se===q?0:se===J?1:2,ne=r(he,se)===0?u(he,se)===1?2:1:0,ie[se]>ie[he]?(ie[ne]=(ie[ne]-ie[he])*te/(ie[se]-ie[he]),ie[se]=te):ie[ne]=ie[se]=0,ie[he]=0,B=ie[0],j=ie[1],I=ie[2]}var U={multiply:function(){B=C*g/255,j=T*m/255,I=P*w/255},screen:function(){B=C+g-C*g/255,j=T+m-T*m/255,I=P+w-P*w/255},overlay:function(){B=C<128?2*C*g/255:255-2*(255-C)*(255-g)/255,j=T<128?2*T*m/255:255-2*(255-T)*(255-m)/255,I=P<128?2*P*w/255:255-2*(255-P)*(255-w)/255},"soft-light":function(){var q=g*C/255;B=q+C*(255-(255-C)*(255-g)/255-q)/255,q=m*T/255,j=q+T*(255-(255-T)*(255-m)/255-q)/255,q=w*P/255,I=q+P*(255-(255-P)*(255-w)/255-q)/255},"hard-light":function(){B=g<128?2*g*C/255:255-2*(255-g)*(255-C)/255,j=m<128?2*m*T/255:255-2*(255-m)*(255-T)/255,I=w<128?2*w*P/255:255-2*(255-w)*(255-P)/255},"color-dodge":function(){B=C===0?0:g===255?255:r(255,255*C/(255-g)),j=T===0?0:m===255?255:r(255,255*T/(255-m)),I=P===0?0:w===255?255:r(255,255*P/(255-w))},"color-burn":function(){B=C===255?255:g===0?0:u(0,255-(255-C)*255/g),j=T===255?255:m===0?0:u(0,255-(255-T)*255/m),I=P===255?255:w===0?0:u(0,255-(255-P)*255/w)},darken:function(){B=C<g?C:g,j=T<m?T:m,I=P<w?P:w},lighten:function(){B=C>g?C:g,j=T>m?T:m,I=P>w?P:w},difference:function(){B=C-g,B<0&&(B=-B),j=T-m,j<0&&(j=-j),I=P-w,I<0&&(I=-I)},exclusion:function(){B=C+g*(255-C-C)/255,j=T+m*(255-T-T)/255,I=P+w*(255-P-P)/255},hue:function(){L(g,m,w,H(C,T,P)),z(B,j,I,Y(C,T,P))},saturation:function(){L(C,T,P,H(g,m,w)),z(B,j,I,Y(C,T,P))},luminosity:function(){z(C,T,P,Y(g,m,w))},color:function(){z(g,m,w,Y(C,T,P))},add:function(){B=r(C+g,255),j=r(T+m,255),I=r(P+w,255)},subtract:function(){B=u(C-g,0),j=u(T-m,0),I=u(P-w,0)},average:function(){B=(C+g)/2,j=(T+m)/2,I=(P+w)/2},negation:function(){B=255-f(255-g-C),j=255-f(255-m-T),I=255-f(255-w-P)}},A=this.nativeModes=a.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(q){this[q]=!0},{}),V=tn.getContext(1,1,{willReadFrequently:!0});V&&(a.each(U,function(q,J){var X=J==="darken",te=!1;V.save();try{V.fillStyle=X?"#300":"#a00",V.fillRect(0,0,1,1),V.globalCompositeOperation=J,V.globalCompositeOperation===J&&(V.fillStyle=X?"#a00":"#300",V.fillRect(0,0,1,1),te=V.getImageData(0,0,1,1).data[0]!==X?170:51)}catch{}V.restore(),A[J]=te}),tn.release(V)),this.process=function(q,J,X,te,ie){var se=J.canvas,he=q==="normal";if(he||A[q])X.save(),X.setTransform(1,0,0,1,0,0),X.globalAlpha=te,he||(X.globalCompositeOperation=q),X.drawImage(se,ie.x,ie.y),X.restore();else{var ne=U[q];if(!ne)return;for(var ce=X.getImageData(ie.x,ie.y,se.width,se.height),fe=ce.data,ye=J.getImageData(0,0,se.width,se.height).data,xe=0,Ee=fe.length;xe<Ee;xe+=4){g=ye[xe],C=fe[xe],m=ye[xe+1],T=fe[xe+1],w=ye[xe+2],P=fe[xe+2],S=ye[xe+3],R=fe[xe+3],ne();var Ne=S*te/255,We=1-Ne;fe[xe]=Ne*B+We*C,fe[xe+1]=Ne*j+We*T,fe[xe+2]=Ne*I+We*P,fe[xe+3]=S*te+We*R}X.putImageData(ce,ie.x,ie.y)}}},Gt=new function(){var r="http://www.w3.org/2000/svg",u="http://www.w3.org/2000/xmlns",f="http://www.w3.org/1999/xlink",g={href:f,xlink:u,xmlns:u+"/","xmlns:xlink":u+"/"};function m(C,T,P){return S(s.createElementNS(r,C),T,P)}function w(C,T){var P=g[T],R=P?C.getAttributeNS(P,T):C.getAttribute(T);return R==="null"?null:R}function S(C,T,P){for(var R in T){var B=T[R],j=g[R];typeof B=="number"&&P&&(B=P.number(B)),j?C.setAttributeNS(j,R,B):C.setAttribute(R,B)}return C}return{svg:r,xmlns:u,xlink:f,create:m,get:w,set:S}},Os=a.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(r,u){return!u&&(r instanceof Be||r instanceof Je||r instanceof yt)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(r,u){var f=a.capitalize(u),g=r[2];this[u]={type:r[1],property:u,attribute:r[0],toSVG:g,fromSVG:g&&a.each(g,function(m,w){this[m]=w},{}),exportFilter:r[3],get:"get"+f,set:"set"+f}},{});new function(){var r;function u(U,A,V){var q=new a,J=U.getTranslation();if(A){var X;U.isInvertible()?(U=U._shiftless(),X=U._inverseTransform(J),J=null):X=new O,q[V?"cx":"x"]=X.x,q[V?"cy":"y"]=X.y}if(!U.isIdentity()){var te=U.decompose();if(te){var ie=[],se=te.rotation,he=te.scaling,ne=te.skewing;J&&!J.isZero()&&ie.push("translate("+r.point(J)+")"),se&&ie.push("rotate("+r.number(se)+")"),(!E.isZero(he.x-1)||!E.isZero(he.y-1))&&ie.push("scale("+r.point(he)+")"),ne.x&&ie.push("skewX("+r.number(ne.x)+")"),ne.y&&ie.push("skewY("+r.number(ne.y)+")"),q.transform=ie.join(" ")}else q.transform="matrix("+U.getValues().join(",")+")"}return q}function f(U,A){for(var V=u(U._matrix),q=U._children,J=Gt.create("g",V,r),X=0,te=q.length;X<te;X++){var ie=q[X],se=H(ie,A);if(se)if(ie.isClipMask()){var he=Gt.create("clipPath");he.appendChild(se),Y(ie,he,"clip"),Gt.set(J,{"clip-path":"url(#"+he.id+")"})}else J.appendChild(se)}return J}function g(U,A){var V=u(U._matrix,!0),q=U.getSize(),J=U.getImage();return V.x-=q.width/2,V.y-=q.height/2,V.width=q.width,V.height=q.height,V.href=A.embedImages==!1&&J&&J.src||U.toDataURL(),Gt.create("image",V,r)}function m(U,A){var V=A.matchShapes;if(V){var q=U.toShape(!1);if(q)return w(q)}var J=U._segments,X=J.length,te,ie=u(U._matrix);if(V&&X>=2&&!U.hasHandles())if(X>2){te=U._closed?"polygon":"polyline";for(var se=[],he=0;he<X;he++)se.push(r.point(J[he]._point));ie.points=se.join(" ")}else{te="line";var ne=J[0]._point,ce=J[1]._point;ie.set({x1:ne.x,y1:ne.y,x2:ce.x,y2:ce.y})}else te="path",ie.d=U.getPathData(null,A.precision);return Gt.create(te,ie,r)}function w(U){var A=U._type,V=U._radius,q=u(U._matrix,!0,A!=="rectangle");if(A==="rectangle"){A="rect";var J=U._size,X=J.width,te=J.height;q.x-=X/2,q.y-=te/2,q.width=X,q.height=te,V.isZero()&&(V=null)}return V&&(A==="circle"?q.r=V:(q.rx=V.width,q.ry=V.height)),Gt.create(A,q,r)}function S(U,A){var V=u(U._matrix),q=U.getPathData(null,A.precision);return q&&(V.d=q),Gt.create("path",V,r)}function C(U,A){var V=u(U._matrix,!0),q=U._definition,J=I(q,"symbol"),X=q._item,te=X.getStrokeBounds();return J||(J=Gt.create("symbol",{viewBox:r.rectangle(te)}),J.appendChild(H(X,A)),Y(q,J,"symbol")),V.href="#"+J.id,V.x+=te.x,V.y+=te.y,V.width=te.width,V.height=te.height,V.overflow="visible",Gt.create("use",V,r)}function T(U){var A=I(U,"color");if(!A){var V=U.getGradient(),q=V._radial,J=U.getOrigin(),X=U.getDestination(),te;if(q){te={cx:J.x,cy:J.y,r:J.getDistance(X)};var ie=U.getHighlight();ie&&(te.fx=ie.x,te.fy=ie.y)}else te={x1:J.x,y1:J.y,x2:X.x,y2:X.y};te.gradientUnits="userSpaceOnUse",A=Gt.create((q?"radial":"linear")+"Gradient",te,r);for(var se=V._stops,he=0,ne=se.length;he<ne;he++){var ce=se[he],fe=ce._color,ye=fe.getAlpha(),xe=ce._offset;te={offset:xe??he/(ne-1)},fe&&(te["stop-color"]=fe.toCSS(!0)),ye<1&&(te["stop-opacity"]=ye),A.appendChild(Gt.create("stop",te,r))}Y(U,A,"color")}return"url(#"+A.id+")"}function P(U){var A=Gt.create("text",u(U._matrix,!0),r);return A.textContent=U._content,A}var R={Group:f,Layer:f,Raster:g,Path:m,Shape:w,CompoundPath:S,SymbolItem:C,PointText:P};function B(U,A,V,q){var J={},X=!q&&U.getParent(),te=[];return U._name!=null&&(J.id=U._name),a.each(Os,function(ie){var se=ie.get,he=ie.type,ne=U[se]();if(ie.exportFilter?ie.exportFilter(U,ne):V.reduceAttributes==!1||!X||!a.equals(X[se](),ne)){if(he==="color"&&ne!=null){var ce=ne.getAlpha();ce<1&&(J[ie.attribute+"-opacity"]=ce)}he==="style"?te.push(ie.attribute+": "+ne):J[ie.attribute]=ne==null?"none":he==="color"?ne.gradient?T(ne):ne.toCSS(!0):he==="array"?ne.join(","):he==="lookup"?ie.toSVG[ne]:ne}}),te.length&&(J.style=te.join(";")),J.opacity===1&&delete J.opacity,U._visible||(J.visibility="hidden"),Gt.set(A,J,r)}var j;function I(U,A){return j||(j={ids:{},svgs:{}}),U&&j.svgs[A+"-"+(U._id||U.__id||(U.__id=N.get("svg")))]}function Y(U,A,V){j||I();var q=j.ids[V]=(j.ids[V]||0)+1;A.id=V+"-"+q,j.svgs[V+"-"+(U._id||U.__id)]=A}function z(U,A){var V=U,q=null;if(j){V=U.nodeName.toLowerCase()==="svg"&&U;for(var J in j.svgs)q||(V||(V=Gt.create("svg"),V.appendChild(U)),q=V.insertBefore(Gt.create("defs"),V.firstChild)),q.appendChild(j.svgs[J]);j=null}return A.asString?new e.XMLSerializer().serializeToString(V):V}function H(U,A,V){var q=R[U._class],J=q&&q(U,A);if(J){var X=A.onExport;X&&(J=X(U,J,A)||J);var te=JSON.stringify(U._data);te&&te!=="{}"&&te!=="null"&&J.setAttribute("data-paper-data",te)}return J&&B(U,J,A,V)}function L(U){return U||(U={}),r=new b(U.precision),U}F.inject({exportSVG:function(U){return U=L(U),z(H(this,U,!0),U)}}),we.inject({exportSVG:function(U){U=L(U);var A=this._children,V=this.getView(),q=a.pick(U.bounds,"view"),J=U.matrix||q==="view"&&V._matrix,X=J&&le.read([J]),te=q==="view"?new K([0,0],V.getViewSize()):q==="content"?F._getBounds(A,X,{stroke:!0}).rect:K.read([q],0,{readNull:!0}),ie={version:"1.1",xmlns:Gt.svg,"xmlns:xlink":Gt.xlink};te&&(ie.width=te.width,ie.height=te.height,(te.x||te.x===0||te.y||te.y===0)&&(ie.viewBox=r.rectangle(te)));var se=Gt.create("svg",ie,r),he=se;X&&!X.isIdentity()&&(he=se.appendChild(Gt.create("g",u(X),r)));for(var ne=0,ce=A.length;ne<ce;ne++)he.appendChild(H(A[ne],U,!0));return z(se,U)}})},new function(){var r={},u;function f(A,V,q,J,X,te){var ie=Gt.get(A,V)||te,se=ie==null?J?null:q?"":0:q?ie:parseFloat(ie);return/%\s*$/.test(ie)?se/100*(X?1:u[/x|^width/.test(V)?"width":"height"]):se}function g(A,V,q,J,X,te,ie){return V=f(A,V||"x",!1,J,X,te),q=f(A,q||"y",!1,J,X,ie),J&&(V==null||q==null)?null:new O(V,q)}function m(A,V,q,J,X){return V=f(A,V||"width",!1,J,X),q=f(A,q||"height",!1,J,X),J&&(V==null||q==null)?null:new W(V,q)}function w(A,V,q){return A==="none"?null:V==="number"?parseFloat(A):V==="array"?A?A.split(/[\s,]+/g).map(parseFloat):[]:V==="color"?H(A)||A:V==="lookup"?q[A]:A}function S(A,V,q,J){var X=A.childNodes,te=V==="clippath",ie=V==="defs",se=new ze,he=se._project,ne=he._currentStyle,ce=[];if(!te&&!ie&&(se=z(se,A,J),he._currentStyle=se._style.clone()),J)for(var fe=A.querySelectorAll("defs"),ye=0,xe=fe.length;ye<xe;ye++)L(fe[ye],q,!1);for(var ye=0,xe=X.length;ye<xe;ye++){var Ee=X[ye],Ne;Ee.nodeType===1&&!/^defs$/i.test(Ee.nodeName)&&(Ne=L(Ee,q,!1))&&!(Ne instanceof Ke)&&ce.push(Ne)}return se.addChildren(ce),te&&(se=z(se.reduce(),A,J)),he._currentStyle=ne,(te||ie)&&(se.remove(),se=null),se}function C(A,V){for(var q=A.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),J=[],X=0,te=q.length;X<te;X+=2)J.push(new O(parseFloat(q[X]),parseFloat(q[X+1])));var ie=new Xe(J);return V==="polygon"&&ie.closePath(),ie}function T(A){return Be.create(A.getAttribute("d"))}function P(A,V){var q=(f(A,"href",!0)||"").substring(1),J=V==="radialgradient",X;if(q)X=r[q].getGradient(),X._radial^J&&(X=X.clone(),X._radial=J);else{for(var te=A.childNodes,ie=[],se=0,he=te.length;se<he;se++){var ne=te[se];ne.nodeType===1&&ie.push(z(new zt,ne))}X=new Mt(ie,J)}var ce,fe,ye,xe=f(A,"gradientUnits",!0)!=="userSpaceOnUse";J?(ce=g(A,"cx","cy",!1,xe,"50%","50%"),fe=ce.add(f(A,"r",!1,!1,xe,"50%"),0),ye=g(A,"fx","fy",!0,xe)):(ce=g(A,"x1","y1",!1,xe,"0%","0%"),fe=g(A,"x2","y2",!1,xe,"100%","0%"));var Ee=z(new pt(X,ce,fe,ye),A);return Ee._scaleToBounds=xe,null}var R={"#document":function(A,V,q,J){for(var X=A.childNodes,te=0,ie=X.length;te<ie;te++){var se=X[te];if(se.nodeType===1)return L(se,q,J)}},g:S,svg:S,clippath:S,polygon:C,polyline:C,path:T,lineargradient:P,radialgradient:P,image:function(A){var V=new ut(f(A,"href",!0));return V.on("load",function(){var q=m(A);this.setSize(q);var J=g(A).add(q.divide(2));this._matrix.append(new le().translate(J))}),V},symbol:function(A,V,q,J){return new Ke(S(A,V,q,J),!0)},defs:S,use:function(A){var V=(f(A,"href",!0)||"").substring(1),q=r[V],J=g(A);return q?q instanceof Ke?q.place(J):q.clone().translate(J):null},circle:function(A){return new Je.Circle(g(A,"cx","cy"),f(A,"r"))},ellipse:function(A){return new Je.Ellipse({center:g(A,"cx","cy"),radius:m(A,"rx","ry")})},rect:function(A){return new Je.Rectangle(new K(g(A),m(A)),m(A,"rx","ry"))},line:function(A){return new Xe.Line(g(A,"x1","y1"),g(A,"x2","y2"))},text:function(A){var V=new Ct(g(A).add(g(A,"dx","dy")));return V.setContent(A.textContent.trim()||""),V},switch:S};function B(A,V,q,J){if(A.transform){for(var X=(J.getAttribute(q)||"").split(/\)\s*/g),te=new le,ie=0,se=X.length;ie<se;ie++){var he=X[ie];if(!he)break;for(var ne=he.split(/\(\s*/),ce=ne[0].trim(),fe=ne[1].split(/[\s,]+/g),ye=0,xe=fe.length;ye<xe;ye++)fe[ye]=parseFloat(fe[ye]);switch(ce){case"matrix":te.append(new le(fe[0],fe[1],fe[2],fe[3],fe[4],fe[5]));break;case"rotate":te.rotate(fe[0],fe[1]||0,fe[2]||0);break;case"translate":te.translate(fe[0],fe[1]||0);break;case"scale":te.scale(fe);break;case"skewX":te.skew(fe[0],0);break;case"skewY":te.skew(0,fe[0]);break}}A.transform(te)}}function j(A,V,q){var J=q==="fill-opacity"?"getFillColor":"getStrokeColor",X=A[J]&&A[J]();X&&X.setAlpha(parseFloat(V))}var I=a.set(a.each(Os,function(A){this[A.attribute]=function(V,q){if(V[A.set]&&(V[A.set](w(q,A.type,A.fromSVG)),A.type==="color")){var J=V[A.get]();if(J&&J._scaleToBounds){var X=V.getBounds();J.transform(new le().translate(X.getPoint()).scale(X.getSize()))}}}},{}),{id:function(A,V){r[V]=A,A.setName&&A.setName(V)},"clip-path":function(A,V){var q=H(V);if(q)if(q=q.clone(),q.setClipMask(!0),A instanceof ze)A.insertChild(0,q);else return new ze(q,A)},gradientTransform:B,transform:B,"fill-opacity":j,"stroke-opacity":j,visibility:function(A,V){A.setVisible&&A.setVisible(V==="visible")},display:function(A,V){A.setVisible&&A.setVisible(V!==null)},"stop-color":function(A,V){A.setColor&&A.setColor(V)},"stop-opacity":function(A,V){A._color&&A._color.setAlpha(parseFloat(V))},offset:function(A,V){if(A.setOffset){var q=V.match(/(.*)%$/);A.setOffset(q?q[1]/100:parseFloat(V))}},viewBox:function(A,V,q,J,X){var te=new K(w(V,"array")),ie=m(J,null,null,!0),se,he;if(A instanceof ze){var ne=ie?ie.divide(te.getSize()):1,he=new le().scale(ne).translate(te.getPoint().negate());se=A}else A instanceof Ke&&(ie&&te.setSize(ie),se=A._item);if(se){if(Y(J,"overflow",X)!=="visible"){var ce=new Je.Rectangle(te);ce.setClipMask(!0),se.addChild(ce)}he&&se.transform(he)}}});function Y(A,V,q){var J=A.attributes[V],X=J&&J.value;if(!X&&A.style){var te=a.camelize(V);X=A.style[te],!X&&q.node[te]!==q.parent[te]&&(X=q.node[te])}return X?X==="none"?null:X:t}function z(A,V,q){var J=V.parentNode,X={node:_t.getStyles(V)||{},parent:!q&&!/^defs$/i.test(J.tagName)&&_t.getStyles(J)||{}};return a.each(I,function(te,ie){var se=Y(V,ie,X);A=se!==t&&te(A,se,ie,V,X)||A}),A}function H(A){var V=A&&A.match(/\((?:["'#]*)([^"')]+)/),q=V&&V[1],J=q&&r[n?q.replace(n.location.href.split("#")[0]+"#",""):q];return J&&J._scaleToBounds&&(J=J.clone(),J._scaleToBounds=!0),J}function L(A,V,q){var J=A.nodeName.toLowerCase(),X=J!=="#document",te=s.body,ie,se,he;q&&X&&(u=Ft.getView().getSize(),u=m(A,null,null,!0)||u,ie=Gt.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),se=A.parentNode,he=A.nextSibling,ie.appendChild(A),te.appendChild(ie));var ne=Ft.settings,ce=ne.applyMatrix,fe=ne.insertItems;ne.applyMatrix=!1,ne.insertItems=!1;var ye=R[J],xe=ye&&ye(A,J,V,q)||null;if(ne.insertItems=fe,ne.applyMatrix=ce,xe){X&&!(xe instanceof ze)&&(xe=z(xe,A,q));var Ee=V.onImport,Ne=X&&A.getAttribute("data-paper-data");Ee&&(xe=Ee(A,xe,V)||xe),V.expandShapes&&xe instanceof Je&&(xe.remove(),xe=xe.toPath()),Ne&&(xe._data=JSON.parse(Ne))}return ie&&(te.removeChild(ie),se&&(he?se.insertBefore(A,he):se.appendChild(A))),q&&(r={},xe&&a.pick(V.applyMatrix,ce)&&xe.matrix.apply(!0,!0)),xe}function U(A,V,q){if(!A)return null;V=typeof V=="function"?{onLoad:V}:V||{};var J=Ft,X=null;function te(ne){try{var ce=typeof ne=="object"?ne:new e.DOMParser().parseFromString(ne.trim(),"image/svg+xml");if(!ce.nodeName)throw ce=null,new Error("Unsupported SVG source: "+A);Ft=J,X=L(ce,V,!0),(!V||V.insert!==!1)&&q._insertItem(t,X);var fe=V.onLoad;fe&&fe(X,ne)}catch(ye){ie(ye)}}function ie(ne,ce){var fe=V.onError;if(fe)fe(ne,ce);else throw new Error(ne)}if(typeof A=="string"&&!/^[\s\S]*</.test(A)){var se=s.getElementById(A);se?te(se):qr.request({url:A,async:!0,onLoad:te,onError:ie})}else if(typeof File<"u"&&A instanceof File){var he=new FileReader;return he.onload=function(){te(he.result)},he.onerror=function(){ie(he.error)},he.readAsText(A)}else te(A);return X}F.inject({importSVG:function(A,V){return U(A,V,this)}}),we.inject({importSVG:function(A,V){return this.activate(),U(A,V,this)}})},a.exports.PaperScript=(function(){var r=this,u=r.acorn;if(!u&&typeof q2<"u")try{u=J2()}catch{}if(!u){var f,g;u=f=g={},(function(z,H){if(typeof f=="object"&&typeof g=="object")return H(f);if(typeof t=="function"&&t.amd)return t(["exports"],H);H(z.acorn||(z.acorn={}))})(this,function(z){z.version="0.5.0";var H,L,U,A;z.parse=function(oe,pe){return L=String(oe),U=L.length,q(pe),fu(),_u(H.program)};var V=z.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function q(oe){H=oe||{};for(var pe in V)Object.prototype.hasOwnProperty.call(H,pe)||(H[pe]=V[pe]);A=H.sourceFile||null}var J=z.getLineInfo=function(oe,pe){for(var Me=1,Re=0;;){In.lastIndex=Re;var St=In.exec(oe);if(St&&St.index<pe)++Me,Re=St.index+St[0].length;else break}return{line:Me,column:pe-Re}};z.tokenize=function(oe,pe){L=String(oe),U=L.length,q(pe),fu();var Me={};function Re(St){return Ne=ie,ls(St),Me.start=te,Me.end=ie,Me.startLoc=se,Me.endLoc=he,Me.type=ne,Me.value=ce,Me}return Re.jumpTo=function(St,kt){if(X=St,H.locations){ye=1,xe=In.lastIndex=0;for(var jt;(jt=In.exec(L))&&jt.index<St;)++ye,xe=jt.index+jt[0].length}fe=kt,mi()},Re};var X,te,ie,se,he,ne,ce,fe,ye,xe,Ee,Ne,We,$e,it,je;function De(oe,pe){var Me=J(L,oe);pe+=" ("+Me.line+":"+Me.column+")";var Re=new SyntaxError(pe);throw Re.pos=oe,Re.loc=Me,Re.raisedAt=X,Re}var tt=[],at={type:"num"},st={type:"regexp"},xt={type:"string"},vt={type:"name"},ot={type:"eof"},Lt={keyword:"break"},bt={keyword:"case",beforeExpr:!0},pn={keyword:"catch"},sn={keyword:"continue"},Sn={keyword:"debugger"},ln={keyword:"default"},qe={keyword:"do",isLoop:!0},Ht={keyword:"else",beforeExpr:!0},an={keyword:"finally"},qt={keyword:"for",isLoop:!0},er={keyword:"function"},Nr={keyword:"if"},hr={keyword:"return",beforeExpr:!0},Wn={keyword:"switch"},Cn={keyword:"throw",beforeExpr:!0},On={keyword:"try"},tr={keyword:"var"},vn={keyword:"while",isLoop:!0},Nn={keyword:"with"},Ps={keyword:"new",beforeExpr:!0},As={keyword:"this"},Ms={keyword:"null",atomValue:null},Ni={keyword:"true",atomValue:!0},qa={keyword:"false",atomValue:!1},Bi={keyword:"in",binop:7,beforeExpr:!0},Vt={break:Lt,case:bt,catch:pn,continue:sn,debugger:Sn,default:ln,do:qe,else:Ht,finally:an,for:qt,function:er,if:Nr,return:hr,switch:Wn,throw:Cn,try:On,var:tr,while:vn,with:Nn,null:Ms,true:Ni,false:qa,new:Ps,in:Bi,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:As,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},zi={type:"[",beforeExpr:!0},Vi={type:"]"},Br={type:"{",beforeExpr:!0},fr={type:"}"},Pt={type:"(",beforeExpr:!0},nr={type:")"},rr={type:",",beforeExpr:!0},Un={type:";",beforeExpr:!0},Hn={type:":",beforeExpr:!0},Sr={type:"."},Cr={type:"?",beforeExpr:!0},di={binop:10,beforeExpr:!0},c={isAssign:!0,beforeExpr:!0},x={isAssign:!0,beforeExpr:!0},D={postfix:!0,prefix:!0,isUpdate:!0},G={prefix:!0,beforeExpr:!0},re={binop:1,beforeExpr:!0},Se={binop:2,beforeExpr:!0},Oe={binop:3,beforeExpr:!0},Ge={binop:4,beforeExpr:!0},rt={binop:5,beforeExpr:!0},Ot={binop:6,beforeExpr:!0},It={binop:7,beforeExpr:!0},Kt={binop:8,beforeExpr:!0},cn={binop:9,prefix:!0,beforeExpr:!0},Kr={binop:10,beforeExpr:!0};z.tokTypes={bracketL:zi,bracketR:Vi,braceL:Br,braceR:fr,parenL:Pt,parenR:nr,comma:rr,semi:Un,colon:Hn,dot:Sr,question:Cr,slash:di,eq:c,name:vt,eof:ot,num:at,regexp:st,string:xt};for(var pi in Vt)z.tokTypes["_"+pi]=Vt[pi];function Zr(oe){oe=oe.split(" ");var pe="",Me=[];e:for(var Re=0;Re<oe.length;++Re){for(var St=0;St<Me.length;++St)if(Me[St][0].length==oe[Re].length){Me[St].push(oe[Re]);continue e}Me.push([oe[Re]])}function kt(Zt){if(Zt.length==1)return pe+="return str === "+JSON.stringify(Zt[0])+";";pe+="switch(str){";for(var Gn=0;Gn<Zt.length;++Gn)pe+="case "+JSON.stringify(Zt[Gn])+":";pe+="return true}return false;"}if(Me.length>3){Me.sort(function(Zt,Gn){return Gn.length-Zt.length}),pe+="switch(str.length){";for(var Re=0;Re<Me.length;++Re){var jt=Me[Re];pe+="case "+jt[0].length+":",kt(jt)}pe+="}"}else kt(oe);return new Function("str",pe)}var Qr=Zr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),zr=Zr("class enum extends super const export import"),Ka=Zr("implements interface let package private protected public static yield"),ua=Zr("eval arguments"),Wi=Zr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Ho=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ca="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",hu="------------------------------------------------------------------------------------------------------------------------------------------",ha=new RegExp("["+ca+"]"),Za=new RegExp("["+ca+hu+"]"),fa=/[\n\r\u2028\u2029]/,In=/\r\n|[\n\r\u2028\u2029]/g,gi=z.isIdentifierStart=function(oe){return oe<65?oe===36:oe<91?!0:oe<97?oe===95:oe<123?!0:oe>=170&&ha.test(String.fromCharCode(oe))},Qa=z.isIdentifierChar=function(oe){return oe<48?oe===36:oe<58?!0:oe<65?!1:oe<91?!0:oe<97?oe===95:oe<123?!0:oe>=170&&Za.test(String.fromCharCode(oe))};function Vr(){this.line=ye,this.column=X-xe}function fu(){ye=1,X=xe=0,fe=!0,mi()}function kn(oe,pe){ie=X,H.locations&&(he=new Vr),ne=oe,mi(),ce=pe,fe=oe.beforeExpr}function Xo(){var oe=H.onComment&&H.locations&&new Vr,pe=X,Me=L.indexOf("*/",X+=2);if(Me===-1&&De(X-2,"Unterminated comment"),X=Me+2,H.locations){In.lastIndex=pe;for(var Re;(Re=In.exec(L))&&Re.index<X;)++ye,xe=Re.index+Re[0].length}H.onComment&&H.onComment(!0,L.slice(pe+2,Me),pe,X,oe,H.locations&&new Vr)}function os(){for(var oe=X,pe=H.onComment&&H.locations&&new Vr,Me=L.charCodeAt(X+=2);X<U&&Me!==10&&Me!==13&&Me!==8232&&Me!==8233;)++X,Me=L.charCodeAt(X);H.onComment&&H.onComment(!1,L.slice(oe+2,X),oe,X,pe,H.locations&&new Vr)}function mi(){for(;X<U;){var oe=L.charCodeAt(X);if(oe===32)++X;else if(oe===13){++X;var pe=L.charCodeAt(X);pe===10&&++X,H.locations&&(++ye,xe=X)}else if(oe===10||oe===8232||oe===8233)++X,H.locations&&(++ye,xe=X);else if(oe>8&&oe<14)++X;else if(oe===47){var pe=L.charCodeAt(X+1);if(pe===42)Xo();else if(pe===47)os();else break}else if(oe===160)++X;else if(oe>=5760&&Ho.test(String.fromCharCode(oe)))++X;else break}}function du(){var oe=L.charCodeAt(X+1);return oe>=48&&oe<=57?gu(!0):(++X,kn(Sr))}function _h(){var oe=L.charCodeAt(X+1);return fe?(++X,pu()):oe===61?Pn(x,2):Pn(di,1)}function xh(){var oe=L.charCodeAt(X+1);return oe===61?Pn(x,2):Pn(Kr,1)}function wh(oe){var pe=L.charCodeAt(X+1);return pe===oe?Pn(oe===124?re:Se,2):pe===61?Pn(x,2):Pn(oe===124?Oe:rt,1)}function Go(){var oe=L.charCodeAt(X+1);return oe===61?Pn(x,2):Pn(Ge,1)}function bh(oe){var pe=L.charCodeAt(X+1);return pe===oe?pe==45&&L.charCodeAt(X+2)==62&&fa.test(L.slice(Ne,X))?(X+=3,os(),mi(),ls()):Pn(D,2):pe===61?Pn(x,2):Pn(cn,1)}function Sh(oe){var pe=L.charCodeAt(X+1),Me=1;return pe===oe?(Me=oe===62&&L.charCodeAt(X+2)===62?3:2,L.charCodeAt(X+Me)===61?Pn(x,Me+1):Pn(Kt,Me)):pe==33&&oe==60&&L.charCodeAt(X+2)==45&&L.charCodeAt(X+3)==45?(X+=4,os(),mi(),ls()):(pe===61&&(Me=L.charCodeAt(X+2)===61?3:2),Pn(It,Me))}function Ch(oe){var pe=L.charCodeAt(X+1);return pe===61?Pn(Ot,L.charCodeAt(X+2)===61?3:2):Pn(oe===61?c:G,1)}function kh(oe){switch(oe){case 46:return du();case 40:return++X,kn(Pt);case 41:return++X,kn(nr);case 59:return++X,kn(Un);case 44:return++X,kn(rr);case 91:return++X,kn(zi);case 93:return++X,kn(Vi);case 123:return++X,kn(Br);case 125:return++X,kn(fr);case 58:return++X,kn(Hn);case 63:return++X,kn(Cr);case 48:var pe=L.charCodeAt(X+1);if(pe===120||pe===88)return Th();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return gu(!1);case 34:case 39:return Yo(oe);case 47:return _h();case 37:case 42:return xh();case 124:case 38:return wh(oe);case 94:return Go();case 43:case 45:return bh(oe);case 60:case 62:return Sh(oe);case 61:case 33:return Ch(oe);case 126:return Pn(G,1)}return!1}function ls(oe){if(oe?X=te+1:te=X,H.locations&&(se=new Vr),oe)return pu();if(X>=U)return kn(ot);var pe=L.charCodeAt(X);if(gi(pe)||pe===92)return qo();var Me=kh(pe);if(Me===!1){var Re=String.fromCharCode(pe);if(Re==="\\"||ha.test(Re))return qo();De(X,"Unexpected character '"+Re+"'")}return Me}function Pn(oe,pe){var Me=L.slice(X,X+pe);X+=pe,kn(oe,Me)}function pu(){for(var St="",oe,pe,Me=X;;){X>=U&&De(Me,"Unterminated regular expression");var Re=L.charAt(X);if(fa.test(Re)&&De(Me,"Unterminated regular expression"),oe)oe=!1;else{if(Re==="[")pe=!0;else if(Re==="]"&&pe)pe=!1;else if(Re==="/"&&!pe)break;oe=Re==="\\"}++X}var St=L.slice(Me,X);++X;var kt=mu();kt&&!/^[gmsiy]*$/.test(kt)&&De(Me,"Invalid regexp flag");try{var jt=new RegExp(St,kt)}catch(Zt){Zt instanceof SyntaxError&&De(Me,Zt.message),De(Zt)}return kn(st,jt)}function da(oe,pe){for(var Me=X,Re=0,St=0,kt=pe??1/0;St<kt;++St){var jt=L.charCodeAt(X),Zt;if(jt>=97?Zt=jt-97+10:jt>=65?Zt=jt-65+10:jt>=48&&jt<=57?Zt=jt-48:Zt=1/0,Zt>=oe)break;++X,Re=Re*oe+Zt}return X===Me||pe!=null&&X-Me!==pe?null:Re}function Th(){X+=2;var oe=da(16);return oe==null&&De(te+2,"Expected hexadecimal number"),gi(L.charCodeAt(X))&&De(X,"Identifier directly after number"),kn(at,oe)}function gu(oe){var pe=X,Me=!1,Re=L.charCodeAt(X)===48;!oe&&da(10)===null&&De(pe,"Invalid number"),L.charCodeAt(X)===46&&(++X,da(10),Me=!0);var St=L.charCodeAt(X);(St===69||St===101)&&(St=L.charCodeAt(++X),(St===43||St===45)&&++X,da(10)===null&&De(pe,"Invalid number"),Me=!0),gi(L.charCodeAt(X))&&De(X,"Identifier directly after number");var kt=L.slice(pe,X),jt;return Me?jt=parseFloat(kt):!Re||kt.length===1?jt=parseInt(kt,10):/[89]/.test(kt)||je?De(pe,"Invalid number"):jt=parseInt(kt,8),kn(at,jt)}function Yo(oe){X++;for(var pe="";;){X>=U&&De(te,"Unterminated string constant");var Me=L.charCodeAt(X);if(Me===oe)return++X,kn(xt,pe);if(Me===92){Me=L.charCodeAt(++X);var Re=/^[0-7]+/.exec(L.slice(X,X+3));for(Re&&(Re=Re[0]);Re&&parseInt(Re,8)>255;)Re=Re.slice(0,-1);if(Re==="0"&&(Re=null),++X,Re)je&&De(X-2,"Octal literal in strict mode"),pe+=String.fromCharCode(parseInt(Re,8)),X+=Re.length-1;else switch(Me){case 110:pe+=`
`;break;case 114:pe+="\r";break;case 120:pe+=String.fromCharCode(Ja(2));break;case 117:pe+=String.fromCharCode(Ja(4));break;case 85:pe+=String.fromCharCode(Ja(8));break;case 116:pe+="	";break;case 98:pe+="\b";break;case 118:pe+="\v";break;case 102:pe+="\f";break;case 48:pe+="\0";break;case 13:L.charCodeAt(X)===10&&++X;case 10:H.locations&&(xe=X,++ye);break;default:pe+=String.fromCharCode(Me);break}}else(Me===13||Me===10||Me===8232||Me===8233)&&De(te,"Unterminated string constant"),pe+=String.fromCharCode(Me),++X}}function Ja(oe){var pe=da(16,oe);return pe===null&&De(te,"Bad character escape sequence"),pe}var Is;function mu(){Is=!1;for(var oe,pe=!0,Me=X;;){var Re=L.charCodeAt(X);if(Qa(Re))Is&&(oe+=L.charAt(X)),++X;else if(Re===92){Is||(oe=L.slice(Me,X)),Is=!0,L.charCodeAt(++X)!=117&&De(X,"Expecting Unicode escape sequence \\uXXXX"),++X;var St=Ja(4),kt=String.fromCharCode(St);kt||De(X-1,"Invalid Unicode escape"),(pe?gi(St):Qa(St))||De(X-4,"Invalid Unicode escape"),oe+=kt}else break;pe=!1}return Is?oe:L.slice(Me,X)}function qo(){var oe=mu(),pe=vt;return!Is&&Wi(oe)&&(pe=Vt[oe]),kn(pe,oe)}function Xt(){Ee=te,Ne=ie,We=he,ls()}function Ko(oe){if(je=oe,X=te,H.locations)for(;X<xe;)xe=L.lastIndexOf(`
`,xe-2)+1,--ye;mi(),ls()}function vu(){this.type=null,this.start=te,this.end=null}function yu(){this.start=se,this.end=null,A!==null&&(this.source=A)}function Bn(){var oe=new vu;return H.locations&&(oe.loc=new yu),H.directSourceFile&&(oe.sourceFile=H.directSourceFile),H.ranges&&(oe.range=[te,0]),oe}function Ui(oe){var pe=new vu;return pe.start=oe.start,H.locations&&(pe.loc=new yu,pe.loc.start=oe.loc.start),H.ranges&&(pe.range=[oe.range[0],0]),pe}function Nt(oe,pe){return oe.type=pe,oe.end=Ne,H.locations&&(oe.loc.end=We),H.ranges&&(oe.range[1]=Ne),oe}function pa(oe){return H.ecmaVersion>=5&&oe.type==="ExpressionStatement"&&oe.expression.type==="Literal"&&oe.expression.value==="use strict"}function rn(oe){if(ne===oe)return Xt(),!0}function $a(){return!H.strictSemicolons&&(ne===ot||ne===fr||fa.test(L.slice(Ne,te)))}function Hi(){!rn(Un)&&!$a()&&Jr()}function yn(oe){ne===oe?Xt():Jr()}function Jr(){De(te,"Unexpected token")}function ga(oe){oe.type!=="Identifier"&&oe.type!=="MemberExpression"&&De(oe.start,"Assigning to rvalue"),je&&oe.type==="Identifier"&&ua(oe.name)&&De(oe.start,"Assigning to "+oe.name+" in strict mode")}function _u(oe){Ee=Ne=X,H.locations&&(We=new Vr),$e=je=null,it=[],ls();var pe=oe||Bn(),Me=!0;for(oe||(pe.body=[]);ne!==ot;){var Re=Wr();pe.body.push(Re),Me&&pa(Re)&&Ko(!0),Me=!1}return Nt(pe,"Program")}var Xi={kind:"loop"},Eh={kind:"switch"};function Wr(){(ne===di||ne===x&&ce=="/=")&&ls(!0);var oe=ne,pe=Bn();switch(oe){case Lt:case sn:Xt();var Me=oe===Lt;rn(Un)||$a()?pe.label=null:ne!==vt?Jr():(pe.label=jn(),Hi());for(var Re=0;Re<it.length;++Re){var St=it[Re];if((pe.label==null||St.name===pe.label.name)&&(St.kind!=null&&(Me||St.kind==="loop")||pe.label&&Me))break}return Re===it.length&&De(pe.start,"Unsyntactic "+oe.keyword),Nt(pe,Me?"BreakStatement":"ContinueStatement");case Sn:return Xt(),Hi(),Nt(pe,"DebuggerStatement");case qe:return Xt(),it.push(Xi),pe.body=Wr(),it.pop(),yn(vn),pe.test=ma(),Hi(),Nt(pe,"DoWhileStatement");case qt:if(Xt(),it.push(Xi),yn(Pt),ne===Un)return eo(pe,null);if(ne===tr){var kt=Bn();return Xt(),Ds(kt,!0),Nt(kt,"VariableDeclaration"),kt.declarations.length===1&&rn(Bi)?Ls(pe,kt):eo(pe,kt)}var kt=Xn(!1,!0);return rn(Bi)?(ga(kt),Ls(pe,kt)):eo(pe,kt);case er:return Xt(),Zo(pe,!0);case Nr:return Xt(),pe.test=ma(),pe.consequent=Wr(),pe.alternate=rn(Ht)?Wr():null,Nt(pe,"IfStatement");case hr:return!$e&&!H.allowReturnOutsideFunction&&De(te,"'return' outside of function"),Xt(),rn(Un)||$a()?pe.argument=null:(pe.argument=Xn(),Hi()),Nt(pe,"ReturnStatement");case Wn:Xt(),pe.discriminant=ma(),pe.cases=[],yn(Br),it.push(Eh);for(var jt,Zt;ne!=fr;)if(ne===bt||ne===ln){var Gn=ne===bt;jt&&Nt(jt,"SwitchCase"),pe.cases.push(jt=Bn()),jt.consequent=[],Xt(),Gn?jt.test=Xn():(Zt&&De(Ee,"Multiple default clauses"),Zt=!0,jt.test=null),yn(Hn)}else jt||Jr(),jt.consequent.push(Wr());return jt&&Nt(jt,"SwitchCase"),Xt(),it.pop(),Nt(pe,"SwitchStatement");case Cn:return Xt(),fa.test(L.slice(Ne,te))&&De(Ne,"Illegal newline after throw"),pe.argument=Xn(),Hi(),Nt(pe,"ThrowStatement");case On:if(Xt(),pe.block=js(),pe.handler=null,ne===pn){var vi=Bn();Xt(),yn(Pt),vi.param=jn(),je&&ua(vi.param.name)&&De(vi.param.start,"Binding "+vi.param.name+" in strict mode"),yn(nr),vi.guard=null,vi.body=js(),pe.handler=Nt(vi,"CatchClause")}return pe.guardedHandlers=tt,pe.finalizer=rn(an)?js():null,!pe.handler&&!pe.finalizer&&De(pe.start,"Missing catch or finally clause"),Nt(pe,"TryStatement");case tr:return Xt(),Ds(pe),Hi(),Nt(pe,"VariableDeclaration");case vn:return Xt(),pe.test=ma(),it.push(Xi),pe.body=Wr(),it.pop(),Nt(pe,"WhileStatement");case Nn:return je&&De(te,"'with' in strict mode"),Xt(),pe.object=ma(),pe.body=Wr(),Nt(pe,"WithStatement");case Br:return js();case Un:return Xt(),Nt(pe,"EmptyStatement");default:var us=ce,Ns=Xn();if(oe===vt&&Ns.type==="Identifier"&&rn(Hn)){for(var Re=0;Re<it.length;++Re)it[Re].name===us&&De(Ns.start,"Label '"+us+"' is already declared");var Su=ne.isLoop?"loop":ne===Wn?"switch":null;return it.push({name:us,kind:Su}),pe.body=Wr(),it.pop(),pe.label=Ns,Nt(pe,"LabeledStatement")}else return pe.expression=Ns,Hi(),Nt(pe,"ExpressionStatement")}}function ma(){yn(Pt);var oe=Xn();return yn(nr),oe}function js(oe){var pe=Bn(),Me=!0,Re=!1,St;for(pe.body=[],yn(Br);!rn(fr);){var kt=Wr();pe.body.push(kt),Me&&oe&&pa(kt)&&(St=Re,Ko(Re=!0)),Me=!1}return Re&&!St&&Ko(!1),Nt(pe,"BlockStatement")}function eo(oe,pe){return oe.init=pe,yn(Un),oe.test=ne===Un?null:Xn(),yn(Un),oe.update=ne===nr?null:Xn(),yn(nr),oe.body=Wr(),it.pop(),Nt(oe,"ForStatement")}function Ls(oe,pe){return oe.left=pe,oe.right=Xn(),yn(nr),oe.body=Wr(),it.pop(),Nt(oe,"ForInStatement")}function Ds(oe,pe){for(oe.declarations=[],oe.kind="var";;){var Me=Bn();if(Me.id=jn(),je&&ua(Me.id.name)&&De(Me.id.start,"Binding "+Me.id.name+" in strict mode"),Me.init=rn(c)?Xn(!0,pe):null,oe.declarations.push(Nt(Me,"VariableDeclarator")),!rn(rr))break}return oe}function Xn(oe,pe){var Me=Rs(pe);if(!oe&&ne===rr){var Re=Ui(Me);for(Re.expressions=[Me];rn(rr);)Re.expressions.push(Rs(pe));return Nt(Re,"SequenceExpression")}return Me}function Rs(oe){var pe=Oh(oe);if(ne.isAssign){var Me=Ui(pe);return Me.operator=ce,Me.left=pe,Xt(),Me.right=Rs(oe),ga(pe),Nt(Me,"AssignmentExpression")}return pe}function Oh(oe){var pe=xu(oe);if(rn(Cr)){var Me=Ui(pe);return Me.test=pe,Me.consequent=Xn(!0),yn(Hn),Me.alternate=Xn(!0,oe),Nt(Me,"ConditionalExpression")}return pe}function xu(oe){return va(ya(),-1,oe)}function va(oe,pe,Me){var Re=ne.binop;if(Re!=null&&(!Me||ne!==Bi)&&Re>pe){var St=Ui(oe);St.left=oe,St.operator=ce;var kt=ne;Xt(),St.right=va(ya(),Re,Me);var jt=Nt(St,kt===re||kt===Se?"LogicalExpression":"BinaryExpression");return va(jt,pe,Me)}return oe}function ya(){if(ne.prefix){var oe=Bn(),pe=ne.isUpdate;return oe.operator=ce,oe.prefix=!0,fe=!0,Xt(),oe.argument=ya(),pe?ga(oe.argument):je&&oe.operator==="delete"&&oe.argument.type==="Identifier"&&De(oe.start,"Deleting local variable in strict mode"),Nt(oe,pe?"UpdateExpression":"UnaryExpression")}for(var Me=wu();ne.postfix&&!$a();){var oe=Ui(Me);oe.operator=ce,oe.prefix=!1,oe.argument=Me,ga(Me),Xt(),Me=Nt(oe,"UpdateExpression")}return Me}function wu(){return Fs(to())}function Fs(oe,pe){if(rn(Sr)){var Me=Ui(oe);return Me.object=oe,Me.property=jn(!0),Me.computed=!1,Fs(Nt(Me,"MemberExpression"),pe)}else if(rn(zi)){var Me=Ui(oe);return Me.object=oe,Me.property=Xn(),Me.computed=!0,yn(Vi),Fs(Nt(Me,"MemberExpression"),pe)}else if(!pe&&rn(Pt)){var Me=Ui(oe);return Me.callee=oe,Me.arguments=Qo(nr,!1),Fs(Nt(Me,"CallExpression"),pe)}else return oe}function to(){switch(ne){case As:var Re=Bn();return Xt(),Nt(Re,"ThisExpression");case vt:return jn();case at:case xt:case st:var Re=Bn();return Re.value=ce,Re.raw=L.slice(te,ie),Xt(),Nt(Re,"Literal");case Ms:case Ni:case qa:var Re=Bn();return Re.value=ne.atomValue,Re.raw=ne.keyword,Xt(),Nt(Re,"Literal");case Pt:var oe=se,pe=te;Xt();var Me=Xn();return Me.start=pe,Me.end=ie,H.locations&&(Me.loc.start=oe,Me.loc.end=he),H.ranges&&(Me.range=[pe,ie]),yn(nr),Me;case zi:var Re=Bn();return Xt(),Re.elements=Qo(Vi,!0,!0),Nt(Re,"ArrayExpression");case Br:return Ah();case er:var Re=Bn();return Xt(),Zo(Re,!1);case Ps:return Ph();default:Jr()}}function Ph(){var oe=Bn();return Xt(),oe.callee=Fs(to(),!0),rn(Pt)?oe.arguments=Qo(nr,!1):oe.arguments=tt,Nt(oe,"NewExpression")}function Ah(){var oe=Bn(),pe=!0,Me=!1;for(oe.properties=[],Xt();!rn(fr);){if(pe)pe=!1;else if(yn(rr),H.allowTrailingCommas&&rn(fr))break;var Re={key:bu()},St=!1,kt;if(rn(Hn)?(Re.value=Xn(!0),kt=Re.kind="init"):H.ecmaVersion>=5&&Re.key.type==="Identifier"&&(Re.key.name==="get"||Re.key.name==="set")?(St=Me=!0,kt=Re.kind=Re.key.name,Re.key=bu(),ne!==Pt&&Jr(),Re.value=Zo(Bn(),!1)):Jr(),Re.key.type==="Identifier"&&(je||Me))for(var jt=0;jt<oe.properties.length;++jt){var Zt=oe.properties[jt];if(Zt.key.name===Re.key.name){var Gn=kt==Zt.kind||St&&Zt.kind==="init"||kt==="init"&&(Zt.kind==="get"||Zt.kind==="set");Gn&&!je&&kt==="init"&&Zt.kind==="init"&&(Gn=!1),Gn&&De(Re.key.start,"Redefinition of property")}}oe.properties.push(Re)}return Nt(oe,"ObjectExpression")}function bu(){return ne===at||ne===xt?to():jn(!0)}function Zo(oe,pe){ne===vt?oe.id=jn():pe?Jr():oe.id=null,oe.params=[];var Me=!0;for(yn(Pt);!rn(nr);)Me?Me=!1:yn(rr),oe.params.push(jn());var Re=$e,St=it;if($e=!0,it=[],oe.body=js(!0),$e=Re,it=St,je||oe.body.body.length&&pa(oe.body.body[0]))for(var kt=oe.id?-1:0;kt<oe.params.length;++kt){var jt=kt<0?oe.id:oe.params[kt];if((Ka(jt.name)||ua(jt.name))&&De(jt.start,"Defining '"+jt.name+"' in strict mode"),kt>=0)for(var Zt=0;Zt<kt;++Zt)jt.name===oe.params[Zt].name&&De(jt.start,"Argument name clash in strict mode")}return Nt(oe,pe?"FunctionDeclaration":"FunctionExpression")}function Qo(oe,pe,Me){for(var Re=[],St=!0;!rn(oe);){if(St)St=!1;else if(yn(rr),pe&&H.allowTrailingCommas&&rn(oe))break;Me&&ne===rr?Re.push(null):Re.push(Xn(!0))}return Re}function jn(oe){var pe=Bn();return oe&&H.forbidReserved=="everywhere"&&(oe=!1),ne===vt?(!oe&&(H.forbidReserved&&(H.ecmaVersion===3?Qr:zr)(ce)||je&&Ka(ce))&&L.slice(te,ie).indexOf("\\")==-1&&De(te,"The keyword '"+ce+"' is reserved"),pe.name=ce):oe&&ne.keyword?pe.name=ne.keyword:Jr(),fe=!1,Xt(),Nt(pe,"Identifier")}}),u.version||(u=null)}function m(z,H){return(r.acorn||u).parse(z,H)}var w={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},S={"-":"__negate","+":"__self"},C=a.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(z){this["__"+z]="#"+z},{__self:function(){return this}});O.inject(C),W.inject(C),pt.inject(C);function T(z,H,L){var U=w[H];if(z&&z[U]){var A=z[U](L);return H==="!="?!A:A}switch(H){case"+":return z+L;case"-":return z-L;case"*":return z*L;case"/":return z/L;case"%":return z%L;case"==":return z==L;case"!=":return z!=L}}function P(z,H){var L=S[z];if(H&&H[L])return H[L]();switch(z){case"+":return+H;case"-":return-H}}function R(z,H){if(!z)return"";H=H||{};var L=[];function U(je){for(var De=0,tt=L.length;De<tt;De++){var at=L[De];if(at[0]>=je)break;je+=at[1]}return je}function A(je){return z.substring(U(je.range[0]),U(je.range[1]))}function V(je,De){return z.substring(U(je.range[1]),U(De.range[0]))}function q(je,De){for(var tt=U(je.range[0]),at=U(je.range[1]),st=0,xt=L.length-1;xt>=0;xt--)if(tt>L[xt][0]){st=xt+1;break}L.splice(st,0,[tt,De.length-at+tt]),z=z.substring(0,tt)+De+z.substring(at)}function J(je,De){switch(je.type){case"UnaryExpression":if(je.operator in S&&je.argument.type!=="Literal"){var tt=A(je.argument);q(je,'$__("'+je.operator+'", '+tt+")")}break;case"BinaryExpression":if(je.operator in w&&je.left.type!=="Literal"){var at=A(je.left),st=A(je.right),xt=V(je.left,je.right),vt=je.operator;q(je,"__$__("+at+","+xt.replace(new RegExp("\\"+vt),'"'+vt+'"')+", "+st+")")}break;case"UpdateExpression":case"AssignmentExpression":var ot=De&&De.type;if(!(ot==="ForStatement"||ot==="BinaryExpression"&&/^[=!<>]/.test(De.operator)||ot==="MemberExpression"&&De.computed)){if(je.type==="UpdateExpression"){var tt=A(je.argument),Lt="__$__("+tt+', "'+je.operator[0]+'", 1)',bt=tt+" = "+Lt;je.prefix?bt="("+bt+")":(ot==="AssignmentExpression"||ot==="VariableDeclarator"||ot==="BinaryExpression")&&(A(De.left||De.id)===tt&&(bt=Lt),bt=tt+"; "+bt),q(je,bt)}else if(/^.=$/.test(je.operator)&&je.left.type!=="Literal"){var at=A(je.left),st=A(je.right),Lt=at+" = __$__("+at+', "'+je.operator[0]+'", '+st+")";q(je,/^\(.*\)$/.test(A(je))?"("+Lt+")":Lt)}}break}}function X(je){switch(je.type){case"ExportDefaultDeclaration":q({range:[je.start,je.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var De=je.declaration,tt=je.specifiers;if(De){var at=De.declarations;at&&(at.forEach(function(xt){q(xt,"module.exports."+A(xt))}),q({range:[je.start,De.start+De.kind.length]},""))}else if(tt){var st=tt.map(function(xt){var vt=A(xt);return"module.exports."+vt+" = "+vt+"; "}).join("");st&&q(je,st)}break}}function te(je,De,tt){if(je){for(var at in je)if(at!=="range"&&at!=="loc"){var st=je[at];if(Array.isArray(st))for(var xt=0,vt=st.length;xt<vt;xt++)te(st[xt],je,tt);else st&&typeof st=="object"&&te(st,je,tt)}tt.operatorOverloading!==!1&&J(je,De),tt.moduleExports!==!1&&X(je)}}function ie(je){var De="",tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(je=(Math.abs(je)<<1)+(je<0?1:0);je||!De;){var at=je&31;je>>=5,je&&(at|=32),De+=tt[at]}return De}var se=H.url||"",he=H.sourceMaps,ne=H.paperFeatures||{},ce=H.source||z,fe=H.offset||0,ye=Ft.agent,xe=ye.versionNumber,Ee=!1,Ne=/\r\n|\n|\r/mg,We;if(he&&(ye.chrome&&xe>=30||ye.webkit&&xe>=537.76||ye.firefox&&xe>=23||ye.node)){if(ye.node)fe-=2;else if(n&&se&&!n.location.href.indexOf(se)){var $e=s.getElementsByTagName("html")[0].innerHTML;fe=$e.substr(0,$e.indexOf(z)+1).match(Ne).length+1}Ee=fe>0&&!(ye.chrome&&xe>=36||ye.safari&&xe>=600||ye.firefox&&xe>=40||ye.node);var it=["AA"+ie(Ee?0:fe)+"A"];it.length=(z.match(Ne)||[]).length+1+(Ee?fe:0),We={version:3,file:se,names:[],mappings:it.join(";AACA"),sourceRoot:"",sources:[se],sourcesContent:[ce]}}return(ne.operatorOverloading!==!1||ne.moduleExports!==!1)&&te(m(z,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,ne),We&&(Ee&&(z=new Array(fe+1).join(`
`)+z),/^(inline|both)$/.test(he)&&(z+=`
//# sourceMappingURL=data:application/json;base64,`+e.btoa(unescape(encodeURIComponent(JSON.stringify(We))))),z+=`
//# sourceURL=`+(se||"paperscript")),{url:se,source:ce,code:z,map:We}}function B(z,H,L){Ft=H;var U=H.getView(),A=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(z)&&!/\bnew\s+Tool\b/.test(z)?new Ri:null,V=A?A._events:[],q=["onFrame","onResize"].concat(V),J=[],X=[],te,ie=typeof z=="object"?z:R(z,L);z=ie.code;function se(xe,Ee){for(var Ne in xe)(Ee||!/^_/.test(Ne))&&new RegExp("([\\b\\s\\W]|^)"+Ne.replace(/\$/g,"\\$")+"\\b").test(z)&&(J.push(Ne),X.push(xe[Ne]))}se({__$__:T,$__:P,paper:H,tool:A},!0),se(H),z="var module = { exports: {} }; "+z;var fe=a.each(q,function(xe){new RegExp("\\s+"+xe+"\\b").test(z)&&(J.push(xe),this.push("module.exports."+xe+" = "+xe+";"))},[]).join(`
`);fe&&(z+=`
`+fe),z+=`
return module.exports;`;var he=Ft.agent;if(s&&(he.chrome||he.firefox&&he.versionNumber<40)){var ne=s.createElement("script"),ce=s.head||s.getElementsByTagName("head")[0];he.firefox&&(z=`
`+z),ne.appendChild(s.createTextNode("document.__paperscript__ = function("+J+") {"+z+`
}`)),ce.appendChild(ne),te=s.__paperscript__,delete s.__paperscript__,ce.removeChild(ne)}else te=Function(J,z);var fe=te&&te.apply(H,X),ye=fe||{};return a.each(V,function(xe){var Ee=ye[xe];Ee&&(A[xe]=Ee)}),U&&(ye.onResize&&U.setOnResize(ye.onResize),U.emit("resize",{size:U.size,delta:new O}),ye.onFrame&&U.setOnFrame(ye.onFrame),U.requestUpdate()),fe}function j(z){if(/^text\/(?:x-|)paperscript$/.test(z.type)&&p.getAttribute(z,"ignore")!=="true"){var H=p.getAttribute(z,"canvas"),L=s.getElementById(H),U=z.src||z.getAttribute("data-src"),A=p.hasAttribute(z,"async"),V="data-paper-scope";if(!L)throw new Error('Unable to find canvas with id "'+H+'"');var q=p.get(L.getAttribute(V))||new p().setup(L);return L.setAttribute(V,q._id),U?qr.request({url:U,async:A,mimeType:"text/plain",onLoad:function(J){B(J,q,U)}}):B(z.innerHTML,q,z.baseURI),z.setAttribute("data-paper-ignore","true"),q}}function I(){a.each(s&&s.getElementsByTagName("script"),j)}function Y(z){return z?j(z):I()}return n&&(s.readyState==="complete"?setTimeout(I):At.add(n,{load:I})),{compile:R,execute:B,load:Y,parse:m,calculateBinary:T,calculateUnary:P}}).call(this);var Ft=new(p.inject(a.exports,{Base:a,Numerical:E,Key:Di,DomEvent:At,DomElement:_t,document:s,window:n,Symbol:Ke,PlacedSymbol:Ie}));return Ft.agent.node&&wm(Ft),typeof t=="function"&&t.amd?t("paper",Ft):l&&(l.exports=Ft),Ft}).call($2,typeof self=="object"?self:null)})(Rc)),Rc.exports}var tS=eS();const fd=Am(tS),ko={cleanup(...l){l.forEach(e=>e&&!e.removed&&e.remove())},reorientSafe(l){return l&&l.closed&&l.reorient(),l},intersects(l,e){return l&&e&&l.intersects(e)},cloneSafe(l){return l?l.clone():null},simplifySafe(l,e=.5){return l&&l.simplify&&l.simplify(e),l},union(l,e){if(!l||!e)return null;const t=l.unite(e);return this.cleanup(l,e),this.reorientSafe(t)},intersect(l,e){if(!l||!e)return null;const t=l.intersect(e);return this.cleanup(l,e),this.reorientSafe(t)},subtract(l,e){if(!l||!e)return null;const t=l.subtract(e);return this.cleanup(l,e),this.reorientSafe(t)},exclude(l,e){if(!l||!e)return null;const t=l.exclude(e);return this.cleanup(l,e),this.reorientSafe(t)},divide(l,e){if(!l||!e)return[];const t=l.divide(e);return this.cleanup(l,e),t||[]},cut(l,e){if(!l||!e)return[];const t=l.divide(e);return this.cleanup(l,e),t||[]},punch(l,e){if(!l||!e)return null;const t=l.subtract(e);return this.cleanup(l,e),this.reorientSafe(t)},crop(l,e){if(!l||!e)return null;const t=l.intersect(e);return this.cleanup(l),this.reorientSafe(t)},xorSplit(l,e){if(!l||!e)return[];const t=l.exclude(e);return this.cleanup(l,e),t.children&&t.children.length?t.children.map(n=>this.reorientSafe(n)):[this.reorientSafe(t)]},smartUnion(l,e){return!l||!e||!this.intersects(l,e)?null:this.union(l,e)},keepLargest(l){return!l||!l.length?null:l.reduce((e,t)=>t.area>e.area?t:e,l[0])},keepSmallest(l){return!l||!l.length?null:l.reduce((e,t)=>t.area<e.area?t:e,l[0])},filterInside(l,e){return!l||!e?[]:l.filter(t=>e.contains(t.bounds.center))},filterOutside(l,e){return!l||!e?[]:l.filter(t=>!e.contains(t.bounds.center))},combine(l){return!l||l.length===0?null:l.reduce((e,t)=>e.unite(t))},snapToGrid(l,e=10){return l?(l.forEach(t=>{t.position.x=Math.round(t.position.x/e)*e,t.position.y=Math.round(t.position.y/e)*e}),l):[]}};function dd(l){return{fill:l.fill,stroke:l.stroke,strokeWidth:l.strokeWidth,strokeDashArray:l.strokeDashArray,strokeLineCap:l.strokeLineCap,strokeLineJoin:l.strokeLineJoin,opacity:l.opacity}}function nS(l,e,t){let n=null;return e.forEach((s,a)=>{const h=l.project.importSVG(s.toSVG(),{expandShapes:!0,insert:!1}),p=rS(h.children?.[0]??h);a===0?n=p:n=ko[t](n,p)}),n}function rS(l){return l.strokeWidth&&(l.strokeColor=null,l.strokeWidth=0,l.fill="black",l.closed=!0),l}function iS(l,e,t){if(!e)return null;if(!Array.isArray(e))return e.exportSVG({asString:!0,bounds:"content",precision:3});if(t==="divide"||t==="cut")return e.map(a=>a.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`);const n=new l.CompoundPath({children:e});n.reorient();const s=n.exportSVG({asString:!0,bounds:"content",precision:3});return n.remove(),s}function Cm(l){const[,e,t]=l.split("-");return Gy[e]?.[t]}function sS(l){const e=document.createElement("canvas").getContext("2d");return e?(e.fillStyle="#000",e.fillStyle=l,e.fillStyle||null):null}let wl=null;const aS={soft:{blur:12,offsetX:0,offsetY:6,color:"rgba(0,0,0,0.2)"},medium:{blur:20,offsetX:0,offsetY:10,color:"rgba(0,0,0,0.25)"},strong:{blur:40,offsetX:0,offsetY:20,color:"rgba(0,0,0,0.3)"}},oS={union:"unite",intersect:"intersect",subtract:"subtract",exclude:"exclude",divide:"divide",cut:"cut",punch:"punch",crop:"crop",xorSplit:"xorSplit",smartUnion:"smartUnion"};function lS(l){const e=l*Math.PI/180;return{x1:.5-Math.cos(e)/2,y1:.5-Math.sin(e)/2,x2:.5+Math.cos(e)/2,y2:.5+Math.sin(e)/2}}function uS(l){if(l.type==="linear"){const{x1:e,y1:t,x2:n,y2:s}=lS(l.angle);return new Oi({type:"linear",gradientUnits:"objectBoundingBox",coords:{x1:e,y1:t,x2:n,y2:s},colorStops:l.stops})}return new Oi({type:"radial",gradientUnits:"objectBoundingBox",coords:{x1:.5,y1:.5,r1:0,x2:.5,y2:.5,r2:.5},colorStops:l.stops})}const cS=(l,e,t)=>({activePaint:"fill",fill:"#FFFFFF",stroke:"#000000",strokeWidth:1,strokeStyle:"solid",opacity:1,gradient:{type:"linear",angle:90,stops:[{offset:0,color:"#ff0000"},{offset:1,color:"#0000ff"}]},setGradient:n=>{l(s=>({gradient:{...s.gradient,...n}}))},applyFillGradient:()=>{const n=e().canvas,s=n?.getActiveObject();if(!n||!s)return;const a=uS(e().gradient);s.set("fill",a),n.requestRenderAll()},strokeStyleList:[{value:"solid",label:"Solid",dash:null,supported:!0},{value:"dashed",label:"Dashed",dash:[6,4],supported:!0},{value:"dotted",label:"Dotted",dash:[2,2],supported:!0},{value:"double",label:"Double",dash:null,supported:!1},{value:"groove",label:"Groove",dash:null,supported:!1},{value:"ridge",label:"Ridge",dash:null,supported:!1},{value:"inset",label:"Inset",dash:null,supported:!1},{value:"outset",label:"Outset",dash:null,supported:!1}],strokeStyleMap:{solid:{dashArray:null,lineCap:"butt"},dashed:{dashArray:[10,5],lineCap:"butt"},dotted:{dashArray:[2,5],lineCap:"round"},double:{dashArray:[1,3,1,3],lineCap:"butt"},groove:{dashArray:[4,2,1,2],lineCap:"butt"},ridge:{dashArray:[1,2,4,2],lineCap:"butt"},inset:{dashArray:[1,1],lineCap:"butt"},outset:{dashArray:[2,1],lineCap:"butt"}},setActivePaint:n=>l({activePaint:n}),setFill:n=>{const s=e().canvas;if(!s||typeof n=="string"&&n.startsWith("bg-")&&(n=Cm(n),!n))return;s.getActiveObjects().forEach(h=>h.set({fill:n})),s.requestRenderAll(),l({fill:n})},setStroke:n=>{const s=e().canvas;if(!s)return;s.getActiveObjects().forEach(h=>h.set({stroke:n})),s.requestRenderAll(),l({stroke:n})},setStrokeWidthN:n=>{const s=e().canvas;if(!s)return;s.getActiveObjects().forEach(h=>h.set({strokeWidth:n})),s.requestRenderAll(),l({strokeWidth:n})},setStrokeStyle:n=>{const s=e().canvas;if(!s)return;const a=s.getActiveObjects(),h=e().strokeStyleMap[n]||e().strokeStyleMap.solid;a.forEach(p=>{p.set({strokeDashArray:h.dashArray,strokeLineCap:h.lineCap})}),s.requestRenderAll(),l({strokeStyle:n})},setOpacity1:n=>{const s=e().canvas,a=s?.getActiveObject();if(!a)return;const h=n/100;a.set("opacity",h),s.requestRenderAll(),l({opacity:n})},setOpacity:n=>{const s=e().canvas,a=s?.getActiveObject();if(!a)return;const h=Math.min(1,Math.max(.05,n));a.set("opacity",h),s.requestRenderAll(),l({opacity:h})},previewOpacity:n=>{const s=e().canvas?.getActiveObject();s&&(wl===null&&(wl=s.opacity??1),s.set("opacity",n/100),e().canvas?.requestRenderAll())},endOpacityPreview:()=>{const n=e().canvas?.getActiveObject();!n||wl===null||(n.set("opacity",wl),wl=null,e().canvas?.requestRenderAll())},handleColorChange:n=>{const s=e().canvas,a=e().geditor;if(!s)return;if(n.startsWith("bg-")){const v=Cm(n);if(!v)return;n=v}const h=sS(n);if(!h)return;const p=s.getActiveObjects();if(a&&a.activeStop&&e().activePaint==="fill"){a.updateActiveColor(h),l({fill:h}),s.requestRenderAll();return}if(p.length===0){e().activePaint==="stroke"?l({stroke:h}):l({fill:h});return}p.forEach(v=>{if(e().activePaint==="stroke")v.set({stroke:h});else{if(v.fill instanceof Oi)return;v.set({fill:h})}}),e().activePaint==="stroke"?l({stroke:h}):l({fill:h}),s.requestRenderAll()},addShadow:n=>{const s=e().canvas,a=s?.getActiveObject();a&&(a.set("shadow",new wr(n)),s.requestRenderAll())},applyShadowPreset:n=>{const s=e().canvas,a=s?.getActiveObject();if(!a)return;const h=aS[n];if(!h)return;const p=new wr({...h});a.set("shadow",p),s.requestRenderAll(),l({activeObjectShadow:p})},removeShadow:()=>{const n=e().canvas,s=n?.getActiveObject();s&&(s.set("shadow",null),n.requestRenderAll(),l({activeObjectShadow:null}))},toFabricPath(n){if(n.type==="path")return n;const a=n.toSVG().match(/d="([^"]+)"/);return a?new Ji(a[1],{fill:n.fill,stroke:n.stroke,strokeWidth:n.strokeWidth,scaleX:n.scaleX,scaleY:n.scaleY,angle:n.angle}):null},booleanOperation:async(n="union")=>{try{const s=e().canvas,a=s.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}const h=a.getObjects();if(h.length<2)return;if(!ko[n]){console.error("Invalid boolean operation:",n);return}const p=a.getBoundingRect(!0),v={x:p.left+p.width/2,y:p.top+p.height/2},_=dd(h[0]);s.discardActiveObject();const b=new fd.PaperScope;b.setup(new b.Size(5e3,5e3));let E=[];if(h.forEach(W=>{const ee=b.project.importSVG(W.toSVG(),{expandShapes:!0,insert:!1}),K=km(ee.children?.[0]??ee);(Array.isArray(K)?K:K?[K]:[]).forEach(le=>{if(!(!le||typeof le.divide!="function")){if(E.length===0){E.push(le);return}if(["divide","cut","xorSplit"].includes(n)){const ve=[];E.forEach(we=>{let F=ko[n](we,le);F&&(Array.isArray(F)||(F=[F]),F.forEach(ze=>{ze&&typeof ze.divide=="function"&&ve.push(ze)}))}),E=ve;return}if(["union","subtract","intersect","exclude","smartUnion","punch","crop"].includes(n)){const ve=ko[n](E[0],le);E=ve?[ve]:[E[0]]}}})}),!E||E.length===0)return;const O=`<svg xmlns="http://www.w3.org/2000/svg">${E.map(W=>W.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`)}</svg>`,{objects:Q}=await Lc(O);if(!Q||Q.length===0)return;if(s.remove(...h),Q.forEach(W=>{W.set({..._,strokeUniform:!0}),s.add(W)}),Q.length>1){const W=new Pi(Q,{canvas:s});s.setActiveObject(W)}else s.setActiveObject(Q[0]);s.requestRenderAll()}catch(s){console.error("Boolean operation error:",s),alert("Boolean operation failed. Check console for details.")}},booleanOperationfinal:async(n="union")=>{try{const s=e().canvas,a=s.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}const h=a.getObjects();if(h.length<2)return;if(!ko[n]){console.error("Invalid boolean operation:",n);return}const p=a.getBoundingRect(!0),v={x:p.left+p.width/2,y:p.top+p.height/2},_=dd(h[0]);s.discardActiveObject();const b=new fd.PaperScope;b.setup(new b.Size(5e3,5e3));let E=[];if(h.forEach((ee,K)=>{const ae=b.project.importSVG(ee.toSVG(),{expandShapes:!0,insert:!1}),le=km(ae.children?.[0]??ae);(Array.isArray(le)?le:[le]).forEach(we=>{if(!we)return;if(E.length===0){E.push(we);return}const F=ko[n](E[0],we);F&&(Array.isArray(F)?E=F:E=[F])})}),!E||E.length===0)return;const O=`<svg xmlns="http://www.w3.org/2000/svg">${E.map(ee=>ee.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`)}</svg>`,{objects:Q}=await Lc(O);if(!Q||Q.length===0)return;s.remove(...h),Q.forEach(ee=>{ee.set({..._,strokeUniform:!0}),s.add(ee)});const W=new Pi(Q,{canvas:s});s.setActiveObject(W),s.requestRenderAll()}catch(s){console.error("Boolean operation failed:",s),alert("Boolean operation failed. See console for details.")}},booleanOperation1:async(n="union")=>{const s=e().canvas,a=s.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}if(!oS[n]){console.error("Invalid boolean operation:",n);return}const h=a.getObjects();if(h.length<2)return;const p=a.getBoundingRect(!0);p.left+p.width/2,p.top+p.height/2;const v=h[0],_=dd(v);s.discardActiveObject();const b=new fd.PaperScope;b.setup(new b.Size(5e3,5e3));const E=nS(b,h,n);if(!E||E.length===0)return;const N=iS(b,E,n);if(!N)return;const{objects:O}=await Lc(`<svg xmlns="http://www.w3.org/2000/svg">${N}</svg>`);if(!O||O.length===0)return;O.forEach(W=>W.set({..._,strokeUniform:!0})),s.remove(...h),O.forEach(W=>s.add(W));const Q=new Pi(O,{canvas:s});s.setActiveObject(Q),s.requestRenderAll()},unionSelected(n){return e().booleanOperation("union",n)},intersectSelected(n){return e().booleanOperation("intersect",n)},subtractSelected(n){return e().booleanOperation("subtract",n)},excludeSelected(n){return e().booleanOperation("exclude",n)},divideSelected(n){return e().booleanOperation("divide",n)},cutSelected(n){return e().booleanOperation("cut",n)},punchSelected(n){return e().booleanOperation("punch",n)},cropSelected(n){return e().booleanOperation("crop",n)},smartUnionSelected(n){return e().booleanOperation("smartUnion",n)},xorSplitSelected(n){return e().booleanOperation("xorSplit",n)}});function km(l){return l.strokeWidth&&(l.strokeColor=null,l.strokeWidth=0,l.fill="black",l.closed=!0),l}const hS=(l,e,t)=>({MAX_HISTORY:20,_isRestoring:!1,undoStack:[],redoStack:[],saveState:()=>{const{canvas:n,_isRestoring:s,undoStack:a}=e();if(!n||s)return;const h=JSON.stringify(n.toJSON()),p=[...a,h];l({undoStack:p,redoStack:[]})},undo:()=>{const{canvas:n,undoStack:s,redoStack:a}=e();if(!n||s.length<=1)return;const h=JSON.stringify(n.toJSON()),p=s[s.length-1],v=s.slice(0,-1);l({_isRestoring:!0}),n.loadFromJSON(p,()=>{l({undoStack:v,redoStack:[h,...a],_isRestoring:!1}),n.requestRenderAll()})},redo:()=>{const{canvas:n,undoStack:s,redoStack:a}=e();if(!n||a.length===0)return;const h=JSON.stringify(n.toJSON()),p=a[0],v=a.slice(1);l({_isRestoring:!0}),n.loadFromJSON(p,()=>{l({undoStack:[...s,h],redoStack:v,_isRestoring:!1}),n.requestRenderAll()})},clearHistory:()=>l({undoStack:[],redoStack:[]})});function fS(l,e,t){return e&&!t?-l:!e&&t?180-l:l}function bl(l){return Math.round(l??0)}const dS=(l,e,t)=>({transform:{x:0,y:0,width:100,height:100,rotation:0,flipX:!1,flipY:!1,originX:"center",centerY:"center",id:"c"},hasSelection:!1,_isSyncing:!1,updateFromFabric:n=>{if(!n){l({hasSelection:!1});return}if(e()._isSyncing)return;const s={x:bl(n.left),y:bl(n.top),width:bl(n.getScaledWidth?.()??(n.width||0)*(n.scaleX||1)),height:bl(n.getScaledHeight?.()??(n.height||0)*(n.scaleY||1)),rotation:bl(n.angle||0),flipX:n.scaleX<0,flipY:n.scaleY<0},a=e().transform;(a.x!==s.x||a.y!==s.y||a.width!==s.width||a.height!==s.height||a.rotation!==s.rotation||a.flipX!==s.flipX||a.flipY!==s.flipY)&&l({transform:s,hasSelection:!0})},updateFabricFromStore1:()=>{const{transform:n,canvas:s}=e(),a=s?.getActiveObject();if(!a)return;l({_isSyncing:!0}),a.set({originX:"center",originY:"center",objectCaching:!1});const h=a._originalWidth||a.width||1,p=a._originalHeight||a.height||1;a._originalWidth||(a._originalWidth=h,a._originalHeight=p);const v=n.width/h,_=n.height/p;a.set({angle:n.rotation||0,scaleX:n.flipX?-Math.abs(v):Math.abs(v),scaleY:n.flipY?-Math.abs(_):Math.abs(_)}),a.setPositionByOrigin(new Ce(n.x,n.y),"center","center"),a.setCoords(),s.requestRenderAll(),l({_isSyncing:!1})},updateFabricFromStore:()=>{const{transform:n,canvas:s}=e(),a=s?.getActiveObject();if(!a||e()._isSyncing)return;l({_isSyncing:!0});const h=Number(n.x)||0,p=Number(n.y)||0,v=Math.max(1,Number(n.width)||1),_=Math.max(1,Number(n.height)||1),b=Number(n.rotation)||0,E=!!n.flipX,N=!!n.flipY,O=fS(b,E,N);a.set({left:h,top:p,width:v,height:_,angle:O,flipX:E,flipY:N}),a.setCoords(),s.requestRenderAll(),l({_isSyncing:!1})},updateFabricFromStore11:()=>{const{transform:n,canvas:s}=e(),a=s?.getActiveObject();if(!a||e()._isSyncing)return;l({_isSyncing:!0});const h=Number(n.x)||0,p=Number(n.y)||0,v=Number(n.width)||1,_=Number(n.height)||1;let b=Number(n.rotation)||0;const E=!!n.flipX,N=!!n.flipY;console.log(h,p),E&&!N?b=-b:!E&&N&&(b=180-b);const O=a.getCenterPoint();a.set({originX:"center",originY:"center",left:O.x,top:O.y,width:v,height:_,angle:b,flipX:E,flipY:N}),a.setCoords(),s.renderAll(),l({_isSyncing:!1})},setTransform:(n,s)=>{l(a=>({transform:{...a.transform,[n]:s}})),requestAnimationFrame(()=>e().updateFabricFromStore())},flipX:()=>{l(n=>({transform:{...n.transform,flipX:!n.transform.flipX}})),requestAnimationFrame(()=>e().updateFabricFromStore())},flipY:()=>{l(n=>({transform:{...n.transform,flipY:!n.transform.flipY}})),requestAnimationFrame(()=>e().updateFabricFromStore())},setOrigin:n=>{l(s=>({transform:{...s.transform,originX:n.originX,originY:n.originY,id:n.id}})),requestAnimationFrame(()=>e().updateFabricFromStore())}}),pS=(l,e,t)=>({addShape:(n,s={})=>{const a=e().canvas;if(!a)return;const{pageWidth:h,pageHeight:p,scale:v}=e(),_=h/4*v,b=p/2*v;s={...{left:_,top:b,originX:"center",originY:"center",selection:!0,hasControls:!0,customType:"shape"},...s};let N;switch(n){case"rect":N=new yr({width:80,height:80,fill:"transparent",stroke:"black",...s});break;case"circle":N=new Ir({radius:48,fill:"transparent",stroke:"black",...s});break;case"capsule":N=new yr({radius:48,fill:"transparent",stroke:"black",...s});break;case"ellipse":N=new Ci({rx:70,ry:45,fill:"transparent",stroke:"black",...s});break;case"triangle":N=new es({width:100,height:100,fill:"transparent",stroke:"black",...s});break;case"line":N=new li([50,50,200,50],{stroke:"black",strokeWidth:2,selectable:!0,hasControls:!0,hasBorders:!1,...s});break;case"polygon":case"pentagon":N=new ta(s.points||[{x:0,y:0},{x:50,y:0},{x:25,y:50}],{fill:"transparent",stroke:"black",...s});break;case"diamond":N=new ta([{x:0,y:s.height/2||40},{x:s.width/2||40,y:0},{x:s.width||80,y:s.height/2||40},{x:s.width/2||40,y:s.height||80}],{fill:"transparent",stroke:"black",...s});break;case"star":N=new ta(e().generateStarPoints(s.numPoints||5,s.outerRadius||50,s.innerRadius||20),{fill:"transparent",stroke:"black",...s});break;case"arrow":N=e().createArrowShape({...s});break;case"paper":{const O=new yr({width:300,height:80,fill:"#FFFFFF",originX:"center",originY:"center",stroke:1,fontFamily:"Bubblegum Sans"}),Q=new ns("Type to enter text",{fontSize:20,width:200,textAlign:"center",originX:"center",originY:"center",fontFamily:"Bubblegum Sans"});N=new ur([O,Q],s),N.__text=Q,N.__box=O,Q.__group=N}break;default:console.warn("Shape not supported:",n);return}a.add(N),a.setActiveObject(N),a.renderAll(),e().setToolbar({target:N}),e().updateFromFabric(N),e().saveState(),e().addLayer(N,n)},generateStarPoints:(n=5,s=50,a=20)=>{const h=[],p=Math.PI/n;for(let v=0;v<2*n;v++){const _=v%2===0?s:a,b=v*p-Math.PI/2;h.push({x:_*Math.cos(b),y:_*Math.sin(b)})}return h},createArrowShape:({width:n=120,stroke:s="black",strokeWidth:a=2,headLength:h=12,headWidth:p=12,left:v=0,top:_=0})=>{const b=new li([0,0,n,0],{stroke:s,strokeWidth:a,originX:"left",originY:"center"}),E=new es({width:h,height:p,fill:s,left:n,top:0,angle:90,originX:"center",originY:"center"});return new ur([b,E],{left:v,top:_,originX:"center",originY:"center"})}}),gS=["Arial","Bubblegum Sans","Comic Neue","Consolas","Courier New","Fredoka One","Georgia","Helvetica","Monaco","Palatino","Patrick Hand","Tahoma","Times New Roman","Trebuchet MS","Verdana"],mS=(l,e,t)=>({fonts:gS,fontSize:16,bgColor:"#000000",setBgColor:n=>l({bgColor:n}),setFontSize:n=>l({fontSize:n}),color:"#000000",hasShadow:!1,setHasShadow:n=>l({hasShadow:n}),shadowColor:"",setShadowColor:n=>l({shadowColor:n}),setColor:n=>l({color:n}),fontFamily:"Arial",setFontFamily:n=>l({fontFamily:n}),isBold:!1,setIsBold:n=>l({isBold:n}),isItalic:!1,setIsItalic:n=>l({isItalic:n}),isUnderline:!1,setIsUnderline:n=>l({isUnderline:n}),charSpacing:0,setCharSpacing:n=>l({charSpacing:n}),lineHeight:1.2,setLineHeight:n=>l({lineHeight:n}),strokeColor:"#000000",setStrokeColor:n=>l({strokeColor:n}),strokeWidth:1,setStrokeWidth:n=>l({strokeWidth:n}),fillColor:"#000000",setFillColor:n=>l({fillColor:n}),addText:(n={})=>{const s=e().canvas;if(!s)return;const{text:a="Enter text",fontSize:h=36,bold:p=!1,italic:v=!1,underline:_=!1,fontFamily:b="Bubblegum Sans",width:E=300,textColor:N="#000000",placeholderColor:O="#9ca3af"}=n,{pageWidth:Q,pageHeight:W,scale:ee}=e(),K=Q/4*ee,ae=W/2*ee,le=new ns(a,{left:K,top:ae,originX:"center",originY:"center",fontSize:h,fontWeight:p?"bold":"normal",fontStyle:v?"italic":"normal",underline:_,fill:O,fontFamily:b,width:E,editable:!0,objectCaching:!1,padding:6,splitByGrapheme:!0});le.on("editing:entered",()=>{le.fill===O&&(le.selectAll(),le.set("fill",N),s.requestRenderAll())}),le.on("editing:exited",()=>{le.text.trim()?le.set("fill",N):(le.text=a,le.set("fill",O)),s.requestRenderAll()}),s.add(le),s.setActiveObject(le),le.enterEditing(),setTimeout(()=>{le.hiddenTextarea?.focus(),le.selectAll()},0),l({showTextToolbar:!0,selectedObject:le}),e().saveState(),s.requestRenderAll()}});function vS(l){const[,e,t]=l.split("-");return Gy[e]?.[t]}const yS=(l,e,t)=>({backgroundColor:"#ff0000",borderColor:"#000000",borderWidth:"1",borderStyle:"solid",setBackgroundColor:n=>{const s=e().canvas;if(!s)return;const a=vS(n);if(!a)return;const h=s.getActiveObject();h&&(h.set("fill",a),s.requestRenderAll(),l({backgroundColor:n}))}}),_S=(l,e,t)=>({visible:!1,x:0,y:0,items:[],openMenu:(n,s,a)=>{const p=a.length*36,v=Math.min(n,window.innerWidth-220),_=Math.min(s,window.innerHeight-p);l({visible:!0,x:v,y:_,items:a})},closeMenu:()=>l({visible:!1})}),xS=(l,e,t)=>({...D2(l,e),...Y2(l,e),...R2(l,e),...F2(l,e),...N2(l,e),...H2(l,e),...G2(l,e),...cS(l,e),...hS(l,e),...dS(l,e),...pS(l,e),...mS(l,e),...yS(l,e),..._S(l)}),et=T2(xS);function wS(){const l=et(t=>t.commands),e=et(t=>t.runCommand);Te.useEffect(()=>{const t=n=>{const s=n.target;if(s.tagName==="INPUT"||s.tagName==="TEXTAREA"||s.isContentEditable)return;const a=[n.metaKey?"Meta":"",n.ctrlKey?"Ctrl":"",n.shiftKey?"Shift":"",n.altKey?"Alt":"",n.key.length===1?n.key.toLowerCase():n.key].filter(Boolean).join("+"),h=l.find(p=>p.shortcut?.some(v=>v.toLowerCase()===a.toLowerCase()));h&&(n.preventDefault(),e(h.id))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[l,e])}function Yy(l){var e,t,n="";if(typeof l=="string"||typeof l=="number")n+=l;else if(typeof l=="object")if(Array.isArray(l)){var s=l.length;for(e=0;e<s;e++)l[e]&&(t=Yy(l[e]))&&(n&&(n+=" "),n+=t)}else for(t in l)l[t]&&(n&&(n+=" "),n+=t);return n}function ci(){for(var l,e,t=0,n="",s=arguments.length;t<s;t++)(l=arguments[t])&&(e=Yy(l))&&(n&&(n+=" "),n+=e);return n}const qy=({options:l,value:e,onChange:t,className:n=""})=>Z.jsxs("div",{className:ci("relative inline-block",n),children:[Z.jsx("select",{value:e,onChange:s=>t(s.target.value),className:ci("w-full appearance-none rounded-md border border-gray-300 bg-white px-3 py-1 pr-8 text-sm shadow-sm","focus:border-blue-500 focus:ring-2 focus:ring-blue-400 focus:outline-none hover:border-gray-400 transition"),children:l.map(s=>Z.jsx("option",{value:s,style:{fontFamily:s},children:s},s))}),Z.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-500",children:""})]}),Cc=8,bS=300,Fo=({content:l,position:e="top",children:t})=>{const n=Te.useRef(null),s=Te.useRef(null),a=Te.useRef(null),[h,p]=Te.useState(!1),[v,_]=Te.useState({top:0,left:0}),[b,E]=Te.useState(e);Te.useEffect(()=>()=>{a.current&&window.clearTimeout(a.current)},[]);const N=()=>{a.current&&window.clearTimeout(a.current),a.current=window.setTimeout(()=>{a.current=null,p(!0)},bS)},O=()=>{a.current&&(window.clearTimeout(a.current),a.current=null),p(!1)};Te.useLayoutEffect(()=>{if(!h||!n.current||!s.current)return;const K=n.current.getBoundingClientRect(),ae=s.current.getBoundingClientRect(),le=ze=>{switch(ze){case"bottom":return{top:K.bottom+Cc,left:K.left+K.width/2-ae.width/2};case"left":return{top:K.top+K.height/2-ae.height/2,left:K.left-ae.width-Cc};case"right":return{top:K.top+K.height/2-ae.height/2,left:K.right+Cc};default:return{top:K.top-ae.height-Cc,left:K.left+K.width/2-ae.width/2}}};let ve=e,{top:we,left:F}=le(ve);we<4&&ve==="top"&&(ve="bottom"),we+ae.height>window.innerHeight&&ve==="bottom"&&(ve="top"),F<4&&ve==="left"&&(ve="right"),F+ae.width>window.innerWidth&&ve==="right"&&(ve="left"),{top:we,left:F}=le(ve),E(ve),_({top:Math.max(6,Math.round(we)),left:Math.max(6,Math.round(F))})},[h,e]);const Q=K=>{K.key==="Escape"&&O()},W=Te.useRef(`tooltip-${Math.random().toString(36).slice(2)}`),ee=typeof document<"u"?document.body:null;return Z.jsxs(Z.Fragment,{children:[Z.jsx("span",{ref:n,className:"inline-flex",onMouseEnter:N,onMouseLeave:O,onClick:O,onFocus:N,onBlur:O,onKeyDown:Q,tabIndex:0,"aria-describedby":l?W.current:void 0,children:t}),h&&ee?Jm.createPortal(Z.jsxs("div",{id:W.current,ref:s,role:"tooltip","aria-hidden":!h,style:{position:"fixed",top:v.top,left:v.left},className:"animate-tooltip z-[9999] rounded-md bg-white px-3 py-1.5 text-[11px] font-medium text-gray-900 shadow-[0_8px_24px_rgba(0,0,0,0.18)] whitespace-nowrap pointer-events-none animate-tooltip-min",children:[l,Z.jsx("div",{className:`absolute w-1.5 h-1.5 bg-white rotate-45 ${b==="top"?"bottom-[-3px] left-1/2 -translate-x-1/2":b==="bottom"?"top-[-3px] left-1/2 -translate-x-1/2":b==="left"?"right-[-3px] top-1/2 -translate-y-1/2":"left-[-3px] top-1/2 -translate-y-1/2"}`})]}),ee):null]})},ys=({options:l,value:e={},onChange:t,single:n=!1})=>{const[s,a]=Te.useState(e),h=26,p=_=>{let b;n?b=Object.fromEntries(l.map(E=>[E.key,E.key===_])):b={...s,[_]:!s[_]},a(b),t?.(b)},v=_=>typeof _=="string"?Z.jsx("i",{className:_,style:{fontSize:h*.55}}):_;return Z.jsx("div",{className:`
        inline-flex overflow-hidden
        rounded-lg
        border border-gray-200
        bg-white
        shadow-[0_1px_2px_rgba(0,0,0,0.03)]
      `,children:l.map(({key:_,icon:b,label:E,tooltip:N})=>{const O=s[_];return Z.jsx(Fo,{content:N,position:"bottom",children:Z.jsxs("button",{type:"button",onClick:()=>p(_),className:`
              flex items-center gap-1.5
              px-2.5 py-1.5
              text-[11px] font-medium
              transition-colors
              border-r border-gray-100 last:border-r-0

              ${O?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-50"}
            `,children:[v(b),E&&Z.jsx("span",{children:E})]},_)},_)})})},Vl=({label:l,value:e,onChange:t,min:n=0,max:s=100,step:a=1,className:h=""})=>{const p=()=>t(Math.min(s,e+a)),v=()=>t(Math.max(n,e-a));return Z.jsxs("div",{className:ci("inline-flex items-center gap-2",h),children:[l&&Z.jsxs("label",{className:"text-xs",children:[l,":"]}),Z.jsxs("div",{className:"relative inline-flex w-18 rounded-md shadow-sm",children:[Z.jsx("input",{type:"number",value:Number(e).toString(),onChange:_=>t(Number(_.target.value)),min:n,max:s,step:a,className:"w-full rounded-full border border-gray-300 bg-white px-3 py-[2px] text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-400 focus:outline-none hover:border-gray-400 transition appearance-textfield"}),Z.jsxs("div",{className:"absolute inset-y-1 right-1 flex flex-col divide-y border-l divide-gray-300 border-gray-300 bg-white rounded-r-md overflow-hidden",children:[Z.jsx("button",{type:"button",onClick:p,className:"flex-1 flex items-center justify-center px-1 text-gray-600 hover:bg-gray-100",children:Z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",stroke:"currentColor",children:Z.jsx("path",{d:"M2 5L4 3L6 5",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),Z.jsx("button",{type:"button",onClick:v,className:"flex-1 flex items-center justify-center px-1 text-gray-600 hover:bg-gray-100",children:Z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",stroke:"currentColor",children:Z.jsx("path",{d:"M2 3L4 5L6 3",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})]})};function SS({target:l,canvas:e,onChange:t}){const n=et(Q=>Q.fontSize),s=et(Q=>Q.setFontSize),a=et(Q=>Q.color),h=et(Q=>Q.setColor),p=et(Q=>Q.fontFamily),v=et(Q=>Q.setFontFamily);et(Q=>Q.isBold);const _=et(Q=>Q.setIsBold);et(Q=>Q.isItalic);const b=et(Q=>Q.setIsItalic);et(Q=>Q.isUnderline);const E=et(Q=>Q.setIsUnderline),N=et(Q=>Q.fonts),O=Te.useRef(null);return Te.useEffect(()=>{l&&(s(l.fontSize||16),h(l.fill||"#000000"),_(l.fontWeight==="bold"))},[l]),Te.useLayoutEffect(()=>{if(!l||!e||!O.current)return;const Q=O.current,W=()=>{if(!l||!Q)return;l.setCoords();const{tl:le,tr:ve,bl:we,br:F}=l.aCoords,ze=(le.x+ve.x)/2,He=(we.y+F.y)/2,Je=e.viewportTransform||[1,0,0,1,0,0],ut=Je[0]*ze+Je[2]*He+Je[4],Ie=Je[1]*ze+Je[3]*He+Je[5],Ke=e.getElement().getBoundingClientRect(),dt=8,Ve=Ke.left+ut,Bt=Ke.top+Ie+dt,Le=Q.getBoundingClientRect();Q.style.position="fixed",Q.style.left=`${Ve-Le.width/2}px`,Q.style.top=`${Bt}px`,Q.style.zIndex="500"};let ee=null;const K=()=>{ee==null&&(ee=requestAnimationFrame(()=>{ee=null,W()}))};W();const ae=["object:moving","object:scaling","object:rotating","object:modified","mouse:wheel","after:render"];return ae.forEach(le=>e.on(le,K)),window.addEventListener("resize",W),window.addEventListener("scroll",W,!0),()=>{ae.forEach(le=>e.off(le,K)),window.removeEventListener("resize",W),window.removeEventListener("scroll",W,!0),ee!=null&&cancelAnimationFrame(ee)}},[l,e]),l?Z.jsxs("div",{ref:O,className:"absolute z-50 flex items-center gap-2 bg-white shadow-lg rounded-full px-4 py-2",children:[Z.jsxs("label",{className:"relative cursor-pointer",children:[Z.jsx("input",{type:"color",value:a,onChange:Q=>{const W=Q.target.value;h(W),t?.({fill:W})},className:"absolute inset-0 opacity-0 cursor-pointer"}),Z.jsx("div",{className:"h-6 w-6 rounded-full border shadow-sm",style:{backgroundColor:a}})]}),Z.jsx(qy,{onChange:Q=>{console.log(Q),v(Q),t?.({fontFamily:Q})},options:N,value:p}),Z.jsx(Vl,{value:n,onChange:Q=>{const W=parseInt(String(Q),10);s(W),t?.({fontSize:W})}}),Z.jsx(ys,{options:[{key:"bold",icon:"fa-solid fa-bold"},{key:"italic",icon:"fa-solid fa-italic"},{key:"underline",icon:"fa-solid fa-underline"}],onChange:Q=>{console.log("formats:",Q);const{bold:W,italic:ee,underline:K}=Q;_(W),b(ee),E(K),t?.({fontWeight:W?"bold":"normal",fontStyle:ee?"italic":"normal",underline:K})}})]}):null}const CS=typeof navigator<"u"&&/Mac|iPhone|iPad/i.test(navigator.platform),So=(l,e)=>CS?l:e;function kS(){const l=Te.useRef(null),e=Te.useRef(null),{init:t,selectedObject:n,canvas:s,openMenu:a,fill:h}=et(),p=et();wS(),Te.useEffect(()=>(l.current&&(t(l.current),e.current=new Xy(s,()=>h)),()=>{s&&(s.dispose(),e.current?.disable(),e.current=null)}),[t]);const v=_=>{_.preventDefault(),a(_.clientX,_.clientY,[{label:"Copy",icon:Z.jsx("i",{className:"fa-solid fa-copy"}),shortcut:So("C","Ctrl+C"),when:()=>p.hasSelection,onClick:()=>p.copy()},{label:"Paste",icon:Z.jsx("i",{className:"fa-solid fa-paste"}),shortcut:So("V","Ctrl+V"),when:()=>p.canPaste(),onClick:()=>p.paste()},{label:"Duplicate",icon:Z.jsx("i",{className:"fa-solid fa-clone"}),shortcut:So("D","Ctrl+D"),when:()=>p.hasSelection,onClick:()=>p.duplicate()},{type:"divider"},{label:"Group",icon:Z.jsx("i",{className:"fa-solid fa-object-group"}),shortcut:So("G","Ctrl+G"),when:()=>p.hasMultipleSelection(),onClick:()=>p.groupLayers()},{label:"Ungroup",icon:Z.jsx("i",{className:"fa-solid fa-object-ungroup"}),shortcut:So("G","Ctrl+Shift+G"),when:()=>p.isGroupSelected(),onClick:()=>p.ungroupSelected()},{type:"divider"},{label:"Delete",icon:Z.jsx("i",{className:"fa-solid fa-trash"}),shortcut:So("","Del"),when:()=>p.hasSelection,onClick:()=>p.removeLayer()}])};return Z.jsxs("main",{className:"bg-white shadow-lg relative",onContextMenu:v,children:[Z.jsx("canvas",{ref:l}),n?.type==="textbox"&&s&&Z.jsx(SS,{target:n,canvas:s,onChange:_=>{n&&(n.set(_),s.requestRenderAll())}})]})}const Tm={tl:{x:"left",y:"top",left:"12%",top:"12%"},tr:{x:"right",y:"top",left:"88%",top:"12%"},c:{x:"center",y:"center",left:"50%",top:"50%"},bl:{x:"left",y:"bottom",left:"12%",top:"88%"},br:{x:"right",y:"bottom",left:"88%",top:"88%"}};function TS({size:l=24,value:e="c",onChange:t}){const n=Tm[e],s=l*.34;return Z.jsxs("div",{style:{width:l,height:l,position:"relative",cursor:"pointer"},children:[Z.jsx("div",{style:{position:"absolute",inset:2,borderRadius:3,border:"1px solid #cbd5e1",background:"linear-gradient(#ffffff, #f8fafc)"}}),Z.jsx("div",{style:{position:"absolute",inset:"50% 4px auto 4px",height:1,background:"#e2e8f0"}}),Z.jsx("div",{style:{position:"absolute",inset:"4px auto 4px 50%",width:1,background:"#e2e8f0"}}),Object.entries(Tm).map(([a,h])=>Z.jsx("div",{onClick:()=>t?.({originX:h.x,originY:h.y,id:a}),style:{position:"absolute",left:h.left,top:h.top,width:l*.45,height:l*.45,transform:"translate(-50%,-50%)"}},a)),e==="c"?Z.jsx("div",{style:{position:"absolute",left:n.left,top:n.top,width:s,height:s,borderRadius:"50%",background:"#ffffff",border:"2px solid #3b82f6",boxShadow:`
              0 1px 2px rgba(0,0,0,0.15),
              0 0 0 3px rgba(59,130,246,0.15)
            `,transform:"translate(-50%,-50%)",transition:"all 140ms ease"}}):Z.jsx("div",{style:{position:"absolute",left:n.left,top:n.top,width:s,height:s,borderRadius:"50%",background:"#3b82f6",boxShadow:`
              0 2px 4px rgba(0,0,0,0.2),
              0 0 0 3px rgba(59,130,246,0.25)
            `,transform:"translate(-50%,-50%)",transition:"all 140ms ease"}})]})}const kc=l=>Z.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...l,children:[Z.jsx("path",{d:"M10 5L3.5 19H10V5Z",className:"fill-current opacity-50"}),Z.jsx("path",{d:"M14 5L20.5 19H14V5Z",className:"fill-current"}),Z.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"21","stroke-width":"2","stroke-dasharray":"3 2","stroke-linecap":"round",className:"stroke-current"})]});function Yl({action:l,toggleType:e="switch",iconOn:t,iconOff:n,tooltipOn:s="",tooltipOff:a="",initial:h=!1,size:p=26,onChange:v}){const[_,b]=Te.useState(h),E=()=>{let O=_;e==="switch"&&(O=!_),e==="exclusive"&&(O=!0),b(O),v?.({action:l,value:O})},N=O=>typeof O=="string"?Z.jsx("i",{className:O,style:{fontSize:p*.55}}):O;return Z.jsx(Fo,{content:_?s:a,position:"bottom",children:Z.jsx("button",{onClick:E,style:{width:p,height:p,borderRadius:6,background:_?"linear-gradient(#3b82f6, #2563eb)":"linear-gradient(#ffffff, #f1f5f9)",border:"1px solid #cbd5e1",boxShadow:_?"0 2px 4px rgba(37,99,235,0.4)":"0 1px 2px rgba(0,0,0,0.12)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 140ms ease",color:_?"#fff":"#334155"},children:Z.jsx("div",{style:{width:p*.6,height:p*.6,display:"flex",alignItems:"center",justifyContent:"center"},children:N(_?t:n)})})})}const ES=({label:l,value:e=0,min:t=0,max:n=100,step:s=1,onChange:a,onKeyDown:h,unit:p,disabled:v,className:_=""})=>Z.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-500",children:[Z.jsxs("span",{children:[l,":"]}),Z.jsxs("div",{className:"flex items-center gap-0.5",children:[Z.jsx("input",{type:"number",min:t,max:n,step:s,value:e,disabled:v,onChange:b=>a?.(Number(b.target.value)),onKeyDown:h,className:`w-14 h-6 px-1.5 text-[11px] text-gray-500 border border-gray-200
            rounded bg-transparent focus:outline-none focus:border-gray-300`}),p&&Z.jsx("span",{className:"text-[10px] text-gray-400",children:p})]})]}),Ky=({label:l,value:e,disabled:t,onChange:n,max:s})=>{const a=p=>{const v=p;if(v===""){n(0);return}let _=parseInt(String(v),10);isNaN(_)&&(_=0),n(_==0?"":_)},h=p=>{(p.key==="."||p.key==="e")&&p.preventDefault()};return Z.jsx(ES,{label:l,value:e??0,onChange:a,disabled:t,onKeyDown:h,max:s})},OS=[{key:"x",label:"X"},{key:"y",label:"Y"},{key:"width",label:"W"},{key:"height",label:"H"},{key:"rotation",label:"R"}],PS=()=>{const l=et(K=>K.transform),e=et(K=>K.setTransform),t=et(K=>K.groupLayers),n=et(K=>K.ungroupSelected),s=et(K=>K.bringForward),a=et(K=>K.sendBackward),h=et(K=>K.bringToFront),p=et(K=>K.sendToBack),v=et(K=>K.toggleActiveObjectLock),_=et(K=>K.alignObjects),b=et(K=>K.hasSelection),E=et(K=>K.removeLayer),N=et(K=>K.setOrigin);et(K=>K.canvas);const[O,Q]=Te.useState(!1),W=(K,ae)=>{K==="group"?t():K==="ungroup"?n():K==="bringforward"?s():K==="sendbackward"?a():K==="sendtoback"?p():K==="bringtofront"?h():K==="lock"||K==="unlock"?v():K==="delete"&&E()},ee=(K,ae)=>{_(K)};return Z.jsx("div",{className:"px-5 py-2 overflow-x-auto shadow-sm bg-white",children:Z.jsxs("div",{className:"flex items-center justify-between whitespace-nowrap text-sm",children:[Z.jsxs("div",{className:"flex items-center gap-4",children:[Z.jsx(TS,{size:24,value:l.id,onChange:K=>{console.log(K),N(K)}}),Z.jsx("div",{className:"flex items-center gap-2",children:OS.map(K=>Z.jsx(Ky,{label:K.label,value:l[K.key],disabled:!b,onChange:ae=>e(K.key,ae)},K.key))}),Z.jsx("div",{className:"border-l h-6 border-gray-300"}),Z.jsx(Yl,{action:"flipX",toggleType:"switch",iconOn:Z.jsx(kc,{className:"cursor-pointer"}),iconOff:Z.jsx(kc,{className:"cursor-pointer"}),tooltipOn:"Flipped horizontally",tooltipOff:"Flip horizontally",initial:!1,onChange:K=>{const{action:ae,value:le}=K;console.log(ae,le),e(ae,le)}}),Z.jsx(Yl,{action:"flipY",toggleType:"switch",iconOn:Z.jsx(kc,{className:"rotate-90 cursor-pointer"}),iconOff:Z.jsx(kc,{className:"rotate-90 cursor-pointer"}),tooltipOn:"Flipped vertically",tooltipOff:"Flip vertically",initial:!1,onChange:K=>{console.log(K);const{action:ae,value:le}=K;e(ae,le)}})]}),Z.jsxs("div",{className:"flex items-center gap-4",children:[Z.jsx(ys,{single:!0,options:[{key:"group",icon:"fa-solid fa-object-group",tooltip:"Group"},{key:"ungroup",icon:"fa-solid fa-object-ungroup",tooltip:"Ungroup"}],onChange:K=>{const{group:ae,ungroup:le}=K,ve=Object.entries(K).find(([we,F])=>F);if(console.log("Group:",ve),ve){const[we,F]=ve;W(we)}}}),Z.jsx("div",{className:"border-l h-6 border-gray-300"}),Z.jsx(Yl,{action:"lock",toggleType:"switch",iconOn:"fa-solid fa-lock",iconOff:"fa-solid fa-unlock",tooltipOn:"Locked",tooltipOff:"Unlocked",initial:!1,onChange:K=>{const{action:ae,value:le}=K;console.log(ae,le),W(ae)}}),Z.jsx(ys,{single:!0,options:[{key:"sendbackward",icon:"fa-solid fa-angle-down",tooltip:"Send backward"},{key:"bringforward",icon:"fa-solid fa-angle-up",tooltip:"Bring forward"}],onChange:K=>{const{sendtoback:ae,bringtofront:le}=K,ve=Object.entries(K).find(([we,F])=>F);if(console.log("Back:",ve),ve){const[we,F]=ve;W(we)}}}),Z.jsx(ys,{single:!0,options:[{key:"sendtoback",icon:"fa-solid fa-angles-down",tooltip:"Send to back"},{key:"bringtofront",icon:"fa-solid fa-angles-up",tooltip:"Bring to front"}],onChange:K=>{const{sendtoback:ae,bringtofront:le}=K,ve=Object.entries(K).find(([we,F])=>F);if(console.log("Back:",ve),ve){const[we,F]=ve;W(we)}}}),Z.jsx(ys,{single:!0,options:[{key:"left",icon:"fa-solid fa-align-left",tooltip:"Align Left"},{key:"center",icon:"fa-solid fa-align-center",tooltip:"Align Center"},{key:"right",icon:"fa-solid fa-align-right",tooltip:"Align Right"}],onChange:K=>{console.log("align:",K);const{left:ae,center:le,right:ve,justify:we}=K;let F="align-left";le?F="align-hcenter":ve&&(F="align-right"),ee(F)}}),Z.jsx("div",{className:"border-l h-6 border-gray-300"}),Z.jsx(ys,{single:!0,options:[{key:"top",icon:"fa-solid fa-align-left rotate-90",tooltip:"Align Top"},{key:"middle",icon:"fa-solid fa-align-center -rotate-90",tooltip:"Align Middle"},{key:"bottom",icon:"fa-solid fa-align-right rotate-90",tooltip:"Align Bottom"}],onChange:K=>{console.log("align:",K);const{top:ae,middle:le,bottom:ve}=K;let we="align-left";ae?we="align-top":le?we="align-vcenter":ve&&(we="align-bottom"),ee(we)}}),Z.jsx(ys,{single:!0,options:[{key:"distribute-h",icon:"fa-solid fa-align-left rotate-90",tooltip:"Distribute horizontally"},{key:"distribute-v",icon:"fa-solid fa-align-center -rotate-90",tooltip:"Distribute vertically"}],onChange:K=>{console.log("align:",K);const{"distribute-v":ae,"distribute-h":le}=K;let ve="align-left";le?ve="distribute-h":ae&&(ve="distribute-v"),ee(ve)}})]})]})})};function nu({icon:l,active:e,className:t,...n}){return Z.jsx("button",{...n,className:ci("flex items-center justify-center cursor-pointer transition h-8 w-8 p-2 rounded-sm",e?"bg-blue-500 text-white hover:bg-blue-600":"hover:bg-stone-200",t),children:l})}const Rd=({src:l,...e})=>Z.jsx(Z.Fragment,{children:Z.jsx("img",{src:l,...e})});function Tc({label:l,value:e,onChange:t,className:n=""}){return Z.jsxs("label",{className:"inline-flex items-center gap-1.5 text-[11px] text-gray-600",children:[l?Z.jsxs("span",{className:"font-medium",children:[l,":"]}):null,Z.jsx("div",{className:"w-5 h-5 rounded-full p-[2px] border border-gray-200 shadow-sm",style:{backgroundColor:e},children:Z.jsx("input",{type:"color",value:e,onChange:s=>t?.(s.target.value),className:`w-full h-full rounded-full opacity-0 cursor-pointer ${n}`})})]})}const AS=()=>{const{canvas:l}=et(),e=et(Ie=>Ie.fontSize),t=et(Ie=>Ie.setFontSize),n=et(Ie=>Ie.bgColor),s=et(Ie=>Ie.setBgColor),a=et(Ie=>Ie.color);et(Ie=>Ie.setColor);const h=et(Ie=>Ie.hasShadow),p=et(Ie=>Ie.setHasShadow),v=et(Ie=>Ie.shadowColor),_=et(Ie=>Ie.setShadowColor),b=et(Ie=>Ie.fontFamily),E=et(Ie=>Ie.setFontFamily);et(Ie=>Ie.align),et(Ie=>Ie.setAlign),et(Ie=>Ie.isBold);const N=et(Ie=>Ie.setIsBold);et(Ie=>Ie.isItalic);const O=et(Ie=>Ie.setIsItalic);et(Ie=>Ie.isUnderline);const Q=et(Ie=>Ie.setIsUnderline),W=et(Ie=>Ie.charSpacing),ee=et(Ie=>Ie.setCharSpacing),K=et(Ie=>Ie.lineHeight),ae=et(Ie=>Ie.setLineHeight),le=et(Ie=>Ie.strokeWidth),ve=et(Ie=>Ie.setStrokeWidth),we=et(Ie=>Ie.strokeColor),F=et(Ie=>Ie.setStrokeColor),ze=et(Ie=>Ie.fillColor),He=et(Ie=>Ie.setFillColor),Je=et(Ie=>Ie.fonts),ut=Ie=>{const Ke=l?.getActiveObject();Ke&&Ke.type.includes("text")&&(Ke.set(Ie),l.requestRenderAll())};return Te.useEffect(()=>{if(!l)return;const Ie=()=>{const Ke=l.getActiveObject();Ke&&Ke.type.includes("text")&&(t(Ke.fontSize||24),E(Ke.fontFamily||"Arial"))};return l.on("selection:created",Ie),l.on("selection:updated",Ie),()=>{l.off("selection:created",Ie),l.off("selection:updated",Ie)}},[l]),Z.jsx("div",{className:"px-5 py-2 flex flex-wrap gap-3 overflow-x-auto items-center bg-white shadow-sm text-sm",children:Z.jsxs("div",{className:"flex items-center justify-between whitespace-nowrap text-sm gap-4",children:[Z.jsx(Tc,{label:"BG",value:n,onChange:Ie=>{s(a),ut({backgroundColor:Ie})}}),Z.jsx(Tc,{label:"TXT",value:ze,onChange:Ie=>{He(Ie),ut({fill:Ie})}}),Z.jsx(qy,{onChange:Ie=>{console.log(Ie),E(Ie),ut({fontFamily:Ie})},options:Je,value:b}),Z.jsx(Vl,{value:e,onChange:Ie=>{const Ke=parseInt(String(Ie),10);t(Ke),ut({fontSize:Ke})}}),Z.jsx(ys,{options:[{key:"bold",icon:"fa-solid fa-bold",tooltip:"Bold"},{key:"italic",icon:"fa-solid fa-italic",tooltip:"Italic"},{key:"underline",icon:"fa-solid fa-underline",tooltip:"Underline"}],onChange:Ie=>{console.log("formats:",Ie);const{bold:Ke,italic:dt,underline:Ve}=Ie;N(Ke),O(dt),Q(Ve),ut({fontWeight:Ke?"bold":"normal"}),ut({fontStyle:dt?"italic":"normal"}),ut({underline:Ve})}}),Z.jsx(ys,{single:!0,options:[{key:"left",icon:"fa-solid fa-align-left",tooltip:"Left Align"},{key:"center",icon:"fa-solid fa-align-center",tooltip:"Center Align"},{key:"right",icon:"fa-solid fa-align-right",tooltip:"Right Align"},{key:"justify",icon:"fa-solid fa-align-justify",tooltip:"Justify"}],onChange:Ie=>{console.log("align:",Ie);const{left:Ke,center:dt,right:Ve,justify:Bt}=Ie;let Le="left";dt?Le="center":Ve?Le="right":Bt&&(Le="justify"),ut({textAlign:Le})}}),Z.jsxs("div",{className:"flex items-center gap-2",children:[Z.jsx(Tc,{label:"Stroke",value:we,onChange:Ie=>{F(Ie),ut({stroke:Ie})}}),Z.jsx(Vl,{label:"STR",max:10,value:le,onChange:Ie=>{const Ke=parseInt(String(Ie),10);ve(Ke),ut({strokeWidth:Ke})}})]}),Z.jsxs("div",{className:"flex items-center gap-2",children:[Z.jsx(Vl,{label:"LH",step:.1,value:K,onChange:Ie=>{const Ke=parseFloat(String(Ie));ae(Ke),ut({lineHeight:Ke})}}),Z.jsx(Vl,{label:"LS",value:W,onChange:Ie=>{const Ke=parseInt(String(Ie),10);ee(Ke),ut({charSpacing:Ke})}})]}),Z.jsx(nu,{icon:Z.jsx("i",{className:"fa-solid fa-square text-xs"}),onClick:()=>{const Ie=!h;p(Ie),ut({shadow:Ie?{color:v,blur:5,offsetX:2,offsetY:2}:null})},active:h,title:"Shadow"}),h&&Z.jsx(Tc,{label:"Shadow",value:v,onChange:Ie=>{_(Ie),ut({shadow:{color:Ie,blur:5,offsetX:2,offsetY:2}})}})]})})},Ma=({children:l,onClick:e,position:t="middle"})=>{const n=t==="top"?"hover:rounded-t-lg":t==="bottom"?"hover:rounded-b-lg":"";return Z.jsx("button",{onClick:e,className:`w-full text-left px-4 py-2 text-sm hover:bg-stone-200 hover:text-stone-900
        ${n}`,children:l})},MS=({trigger:l,children:e})=>{const[t,n]=Te.useState(!1),s=Te.useRef(null);return Te.useEffect(()=>{const a=h=>{s.current&&!s.current.contains(h.target)&&n(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),Z.jsxs("div",{className:"relative inline-block",ref:s,children:[Z.jsx(nu,{icon:l,onClick:()=>n(!t),title:"Menu"}),t&&Z.jsx("div",{className:"z-1000 absolute right-0 mt-2 w-40 rounded-lg bg-white shadow-lg ring-1 ring-black/10 bg-white text-gray-500",children:e})]})};function IS(){const l=Bd(),e=et(O=>O.canvas),t=et(O=>O.toggleGrid),n=et(O=>O.clearBoard),[s,a]=Te.useState(!1),h=Te.useRef(null),{selectedObject:p}=et(),v=()=>{if(!e)return;const O=JSON.stringify(e.toJSON(["backgroundColor","customId"])),Q=new Blob([O],{type:"application/json"}),W=document.createElement("a");W.href=URL.createObjectURL(Q),W.download="drawing.fateboard",W.click(),URL.revokeObjectURL(W.href)},_=()=>{h.current?.click()},b=O=>{if(!O)return;const Q=O.getActiveObject();if(!Q)return alert("Select something first");const W=Q.toSVG(),ee=new Blob([W],{type:"image/svg+xml"}),K=URL.createObjectURL(ee),ae=document.createElement("a");ae.href=K,ae.download="selection.svg",ae.click(),URL.revokeObjectURL(K)},E=(O,Q="whiteboard.svg")=>{if(!O)return;const W=O.toSVG(),ee=new Blob([W],{type:"image/svg+xml;charset=utf-8"}),K=URL.createObjectURL(ee),ae=document.createElement("a");ae.href=K,ae.download=Q,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(K)},N=O=>{const Q=O.target.files?.[0];if(!Q||!e)return;const W=new FileReader;W.onload=ee=>{try{const K=ee.target?.result;let ae=null;if(typeof K=="string"?ae=K:K instanceof ArrayBuffer&&(ae=new TextDecoder().decode(K)),!ae)throw new Error("Invalid file content");const le=JSON.parse(ae);e.clear(),e.loadFromJSON(le,()=>{e.requestRenderAll()})}catch(K){console.error("Failed to load canvas:",K)}},W.readAsText(Q)};return Z.jsx("header",{className:"fixed top-0 left-0 right-0 bg-stone-100 flex flex-row justify-between items-center z-50",children:Z.jsxs("div",{className:"flex flex-col w-full",children:[Z.jsxs("div",{className:"flex items-center justify-between w-full shadow-sm px-2",children:[Z.jsx(Rd,{src:"fate.svg",className:"h-10 cursor-pointer hidden md:block"}),Z.jsx(Rd,{src:"fateicon.svg",className:"h-8 cursor-pointer md:hidden"}),Z.jsxs("div",{className:"flex gap-4 p-2",children:[Z.jsx("input",{type:"file",accept:".fateboard",ref:h,className:"hidden",onChange:N}),Z.jsx(Fo,{position:"bottom",content:"Grid View",children:Z.jsx(nu,{active:s,icon:Z.jsx("i",{className:"fa-solid fa-table-cells-large"}),onClick:()=>{a(!s),t()},title:"Grid View"})}),Z.jsx(Fo,{position:"bottom",content:"Create New Board",children:Z.jsx(nu,{icon:Z.jsx("img",{src:"/edit.svg",alt:"New Draw",height:"16"}),onClick:n,title:"Grid View"})}),Z.jsx("div",{className:"flex items-center justify-center cursor-pointer hover:bg-stone-200 h-8 w-8 rounded-sm",children:Z.jsxs(MS,{trigger:Z.jsx("i",{className:"fa-solid fa-ellipsis-vertical cursor-pointer"}),children:[Z.jsx(Ma,{position:"top",onClick:n,children:"Create"}),Z.jsx(Ma,{onClick:v,children:"Save"}),Z.jsx(Ma,{onClick:()=>E(e),children:"Download Svg"}),Z.jsx(Ma,{onClick:()=>b(e),children:"Download Selected"}),Z.jsx(Ma,{onClick:_,children:"Load"}),Z.jsx(Ma,{onClick:()=>l("/command-palette"),children:"Command Palette"}),Z.jsx(Ma,{position:"bottom",onClick:()=>l("/setting"),children:"Settings"})]})})]})]}),p==="shape"&&Z.jsx(PS,{}),p&&p?.type==="textbox"&&Z.jsx(AS,{})]})})}function jS(l,e,t){switch(l){case"left":return{top:e.top-10,left:e.right+18};case"right":return{top:e.top,left:e.left-t.width-18};case"top":return{top:e.bottom+18,left:e.left};case"bottom":return{top:e.top-t.height-18,left:e.left};default:return{top:e.top,left:e.right+18}}}function LS({tools:l,activeTool:e,onToolClick:t,position:n}){const s=et(h=>h.isActiveObjectLocked()),a={left:"fixed top-1/2 left-2 -translate-y-1/2 flex-col",right:"fixed top-1/2 right-2 -translate-y-1/2 flex-col",top:"fixed top-0 left-1/2 -translate-x-1/2 flex-row",bottom:"fixed bottom-0 left-1/2 -translate-x-1/2 flex-row"};return Z.jsx("div",{className:`flex justify-center items-center bg-white border border-stone-200 shadow rounded-md gap-2 z-50 p-2 ${a[n]}`,children:l.map(h=>{const p=h.id==="lock"?s?"fa-solid fa-lock":"fa-solid fa-unlock":h.icon;return Z.jsx(Fo,{content:h.tooltip,position:h.position,children:Z.jsx("button",{onClick:v=>t(h.id,v),className:ci("flex justify-center items-center cursor-pointer h-8 w-8 p-2 rounded-md",e===h.id?"bg-blue-500 text-white hover:bg-blue-600":"hover:bg-stone-200"),children:Z.jsx("i",{className:p})},h.id)},h.id)})})}function DS({isOpen:l,position:e,from:t="left",children:n}){return e?Jm.createPortal(Z.jsx("aside",{style:{position:"fixed",top:"50%",left:`${e.left}px`},className:ci("bg-stone-100 border border-stone-200 rounded-md shadow-lg w-70 p-4 z-50 transform -translate-y-1/2 transition-all duration-300 ease-out",l?"opacity-100 translate-x-0 pointer-events-auto":t==="left"?"-translate-x-4 opacity-0 pointer-events-none":"translate-x-4 opacity-0 pointer-events-none"),children:n}),document.body):null}const RS=(l,e)=>({select:()=>l.setActiveTool("select"),pan:()=>l.setActiveTool("pan"),draw:()=>l.setActiveTool("draw"),shapes:()=>{},text:()=>l.addText({}),delete:()=>e(),undo:()=>l.undo(),redo:()=>l.redo(),group:()=>l.groupLayers(),ungroup:()=>l.ungroupSelected(),forward:()=>l.bringForward(),backward:()=>l.sendBackward(),forwards:()=>l.bringToFront(),backwards:()=>l.sendToBack(),lock:()=>l.toggleActiveObjectLock(),fullscreen:()=>l.toggleFullscreen(),zoomIn:()=>l.zoomIn(),zoomOut:()=>l.zoomOut(),zoomFit:()=>l.zoomFit(),copy:()=>l.copy(),paste:()=>l.paste(),duplicate:()=>l.duplicate()}),FS=(l,e,t)=>{if(!l?.component)return null;const n=e.currentTarget.getBoundingClientRect(),s=l.panelSize||{width:288,height:300};return jS(t,n,s)};function NS({config:l,toolbarPosition:e="left"}){const[t,n]=Te.useState(null),[s,a]=Te.useState(null),h=et(),p=h.removeLayer,v=RS(h,p),_=(E,N)=>{const O=l.find(Q=>Q.id===E);if(O){if(O.type==="momentary"){h.setActiveTool(E),setTimeout(()=>h.setActiveTool(null),400),v[E]?.();return}if(O.type==="exclusive"){h.activeTool===E?(h.setActiveTool("select"),n(null)):(h.setActiveTool(E),n(null),v[E]?.());return}if(O.type==="panel"){t===E?(n(null),h.setActiveTool("select")):(n(E),a(FS(O,N,e)),h.setActiveTool(E),v[E]?.());return}}},b=E=>{const N=l.find(O=>O.id===E);N&&(n(null),N.id!=="draw"&&h.setActiveTool("select"))};return Z.jsxs(Z.Fragment,{children:[Z.jsx(LS,{tools:l,activeTool:h.activeTool,onToolClick:_,position:e}),l.map(E=>t===E.id&&E.component&&Z.jsx(DS,{isOpen:!0,position:s,from:e,children:typeof E.component=="function"?Z.jsx(E.component,{closePanel:()=>b(E.id)}):E.component},E.id))]})}const BS=({onClick:l,size:e=24,className:t="",title:n="Close"})=>Z.jsx("button",{onClick:l,title:n,"aria-label":n,className:ci("flex items-center justify-center rounded-full hover:bg-gray-200 cursor-pointer",t),style:{width:e,height:e},children:""});function Zy({title:l,onClose:e}){return Z.jsxs("div",{className:"flex items-center justify-between pb-3",children:[Z.jsx("h3",{className:"text-lg font-bold text-gray-800",children:l}),Z.jsx(BS,{onClick:e})]})}function zS({closePanel:l}){et(v=>v.canvas);const e=et(v=>v.color),t=et(v=>v.setBrushColor),n=et(v=>v.width),s=et(v=>v.setBrushWidth),a=et(v=>v.brush),h=et(v=>v.setBrush),p=["pencil","circle","spray","pattern","eraser"];return Z.jsxs("div",{className:"bg-gray-100 w-60 p-3 flex flex-col gap-4",children:[Z.jsx(Zy,{title:"Draw",onClose:l}),Z.jsxs("div",{className:"grid grid-cols-[8%_92%] grid-rows-[auto_auto_auto] w-full",children:[Z.jsx("div",{className:"row-span-4 flex flex-col items-center justify-center gap-4 h-48",children:Z.jsx("input",{type:"range",min:"1",max:"50",value:n,onChange:v=>s({width:Number(v.target.value)}),className:"rotate-[-90deg] w-48 cursor-pointer"})}),Z.jsxs("div",{className:"flex items-center justify-between pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Color:"}),Z.jsx("input",{type:"color",value:e,onChange:v=>t({color:v.target.value}),className:"w-6 h-6 p-0 rounded border"})]}),Z.jsxs("div",{className:"flex items-center justify-between pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Brush:"}),Z.jsx("select",{value:a,onChange:v=>h({color:e,width:n,brush:v.target.value}),className:"ml-2 border rounded p-1 flex-1",children:p.map(v=>Z.jsx("option",{value:v,children:v.charAt(0).toUpperCase()+v.slice(1)},v))})]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Width:"}),[15,10,5,4,2].map(v=>Z.jsx("div",{onClick:()=>s({width:v}),className:`rounded-full border cursor-pointer flex items-center justify-center transition-transform
                        ${n===v?"scale-110 border-blue-500":"border-gray-400"}`,style:{width:`${v*2}px`,height:`${v*2}px`,backgroundColor:e}},v))]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("div",{className:"flex items-center justify-center rounded-full border h-6 w-6",style:{backgroundColor:e,borderColor:"#333"},children:Z.jsx("span",{className:"text-xs text-white select-none",children:a.charAt(0).toUpperCase()})}),Z.jsxs("span",{className:"text-sm",children:[n,"px"]})]})]})]})}const Em=[{type:"rect",icon:"fa-regular fa-square",defaultProps:{width:120,height:80,rx:0,ry:0,fill:"transparent",stroke:"black"}},{type:"circle",icon:"fa-solid fa-circle",defaultProps:{radius:48,fill:"transparent",stroke:"black"}},{type:"paper",icon:"fa-solid fa-square-pen",defaultProps:{with:120,height:80,fill:"transparent",strock:"black"}},{type:"triangle",icon:"fas fa-play rotate-270",defaultProps:{width:100,height:100,fill:"transparent",stroke:"black"}},{type:"ellipse",icon:"fa-solid fa-circle transform scale-x-120",defaultProps:{rx:70,ry:45,fill:"transparent",stroke:"black"}},{type:"line",icon:"fa-solid fa-slash",defaultProps:{strokeWidth:2,stroke:"black"}},{type:"polygon",icon:"fa-solid fa-caret-up",defaultProps:{points:[{x:50,y:0},{x:100,y:50},{x:75,y:100},{x:25,y:100},{x:0,y:50}],fill:"transparent",stroke:"black",strokeWidth:2}},{type:"star",icon:"fa-solid fa-star",defaultProps:{numPoints:5,innerRadius:20,outerRadius:50,fill:"transparent",stroke:"black",strokeWidth:2}},{type:"arrow",icon:"fa-solid fa-arrow-up",defaultProps:{width:120,height:20,fill:"transparent",stroke:"black",strokeWidth:3,headLength:15}},{type:"diamond",icon:"fa-solid fa-gem",defaultProps:{width:80,height:80,fill:"transparent",stroke:"black",strokeWidth:2,angle:45}},{type:"pentagon",icon:"fa-solid fa-star-half-stroke",defaultProps:{points:[{x:50,y:0},{x:95,y:38},{x:78,y:90},{x:22,y:90},{x:5,y:38}],fill:"transparent",stroke:"black",strokeWidth:2}}],VS=()=>{const l=et(N=>N.canvas),e=et(N=>N.addShape),t=et(N=>N.setActiveTool),n=(N,O={})=>{if(!l)return;const Q=Em.find(W=>W.type===N);Q&&e(N,{...Q.defaultProps,...O})};let s=null,a=!1,h=!1;const p=N=>{if(N.target)return;a=!0;const O=l.getPointer(N.e),Q=[O.x,O.y,O.x,O.y];s=new li(Q,{strokeWidth:2,stroke:"black",selectable:!0,evented:!0}),l.add(s)},v=N=>{if(!a||!s)return;const O=l.getPointer(N.e);s.set({x2:O.x,y2:O.y}),l.renderAll()},_=()=>{a&&(a=!1,s=null,t("select"),E())},b=()=>{!l||h||(l.on("mouse:down",p),l.on("mouse:move",v),l.on("mouse:up",_),h=!0,l.isDrawingMode=!1)},E=()=>{!l||!h||(l.off("mouse:down",p),l.off("mouse:move",v),l.off("mouse:up",_),h=!1)};return{shapesList:Em,add:n,enableLineDrawing:b,disableLineDrawing:E}};function WS({closePanel:l}){const{fill:e,stroke:t,strokeWidth:n,strokeStyle:s,strokeStyleList:a,setFill:h,setStroke:p,setStrokeWidth:v,setStrokeStyle:_}=et(),{shapesList:b,add:E,enableLineDrawing:N}=VS(),O={fill:e,stroke:t,strokeWidth:n};function Q(W){W==="line"?N():E(W,O),l?.(W)}return Z.jsxs("div",{className:"bg-gray-100 w-60 p-3 flex flex-col gap-4",children:[Z.jsx(Zy,{title:"Shapes",onClose:l}),Z.jsxs("div",{className:"grid grid-cols-[8%_92%] grid-rows-[auto_auto_auto] w-full",children:[Z.jsx("div",{className:"row-span-4 flex flex-col items-center justify-center gap-4 h-48",children:Z.jsx("input",{type:"range",min:"0",max:"16",value:n,onChange:W=>v(Number(W.target.value)),className:"rotate-[-90deg] w-48 cursor-pointer"})}),Z.jsx("div",{className:"flex items-center justify-between pl-4 flex-wrap py-4",children:b.map(W=>Z.jsx("button",{className:"rounded-sm hover:bg-gray-200 h-8 w-8 cursor-pointer",onClick:()=>Q(W.type),title:W.type,children:Z.jsx("i",{className:W.icon})},W.type))}),Z.jsxs("div",{className:"flex items-center justify-between pl-4 py-2",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Stork:"}),Z.jsx("input",{type:"color",value:t,onChange:W=>p(W.target.value),className:"w-6 h-6 p-0 rounded border"}),Z.jsx("span",{className:"text-sm font-medium",children:"Fill:"}),Z.jsx("input",{type:"color",value:e,onChange:W=>h(W.target.value),className:"w-6 h-6 p-0 rounded border"})]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Width:"}),Z.jsx("select",{value:s,onChange:W=>_(W.target.value),className:"ml-2 border rounded p-1 flex-1",children:a.map(W=>Z.jsx("option",{value:W.value,children:W.label},W.label))})]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("div",{className:"flex items-center justify-center rounded-full border h-6 w-6",style:{backgroundColor:e,borderColor:"#333"},children:Z.jsx("span",{className:"text-xs text-white select-none",children:"A"})}),Z.jsxs("span",{className:"text-sm",children:[e,"px"]})]})]})]})}const US=[{id:"select",type:"exclusive",icon:"fa-solid fa-location-arrow rotate-280",position:"left",component:null,tooltip:"Selector Tool"},{id:"pan",type:"exclusive",icon:"fa-solid fa-hand",position:"left",component:null,tooltip:"Hand Tool"},{id:"draw",type:"panel",icon:"fa-solid fa-pencil",position:"left",component:zS,panelSize:{width:300,height:250},tooltip:"Pencil Tool"},{id:"shapes",type:"panel",icon:"fa-solid fa-shapes",position:"left",component:l=>Z.jsx(WS,{...l,panelId:"shapes"}),tooltip:"Shape Builder Tool"},{id:"text",type:"momentary",icon:"fa-solid fa-font",position:"left",component:null,tooltip:"Text Tool"}],HS=()=>{const l=et(t=>t.toggleFullscreen),e=et(t=>t.isFullScreen);return Z.jsx(Fo,{position:"bottom",content:"Fullscreen",children:Z.jsx(nu,{active:e,icon:Z.jsx("i",{className:`fa-solid ${e?"fa-compress":"fa-expand"}`}),onClick:l,title:"Toggle Fullscreen",className:"border border-stone-200"})})},XS=({colorTool:l,zoomTool:e,strokeTool:t})=>Z.jsxs("div",{className:"flex bg-white flex-col items-start px-2 py-1",children:[l&&Z.jsx("div",{className:"flex-1 flex justify-center",children:l}),Z.jsxs("div",{className:"flex items-center gap-2",children:[e&&Z.jsx("div",{className:"flex py-1",children:e}),t&&Z.jsx("div",{className:"flex py-1",children:t})]})]}),GS=({bgColor:l,isActive:e=!1,onClick:t,className:n=""})=>Z.jsx("div",{onClick:t,role:"button",tabIndex:0,className:ci("relative w-8 h-5 ml-px mb-px border border-stone-300 cursor-pointer",l,n),children:e&&Z.jsx("span",{className:"absolute inset-0 m-auto w-2 h-2 rounded-full bg-white",style:{boxShadow:"0 0 0 1px #000"}})}),YS=({fill:l,bgColors:e,onClick:t})=>Z.jsx(Z.Fragment,{children:[...e].reverse().map((n,s)=>Z.jsx(GS,{bgColor:n,isActive:n===l,onClick:()=>t(n,l)},s))}),qS=({scrollRef:l,fill:e,bgColors:t,colorsMap:n,onClick:s})=>Z.jsx(Z.Fragment,{children:Z.jsx("div",{ref:l,className:"h-10 bg-white w-full flex flex-wrap gap-0.01 max-h-64 overflow-y-auto",children:t.flatMap((a,h)=>Z.jsx(YS,{fill:e,bgColors:n[a],onClick:s},`${a}-${h}`))})}),KS=({scrollRef:l,className:e=""})=>{const[t,n]=Te.useState(!1),[s,a]=Te.useState(!1),h=()=>{const v=l.current;v&&(n(v.scrollTop>0),a(v.scrollTop<v.scrollHeight-v.clientHeight))};Te.useEffect(()=>{const v=l.current;if(v)return h(),v.addEventListener("scroll",h),()=>v.removeEventListener("scroll",h)},[l]);const p=v=>{const _=l.current;if(!_)return;const b=_.scrollHeight-_.clientHeight;let E=_.scrollTop+v;E<0&&(E=0),E>b&&(E=b),_.scrollTop=E,requestAnimationFrame(()=>{_.scrollTop=E,h()})};return Z.jsxs("div",{className:ci("flex flex-row items-center gap-1",e),children:[Z.jsx("button",{className:"h-10 w-8 flex items-center justify-center rounded hover:bg-stone-200 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",disabled:!t,onClick:()=>p(-20),children:Z.jsx("i",{className:"fa-solid fa-chevron-up"})}),Z.jsx("button",{className:"h-10 w-8 flex items-center justify-center rounded hover:bg-stone-200 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",disabled:!s,onClick:()=>p(20),children:Z.jsx("i",{className:"fa-solid fa-chevron-down"})})]})},ZS={red:["bg-red-50","bg-red-100","bg-red-200","bg-red-300","bg-red-400","bg-red-500","bg-red-600","bg-red-700","bg-red-800","bg-red-900"],orange:["bg-orange-50","bg-orange-100","bg-orange-200","bg-orange-300","bg-orange-400","bg-orange-500","bg-orange-600","bg-orange-700","bg-orange-800","bg-orange-900"],amber:["bg-amber-50","bg-amber-100","bg-amber-200","bg-amber-300","bg-amber-400","bg-amber-500","bg-amber-600","bg-amber-700","bg-amber-800","bg-amber-900"],yellow:["bg-yellow-50","bg-yellow-100","bg-yellow-200","bg-yellow-300","bg-yellow-400","bg-yellow-500","bg-yellow-600","bg-yellow-700","bg-yellow-800","bg-yellow-900"],lime:["bg-lime-50","bg-lime-100","bg-lime-200","bg-lime-300","bg-lime-400","bg-lime-500","bg-lime-600","bg-lime-700","bg-lime-800","bg-lime-900"],green:["bg-green-50","bg-green-100","bg-green-200","bg-green-300","bg-green-400","bg-green-500","bg-green-600","bg-green-700","bg-green-800","bg-green-900"],emerald:["bg-emerald-50","bg-emerald-100","bg-emerald-200","bg-emerald-300","bg-emerald-400","bg-emerald-500","bg-emerald-600","bg-emerald-700","bg-emerald-800","bg-emerald-900"],teal:["bg-teal-50","bg-teal-100","bg-teal-200","bg-teal-300","bg-teal-400","bg-teal-500","bg-teal-600","bg-teal-700","bg-teal-800","bg-teal-900"],cyan:["bg-cyan-50","bg-cyan-100","bg-cyan-200","bg-cyan-300","bg-cyan-400","bg-cyan-500","bg-cyan-600","bg-cyan-700","bg-cyan-800","bg-cyan-900"],sky:["bg-sky-50","bg-sky-100","bg-sky-200","bg-sky-300","bg-sky-400","bg-sky-500","bg-sky-600","bg-sky-700","bg-sky-800","bg-sky-900"],blue:["bg-blue-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-400","bg-blue-500","bg-blue-600","bg-blue-700","bg-blue-800","bg-blue-900"],indigo:["bg-indigo-50","bg-indigo-100","bg-indigo-200","bg-indigo-300","bg-indigo-400","bg-indigo-500","bg-indigo-600","bg-indigo-700","bg-indigo-800","bg-indigo-900"],violet:["bg-violet-50","bg-violet-100","bg-violet-200","bg-violet-300","bg-violet-400","bg-violet-500","bg-violet-600","bg-violet-700","bg-violet-800","bg-violet-900"],purple:["bg-purple-50","bg-purple-100","bg-purple-200","bg-purple-300","bg-purple-400","bg-purple-500","bg-purple-600","bg-purple-700","bg-purple-800","bg-purple-900"],fuchsia:["bg-fuchsia-50","bg-fuchsia-100","bg-fuchsia-200","bg-fuchsia-300","bg-fuchsia-400","bg-fuchsia-500","bg-fuchsia-600","bg-fuchsia-700","bg-fuchsia-800","bg-fuchsia-900"],pink:["bg-pink-50","bg-pink-100","bg-pink-200","bg-pink-300","bg-pink-400","bg-pink-500","bg-pink-600","bg-pink-700","bg-pink-800","bg-pink-900"],rose:["bg-rose-50","bg-rose-100","bg-rose-200","bg-rose-300","bg-rose-400","bg-rose-500","bg-rose-600","bg-rose-700","bg-rose-800","bg-rose-900"],slate:["bg-slate-50","bg-slate-100","bg-slate-200","bg-slate-300","bg-slate-400","bg-slate-500","bg-slate-600","bg-slate-700","bg-slate-800","bg-slate-900"],gray:["bg-gray-50","bg-gray-100","bg-gray-200","bg-gray-300","bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800","bg-gray-900"],zinc:["bg-zinc-50","bg-zinc-100","bg-zinc-200","bg-zinc-300","bg-zinc-400","bg-zinc-500","bg-zinc-600","bg-zinc-700","bg-zinc-800","bg-zinc-900"],neutral:["bg-neutral-50","bg-neutral-100","bg-neutral-200","bg-neutral-300","bg-neutral-400","bg-neutral-500","bg-neutral-600","bg-neutral-700","bg-neutral-800","bg-neutral-900"],stone:["bg-stone-50","bg-stone-100","bg-stone-200","bg-stone-300","bg-stone-400","bg-stone-500","bg-stone-600","bg-stone-700","bg-stone-800","bg-stone-900"]},QS=()=>{const[l,e]=Te.useState(["red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia","pink","rose","slate","gray","zinc","neutral","stone"]),t=Te.useRef(null),{handleColorChange:n,fill:s}=et();return Z.jsxs("div",{className:"flex flex-row items-start bg-white",children:[Z.jsx(qS,{scrollRef:t,fill:s,bgColors:l,colorsMap:ZS,onClick:n}),Z.jsx(KS,{scrollRef:t})]})};function bp({options:l=[],value:e,onChange:t,className:n="",label:s,preview:a,disabled:h}){return Z.jsxs("div",{className:ci("flex items-center gap-1",n),children:[s&&Z.jsx("span",{className:"text-xs text-gray-600",children:s}),a&&Z.jsx("div",{children:a}),Z.jsx("select",{value:e,onChange:p=>t?.(p.target.value),disabled:h,className:"p-1 text-xs border border-gray-300 rounded cursor-pointer",children:l.map(p=>Z.jsx("option",{value:p.value,children:p.label},p.value))})]})}const Om=({label:l,hasActiveShape:e,isTileActive:t,setActiveTile:n,color:s})=>Z.jsxs("div",{className:"flex items-center h-4",children:[Z.jsx("label",{className:"text-[11px] font-medium text-gray-500 w-10 leading-none select-none",children:l}),e?Z.jsx("div",{onClick:()=>n("fill"),title:"Edit fill color",className:ci("ml-2 h-4 w-10 rounded border cursor-pointer",t?"ring-1 ring-blue-500 border-blue-500":"border-gray-300 hover:border-gray-400"),style:{backgroundColor:s}}):Z.jsx("span",{className:"ml-2 w-8 text-center text-[10px] text-gray-400",children:"N/A"})]}),JS=({label:l,strokeStyleList:e,strokeStyle:t,setStrokeStyle:n,disabled:s})=>Z.jsxs("div",{className:"flex items-center justify-center h-8 gap-2",children:[Z.jsx("span",{className:"text-[11px] font-medium text-gray-500 leading-none select-none",children:l}),Z.jsx(bp,{disabled:s,options:e,value:t,onChange:n})]}),$S=({value:l,min:e=0,max:t=100,step:n=1,unit:s,onChange:a,disabled:h=!1})=>{const p=v=>Math.min(t,Math.max(e,v));return Z.jsxs("div",{className:ci("inline-flex items-center rounded-lg border border-gray-300 bg-white shadow-sm",h&&"opacity-40 pointer-events-none"),children:[Z.jsx("button",{onClick:()=>a(p(l-n)),className:`cursor-pointer w-8 h-8 flex items-center justify-center rounded-l-lg text-gray-600
                   hover:bg-gray-100 active:bg-gray-200 transition-colors`,title:"Decrease",children:Z.jsx("i",{className:"fa-solid fa-minus"})}),Z.jsxs("div",{className:`px-3 text-sm font-semibold text-gray-800 bg-gray-50 border-x border-gray-300
                   min-w-[44px] text-center`,title:"Value",children:[l,s]}),Z.jsx("button",{onClick:()=>a(p(l+n)),className:`cursor-pointer w-8 h-8 flex items-center justify-center rounded-r-lg text-gray-600
                   hover:bg-gray-100 active:bg-gray-200 transition-colors`,title:"Increase",children:Z.jsx("i",{className:"fa-solid fa-plus"})})]})},eC=({value:l=1,onChange:e,disabled:t})=>{const n=Math.round(l*100);return Z.jsx($S,{value:n,min:0,max:100,step:5,unit:"%",disabled:t,onChange:s=>e(s/100)})},tC=({size:l=20})=>Z.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[Z.jsx("defs",{children:Z.jsxs("linearGradient",{id:"g1",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[Z.jsx("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.15"}),Z.jsx("stop",{offset:"100%",stopColor:"currentColor"})]})}),Z.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",fill:"url(#g1)"})]}),nC=({size:l=20})=>Z.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[Z.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"5"}),Z.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"22"}),Z.jsx("line",{x1:"2",y1:"12",x2:"5",y2:"12"}),Z.jsx("line",{x1:"19",y1:"12",x2:"22",y2:"12"}),Z.jsx("line",{x1:"4.93",y1:"4.93",x2:"7.07",y2:"7.07"}),Z.jsx("line",{x1:"16.93",y1:"16.93",x2:"19.07",y2:"19.07"}),Z.jsx("line",{x1:"4.93",y1:"19.07",x2:"7.07",y2:"16.93"}),Z.jsx("line",{x1:"16.93",y1:"7.07",x2:"19.07",y2:"4.93"}),Z.jsx("circle",{cx:"12",cy:"12",r:"5",fill:"currentColor",opacity:"0.3"})]}),Pm=({size:l=20})=>Z.jsxs("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[Z.jsx("line",{x1:"5",y1:"19",x2:"19",y2:"5"}),Z.jsx("circle",{cx:"5",cy:"19",r:"2",fill:"currentColor"}),Z.jsx("circle",{cx:"19",cy:"5",r:"2",fill:"currentColor"})]}),rC=[{label:"Select Operation",value:""},{label:"Union",value:"union"},{label:"Intersect",value:"intersect"},{label:"Subtract",value:"subtract"},{label:"Exclude",value:"exclude"},{label:"Divide",value:"divide"},{label:"Cut",value:"cut"},{label:"Punch",value:"punch"},{label:"Crop",value:"crop"},{label:"Smart Union",value:"smartUnion"},{label:"Xor Split",value:"xorSplit"}],iC=()=>{const[l,e]=Te.useState(""),t=et(),n=s=>{switch(s){case"union":t.unionSelected({fill:"green"});break;case"intersect":t.intersectSelected({fill:"orange"});break;case"subtract":t.subtractSelected({fill:"pink"});break;case"exclude":t.excludeSelected({fill:"purple"});break;case"divide":t.divideSelected({fill:"purple"});break;case"cut":t.cutSelected({fill:"purple"});break;case"punch":t.punchSelected({fill:"purple"});break;case"crop":t.cropSelected({fill:"purple"});break;case"smartUnion":t.smartUnionSelected({fill:"purple"});break;case"xorSplit":t.xorSplitSelected({fill:"purple"});break}};return Z.jsx("div",{className:"flex items-center space-x-2",children:Z.jsx(bp,{value:l,options:rC,onChange:s=>{e(s),n(s)}})})},eh={soft:{blur:12,offsetX:0,offsetY:6,color:"rgba(0,0,0,0.2)"},medium:{blur:20,offsetX:0,offsetY:10,color:"rgba(0,0,0,0.25)"},strong:{blur:40,offsetX:0,offsetY:20,color:"rgba(0,0,0,0.3)"}},sC=({disabled:l})=>{const e=et(a=>a.activeObjectShadow),t=et(a=>a.applyShadowPreset),n=et(a=>a.removeShadow),s=e?Object.entries(eh).find(([,a])=>a.blur===e.blur&&a.offsetX===e.offsetX&&a.offsetY===e.offsetY&&a.color===e.color)?.[0]??"custom":"none";return Z.jsx(bp,{value:s,disabled:l,options:[{label:"None",value:"none"},...Object.keys(eh).map(a=>({label:a.charAt(0).toUpperCase()+a.slice(1),value:a}))],onChange:a=>{if(a==="none")return n();t(a)}})};function aC(){const{fill:l,stroke:e,strokeWidth:t,activePaint:n,setActivePaint:s,setStroke:a,setStrokeWidthN:h,opacity:p,setOpacity:v,hasActiveShape:_,strokeStyleList:b,strokeStyle:E,setStrokeStyle:N,addShadow:O,applyShadowPreset:Q,geditor:W}=et(),[ee,K]=Te.useState(!1),ve=et(He=>He.canvas)?.getActiveObject()?.shadow?.blur,we=n==="fill",F=n==="stroke",ze=He=>{const Je=Math.max(0,Number(He)||0);h(Je)};return[...Object.keys(eh).map(He=>({label:He.charAt(0).toUpperCase()+He.slice(1),value:He}))],Object.entries(eh).find(([,He])=>He.blur===ve)?.[0],Z.jsxs("div",{className:"flex flex-row justify-center items-center gap-5 bg-white",children:[Z.jsxs("div",{className:"flex flex-col gap-2",children:[Z.jsx(Om,{label:"Fill",hasActiveShape:_,isTileActive:we,setActiveTile:()=>s("fill"),color:l}),Z.jsx(Om,{label:"Stroke",hasActiveShape:_,isTileActive:F,setActiveTile:()=>s("stroke"),color:e})]}),Z.jsxs("div",{className:"flex gap-2 items-center",children:[Z.jsx(Ky,{disabled:!_,label:"Width",value:t,onChange:ze,max:"16"}),Z.jsx(JS,{label:"Style",strokeStyleList:b,strokeStyle:E,setStrokeStyle:N,disabled:!_})]}),Z.jsx("div",{className:"flex gap-2 items-center",children:Z.jsx(eC,{value:p,onChange:v,disabled:!_})}),Z.jsx("div",{className:"flex",children:Z.jsx(sC,{disabled:!_})}),Z.jsxs("div",{className:"flex items-center gap-1 bg-stone-100 p-1 rounded-lg",children:[Z.jsx(Yl,{action:"gradient",toggleType:"switch",iconOn:Z.jsx(Pm,{}),iconOff:Z.jsx(Pm,{}),tooltipOn:"Gradient",tooltipOff:"Normal",initial:!1,onChange:He=>{He.value?W.enable():W.disable()}}),Z.jsx(Yl,{action:"gradienttype",toggleType:"switch",iconOn:Z.jsx(tC,{}),iconOff:Z.jsx(nC,{}),tooltipOn:"Linear Gradient",tooltipOff:"Radial Graient",initial:!1,onChange:He=>{W.toggleGradientType()}})]}),Z.jsx("div",{className:"flex",children:Z.jsx(iC,{})})]})}function oC(){return Z.jsx("footer",{className:"flex flex-col",children:Z.jsx(XS,{colorTool:Z.jsx(QS,{}),zoomTool:Z.jsx(HS,{}),strokeTool:Z.jsx(aC,{})})})}const lC=()=>{const{visible:l,x:e,y:t,items:n,closeMenu:s}=et();if(!l)return null;const a=n.filter(p=>typeof p.when=="function"?p.when():!0),h=a.filter((p,v)=>{if(p.type!=="divider")return!0;const _=a[v-1],b=a[v+1];return _&&b&&_.type!=="divider"&&b.type!=="divider"});return h.length===0?null:Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"fixed inset-0 z-40",onClick:s}),Z.jsx("div",{className:`fixed z-50 min-w-[220px] rounded-lg
                   bg-white shadow-lg border border-stone-200 p-1`,style:{top:t,left:e},children:h.map((p,v)=>p.type==="divider"?Z.jsx("div",{className:"my-1 h-px bg-stone-200"},p.id??v):Z.jsxs("button",{disabled:p.disabled,onClick:()=>{p.onClick(),s()},className:`
                flex w-full items-center justify-between
                rounded-lg px-3 py-2 text-sm
                hover:bg-gray-100
                disabled:opacity-40
              `,children:[Z.jsxs("span",{className:"flex items-center gap-2",children:[p.icon,p.label]}),p.shortcut&&Z.jsx("span",{className:"text-xs text-gray-400",children:p.shortcut})]},p.id??v))})]})};function Qy(l){Te.useEffect(()=>{document.title=l},[l])}const uC=()=>(Qy("Draw | Fateboard"),Z.jsxs("div",{children:[Z.jsx(Ox,{header:Z.jsx(IS,{}),leftSidebar:Z.jsx(NS,{config:US,toolbarPosition:"left"}),canvasBoard:Z.jsx(kS,{}),footer:Z.jsx(oC,{})}),Z.jsx(lC,{})]}));function cC(){const l=Te.useRef(null),[e,t]=Te.useState(0),[n,s]=Te.useState(!1),[a,h]=Te.useState(0),p=Te.useRef(0);return Te.useEffect(()=>{const v=l.current,_=v?.getContext("2d");if(!v||!_)return;const b=20,E=[{x:8*b,y:10*b},{x:7*b,y:10*b},{x:6*b,y:10*b}];let N=Q(),O="RIGHT";function Q(){return{x:Math.floor(Math.random()*(v.width/b))*b,y:Math.floor(Math.random()*(v.height/b))*b}}const W=le=>{le.key==="ArrowLeft"&&O!=="RIGHT"&&(O="LEFT"),le.key==="ArrowUp"&&O!=="DOWN"&&(O="UP"),le.key==="ArrowRight"&&O!=="LEFT"&&(O="RIGHT"),le.key==="ArrowDown"&&O!=="UP"&&(O="DOWN")};document.addEventListener("keydown",W);const ee=()=>{_.fillStyle="#fdfdfd",_.fillRect(0,0,v.width,v.height);for(let ze=0;ze<E.length;ze++)_.fillStyle=ze===0?"#2ecc71":"#27ae60",_.fillRect(E[ze].x,E[ze].y,b,b),_.strokeStyle="#ecf0f1",_.strokeRect(E[ze].x,E[ze].y,b,b);_.fillStyle="#e74c3c",_.fillRect(N.x,N.y,b,b);let le=E[0].x,ve=E[0].y;O==="LEFT"&&(le-=b),O==="UP"&&(ve-=b),O==="RIGHT"&&(le+=b),O==="DOWN"&&(ve+=b),le===N.x&&ve===N.y?(p.current+=1,t(p.current),N=Q()):E.pop();const F={x:le,y:ve};(le<0||ve<0||le>=v.width||ve>=v.height||K(F,E))&&(s(!0),clearInterval(ae),document.removeEventListener("keydown",W)),E.unshift(F),_.fillStyle="#2c3e50",_.font="18px Arial",_.fillText("Score: "+p.current,b,b)},K=(le,ve)=>{for(let we=0;we<ve.length;we++)if(le.x===ve[we].x&&le.y===ve[we].y)return!0;return!1},ae=setInterval(ee,100);return()=>{clearInterval(ae),document.removeEventListener("keydown",W)}},[a]),Z.jsxs("div",{className:"flex flex-col items-center p-6 font-sans m-4",children:[Z.jsx("h1",{className:"text-7xl font-bold text-red-600",children:"404"}),Z.jsx("p",{className:"m-4 text-lg text-gray-700",children:"Oops! Page not found."}),n?Z.jsxs("div",{className:"flex flex-col items-center",children:[Z.jsxs("p",{className:"text-xl text-red-600 font-semibold m-4",children:[" Game Over! Final Score: ",e]}),Z.jsx("button",{onClick:()=>{t(0),p.current=0,s(!1),h(v=>v+1)},className:"mt-4 px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-800",children:" Restart Game"})]}):Z.jsx("canvas",{ref:l,width:600,height:400,className:"border border-gray-400 rounded shadow"},a),Z.jsx(Hd,{to:"/",className:"mt-6 px-6 py-3 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-800 transition",children:"Go Back Home"})]})}function hC({checked:l,onCheckedChange:e}){return Z.jsx("button",{type:"button",role:"switch","aria-checked":l,onClick:()=>e(!l),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${l?"bg-blue-600":"bg-gray-300"}`,children:Z.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${l?"translate-x-6":"translate-x-1"}`})})}function fC(){const[l,e]=Te.useState(!1);return Te.useEffect(()=>{l?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[l]),Z.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6 transition-colors",children:[Z.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100",children:" Settings"}),Z.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Z.jsxs("div",{className:"rounded-2xl shadow p-4 bg-white dark:bg-gray-800 transition-colors",children:[Z.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Appearance"}),Z.jsxs("div",{className:"flex items-center justify-between mt-3",children:[Z.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Dark Mode"}),Z.jsx(hC,{checked:l,onCheckedChange:e})]})]})})]})}function yh(...l){return l.filter(Boolean).join(" ")}function dC({className:l,...e}){return Z.jsx("div",{className:yh("rounded-2xl border bg-white shadow-md dark:bg-gray-100 dark:border-gray-800",l),...e})}function pC({className:l,...e}){return Z.jsx("div",{className:yh("p-4 border-b dark:border-gray-800",l),...e})}function gC({className:l,...e}){return Z.jsx("h3",{className:yh("text-lg font-semibold leading-none tracking-tight",l),...e})}function mC({className:l,...e}){return Z.jsx("div",{className:yh("p-4",l),...e})}const vC=[{id:1,name:"New File",mac:"N",win:"Ctrl+N"},{id:2,name:"Open Settings",mac:",",win:"Ctrl+,"},{id:3,name:"Copy",mac:"C",win:"Ctrl+C"},{id:4,name:"Paste",mac:"V",win:"Ctrl+V"},{id:5,name:"Group",mac:"G",win:"Ctrl+G"},{id:6,name:"Ungroup",mac:"U",win:"Ctrl+Shift+U"}];function yC(){const[l,e]=Te.useState(""),[t,n]=Te.useState("win");Te.useEffect(()=>{navigator.platform.toLowerCase().includes("mac")&&n("mac")},[]);const s=vC.filter(a=>a.name.toLowerCase().includes(l.toLowerCase()));return Z.jsx("div",{className:"flex justify-center items-start pt-20",children:Z.jsxs(dC,{className:"w-full max-w-lg shadow-xl rounded-2xl",children:[Z.jsx(pC,{children:Z.jsx(gC,{className:"text-xl",children:"Command Palette"})}),Z.jsxs(mC,{children:[Z.jsx("input",{placeholder:"Type a command...",value:l,onChange:a=>e(a.target.value),className:"mb-4"}),Z.jsxs("ul",{className:"space-y-2",children:[s.map(a=>Z.jsxs("li",{className:"flex justify-between items-center p-2 rounded-lg hover:bg-gray-100 cursor-pointer",children:[Z.jsx("span",{children:a.name}),Z.jsx("span",{className:"text-sm text-gray-500",children:t==="mac"?a.mac:a.win})]},a.id)),s.length===0&&Z.jsx("li",{className:"text-gray-500 text-sm",children:"No results found"})]})]})]})})}function _C({images:l}){const[e,t]=To.useState(0);return To.useEffect(()=>{const n=setInterval(()=>{t(s=>(s+1)%l.length)},2500);return()=>clearInterval(n)},[l.length]),Z.jsxs("div",{className:"relative bg-white rounded-2xl shadow overflow-hidden",children:[Z.jsx("img",{src:l[e],alt:"Fateboard glimpse",className:"w-full h-64 object-cover transition-all"}),Z.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-2",children:l.map((n,s)=>Z.jsx("span",{className:`h-2 w-2 rounded-full ${s===e?"bg-blue-600":"bg-gray-300"}`},s))})]})}function xC(){Qy("Online Whiteboard | Fateboard");const l=Bd(),e=()=>{l("/draw")};return Z.jsxs("div",{className:"min-h-screen bg-gray-50 text-gray-800",children:[Z.jsx("header",{className:"bg-white shadow-sm",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex justify-between items-center",children:[Z.jsx(Rd,{src:"fate.svg",className:"h-10 cursor-pointer"}),Z.jsxs("nav",{className:"space-x-6 text-sm",children:[Z.jsx("a",{href:"#features",className:"hover:text-blue-600",children:"Features"}),Z.jsx("a",{href:"#process",className:"hover:text-blue-600",children:"Action"})]})]})}),Z.jsx("section",{className:"bg-gradient-to-br from-blue-600 to-indigo-600 text-white",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-24 text-center",children:[Z.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Draw the Fate"}),Z.jsx("p",{className:"max-w-2xl mx-auto text-lg mb-8 opacity-90",children:"Just start with a blank canvas and the freedom to move the draw fate."}),Z.jsx("button",{className:"bg-white text-blue-600 px-8 py-3 rounded-full font-semibold shadow hover:scale-105 transition",onClick:e,children:"Start Now"})]})}),Z.jsx("section",{id:"features",className:"py-20",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[Z.jsx("h3",{className:"text-3xl font-bold text-center mb-12",children:"Key Features"}),Z.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{title:"Shape Creation",desc:"Draw rectangles, circles, arrows, and freehand shapes just like on a real whiteboard."},{title:"Easy to Use",desc:"No learning curve. Pick a tool, draw, and your idea comes to life instantly."},{title:"Color Options",desc:"Choose colors that feel right  soft, bold, or playful  to match your story."}].map(t=>Z.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow hover:shadow-lg transition",children:[Z.jsx("h4",{className:"text-xl font-semibold mb-3",children:t.title}),Z.jsx("p",{className:"text-sm text-gray-600",children:t.desc})]},t.title))})]})}),Z.jsx("section",{id:"process",className:"bg-gray-100 py-20",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[Z.jsx("h3",{className:"text-3xl font-bold text-center mb-6",children:"See It In Action"}),Z.jsx("p",{className:"text-center text-gray-600 mb-12 max-w-2xl mx-auto",children:"A quick look at how ideas turn into visuals  simple, smooth, and human."}),Z.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[Z.jsxs("div",{className:"space-y-6",children:[Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Draw Naturally"}),Z.jsx("p",{className:"text-sm text-gray-600",children:"Pick a shape or pen and draw freely, just like on a real whiteboard."})]}),Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Adjust as You Go"}),Z.jsx("p",{className:"text-sm text-gray-600",children:"Resize, recolor, and tweak elements until it feels right."})]}),Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Bring It to Life"}),Z.jsx("p",{className:"text-sm text-gray-600",children:"Watch your board come alive with smooth visual flow."})]})]}),Z.jsx(_C,{images:["./demo.png","./shape.png","./draw.png","./text.png"]})]})]})}),Z.jsx("footer",{className:"bg-white border-t",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-6 text-sm text-center text-gray-500",children:[" ",new Date().getFullYear()," fateboard. All rights reserved."]})})]})}function wC(){return Z.jsx(yx,{basename:"/",children:Z.jsxs(q1,{children:[Z.jsx(Co,{path:"/",element:Z.jsx(xC,{})}),Z.jsx(Co,{path:"/draw",element:Z.jsx(uC,{})}),Z.jsx(Co,{path:"/setting",element:Z.jsx(fC,{})}),Z.jsx(Co,{path:"/command-palette",element:Z.jsx(yC,{})}),Z.jsx(Co,{path:"*",element:Z.jsx(cC,{})})]})})}function bC(){return Z.jsx(wC,{})}Q_.createRoot(document.getElementById("fateboard")).render(Z.jsx(Te.StrictMode,{children:Z.jsx(bC,{})}));
