(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Mm(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function X_(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var e=o.default;if(typeof e=="function"){var t=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(o).forEach(function(n){var i=Object.getOwnPropertyDescriptor(o,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return o[n]}})}),t}var qf={exports:{}},yl={},Kf={exports:{}},Wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v0;function G_(){if(v0)return Wt;v0=1;var o=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),h=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.iterator;function I(be){return be===null||typeof be!="object"?null:(be=E&&be[E]||be["@@iterator"],typeof be=="function"?be:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q=Object.assign,W={};function ee(be,Fe,yt){this.props=be,this.context=Fe,this.refs=W,this.updater=yt||O}ee.prototype.isReactComponent={},ee.prototype.setState=function(be,Fe){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Fe,"setState")},ee.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function K(){}K.prototype=ee.prototype;function ae(be,Fe,yt){this.props=be,this.context=Fe,this.refs=W,this.updater=yt||O}var le=ae.prototype=new K;le.constructor=ae,Q(le,ee.prototype),le.isPureReactComponent=!0;var ge=Array.isArray,xe=Object.prototype.hasOwnProperty,F={current:null},Ne={key:!0,ref:!0,__self:!0,__source:!0};function Ve(be,Fe,yt){var Ct,pt={},Mt=null,zt=null;if(Fe!=null)for(Ct in Fe.ref!==void 0&&(zt=Fe.ref),Fe.key!==void 0&&(Mt=""+Fe.key),Fe)xe.call(Fe,Ct)&&!Ne.hasOwnProperty(Ct)&&(pt[Ct]=Fe[Ct]);var Ut=arguments.length-2;if(Ut===1)pt.children=yt;else if(1<Ut){for(var _t=Array(Ut),At=0;At<Ut;At++)_t[At]=arguments[At+2];pt.children=_t}if(be&&be.defaultProps)for(Ct in Ut=be.defaultProps,Ut)pt[Ct]===void 0&&(pt[Ct]=Ut[Ct]);return{$$typeof:o,type:be,key:Mt,ref:zt,props:pt,_owner:F.current}}function qe(be,Fe){return{$$typeof:o,type:be.type,key:Fe,ref:be.ref,props:be.props,_owner:be._owner}}function ot(be){return typeof be=="object"&&be!==null&&be.$$typeof===o}function je(be){var Fe={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(yt){return Fe[yt]})}var Ze=/\/+/g;function dt(be,Fe){return typeof be=="object"&&be!==null&&be.key!=null?je(""+be.key):Fe.toString(36)}function We(be,Fe,yt,Ct,pt){var Mt=typeof be;(Mt==="undefined"||Mt==="boolean")&&(be=null);var zt=!1;if(be===null)zt=!0;else switch(Mt){case"string":case"number":zt=!0;break;case"object":switch(be.$$typeof){case o:case e:zt=!0}}if(zt)return zt=be,pt=pt(zt),be=Ct===""?"."+dt(zt,0):Ct,ge(pt)?(yt="",be!=null&&(yt=be.replace(Ze,"$&/")+"/"),We(pt,Fe,yt,"",function(At){return At})):pt!=null&&(ot(pt)&&(pt=qe(pt,yt+(!pt.key||zt&&zt.key===pt.key?"":(""+pt.key).replace(Ze,"$&/")+"/")+be)),Fe.push(pt)),1;if(zt=0,Ct=Ct===""?".":Ct+":",ge(be))for(var Ut=0;Ut<be.length;Ut++){Mt=be[Ut];var _t=Ct+dt(Mt,Ut);zt+=We(Mt,Fe,yt,_t,pt)}else if(_t=I(be),typeof _t=="function")for(be=_t.call(be),Ut=0;!(Mt=be.next()).done;)Mt=Mt.value,_t=Ct+dt(Mt,Ut++),zt+=We(Mt,Fe,yt,_t,pt);else if(Mt==="object")throw Fe=String(be),Error("Objects are not valid as a React child (found: "+(Fe==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Fe)+"). If you meant to render a collection of children, use an array instead.");return zt}function Bt(be,Fe,yt){if(be==null)return be;var Ct=[],pt=0;return We(be,Ct,"","",function(Mt){return Fe.call(yt,Mt,pt++)}),Ct}function Le(be){if(be._status===-1){var Fe=be._result;Fe=Fe(),Fe.then(function(yt){(be._status===0||be._status===-1)&&(be._status=1,be._result=yt)},function(yt){(be._status===0||be._status===-1)&&(be._status=2,be._result=yt)}),be._status===-1&&(be._status=0,be._result=Fe)}if(be._status===1)return be._result.default;throw be._result}var wt={current:null},ze={transition:null},Xe={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:ze,ReactCurrentOwner:F};function Qe(){throw Error("act(...) is not supported in production builds of React.")}return Wt.Children={map:Bt,forEach:function(be,Fe,yt){Bt(be,function(){Fe.apply(this,arguments)},yt)},count:function(be){var Fe=0;return Bt(be,function(){Fe++}),Fe},toArray:function(be){return Bt(be,function(Fe){return Fe})||[]},only:function(be){if(!ot(be))throw Error("React.Children.only expected to receive a single React element child.");return be}},Wt.Component=ee,Wt.Fragment=t,Wt.Profiler=i,Wt.PureComponent=ae,Wt.StrictMode=n,Wt.Suspense=m,Wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xe,Wt.act=Qe,Wt.cloneElement=function(be,Fe,yt){if(be==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+be+".");var Ct=Q({},be.props),pt=be.key,Mt=be.ref,zt=be._owner;if(Fe!=null){if(Fe.ref!==void 0&&(Mt=Fe.ref,zt=F.current),Fe.key!==void 0&&(pt=""+Fe.key),be.type&&be.type.defaultProps)var Ut=be.type.defaultProps;for(_t in Fe)xe.call(Fe,_t)&&!Ne.hasOwnProperty(_t)&&(Ct[_t]=Fe[_t]===void 0&&Ut!==void 0?Ut[_t]:Fe[_t])}var _t=arguments.length-2;if(_t===1)Ct.children=yt;else if(1<_t){Ut=Array(_t);for(var At=0;At<_t;At++)Ut[At]=arguments[At+2];Ct.children=Ut}return{$$typeof:o,type:be.type,key:pt,ref:Mt,props:Ct,_owner:zt}},Wt.createContext=function(be){return be={$$typeof:h,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},be.Provider={$$typeof:a,_context:be},be.Consumer=be},Wt.createElement=Ve,Wt.createFactory=function(be){var Fe=Ve.bind(null,be);return Fe.type=be,Fe},Wt.createRef=function(){return{current:null}},Wt.forwardRef=function(be){return{$$typeof:p,render:be}},Wt.isValidElement=ot,Wt.lazy=function(be){return{$$typeof:b,_payload:{_status:-1,_result:be},_init:Le}},Wt.memo=function(be,Fe){return{$$typeof:_,type:be,compare:Fe===void 0?null:Fe}},Wt.startTransition=function(be){var Fe=ze.transition;ze.transition={};try{be()}finally{ze.transition=Fe}},Wt.unstable_act=Qe,Wt.useCallback=function(be,Fe){return wt.current.useCallback(be,Fe)},Wt.useContext=function(be){return wt.current.useContext(be)},Wt.useDebugValue=function(){},Wt.useDeferredValue=function(be){return wt.current.useDeferredValue(be)},Wt.useEffect=function(be,Fe){return wt.current.useEffect(be,Fe)},Wt.useId=function(){return wt.current.useId()},Wt.useImperativeHandle=function(be,Fe,yt){return wt.current.useImperativeHandle(be,Fe,yt)},Wt.useInsertionEffect=function(be,Fe){return wt.current.useInsertionEffect(be,Fe)},Wt.useLayoutEffect=function(be,Fe){return wt.current.useLayoutEffect(be,Fe)},Wt.useMemo=function(be,Fe){return wt.current.useMemo(be,Fe)},Wt.useReducer=function(be,Fe,yt){return wt.current.useReducer(be,Fe,yt)},Wt.useRef=function(be){return wt.current.useRef(be)},Wt.useState=function(be){return wt.current.useState(be)},Wt.useSyncExternalStore=function(be,Fe,yt){return wt.current.useSyncExternalStore(be,Fe,yt)},Wt.useTransition=function(){return wt.current.useTransition()},Wt.version="18.3.1",Wt}var y0;function Bd(){return y0||(y0=1,Kf.exports=G_()),Kf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _0;function Y_(){if(_0)return yl;_0=1;var o=Bd(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function h(p,m,_){var b,E={},I=null,O=null;_!==void 0&&(I=""+_),m.key!==void 0&&(I=""+m.key),m.ref!==void 0&&(O=m.ref);for(b in m)n.call(m,b)&&!a.hasOwnProperty(b)&&(E[b]=m[b]);if(p&&p.defaultProps)for(b in m=p.defaultProps,m)E[b]===void 0&&(E[b]=m[b]);return{$$typeof:e,type:p,key:I,ref:O,props:E,_owner:i.current}}return yl.Fragment=t,yl.jsx=h,yl.jsxs=h,yl}var x0;function q_(){return x0||(x0=1,qf.exports=Y_()),qf.exports}var Z=q_(),ke=Bd();const Eo=Mm(ke);var mc={},Zf={exports:{}},Ar={},Qf={exports:{}},Jf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w0;function K_(){return w0||(w0=1,(function(o){function e(ze,Xe){var Qe=ze.length;ze.push(Xe);e:for(;0<Qe;){var be=Qe-1>>>1,Fe=ze[be];if(0<i(Fe,Xe))ze[be]=Xe,ze[Qe]=Fe,Qe=be;else break e}}function t(ze){return ze.length===0?null:ze[0]}function n(ze){if(ze.length===0)return null;var Xe=ze[0],Qe=ze.pop();if(Qe!==Xe){ze[0]=Qe;e:for(var be=0,Fe=ze.length,yt=Fe>>>1;be<yt;){var Ct=2*(be+1)-1,pt=ze[Ct],Mt=Ct+1,zt=ze[Mt];if(0>i(pt,Qe))Mt<Fe&&0>i(zt,pt)?(ze[be]=zt,ze[Mt]=Qe,be=Mt):(ze[be]=pt,ze[Ct]=Qe,be=Ct);else if(Mt<Fe&&0>i(zt,Qe))ze[be]=zt,ze[Mt]=Qe,be=Mt;else break e}}return Xe}function i(ze,Xe){var Qe=ze.sortIndex-Xe.sortIndex;return Qe!==0?Qe:ze.id-Xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;o.unstable_now=function(){return a.now()}}else{var h=Date,p=h.now();o.unstable_now=function(){return h.now()-p}}var m=[],_=[],b=1,E=null,I=3,O=!1,Q=!1,W=!1,ee=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,ae=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function le(ze){for(var Xe=t(_);Xe!==null;){if(Xe.callback===null)n(_);else if(Xe.startTime<=ze)n(_),Xe.sortIndex=Xe.expirationTime,e(m,Xe);else break;Xe=t(_)}}function ge(ze){if(W=!1,le(ze),!Q)if(t(m)!==null)Q=!0,Le(xe);else{var Xe=t(_);Xe!==null&&wt(ge,Xe.startTime-ze)}}function xe(ze,Xe){Q=!1,W&&(W=!1,K(Ve),Ve=-1),O=!0;var Qe=I;try{for(le(Xe),E=t(m);E!==null&&(!(E.expirationTime>Xe)||ze&&!je());){var be=E.callback;if(typeof be=="function"){E.callback=null,I=E.priorityLevel;var Fe=be(E.expirationTime<=Xe);Xe=o.unstable_now(),typeof Fe=="function"?E.callback=Fe:E===t(m)&&n(m),le(Xe)}else n(m);E=t(m)}if(E!==null)var yt=!0;else{var Ct=t(_);Ct!==null&&wt(ge,Ct.startTime-Xe),yt=!1}return yt}finally{E=null,I=Qe,O=!1}}var F=!1,Ne=null,Ve=-1,qe=5,ot=-1;function je(){return!(o.unstable_now()-ot<qe)}function Ze(){if(Ne!==null){var ze=o.unstable_now();ot=ze;var Xe=!0;try{Xe=Ne(!0,ze)}finally{Xe?dt():(F=!1,Ne=null)}}else F=!1}var dt;if(typeof ae=="function")dt=function(){ae(Ze)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Bt=We.port2;We.port1.onmessage=Ze,dt=function(){Bt.postMessage(null)}}else dt=function(){ee(Ze,0)};function Le(ze){Ne=ze,F||(F=!0,dt())}function wt(ze,Xe){Ve=ee(function(){ze(o.unstable_now())},Xe)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(ze){ze.callback=null},o.unstable_continueExecution=function(){Q||O||(Q=!0,Le(xe))},o.unstable_forceFrameRate=function(ze){0>ze||125<ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):qe=0<ze?Math.floor(1e3/ze):5},o.unstable_getCurrentPriorityLevel=function(){return I},o.unstable_getFirstCallbackNode=function(){return t(m)},o.unstable_next=function(ze){switch(I){case 1:case 2:case 3:var Xe=3;break;default:Xe=I}var Qe=I;I=Xe;try{return ze()}finally{I=Qe}},o.unstable_pauseExecution=function(){},o.unstable_requestPaint=function(){},o.unstable_runWithPriority=function(ze,Xe){switch(ze){case 1:case 2:case 3:case 4:case 5:break;default:ze=3}var Qe=I;I=ze;try{return Xe()}finally{I=Qe}},o.unstable_scheduleCallback=function(ze,Xe,Qe){var be=o.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?be+Qe:be):Qe=be,ze){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=Qe+Fe,ze={id:b++,callback:Xe,priorityLevel:ze,startTime:Qe,expirationTime:Fe,sortIndex:-1},Qe>be?(ze.sortIndex=Qe,e(_,ze),t(m)===null&&ze===t(_)&&(W?(K(Ve),Ve=-1):W=!0,wt(ge,Qe-be))):(ze.sortIndex=Fe,e(m,ze),Q||O||(Q=!0,Le(xe))),ze},o.unstable_shouldYield=je,o.unstable_wrapCallback=function(ze){var Xe=I;return function(){var Qe=I;I=Xe;try{return ze.apply(this,arguments)}finally{I=Qe}}}})(Jf)),Jf}var b0;function Z_(){return b0||(b0=1,Qf.exports=K_()),Qf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function Q_(){if(S0)return Ar;S0=1;var o=Bd(),e=Z_();function t(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,d=1;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,l){h(s,l),h(s+"Capture",l)}function h(s,l){for(i[s]=l,s=0;s<l.length;s++)n.add(l[s])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b={},E={};function I(s){return m.call(E,s)?!0:m.call(b,s)?!1:_.test(s)?E[s]=!0:(b[s]=!0,!1)}function O(s,l,d,y){if(d!==null&&d.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return y?!1:d!==null?!d.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function Q(s,l,d,y){if(l===null||typeof l>"u"||O(s,l,d,y))return!0;if(y)return!1;if(d!==null)switch(d.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function W(s,l,d,y,k,M,$){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=y,this.attributeNamespace=k,this.mustUseProperty=d,this.propertyName=s,this.type=l,this.sanitizeURL=M,this.removeEmptyString=$}var ee={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){ee[s]=new W(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];ee[l]=new W(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){ee[s]=new W(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){ee[s]=new W(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){ee[s]=new W(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){ee[s]=new W(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){ee[s]=new W(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){ee[s]=new W(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){ee[s]=new W(s,5,!1,s.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function ae(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(K,ae);ee[l]=new W(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(K,ae);ee[l]=new W(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(K,ae);ee[l]=new W(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){ee[s]=new W(s,1,!1,s.toLowerCase(),null,!1,!1)}),ee.xlinkHref=new W("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){ee[s]=new W(s,1,!1,s.toLowerCase(),null,!0,!0)});function le(s,l,d,y){var k=ee.hasOwnProperty(l)?ee[l]:null;(k!==null?k.type!==0:y||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(Q(l,d,k,y)&&(d=null),y||k===null?I(l)&&(d===null?s.removeAttribute(l):s.setAttribute(l,""+d)):k.mustUseProperty?s[k.propertyName]=d===null?k.type===3?!1:"":d:(l=k.attributeName,y=k.attributeNamespace,d===null?s.removeAttribute(l):(k=k.type,d=k===3||k===4&&d===!0?"":""+d,y?s.setAttributeNS(y,l,d):s.setAttribute(l,d))))}var ge=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xe=Symbol.for("react.element"),F=Symbol.for("react.portal"),Ne=Symbol.for("react.fragment"),Ve=Symbol.for("react.strict_mode"),qe=Symbol.for("react.profiler"),ot=Symbol.for("react.provider"),je=Symbol.for("react.context"),Ze=Symbol.for("react.forward_ref"),dt=Symbol.for("react.suspense"),We=Symbol.for("react.suspense_list"),Bt=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),wt=Symbol.for("react.offscreen"),ze=Symbol.iterator;function Xe(s){return s===null||typeof s!="object"?null:(s=ze&&s[ze]||s["@@iterator"],typeof s=="function"?s:null)}var Qe=Object.assign,be;function Fe(s){if(be===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);be=l&&l[1]||""}return`
`+be+s}var yt=!1;function Ct(s,l){if(!s||yt)return"";yt=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Ae){var y=Ae}Reflect.construct(s,[],l)}else{try{l.call()}catch(Ae){y=Ae}s.call(l.prototype)}else{try{throw Error()}catch(Ae){y=Ae}s()}}catch(Ae){if(Ae&&y&&typeof Ae.stack=="string"){for(var k=Ae.stack.split(`
`),M=y.stack.split(`
`),$=k.length-1,ue=M.length-1;1<=$&&0<=ue&&k[$]!==M[ue];)ue--;for(;1<=$&&0<=ue;$--,ue--)if(k[$]!==M[ue]){if($!==1||ue!==1)do if($--,ue--,0>ue||k[$]!==M[ue]){var ve=`
`+k[$].replace(" at new "," at ");return s.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",s.displayName)),ve}while(1<=$&&0<=ue);break}}}finally{yt=!1,Error.prepareStackTrace=d}return(s=s?s.displayName||s.name:"")?Fe(s):""}function pt(s){switch(s.tag){case 5:return Fe(s.type);case 16:return Fe("Lazy");case 13:return Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 2:case 15:return s=Ct(s.type,!1),s;case 11:return s=Ct(s.type.render,!1),s;case 1:return s=Ct(s.type,!0),s;default:return""}}function Mt(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case Ne:return"Fragment";case F:return"Portal";case qe:return"Profiler";case Ve:return"StrictMode";case dt:return"Suspense";case We:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case je:return(s.displayName||"Context")+".Consumer";case ot:return(s._context.displayName||"Context")+".Provider";case Ze:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Bt:return l=s.displayName||null,l!==null?l:Mt(s.type)||"Memo";case Le:l=s._payload,s=s._init;try{return Mt(s(l))}catch{}}return null}function zt(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mt(l);case 8:return l===Ve?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Ut(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function _t(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function At(s){var l=_t(s)?"checked":"value",d=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),y=""+s[l];if(!s.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var k=d.get,M=d.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return k.call(this)},set:function($){y=""+$,M.call(this,$)}}),Object.defineProperty(s,l,{enumerable:d.enumerable}),{getValue:function(){return y},setValue:function($){y=""+$},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function en(s){s._valueTracker||(s._valueTracker=At(s))}function la(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var d=l.getValue(),y="";return s&&(y=_t(s)?s.checked?"true":"false":s.value),s=y,s!==d?(l.setValue(s),!0):!1}function Rr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Os(s,l){var d=l.checked;return Qe({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??s._wrapperState.initialChecked})}function Di(s,l){var d=l.defaultValue==null?"":l.defaultValue,y=l.checked!=null?l.checked:l.defaultChecked;d=Ut(l.value!=null?l.value:d),s._wrapperState={initialChecked:y,initialValue:d,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ua(s,l){l=l.checked,l!=null&&le(s,"checked",l,!1)}function Nr(s,l){ua(s,l);var d=Ut(l.value),y=l.type;if(d!=null)y==="number"?(d===0&&s.value===""||s.value!=d)&&(s.value=""+d):s.value!==""+d&&(s.value=""+d);else if(y==="submit"||y==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?Ni(s,l.type,d):l.hasOwnProperty("defaultValue")&&Ni(s,l.type,Ut(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function Ri(s,l,d){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var y=l.type;if(!(y!=="submit"&&y!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,d||l===s.value||(s.value=l),s.defaultValue=l}d=s.name,d!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,d!==""&&(s.name=d)}function Ni(s,l,d){(l!=="number"||Rr(s.ownerDocument)!==s)&&(d==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+d&&(s.defaultValue=""+d))}var qr=Array.isArray;function tn(s,l,d,y){if(s=s.options,l){l={};for(var k=0;k<d.length;k++)l["$"+d[k]]=!0;for(d=0;d<s.length;d++)k=l.hasOwnProperty("$"+s[d].value),s[d].selected!==k&&(s[d].selected=k),k&&y&&(s[d].defaultSelected=!0)}else{for(d=""+Ut(d),l=null,k=0;k<s.length;k++){if(s[k].value===d){s[k].selected=!0,y&&(s[k].defaultSelected=!0);return}l!==null||s[k].disabled||(l=s[k])}l!==null&&(l.selected=!0)}}function pi(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return Qe({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Gt(s,l){var d=l.value;if(d==null){if(d=l.children,l=l.defaultValue,d!=null){if(l!=null)throw Error(t(92));if(qr(d)){if(1<d.length)throw Error(t(93));d=d[0]}l=d}l==null&&(l=""),d=l}s._wrapperState={initialValue:Ut(d)}}function Ps(s,l){var d=Ut(l.value),y=Ut(l.defaultValue);d!=null&&(d=""+d,d!==s.value&&(s.value=d),l.defaultValue==null&&s.defaultValue!==d&&(s.defaultValue=d)),y!=null&&(s.defaultValue=""+y)}function Nt(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function r(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function u(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?r(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var f,g=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,d,y,k){MSApp.execUnsafeLocalFunction(function(){return s(l,d,y,k)})}:s})(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for(f=f||document.createElement("div"),f.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=f.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function v(s,l){if(l){var d=s.firstChild;if(d&&d===s.lastChild&&d.nodeType===3){d.nodeValue=l;return}}s.textContent=l}var w={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S=["Webkit","ms","Moz","O"];Object.keys(w).forEach(function(s){S.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),w[l]=w[s]})});function C(s,l,d){return l==null||typeof l=="boolean"||l===""?"":d||typeof l!="number"||l===0||w.hasOwnProperty(s)&&w[s]?(""+l).trim():l+"px"}function T(s,l){s=s.style;for(var d in l)if(l.hasOwnProperty(d)){var y=d.indexOf("--")===0,k=C(d,l[d],y);d==="float"&&(d="cssFloat"),y?s.setProperty(d,k):s[d]=k}}var P=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function N(s,l){if(l){if(P[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function B(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var L=null;function j(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Y=null,z=null,H=null;function D(s){if(s=rl(s)){if(typeof Y!="function")throw Error(t(280));var l=s.stateNode;l&&(l=Mu(l),Y(s.stateNode,s.type,l))}}function U(s){z?H?H.push(s):H=[s]:z=s}function A(){if(z){var s=z,l=H;if(H=z=null,D(s),l)for(s=0;s<l.length;s++)D(l[s])}}function V(s,l){return s(l)}function q(){}var J=!1;function X(s,l,d){if(J)return s(l,d);J=!0;try{return V(s,l,d)}finally{J=!1,(z!==null||H!==null)&&(q(),A())}}function te(s,l){var d=s.stateNode;if(d===null)return null;var y=Mu(d);if(y===null)return null;d=y[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(s=s.type,y=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!y;break e;default:s=!1}if(s)return null;if(d&&typeof d!="function")throw Error(t(231,l,typeof d));return d}var ie=!1;if(p)try{var se={};Object.defineProperty(se,"passive",{get:function(){ie=!0}}),window.addEventListener("test",se,se),window.removeEventListener("test",se,se)}catch{ie=!1}function he(s,l,d,y,k,M,$,ue,ve){var Ae=Array.prototype.slice.call(arguments,3);try{l.apply(d,Ae)}catch(Ye){this.onError(Ye)}}var ne=!1,ce=null,fe=!1,ye=null,we={onError:function(s){ne=!0,ce=s}};function Ee(s,l,d,y,k,M,$,ue,ve){ne=!1,ce=null,he.apply(we,arguments)}function Be(s,l,d,y,k,M,$,ue,ve){if(Ee.apply(this,arguments),ne){if(ne){var Ae=ce;ne=!1,ce=null}else throw Error(t(198));fe||(fe=!0,ye=Ae)}}function Ue(s){var l=s,d=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(d=l.return),s=l.return;while(s)}return l.tag===3?d:null}function et(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function it(s){if(Ue(s)!==s)throw Error(t(188))}function Ie(s){var l=s.alternate;if(!l){if(l=Ue(s),l===null)throw Error(t(188));return l!==s?null:s}for(var d=s,y=l;;){var k=d.return;if(k===null)break;var M=k.alternate;if(M===null){if(y=k.return,y!==null){d=y;continue}break}if(k.child===M.child){for(M=k.child;M;){if(M===d)return it(k),s;if(M===y)return it(k),l;M=M.sibling}throw Error(t(188))}if(d.return!==y.return)d=k,y=M;else{for(var $=!1,ue=k.child;ue;){if(ue===d){$=!0,d=k,y=M;break}if(ue===y){$=!0,y=k,d=M;break}ue=ue.sibling}if(!$){for(ue=M.child;ue;){if(ue===d){$=!0,d=M,y=k;break}if(ue===y){$=!0,y=M,d=k;break}ue=ue.sibling}if(!$)throw Error(t(189))}}if(d.alternate!==y)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?s:l}function De(s){return s=Ie(s),s!==null?tt(s):null}function tt(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=tt(s);if(l!==null)return l;s=s.sibling}return null}var at=e.unstable_scheduleCallback,st=e.unstable_cancelCallback,xt=e.unstable_shouldYield,vt=e.unstable_requestPaint,lt=e.unstable_now,Lt=e.unstable_getCurrentPriorityLevel,bt=e.unstable_ImmediatePriority,pn=e.unstable_UserBlockingPriority,sn=e.unstable_NormalPriority,Sn=e.unstable_LowPriority,ln=e.unstable_IdlePriority,Ke=null,Ht=null;function an(s){if(Ht&&typeof Ht.onCommitFiberRoot=="function")try{Ht.onCommitFiberRoot(Ke,s,void 0,(s.current.flags&128)===128)}catch{}}var qt=Math.clz32?Math.clz32:fr,tr=Math.log,Fr=Math.LN2;function fr(s){return s>>>=0,s===0?32:31-(tr(s)/Fr|0)|0}var Wn=64,Cn=4194304;function On(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function nr(s,l){var d=s.pendingLanes;if(d===0)return 0;var y=0,k=s.suspendedLanes,M=s.pingedLanes,$=d&268435455;if($!==0){var ue=$&~k;ue!==0?y=On(ue):(M&=$,M!==0&&(y=On(M)))}else $=d&~k,$!==0?y=On($):M!==0&&(y=On(M));if(y===0)return 0;if(l!==0&&l!==y&&(l&k)===0&&(k=y&-y,M=l&-l,k>=M||k===16&&(M&4194240)!==0))return l;if((y&4)!==0&&(y|=d&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=y;0<l;)d=31-qt(l),k=1<<d,y|=s[d],l&=~k;return y}function vn(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fn(s,l){for(var d=s.suspendedLanes,y=s.pingedLanes,k=s.expirationTimes,M=s.pendingLanes;0<M;){var $=31-qt(M),ue=1<<$,ve=k[$];ve===-1?((ue&d)===0||(ue&y)!==0)&&(k[$]=vn(ue,l)):ve<=l&&(s.expiredLanes|=ue),M&=~ue}}function As(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Ms(){var s=Wn;return Wn<<=1,(Wn&4194240)===0&&(Wn=64),s}function js(s){for(var l=[],d=0;31>d;d++)l.push(s);return l}function Fi(s,l,d){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-qt(l),s[l]=d}function Za(s,l){var d=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var y=s.eventTimes;for(s=s.expirationTimes;0<d;){var k=31-qt(d),M=1<<k;l[k]=0,y[k]=-1,s[k]=-1,d&=~M}}function Bi(s,l){var d=s.entangledLanes|=l;for(s=s.entanglements;d;){var y=31-qt(d),k=1<<y;k&l|s[y]&l&&(s[y]|=l),d&=~k}}var Vt=0;function zi(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Vi,Br,dr,Pt,rr,ir=!1,Un=[],Hn=null,Sr=null,Cr=null,gi=new Map,c=new Map,x=[],R="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G(s,l){switch(s){case"focusin":case"focusout":Hn=null;break;case"dragenter":case"dragleave":Sr=null;break;case"mouseover":case"mouseout":Cr=null;break;case"pointerover":case"pointerout":gi.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":c.delete(l.pointerId)}}function re(s,l,d,y,k,M){return s===null||s.nativeEvent!==M?(s={blockedOn:l,domEventName:d,eventSystemFlags:y,nativeEvent:M,targetContainers:[k]},l!==null&&(l=rl(l),l!==null&&Br(l)),s):(s.eventSystemFlags|=y,l=s.targetContainers,k!==null&&l.indexOf(k)===-1&&l.push(k),s)}function Se(s,l,d,y,k){switch(l){case"focusin":return Hn=re(Hn,s,l,d,y,k),!0;case"dragenter":return Sr=re(Sr,s,l,d,y,k),!0;case"mouseover":return Cr=re(Cr,s,l,d,y,k),!0;case"pointerover":var M=k.pointerId;return gi.set(M,re(gi.get(M)||null,s,l,d,y,k)),!0;case"gotpointercapture":return M=k.pointerId,c.set(M,re(c.get(M)||null,s,l,d,y,k)),!0}return!1}function Oe(s){var l=xa(s.target);if(l!==null){var d=Ue(l);if(d!==null){if(l=d.tag,l===13){if(l=et(d),l!==null){s.blockedOn=l,rr(s.priority,function(){dr(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){s.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ge(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var d=Qa(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(d===null){d=s.nativeEvent;var y=new d.constructor(d.type,d);L=y,d.target.dispatchEvent(y),L=null}else return l=rl(d),l!==null&&Br(l),s.blockedOn=d,!1;l.shift()}return!0}function rt(s,l,d){Ge(s)&&d.delete(l)}function Ot(){ir=!1,Hn!==null&&Ge(Hn)&&(Hn=null),Sr!==null&&Ge(Sr)&&(Sr=null),Cr!==null&&Ge(Cr)&&(Cr=null),gi.forEach(rt),c.forEach(rt)}function jt(s,l){s.blockedOn===l&&(s.blockedOn=null,ir||(ir=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ot)))}function Kt(s){function l(k){return jt(k,s)}if(0<Un.length){jt(Un[0],s);for(var d=1;d<Un.length;d++){var y=Un[d];y.blockedOn===s&&(y.blockedOn=null)}}for(Hn!==null&&jt(Hn,s),Sr!==null&&jt(Sr,s),Cr!==null&&jt(Cr,s),gi.forEach(l),c.forEach(l),d=0;d<x.length;d++)y=x[d],y.blockedOn===s&&(y.blockedOn=null);for(;0<x.length&&(d=x[0],d.blockedOn===null);)Oe(d),d.blockedOn===null&&x.shift()}var cn=ge.ReactCurrentBatchConfig,Kr=!0;function mi(s,l,d,y){var k=Vt,M=cn.transition;cn.transition=null;try{Vt=1,Qr(s,l,d,y)}finally{Vt=k,cn.transition=M}}function Zr(s,l,d,y){var k=Vt,M=cn.transition;cn.transition=null;try{Vt=4,Qr(s,l,d,y)}finally{Vt=k,cn.transition=M}}function Qr(s,l,d,y){if(Kr){var k=Qa(s,l,d,y);if(k===null)Nh(s,l,y,zr,d),G(s,y);else if(Se(k,s,l,d,y))y.stopPropagation();else if(G(s,y),l&4&&-1<R.indexOf(s)){for(;k!==null;){var M=rl(k);if(M!==null&&Vi(M),M=Qa(s,l,d,y),M===null&&Nh(s,l,y,zr,d),M===k)break;k=M}k!==null&&y.stopPropagation()}else Nh(s,l,y,null,d)}}var zr=null;function Qa(s,l,d,y){if(zr=null,s=j(y),s=xa(s),s!==null)if(l=Ue(s),l===null)s=null;else if(d=l.tag,d===13){if(s=et(l),s!==null)return s;s=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return zr=s,null}function ca(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lt()){case bt:return 1;case pn:return 4;case sn:case Sn:return 16;case ln:return 536870912;default:return 16}default:return 16}}var Wi=null,Xo=null,ha=null;function fu(){if(ha)return ha;var s,l=Xo,d=l.length,y,k="value"in Wi?Wi.value:Wi.textContent,M=k.length;for(s=0;s<d&&l[s]===k[s];s++);var $=d-s;for(y=1;y<=$&&l[d-y]===k[M-y];y++);return ha=k.slice(s,1<y?1-y:void 0)}function fa(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Ja(){return!0}function da(){return!1}function jn(s){function l(d,y,k,M,$){this._reactName=d,this._targetInst=k,this.type=y,this.nativeEvent=M,this.target=$,this.currentTarget=null;for(var ue in s)s.hasOwnProperty(ue)&&(d=s[ue],this[ue]=d?d(M):M[ue]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Ja:da,this.isPropagationStopped=da,this}return Qe(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ja)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ja)},persist:function(){},isPersistent:Ja}),l}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$a=jn(vi),Vr=Qe({},vi,{view:0,detail:0}),du=jn(Vr),kn,Go,os,yi=Qe({},Vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==os&&(os&&s.type==="mousemove"?(kn=s.screenX-os.screenX,Go=s.screenY-os.screenY):Go=kn=0,os=s),kn)},movementY:function(s){return"movementY"in s?s.movementY:Go}}),pu=jn(yi),wh=Qe({},yi,{dataTransfer:0}),bh=jn(wh),Sh=Qe({},Vr,{relatedTarget:0}),Yo=jn(Sh),Ch=Qe({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),kh=jn(Ch),Th=Qe({},vi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Eh=jn(Th),ls=Qe({},vi,{data:0}),Pn=jn(ls),gu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mu(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Oh[s])?!!l[s]:!1}function qo(){return mu}var eo=Qe({},Vr,{key:function(s){if(s.key){var l=gu[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=fa(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?pa[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qo,charCode:function(s){return s.type==="keypress"?fa(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?fa(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Is=jn(eo),vu=Qe({},yi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ko=jn(vu),Xt=Qe({},Vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qo}),Zo=jn(Xt),yu=Qe({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),_u=jn(yu),Bn=Qe({},yi,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ui=jn(Bn),Ft=[9,13,27,32],ga=p&&"CompositionEvent"in window,rn=null;p&&"documentMode"in document&&(rn=document.documentMode);var to=p&&"TextEvent"in window&&!rn,Hi=p&&(!ga||rn&&8<rn&&11>=rn),yn=" ",Jr=!1;function ma(s,l){switch(s){case"keyup":return Ft.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xu(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Xi=!1;function Ph(s,l){switch(s){case"compositionend":return xu(l);case"keypress":return l.which!==32?null:(Jr=!0,yn);case"textInput":return s=l.data,s===yn&&Jr?null:s;default:return null}}function Wr(s,l){if(Xi)return s==="compositionend"||!ga&&ma(s,l)?(s=fu(),ha=Xo=Wi=null,Xi=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Hi&&l.locale!=="ko"?null:l.data;default:return null}}var va={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ls(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!va[s.type]:l==="textarea"}function no(s,l,d,y){U(y),l=Ou(l,"onChange"),0<l.length&&(d=new $a("onChange","change",null,d,y),s.push({event:d,listeners:l}))}var Ds=null,Rs=null;function Xn(s){Ip(s,0)}function Ns(s){var l=oo(s);if(la(l))return s}function Ah(s,l){if(s==="change")return l}var wu=!1;if(p){var ya;if(p){var _a="oninput"in document;if(!_a){var bu=document.createElement("div");bu.setAttribute("oninput","return;"),_a=typeof bu.oninput=="function"}ya=_a}else ya=!1;wu=ya&&(!document.documentMode||9<document.documentMode)}function Fs(){Ds&&(Ds.detachEvent("onpropertychange",ro),Rs=Ds=null)}function ro(s){if(s.propertyName==="value"&&Ns(Rs)){var l=[];no(l,Rs,s,j(s)),X(Xn,l)}}function Mh(s,l,d){s==="focusin"?(Fs(),Ds=l,Rs=d,Ds.attachEvent("onpropertychange",ro)):s==="focusout"&&Fs()}function jh(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ns(Rs)}function Su(s,l){if(s==="click")return Ns(l)}function Qo(s,l){if(s==="input"||s==="change")return Ns(l)}function Jo(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var In=typeof Object.is=="function"?Object.is:Jo;function oe(s,l){if(In(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var d=Object.keys(s),y=Object.keys(l);if(d.length!==y.length)return!1;for(y=0;y<d.length;y++){var k=d[y];if(!m.call(l,k)||!In(s[k],l[k]))return!1}return!0}function pe(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Me(s,l){var d=pe(s);s=0;for(var y;d;){if(d.nodeType===3){if(y=s+d.textContent.length,s<=l&&y>=l)return{node:d,offset:l-s};s=y}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=pe(d)}}function Re(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?Re(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function St(){for(var s=window,l=Rr();l instanceof s.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)s=l.contentWindow;else break;l=Rr(s.document)}return l}function kt(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function It(s){var l=St(),d=s.focusedElem,y=s.selectionRange;if(l!==d&&d&&d.ownerDocument&&Re(d.ownerDocument.documentElement,d)){if(y!==null&&kt(d)){if(l=y.start,s=y.end,s===void 0&&(s=l),"selectionStart"in d)d.selectionStart=l,d.selectionEnd=Math.min(s,d.value.length);else if(s=(l=d.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var k=d.textContent.length,M=Math.min(y.start,k);y=y.end===void 0?M:Math.min(y.end,k),!s.extend&&M>y&&(k=y,y=M,M=k),k=Me(d,M);var $=Me(d,y);k&&$&&(s.rangeCount!==1||s.anchorNode!==k.node||s.anchorOffset!==k.offset||s.focusNode!==$.node||s.focusOffset!==$.offset)&&(l=l.createRange(),l.setStart(k.node,k.offset),s.removeAllRanges(),M>y?(s.addRange(l),s.extend($.node,$.offset)):(l.setEnd($.node,$.offset),s.addRange(l)))}}for(l=[],s=d;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<l.length;d++)s=l[d],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Zt=p&&"documentMode"in document&&11>=document.documentMode,Gn=null,_i=null,us=null,Bs=!1;function Cu(s,l,d){var y=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Bs||Gn==null||Gn!==Rr(y)||(y=Gn,"selectionStart"in y&&kt(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),us&&oe(us,y)||(us=y,y=Ou(_i,"onSelect"),0<y.length&&(l=new $a("onSelect","select",null,l,d),s.push({event:l,listeners:y}),l.target=Gn)))}function ku(s,l){var d={};return d[s.toLowerCase()]=l.toLowerCase(),d["Webkit"+s]="webkit"+l,d["Moz"+s]="moz"+l,d}var io={animationend:ku("Animation","AnimationEnd"),animationiteration:ku("Animation","AnimationIteration"),animationstart:ku("Animation","AnimationStart"),transitionend:ku("Transition","TransitionEnd")},Ih={},kp={};p&&(kp=document.createElement("div").style,"AnimationEvent"in window||(delete io.animationend.animation,delete io.animationiteration.animation,delete io.animationstart.animation),"TransitionEvent"in window||delete io.transitionend.transition);function Tu(s){if(Ih[s])return Ih[s];if(!io[s])return s;var l=io[s],d;for(d in l)if(l.hasOwnProperty(d)&&d in kp)return Ih[s]=l[d];return s}var Tp=Tu("animationend"),Ep=Tu("animationiteration"),Op=Tu("animationstart"),Pp=Tu("transitionend"),Ap=new Map,Mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zs(s,l){Ap.set(s,l),a(l,[s])}for(var Lh=0;Lh<Mp.length;Lh++){var Dh=Mp[Lh],e_=Dh.toLowerCase(),t_=Dh[0].toUpperCase()+Dh.slice(1);zs(e_,"on"+t_)}zs(Tp,"onAnimationEnd"),zs(Ep,"onAnimationIteration"),zs(Op,"onAnimationStart"),zs("dblclick","onDoubleClick"),zs("focusin","onFocus"),zs("focusout","onBlur"),zs(Pp,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $o="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n_=new Set("cancel close invalid load scroll toggle".split(" ").concat($o));function jp(s,l,d){var y=s.type||"unknown-event";s.currentTarget=d,Be(y,l,void 0,s),s.currentTarget=null}function Ip(s,l){l=(l&4)!==0;for(var d=0;d<s.length;d++){var y=s[d],k=y.event;y=y.listeners;e:{var M=void 0;if(l)for(var $=y.length-1;0<=$;$--){var ue=y[$],ve=ue.instance,Ae=ue.currentTarget;if(ue=ue.listener,ve!==M&&k.isPropagationStopped())break e;jp(k,ue,Ae),M=ve}else for($=0;$<y.length;$++){if(ue=y[$],ve=ue.instance,Ae=ue.currentTarget,ue=ue.listener,ve!==M&&k.isPropagationStopped())break e;jp(k,ue,Ae),M=ve}}}if(fe)throw s=ye,fe=!1,ye=null,s}function hn(s,l){var d=l[Uh];d===void 0&&(d=l[Uh]=new Set);var y=s+"__bubble";d.has(y)||(Lp(l,s,2,!1),d.add(y))}function Rh(s,l,d){var y=0;l&&(y|=4),Lp(d,s,y,l)}var Eu="_reactListening"+Math.random().toString(36).slice(2);function el(s){if(!s[Eu]){s[Eu]=!0,n.forEach(function(d){d!=="selectionchange"&&(n_.has(d)||Rh(d,!1,s),Rh(d,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Eu]||(l[Eu]=!0,Rh("selectionchange",!1,l))}}function Lp(s,l,d,y){switch(ca(l)){case 1:var k=mi;break;case 4:k=Zr;break;default:k=Qr}d=k.bind(null,l,d,s),k=void 0,!ie||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(k=!0),y?k!==void 0?s.addEventListener(l,d,{capture:!0,passive:k}):s.addEventListener(l,d,!0):k!==void 0?s.addEventListener(l,d,{passive:k}):s.addEventListener(l,d,!1)}function Nh(s,l,d,y,k){var M=y;if((l&1)===0&&(l&2)===0&&y!==null)e:for(;;){if(y===null)return;var $=y.tag;if($===3||$===4){var ue=y.stateNode.containerInfo;if(ue===k||ue.nodeType===8&&ue.parentNode===k)break;if($===4)for($=y.return;$!==null;){var ve=$.tag;if((ve===3||ve===4)&&(ve=$.stateNode.containerInfo,ve===k||ve.nodeType===8&&ve.parentNode===k))return;$=$.return}for(;ue!==null;){if($=xa(ue),$===null)return;if(ve=$.tag,ve===5||ve===6){y=M=$;continue e}ue=ue.parentNode}}y=y.return}X(function(){var Ae=M,Ye=j(d),Je=[];e:{var He=Ap.get(s);if(He!==void 0){var ut=$a,ft=s;switch(s){case"keypress":if(fa(d)===0)break e;case"keydown":case"keyup":ut=Is;break;case"focusin":ft="focus",ut=Yo;break;case"focusout":ft="blur",ut=Yo;break;case"beforeblur":case"afterblur":ut=Yo;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=pu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=bh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=Zo;break;case Tp:case Ep:case Op:ut=kh;break;case Pp:ut=_u;break;case"scroll":ut=du;break;case"wheel":ut=Ui;break;case"copy":case"cut":case"paste":ut=Eh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=Ko}var gt=(l&4)!==0,An=!gt&&s==="scroll",Te=gt?He!==null?He+"Capture":null:He;gt=[];for(var _e=Ae,Pe;_e!==null;){Pe=_e;var nt=Pe.stateNode;if(Pe.tag===5&&nt!==null&&(Pe=nt,Te!==null&&(nt=te(_e,Te),nt!=null&&gt.push(tl(_e,nt,Pe)))),An)break;_e=_e.return}0<gt.length&&(He=new ut(He,ft,null,d,Ye),Je.push({event:He,listeners:gt}))}}if((l&7)===0){e:{if(He=s==="mouseover"||s==="pointerover",ut=s==="mouseout"||s==="pointerout",He&&d!==L&&(ft=d.relatedTarget||d.fromElement)&&(xa(ft)||ft[cs]))break e;if((ut||He)&&(He=Ye.window===Ye?Ye:(He=Ye.ownerDocument)?He.defaultView||He.parentWindow:window,ut?(ft=d.relatedTarget||d.toElement,ut=Ae,ft=ft?xa(ft):null,ft!==null&&(An=Ue(ft),ft!==An||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(ut=null,ft=Ae),ut!==ft)){if(gt=pu,nt="onMouseLeave",Te="onMouseEnter",_e="mouse",(s==="pointerout"||s==="pointerover")&&(gt=Ko,nt="onPointerLeave",Te="onPointerEnter",_e="pointer"),An=ut==null?He:oo(ut),Pe=ft==null?He:oo(ft),He=new gt(nt,_e+"leave",ut,d,Ye),He.target=An,He.relatedTarget=Pe,nt=null,xa(Ye)===Ae&&(gt=new gt(Te,_e+"enter",ft,d,Ye),gt.target=Pe,gt.relatedTarget=An,nt=gt),An=nt,ut&&ft)t:{for(gt=ut,Te=ft,_e=0,Pe=gt;Pe;Pe=so(Pe))_e++;for(Pe=0,nt=Te;nt;nt=so(nt))Pe++;for(;0<_e-Pe;)gt=so(gt),_e--;for(;0<Pe-_e;)Te=so(Te),Pe--;for(;_e--;){if(gt===Te||Te!==null&&gt===Te.alternate)break t;gt=so(gt),Te=so(Te)}gt=null}else gt=null;ut!==null&&Dp(Je,He,ut,gt,!1),ft!==null&&An!==null&&Dp(Je,An,ft,gt,!0)}}e:{if(He=Ae?oo(Ae):window,ut=He.nodeName&&He.nodeName.toLowerCase(),ut==="select"||ut==="input"&&He.type==="file")var mt=Ah;else if(Ls(He))if(wu)mt=Qo;else{mt=jh;var Tt=Mh}else(ut=He.nodeName)&&ut.toLowerCase()==="input"&&(He.type==="checkbox"||He.type==="radio")&&(mt=Su);if(mt&&(mt=mt(s,Ae))){no(Je,mt,d,Ye);break e}Tt&&Tt(s,He,Ae),s==="focusout"&&(Tt=He._wrapperState)&&Tt.controlled&&He.type==="number"&&Ni(He,"number",He.value)}switch(Tt=Ae?oo(Ae):window,s){case"focusin":(Ls(Tt)||Tt.contentEditable==="true")&&(Gn=Tt,_i=Ae,us=null);break;case"focusout":us=_i=Gn=null;break;case"mousedown":Bs=!0;break;case"contextmenu":case"mouseup":case"dragend":Bs=!1,Cu(Je,d,Ye);break;case"selectionchange":if(Zt)break;case"keydown":case"keyup":Cu(Je,d,Ye)}var Et;if(ga)e:{switch(s){case"compositionstart":var Dt="onCompositionStart";break e;case"compositionend":Dt="onCompositionEnd";break e;case"compositionupdate":Dt="onCompositionUpdate";break e}Dt=void 0}else Xi?ma(s,d)&&(Dt="onCompositionEnd"):s==="keydown"&&d.keyCode===229&&(Dt="onCompositionStart");Dt&&(Hi&&d.locale!=="ko"&&(Xi||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&Xi&&(Et=fu()):(Wi=Ye,Xo="value"in Wi?Wi.value:Wi.textContent,Xi=!0)),Tt=Ou(Ae,Dt),0<Tt.length&&(Dt=new Pn(Dt,s,null,d,Ye),Je.push({event:Dt,listeners:Tt}),Et?Dt.data=Et:(Et=xu(d),Et!==null&&(Dt.data=Et)))),(Et=to?Ph(s,d):Wr(s,d))&&(Ae=Ou(Ae,"onBeforeInput"),0<Ae.length&&(Ye=new Pn("onBeforeInput","beforeinput",null,d,Ye),Je.push({event:Ye,listeners:Ae}),Ye.data=Et))}Ip(Je,l)})}function tl(s,l,d){return{instance:s,listener:l,currentTarget:d}}function Ou(s,l){for(var d=l+"Capture",y=[];s!==null;){var k=s,M=k.stateNode;k.tag===5&&M!==null&&(k=M,M=te(s,d),M!=null&&y.unshift(tl(s,M,k)),M=te(s,l),M!=null&&y.push(tl(s,M,k))),s=s.return}return y}function so(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function Dp(s,l,d,y,k){for(var M=l._reactName,$=[];d!==null&&d!==y;){var ue=d,ve=ue.alternate,Ae=ue.stateNode;if(ve!==null&&ve===y)break;ue.tag===5&&Ae!==null&&(ue=Ae,k?(ve=te(d,M),ve!=null&&$.unshift(tl(d,ve,ue))):k||(ve=te(d,M),ve!=null&&$.push(tl(d,ve,ue)))),d=d.return}$.length!==0&&s.push({event:l,listeners:$})}var r_=/\r\n?/g,i_=/\u0000|\uFFFD/g;function Rp(s){return(typeof s=="string"?s:""+s).replace(r_,`
`).replace(i_,"")}function Pu(s,l,d){if(l=Rp(l),Rp(s)!==l&&d)throw Error(t(425))}function Au(){}var Fh=null,Bh=null;function zh(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Vh=typeof setTimeout=="function"?setTimeout:void 0,s_=typeof clearTimeout=="function"?clearTimeout:void 0,Np=typeof Promise=="function"?Promise:void 0,a_=typeof queueMicrotask=="function"?queueMicrotask:typeof Np<"u"?function(s){return Np.resolve(null).then(s).catch(o_)}:Vh;function o_(s){setTimeout(function(){throw s})}function Wh(s,l){var d=l,y=0;do{var k=d.nextSibling;if(s.removeChild(d),k&&k.nodeType===8)if(d=k.data,d==="/$"){if(y===0){s.removeChild(k),Kt(l);return}y--}else d!=="$"&&d!=="$?"&&d!=="$!"||y++;d=k}while(d);Kt(l)}function Vs(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function Fp(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var d=s.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return s;l--}else d==="/$"&&l++}s=s.previousSibling}return null}var ao=Math.random().toString(36).slice(2),Gi="__reactFiber$"+ao,nl="__reactProps$"+ao,cs="__reactContainer$"+ao,Uh="__reactEvents$"+ao,l_="__reactListeners$"+ao,u_="__reactHandles$"+ao;function xa(s){var l=s[Gi];if(l)return l;for(var d=s.parentNode;d;){if(l=d[cs]||d[Gi]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(s=Fp(s);s!==null;){if(d=s[Gi])return d;s=Fp(s)}return l}s=d,d=s.parentNode}return null}function rl(s){return s=s[Gi]||s[cs],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function oo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Mu(s){return s[nl]||null}var Hh=[],lo=-1;function Ws(s){return{current:s}}function fn(s){0>lo||(s.current=Hh[lo],Hh[lo]=null,lo--)}function un(s,l){lo++,Hh[lo]=s.current,s.current=l}var Us={},sr=Ws(Us),kr=Ws(!1),wa=Us;function uo(s,l){var d=s.type.contextTypes;if(!d)return Us;var y=s.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===l)return y.__reactInternalMemoizedMaskedChildContext;var k={},M;for(M in d)k[M]=l[M];return y&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=k),k}function Tr(s){return s=s.childContextTypes,s!=null}function ju(){fn(kr),fn(sr)}function Bp(s,l,d){if(sr.current!==Us)throw Error(t(168));un(sr,l),un(kr,d)}function zp(s,l,d){var y=s.stateNode;if(l=l.childContextTypes,typeof y.getChildContext!="function")return d;y=y.getChildContext();for(var k in y)if(!(k in l))throw Error(t(108,zt(s)||"Unknown",k));return Qe({},d,y)}function Iu(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Us,wa=sr.current,un(sr,s),un(kr,kr.current),!0}function Vp(s,l,d){var y=s.stateNode;if(!y)throw Error(t(169));d?(s=zp(s,l,wa),y.__reactInternalMemoizedMergedChildContext=s,fn(kr),fn(sr),un(sr,s)):fn(kr),un(kr,d)}var hs=null,Lu=!1,Xh=!1;function Wp(s){hs===null?hs=[s]:hs.push(s)}function c_(s){Lu=!0,Wp(s)}function Hs(){if(!Xh&&hs!==null){Xh=!0;var s=0,l=Vt;try{var d=hs;for(Vt=1;s<d.length;s++){var y=d[s];do y=y(!0);while(y!==null)}hs=null,Lu=!1}catch(k){throw hs!==null&&(hs=hs.slice(s+1)),at(bt,Hs),k}finally{Vt=l,Xh=!1}}return null}var co=[],ho=0,Du=null,Ru=0,$r=[],ei=0,ba=null,fs=1,ds="";function Sa(s,l){co[ho++]=Ru,co[ho++]=Du,Du=s,Ru=l}function Up(s,l,d){$r[ei++]=fs,$r[ei++]=ds,$r[ei++]=ba,ba=s;var y=fs;s=ds;var k=32-qt(y)-1;y&=~(1<<k),d+=1;var M=32-qt(l)+k;if(30<M){var $=k-k%5;M=(y&(1<<$)-1).toString(32),y>>=$,k-=$,fs=1<<32-qt(l)+k|d<<k|y,ds=M+s}else fs=1<<M|d<<k|y,ds=s}function Gh(s){s.return!==null&&(Sa(s,1),Up(s,1,0))}function Yh(s){for(;s===Du;)Du=co[--ho],co[ho]=null,Ru=co[--ho],co[ho]=null;for(;s===ba;)ba=$r[--ei],$r[ei]=null,ds=$r[--ei],$r[ei]=null,fs=$r[--ei],$r[ei]=null}var Ur=null,Hr=null,gn=!1,xi=null;function Hp(s,l){var d=ii(5,null,null,0);d.elementType="DELETED",d.stateNode=l,d.return=s,l=s.deletions,l===null?(s.deletions=[d],s.flags|=16):l.push(d)}function Xp(s,l){switch(s.tag){case 5:var d=s.type;return l=l.nodeType!==1||d.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,Ur=s,Hr=Vs(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,Ur=s,Hr=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(d=ba!==null?{id:fs,overflow:ds}:null,s.memoizedState={dehydrated:l,treeContext:d,retryLane:1073741824},d=ii(18,null,null,0),d.stateNode=l,d.return=s,s.child=d,Ur=s,Hr=null,!0):!1;default:return!1}}function qh(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Kh(s){if(gn){var l=Hr;if(l){var d=l;if(!Xp(s,l)){if(qh(s))throw Error(t(418));l=Vs(d.nextSibling);var y=Ur;l&&Xp(s,l)?Hp(y,d):(s.flags=s.flags&-4097|2,gn=!1,Ur=s)}}else{if(qh(s))throw Error(t(418));s.flags=s.flags&-4097|2,gn=!1,Ur=s}}}function Gp(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Ur=s}function Nu(s){if(s!==Ur)return!1;if(!gn)return Gp(s),gn=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!zh(s.type,s.memoizedProps)),l&&(l=Hr)){if(qh(s))throw Yp(),Error(t(418));for(;l;)Hp(s,l),l=Vs(l.nextSibling)}if(Gp(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var d=s.data;if(d==="/$"){if(l===0){Hr=Vs(s.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++}s=s.nextSibling}Hr=null}}else Hr=Ur?Vs(s.stateNode.nextSibling):null;return!0}function Yp(){for(var s=Hr;s;)s=Vs(s.nextSibling)}function fo(){Hr=Ur=null,gn=!1}function Zh(s){xi===null?xi=[s]:xi.push(s)}var h_=ge.ReactCurrentBatchConfig;function il(s,l,d){if(s=d.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var y=d.stateNode}if(!y)throw Error(t(147,s));var k=y,M=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===M?l.ref:(l=function($){var ue=k.refs;$===null?delete ue[M]:ue[M]=$},l._stringRef=M,l)}if(typeof s!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,s))}return s}function Fu(s,l){throw s=Object.prototype.toString.call(l),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function qp(s){var l=s._init;return l(s._payload)}function Kp(s){function l(Te,_e){if(s){var Pe=Te.deletions;Pe===null?(Te.deletions=[_e],Te.flags|=16):Pe.push(_e)}}function d(Te,_e){if(!s)return null;for(;_e!==null;)l(Te,_e),_e=_e.sibling;return null}function y(Te,_e){for(Te=new Map;_e!==null;)_e.key!==null?Te.set(_e.key,_e):Te.set(_e.index,_e),_e=_e.sibling;return Te}function k(Te,_e){return Te=Js(Te,_e),Te.index=0,Te.sibling=null,Te}function M(Te,_e,Pe){return Te.index=Pe,s?(Pe=Te.alternate,Pe!==null?(Pe=Pe.index,Pe<_e?(Te.flags|=2,_e):Pe):(Te.flags|=2,_e)):(Te.flags|=1048576,_e)}function $(Te){return s&&Te.alternate===null&&(Te.flags|=2),Te}function ue(Te,_e,Pe,nt){return _e===null||_e.tag!==6?(_e=Wf(Pe,Te.mode,nt),_e.return=Te,_e):(_e=k(_e,Pe),_e.return=Te,_e)}function ve(Te,_e,Pe,nt){var mt=Pe.type;return mt===Ne?Ye(Te,_e,Pe.props.children,nt,Pe.key):_e!==null&&(_e.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===Le&&qp(mt)===_e.type)?(nt=k(_e,Pe.props),nt.ref=il(Te,_e,Pe),nt.return=Te,nt):(nt=lc(Pe.type,Pe.key,Pe.props,null,Te.mode,nt),nt.ref=il(Te,_e,Pe),nt.return=Te,nt)}function Ae(Te,_e,Pe,nt){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==Pe.containerInfo||_e.stateNode.implementation!==Pe.implementation?(_e=Uf(Pe,Te.mode,nt),_e.return=Te,_e):(_e=k(_e,Pe.children||[]),_e.return=Te,_e)}function Ye(Te,_e,Pe,nt,mt){return _e===null||_e.tag!==7?(_e=Ma(Pe,Te.mode,nt,mt),_e.return=Te,_e):(_e=k(_e,Pe),_e.return=Te,_e)}function Je(Te,_e,Pe){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return _e=Wf(""+_e,Te.mode,Pe),_e.return=Te,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case xe:return Pe=lc(_e.type,_e.key,_e.props,null,Te.mode,Pe),Pe.ref=il(Te,null,_e),Pe.return=Te,Pe;case F:return _e=Uf(_e,Te.mode,Pe),_e.return=Te,_e;case Le:var nt=_e._init;return Je(Te,nt(_e._payload),Pe)}if(qr(_e)||Xe(_e))return _e=Ma(_e,Te.mode,Pe,null),_e.return=Te,_e;Fu(Te,_e)}return null}function He(Te,_e,Pe,nt){var mt=_e!==null?_e.key:null;if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return mt!==null?null:ue(Te,_e,""+Pe,nt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case xe:return Pe.key===mt?ve(Te,_e,Pe,nt):null;case F:return Pe.key===mt?Ae(Te,_e,Pe,nt):null;case Le:return mt=Pe._init,He(Te,_e,mt(Pe._payload),nt)}if(qr(Pe)||Xe(Pe))return mt!==null?null:Ye(Te,_e,Pe,nt,null);Fu(Te,Pe)}return null}function ut(Te,_e,Pe,nt,mt){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return Te=Te.get(Pe)||null,ue(_e,Te,""+nt,mt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case xe:return Te=Te.get(nt.key===null?Pe:nt.key)||null,ve(_e,Te,nt,mt);case F:return Te=Te.get(nt.key===null?Pe:nt.key)||null,Ae(_e,Te,nt,mt);case Le:var Tt=nt._init;return ut(Te,_e,Pe,Tt(nt._payload),mt)}if(qr(nt)||Xe(nt))return Te=Te.get(Pe)||null,Ye(_e,Te,nt,mt,null);Fu(_e,nt)}return null}function ft(Te,_e,Pe,nt){for(var mt=null,Tt=null,Et=_e,Dt=_e=0,Kn=null;Et!==null&&Dt<Pe.length;Dt++){Et.index>Dt?(Kn=Et,Et=null):Kn=Et.sibling;var Jt=He(Te,Et,Pe[Dt],nt);if(Jt===null){Et===null&&(Et=Kn);break}s&&Et&&Jt.alternate===null&&l(Te,Et),_e=M(Jt,_e,Dt),Tt===null?mt=Jt:Tt.sibling=Jt,Tt=Jt,Et=Kn}if(Dt===Pe.length)return d(Te,Et),gn&&Sa(Te,Dt),mt;if(Et===null){for(;Dt<Pe.length;Dt++)Et=Je(Te,Pe[Dt],nt),Et!==null&&(_e=M(Et,_e,Dt),Tt===null?mt=Et:Tt.sibling=Et,Tt=Et);return gn&&Sa(Te,Dt),mt}for(Et=y(Te,Et);Dt<Pe.length;Dt++)Kn=ut(Et,Te,Dt,Pe[Dt],nt),Kn!==null&&(s&&Kn.alternate!==null&&Et.delete(Kn.key===null?Dt:Kn.key),_e=M(Kn,_e,Dt),Tt===null?mt=Kn:Tt.sibling=Kn,Tt=Kn);return s&&Et.forEach(function($s){return l(Te,$s)}),gn&&Sa(Te,Dt),mt}function gt(Te,_e,Pe,nt){var mt=Xe(Pe);if(typeof mt!="function")throw Error(t(150));if(Pe=mt.call(Pe),Pe==null)throw Error(t(151));for(var Tt=mt=null,Et=_e,Dt=_e=0,Kn=null,Jt=Pe.next();Et!==null&&!Jt.done;Dt++,Jt=Pe.next()){Et.index>Dt?(Kn=Et,Et=null):Kn=Et.sibling;var $s=He(Te,Et,Jt.value,nt);if($s===null){Et===null&&(Et=Kn);break}s&&Et&&$s.alternate===null&&l(Te,Et),_e=M($s,_e,Dt),Tt===null?mt=$s:Tt.sibling=$s,Tt=$s,Et=Kn}if(Jt.done)return d(Te,Et),gn&&Sa(Te,Dt),mt;if(Et===null){for(;!Jt.done;Dt++,Jt=Pe.next())Jt=Je(Te,Jt.value,nt),Jt!==null&&(_e=M(Jt,_e,Dt),Tt===null?mt=Jt:Tt.sibling=Jt,Tt=Jt);return gn&&Sa(Te,Dt),mt}for(Et=y(Te,Et);!Jt.done;Dt++,Jt=Pe.next())Jt=ut(Et,Te,Dt,Jt.value,nt),Jt!==null&&(s&&Jt.alternate!==null&&Et.delete(Jt.key===null?Dt:Jt.key),_e=M(Jt,_e,Dt),Tt===null?mt=Jt:Tt.sibling=Jt,Tt=Jt);return s&&Et.forEach(function(H_){return l(Te,H_)}),gn&&Sa(Te,Dt),mt}function An(Te,_e,Pe,nt){if(typeof Pe=="object"&&Pe!==null&&Pe.type===Ne&&Pe.key===null&&(Pe=Pe.props.children),typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case xe:e:{for(var mt=Pe.key,Tt=_e;Tt!==null;){if(Tt.key===mt){if(mt=Pe.type,mt===Ne){if(Tt.tag===7){d(Te,Tt.sibling),_e=k(Tt,Pe.props.children),_e.return=Te,Te=_e;break e}}else if(Tt.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===Le&&qp(mt)===Tt.type){d(Te,Tt.sibling),_e=k(Tt,Pe.props),_e.ref=il(Te,Tt,Pe),_e.return=Te,Te=_e;break e}d(Te,Tt);break}else l(Te,Tt);Tt=Tt.sibling}Pe.type===Ne?(_e=Ma(Pe.props.children,Te.mode,nt,Pe.key),_e.return=Te,Te=_e):(nt=lc(Pe.type,Pe.key,Pe.props,null,Te.mode,nt),nt.ref=il(Te,_e,Pe),nt.return=Te,Te=nt)}return $(Te);case F:e:{for(Tt=Pe.key;_e!==null;){if(_e.key===Tt)if(_e.tag===4&&_e.stateNode.containerInfo===Pe.containerInfo&&_e.stateNode.implementation===Pe.implementation){d(Te,_e.sibling),_e=k(_e,Pe.children||[]),_e.return=Te,Te=_e;break e}else{d(Te,_e);break}else l(Te,_e);_e=_e.sibling}_e=Uf(Pe,Te.mode,nt),_e.return=Te,Te=_e}return $(Te);case Le:return Tt=Pe._init,An(Te,_e,Tt(Pe._payload),nt)}if(qr(Pe))return ft(Te,_e,Pe,nt);if(Xe(Pe))return gt(Te,_e,Pe,nt);Fu(Te,Pe)}return typeof Pe=="string"&&Pe!==""||typeof Pe=="number"?(Pe=""+Pe,_e!==null&&_e.tag===6?(d(Te,_e.sibling),_e=k(_e,Pe),_e.return=Te,Te=_e):(d(Te,_e),_e=Wf(Pe,Te.mode,nt),_e.return=Te,Te=_e),$(Te)):d(Te,_e)}return An}var po=Kp(!0),Zp=Kp(!1),Bu=Ws(null),zu=null,go=null,Qh=null;function Jh(){Qh=go=zu=null}function $h(s){var l=Bu.current;fn(Bu),s._currentValue=l}function ef(s,l,d){for(;s!==null;){var y=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,y!==null&&(y.childLanes|=l)):y!==null&&(y.childLanes&l)!==l&&(y.childLanes|=l),s===d)break;s=s.return}}function mo(s,l){zu=s,Qh=go=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&l)!==0&&(Er=!0),s.firstContext=null)}function ti(s){var l=s._currentValue;if(Qh!==s)if(s={context:s,memoizedValue:l,next:null},go===null){if(zu===null)throw Error(t(308));go=s,zu.dependencies={lanes:0,firstContext:s}}else go=go.next=s;return l}var Ca=null;function tf(s){Ca===null?Ca=[s]:Ca.push(s)}function Qp(s,l,d,y){var k=l.interleaved;return k===null?(d.next=d,tf(l)):(d.next=k.next,k.next=d),l.interleaved=d,ps(s,y)}function ps(s,l){s.lanes|=l;var d=s.alternate;for(d!==null&&(d.lanes|=l),d=s,s=s.return;s!==null;)s.childLanes|=l,d=s.alternate,d!==null&&(d.childLanes|=l),d=s,s=s.return;return d.tag===3?d.stateNode:null}var Xs=!1;function nf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jp(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function gs(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function Gs(s,l,d){var y=s.updateQueue;if(y===null)return null;if(y=y.shared,(Qt&2)!==0){var k=y.pending;return k===null?l.next=l:(l.next=k.next,k.next=l),y.pending=l,ps(s,d)}return k=y.interleaved,k===null?(l.next=l,tf(y)):(l.next=k.next,k.next=l),y.interleaved=l,ps(s,d)}function Vu(s,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194240)!==0)){var y=l.lanes;y&=s.pendingLanes,d|=y,l.lanes=d,Bi(s,d)}}function $p(s,l){var d=s.updateQueue,y=s.alternate;if(y!==null&&(y=y.updateQueue,d===y)){var k=null,M=null;if(d=d.firstBaseUpdate,d!==null){do{var $={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};M===null?k=M=$:M=M.next=$,d=d.next}while(d!==null);M===null?k=M=l:M=M.next=l}else k=M=l;d={baseState:y.baseState,firstBaseUpdate:k,lastBaseUpdate:M,shared:y.shared,effects:y.effects},s.updateQueue=d;return}s=d.lastBaseUpdate,s===null?d.firstBaseUpdate=l:s.next=l,d.lastBaseUpdate=l}function Wu(s,l,d,y){var k=s.updateQueue;Xs=!1;var M=k.firstBaseUpdate,$=k.lastBaseUpdate,ue=k.shared.pending;if(ue!==null){k.shared.pending=null;var ve=ue,Ae=ve.next;ve.next=null,$===null?M=Ae:$.next=Ae,$=ve;var Ye=s.alternate;Ye!==null&&(Ye=Ye.updateQueue,ue=Ye.lastBaseUpdate,ue!==$&&(ue===null?Ye.firstBaseUpdate=Ae:ue.next=Ae,Ye.lastBaseUpdate=ve))}if(M!==null){var Je=k.baseState;$=0,Ye=Ae=ve=null,ue=M;do{var He=ue.lane,ut=ue.eventTime;if((y&He)===He){Ye!==null&&(Ye=Ye.next={eventTime:ut,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var ft=s,gt=ue;switch(He=l,ut=d,gt.tag){case 1:if(ft=gt.payload,typeof ft=="function"){Je=ft.call(ut,Je,He);break e}Je=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=gt.payload,He=typeof ft=="function"?ft.call(ut,Je,He):ft,He==null)break e;Je=Qe({},Je,He);break e;case 2:Xs=!0}}ue.callback!==null&&ue.lane!==0&&(s.flags|=64,He=k.effects,He===null?k.effects=[ue]:He.push(ue))}else ut={eventTime:ut,lane:He,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Ye===null?(Ae=Ye=ut,ve=Je):Ye=Ye.next=ut,$|=He;if(ue=ue.next,ue===null){if(ue=k.shared.pending,ue===null)break;He=ue,ue=He.next,He.next=null,k.lastBaseUpdate=He,k.shared.pending=null}}while(!0);if(Ye===null&&(ve=Je),k.baseState=ve,k.firstBaseUpdate=Ae,k.lastBaseUpdate=Ye,l=k.shared.interleaved,l!==null){k=l;do $|=k.lane,k=k.next;while(k!==l)}else M===null&&(k.shared.lanes=0);Ea|=$,s.lanes=$,s.memoizedState=Je}}function eg(s,l,d){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var y=s[l],k=y.callback;if(k!==null){if(y.callback=null,y=d,typeof k!="function")throw Error(t(191,k));k.call(y)}}}var sl={},Yi=Ws(sl),al=Ws(sl),ol=Ws(sl);function ka(s){if(s===sl)throw Error(t(174));return s}function rf(s,l){switch(un(ol,l),un(al,s),un(Yi,sl),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:u(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=u(l,s)}fn(Yi),un(Yi,l)}function vo(){fn(Yi),fn(al),fn(ol)}function tg(s){ka(ol.current);var l=ka(Yi.current),d=u(l,s.type);l!==d&&(un(al,s),un(Yi,d))}function sf(s){al.current===s&&(fn(Yi),fn(al))}var _n=Ws(0);function Uu(s){for(var l=s;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var af=[];function of(){for(var s=0;s<af.length;s++)af[s]._workInProgressVersionPrimary=null;af.length=0}var Hu=ge.ReactCurrentDispatcher,lf=ge.ReactCurrentBatchConfig,Ta=0,xn=null,zn=null,Yn=null,Xu=!1,ll=!1,ul=0,f_=0;function ar(){throw Error(t(321))}function uf(s,l){if(l===null)return!1;for(var d=0;d<l.length&&d<s.length;d++)if(!In(s[d],l[d]))return!1;return!0}function cf(s,l,d,y,k,M){if(Ta=M,xn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Hu.current=s===null||s.memoizedState===null?m_:v_,s=d(y,k),ll){M=0;do{if(ll=!1,ul=0,25<=M)throw Error(t(301));M+=1,Yn=zn=null,l.updateQueue=null,Hu.current=y_,s=d(y,k)}while(ll)}if(Hu.current=qu,l=zn!==null&&zn.next!==null,Ta=0,Yn=zn=xn=null,Xu=!1,l)throw Error(t(300));return s}function hf(){var s=ul!==0;return ul=0,s}function qi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yn===null?xn.memoizedState=Yn=s:Yn=Yn.next=s,Yn}function ni(){if(zn===null){var s=xn.alternate;s=s!==null?s.memoizedState:null}else s=zn.next;var l=Yn===null?xn.memoizedState:Yn.next;if(l!==null)Yn=l,zn=s;else{if(s===null)throw Error(t(310));zn=s,s={memoizedState:zn.memoizedState,baseState:zn.baseState,baseQueue:zn.baseQueue,queue:zn.queue,next:null},Yn===null?xn.memoizedState=Yn=s:Yn=Yn.next=s}return Yn}function cl(s,l){return typeof l=="function"?l(s):l}function ff(s){var l=ni(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var y=zn,k=y.baseQueue,M=d.pending;if(M!==null){if(k!==null){var $=k.next;k.next=M.next,M.next=$}y.baseQueue=k=M,d.pending=null}if(k!==null){M=k.next,y=y.baseState;var ue=$=null,ve=null,Ae=M;do{var Ye=Ae.lane;if((Ta&Ye)===Ye)ve!==null&&(ve=ve.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),y=Ae.hasEagerState?Ae.eagerState:s(y,Ae.action);else{var Je={lane:Ye,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};ve===null?(ue=ve=Je,$=y):ve=ve.next=Je,xn.lanes|=Ye,Ea|=Ye}Ae=Ae.next}while(Ae!==null&&Ae!==M);ve===null?$=y:ve.next=ue,In(y,l.memoizedState)||(Er=!0),l.memoizedState=y,l.baseState=$,l.baseQueue=ve,d.lastRenderedState=y}if(s=d.interleaved,s!==null){k=s;do M=k.lane,xn.lanes|=M,Ea|=M,k=k.next;while(k!==s)}else k===null&&(d.lanes=0);return[l.memoizedState,d.dispatch]}function df(s){var l=ni(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=s;var y=d.dispatch,k=d.pending,M=l.memoizedState;if(k!==null){d.pending=null;var $=k=k.next;do M=s(M,$.action),$=$.next;while($!==k);In(M,l.memoizedState)||(Er=!0),l.memoizedState=M,l.baseQueue===null&&(l.baseState=M),d.lastRenderedState=M}return[M,y]}function ng(){}function rg(s,l){var d=xn,y=ni(),k=l(),M=!In(y.memoizedState,k);if(M&&(y.memoizedState=k,Er=!0),y=y.queue,pf(ag.bind(null,d,y,s),[s]),y.getSnapshot!==l||M||Yn!==null&&Yn.memoizedState.tag&1){if(d.flags|=2048,hl(9,sg.bind(null,d,y,k,l),void 0,null),qn===null)throw Error(t(349));(Ta&30)!==0||ig(d,l,k)}return k}function ig(s,l,d){s.flags|=16384,s={getSnapshot:l,value:d},l=xn.updateQueue,l===null?(l={lastEffect:null,stores:null},xn.updateQueue=l,l.stores=[s]):(d=l.stores,d===null?l.stores=[s]:d.push(s))}function sg(s,l,d,y){l.value=d,l.getSnapshot=y,og(l)&&lg(s)}function ag(s,l,d){return d(function(){og(l)&&lg(s)})}function og(s){var l=s.getSnapshot;s=s.value;try{var d=l();return!In(s,d)}catch{return!0}}function lg(s){var l=ps(s,1);l!==null&&Ci(l,s,1,-1)}function ug(s){var l=qi();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cl,lastRenderedState:s},l.queue=s,s=s.dispatch=g_.bind(null,xn,s),[l.memoizedState,s]}function hl(s,l,d,y){return s={tag:s,create:l,destroy:d,deps:y,next:null},l=xn.updateQueue,l===null?(l={lastEffect:null,stores:null},xn.updateQueue=l,l.lastEffect=s.next=s):(d=l.lastEffect,d===null?l.lastEffect=s.next=s:(y=d.next,d.next=s,s.next=y,l.lastEffect=s)),s}function cg(){return ni().memoizedState}function Gu(s,l,d,y){var k=qi();xn.flags|=s,k.memoizedState=hl(1|l,d,void 0,y===void 0?null:y)}function Yu(s,l,d,y){var k=ni();y=y===void 0?null:y;var M=void 0;if(zn!==null){var $=zn.memoizedState;if(M=$.destroy,y!==null&&uf(y,$.deps)){k.memoizedState=hl(l,d,M,y);return}}xn.flags|=s,k.memoizedState=hl(1|l,d,M,y)}function hg(s,l){return Gu(8390656,8,s,l)}function pf(s,l){return Yu(2048,8,s,l)}function fg(s,l){return Yu(4,2,s,l)}function dg(s,l){return Yu(4,4,s,l)}function pg(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function gg(s,l,d){return d=d!=null?d.concat([s]):null,Yu(4,4,pg.bind(null,l,s),d)}function gf(){}function mg(s,l){var d=ni();l=l===void 0?null:l;var y=d.memoizedState;return y!==null&&l!==null&&uf(l,y[1])?y[0]:(d.memoizedState=[s,l],s)}function vg(s,l){var d=ni();l=l===void 0?null:l;var y=d.memoizedState;return y!==null&&l!==null&&uf(l,y[1])?y[0]:(s=s(),d.memoizedState=[s,l],s)}function yg(s,l,d){return(Ta&21)===0?(s.baseState&&(s.baseState=!1,Er=!0),s.memoizedState=d):(In(d,l)||(d=Ms(),xn.lanes|=d,Ea|=d,s.baseState=!0),l)}function d_(s,l){var d=Vt;Vt=d!==0&&4>d?d:4,s(!0);var y=lf.transition;lf.transition={};try{s(!1),l()}finally{Vt=d,lf.transition=y}}function _g(){return ni().memoizedState}function p_(s,l,d){var y=Zs(s);if(d={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null},xg(s))wg(l,d);else if(d=Qp(s,l,d,y),d!==null){var k=gr();Ci(d,s,y,k),bg(d,l,y)}}function g_(s,l,d){var y=Zs(s),k={lane:y,action:d,hasEagerState:!1,eagerState:null,next:null};if(xg(s))wg(l,k);else{var M=s.alternate;if(s.lanes===0&&(M===null||M.lanes===0)&&(M=l.lastRenderedReducer,M!==null))try{var $=l.lastRenderedState,ue=M($,d);if(k.hasEagerState=!0,k.eagerState=ue,In(ue,$)){var ve=l.interleaved;ve===null?(k.next=k,tf(l)):(k.next=ve.next,ve.next=k),l.interleaved=k;return}}catch{}finally{}d=Qp(s,l,k,y),d!==null&&(k=gr(),Ci(d,s,y,k),bg(d,l,y))}}function xg(s){var l=s.alternate;return s===xn||l!==null&&l===xn}function wg(s,l){ll=Xu=!0;var d=s.pending;d===null?l.next=l:(l.next=d.next,d.next=l),s.pending=l}function bg(s,l,d){if((d&4194240)!==0){var y=l.lanes;y&=s.pendingLanes,d|=y,l.lanes=d,Bi(s,d)}}var qu={readContext:ti,useCallback:ar,useContext:ar,useEffect:ar,useImperativeHandle:ar,useInsertionEffect:ar,useLayoutEffect:ar,useMemo:ar,useReducer:ar,useRef:ar,useState:ar,useDebugValue:ar,useDeferredValue:ar,useTransition:ar,useMutableSource:ar,useSyncExternalStore:ar,useId:ar,unstable_isNewReconciler:!1},m_={readContext:ti,useCallback:function(s,l){return qi().memoizedState=[s,l===void 0?null:l],s},useContext:ti,useEffect:hg,useImperativeHandle:function(s,l,d){return d=d!=null?d.concat([s]):null,Gu(4194308,4,pg.bind(null,l,s),d)},useLayoutEffect:function(s,l){return Gu(4194308,4,s,l)},useInsertionEffect:function(s,l){return Gu(4,2,s,l)},useMemo:function(s,l){var d=qi();return l=l===void 0?null:l,s=s(),d.memoizedState=[s,l],s},useReducer:function(s,l,d){var y=qi();return l=d!==void 0?d(l):l,y.memoizedState=y.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},y.queue=s,s=s.dispatch=p_.bind(null,xn,s),[y.memoizedState,s]},useRef:function(s){var l=qi();return s={current:s},l.memoizedState=s},useState:ug,useDebugValue:gf,useDeferredValue:function(s){return qi().memoizedState=s},useTransition:function(){var s=ug(!1),l=s[0];return s=d_.bind(null,s[1]),qi().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,d){var y=xn,k=qi();if(gn){if(d===void 0)throw Error(t(407));d=d()}else{if(d=l(),qn===null)throw Error(t(349));(Ta&30)!==0||ig(y,l,d)}k.memoizedState=d;var M={value:d,getSnapshot:l};return k.queue=M,hg(ag.bind(null,y,M,s),[s]),y.flags|=2048,hl(9,sg.bind(null,y,M,d,l),void 0,null),d},useId:function(){var s=qi(),l=qn.identifierPrefix;if(gn){var d=ds,y=fs;d=(y&~(1<<32-qt(y)-1)).toString(32)+d,l=":"+l+"R"+d,d=ul++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=f_++,l=":"+l+"r"+d.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},v_={readContext:ti,useCallback:mg,useContext:ti,useEffect:pf,useImperativeHandle:gg,useInsertionEffect:fg,useLayoutEffect:dg,useMemo:vg,useReducer:ff,useRef:cg,useState:function(){return ff(cl)},useDebugValue:gf,useDeferredValue:function(s){var l=ni();return yg(l,zn.memoizedState,s)},useTransition:function(){var s=ff(cl)[0],l=ni().memoizedState;return[s,l]},useMutableSource:ng,useSyncExternalStore:rg,useId:_g,unstable_isNewReconciler:!1},y_={readContext:ti,useCallback:mg,useContext:ti,useEffect:pf,useImperativeHandle:gg,useInsertionEffect:fg,useLayoutEffect:dg,useMemo:vg,useReducer:df,useRef:cg,useState:function(){return df(cl)},useDebugValue:gf,useDeferredValue:function(s){var l=ni();return zn===null?l.memoizedState=s:yg(l,zn.memoizedState,s)},useTransition:function(){var s=df(cl)[0],l=ni().memoizedState;return[s,l]},useMutableSource:ng,useSyncExternalStore:rg,useId:_g,unstable_isNewReconciler:!1};function wi(s,l){if(s&&s.defaultProps){l=Qe({},l),s=s.defaultProps;for(var d in s)l[d]===void 0&&(l[d]=s[d]);return l}return l}function mf(s,l,d,y){l=s.memoizedState,d=d(y,l),d=d==null?l:Qe({},l,d),s.memoizedState=d,s.lanes===0&&(s.updateQueue.baseState=d)}var Ku={isMounted:function(s){return(s=s._reactInternals)?Ue(s)===s:!1},enqueueSetState:function(s,l,d){s=s._reactInternals;var y=gr(),k=Zs(s),M=gs(y,k);M.payload=l,d!=null&&(M.callback=d),l=Gs(s,M,k),l!==null&&(Ci(l,s,k,y),Vu(l,s,k))},enqueueReplaceState:function(s,l,d){s=s._reactInternals;var y=gr(),k=Zs(s),M=gs(y,k);M.tag=1,M.payload=l,d!=null&&(M.callback=d),l=Gs(s,M,k),l!==null&&(Ci(l,s,k,y),Vu(l,s,k))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var d=gr(),y=Zs(s),k=gs(d,y);k.tag=2,l!=null&&(k.callback=l),l=Gs(s,k,y),l!==null&&(Ci(l,s,y,d),Vu(l,s,y))}};function Sg(s,l,d,y,k,M,$){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(y,M,$):l.prototype&&l.prototype.isPureReactComponent?!oe(d,y)||!oe(k,M):!0}function Cg(s,l,d){var y=!1,k=Us,M=l.contextType;return typeof M=="object"&&M!==null?M=ti(M):(k=Tr(l)?wa:sr.current,y=l.contextTypes,M=(y=y!=null)?uo(s,k):Us),l=new l(d,M),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ku,s.stateNode=l,l._reactInternals=s,y&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=k,s.__reactInternalMemoizedMaskedChildContext=M),l}function kg(s,l,d,y){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,y),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,y),l.state!==s&&Ku.enqueueReplaceState(l,l.state,null)}function vf(s,l,d,y){var k=s.stateNode;k.props=d,k.state=s.memoizedState,k.refs={},nf(s);var M=l.contextType;typeof M=="object"&&M!==null?k.context=ti(M):(M=Tr(l)?wa:sr.current,k.context=uo(s,M)),k.state=s.memoizedState,M=l.getDerivedStateFromProps,typeof M=="function"&&(mf(s,l,M,d),k.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(l=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),l!==k.state&&Ku.enqueueReplaceState(k,k.state,null),Wu(s,d,k,y),k.state=s.memoizedState),typeof k.componentDidMount=="function"&&(s.flags|=4194308)}function yo(s,l){try{var d="",y=l;do d+=pt(y),y=y.return;while(y);var k=d}catch(M){k=`
Error generating stack: `+M.message+`
`+M.stack}return{value:s,source:l,stack:k,digest:null}}function yf(s,l,d){return{value:s,source:null,stack:d??null,digest:l??null}}function _f(s,l){try{console.error(l.value)}catch(d){setTimeout(function(){throw d})}}var __=typeof WeakMap=="function"?WeakMap:Map;function Tg(s,l,d){d=gs(-1,d),d.tag=3,d.payload={element:null};var y=l.value;return d.callback=function(){nc||(nc=!0,Lf=y),_f(s,l)},d}function Eg(s,l,d){d=gs(-1,d),d.tag=3;var y=s.type.getDerivedStateFromError;if(typeof y=="function"){var k=l.value;d.payload=function(){return y(k)},d.callback=function(){_f(s,l)}}var M=s.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(d.callback=function(){_f(s,l),typeof y!="function"&&(qs===null?qs=new Set([this]):qs.add(this));var $=l.stack;this.componentDidCatch(l.value,{componentStack:$!==null?$:""})}),d}function Og(s,l,d){var y=s.pingCache;if(y===null){y=s.pingCache=new __;var k=new Set;y.set(l,k)}else k=y.get(l),k===void 0&&(k=new Set,y.set(l,k));k.has(d)||(k.add(d),s=I_.bind(null,s,l,d),l.then(s,s))}function Pg(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function Ag(s,l,d,y,k){return(s.mode&1)===0?(s===l?s.flags|=65536:(s.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(l=gs(-1,1),l.tag=2,Gs(d,l,1))),d.lanes|=1),s):(s.flags|=65536,s.lanes=k,s)}var x_=ge.ReactCurrentOwner,Er=!1;function pr(s,l,d,y){l.child=s===null?Zp(l,null,d,y):po(l,s.child,d,y)}function Mg(s,l,d,y,k){d=d.render;var M=l.ref;return mo(l,k),y=cf(s,l,d,y,M,k),d=hf(),s!==null&&!Er?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~k,ms(s,l,k)):(gn&&d&&Gh(l),l.flags|=1,pr(s,l,y,k),l.child)}function jg(s,l,d,y,k){if(s===null){var M=d.type;return typeof M=="function"&&!Vf(M)&&M.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(l.tag=15,l.type=M,Ig(s,l,M,y,k)):(s=lc(d.type,null,y,l,l.mode,k),s.ref=l.ref,s.return=l,l.child=s)}if(M=s.child,(s.lanes&k)===0){var $=M.memoizedProps;if(d=d.compare,d=d!==null?d:oe,d($,y)&&s.ref===l.ref)return ms(s,l,k)}return l.flags|=1,s=Js(M,y),s.ref=l.ref,s.return=l,l.child=s}function Ig(s,l,d,y,k){if(s!==null){var M=s.memoizedProps;if(oe(M,y)&&s.ref===l.ref)if(Er=!1,l.pendingProps=y=M,(s.lanes&k)!==0)(s.flags&131072)!==0&&(Er=!0);else return l.lanes=s.lanes,ms(s,l,k)}return xf(s,l,d,y,k)}function Lg(s,l,d){var y=l.pendingProps,k=y.children,M=s!==null?s.memoizedState:null;if(y.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},un(xo,Xr),Xr|=d;else{if((d&1073741824)===0)return s=M!==null?M.baseLanes|d:d,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,un(xo,Xr),Xr|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=M!==null?M.baseLanes:d,un(xo,Xr),Xr|=y}else M!==null?(y=M.baseLanes|d,l.memoizedState=null):y=d,un(xo,Xr),Xr|=y;return pr(s,l,k,d),l.child}function Dg(s,l){var d=l.ref;(s===null&&d!==null||s!==null&&s.ref!==d)&&(l.flags|=512,l.flags|=2097152)}function xf(s,l,d,y,k){var M=Tr(d)?wa:sr.current;return M=uo(l,M),mo(l,k),d=cf(s,l,d,y,M,k),y=hf(),s!==null&&!Er?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~k,ms(s,l,k)):(gn&&y&&Gh(l),l.flags|=1,pr(s,l,d,k),l.child)}function Rg(s,l,d,y,k){if(Tr(d)){var M=!0;Iu(l)}else M=!1;if(mo(l,k),l.stateNode===null)Qu(s,l),Cg(l,d,y),vf(l,d,y,k),y=!0;else if(s===null){var $=l.stateNode,ue=l.memoizedProps;$.props=ue;var ve=$.context,Ae=d.contextType;typeof Ae=="object"&&Ae!==null?Ae=ti(Ae):(Ae=Tr(d)?wa:sr.current,Ae=uo(l,Ae));var Ye=d.getDerivedStateFromProps,Je=typeof Ye=="function"||typeof $.getSnapshotBeforeUpdate=="function";Je||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==y||ve!==Ae)&&kg(l,$,y,Ae),Xs=!1;var He=l.memoizedState;$.state=He,Wu(l,y,$,k),ve=l.memoizedState,ue!==y||He!==ve||kr.current||Xs?(typeof Ye=="function"&&(mf(l,d,Ye,y),ve=l.memoizedState),(ue=Xs||Sg(l,d,ue,y,He,ve,Ae))?(Je||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(l.flags|=4194308)):(typeof $.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=y,l.memoizedState=ve),$.props=y,$.state=ve,$.context=Ae,y=ue):(typeof $.componentDidMount=="function"&&(l.flags|=4194308),y=!1)}else{$=l.stateNode,Jp(s,l),ue=l.memoizedProps,Ae=l.type===l.elementType?ue:wi(l.type,ue),$.props=Ae,Je=l.pendingProps,He=$.context,ve=d.contextType,typeof ve=="object"&&ve!==null?ve=ti(ve):(ve=Tr(d)?wa:sr.current,ve=uo(l,ve));var ut=d.getDerivedStateFromProps;(Ye=typeof ut=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ue!==Je||He!==ve)&&kg(l,$,y,ve),Xs=!1,He=l.memoizedState,$.state=He,Wu(l,y,$,k);var ft=l.memoizedState;ue!==Je||He!==ft||kr.current||Xs?(typeof ut=="function"&&(mf(l,d,ut,y),ft=l.memoizedState),(Ae=Xs||Sg(l,d,Ae,y,He,ft,ve)||!1)?(Ye||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(y,ft,ve),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(y,ft,ve)),typeof $.componentDidUpdate=="function"&&(l.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof $.componentDidUpdate!="function"||ue===s.memoizedProps&&He===s.memoizedState||(l.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===s.memoizedProps&&He===s.memoizedState||(l.flags|=1024),l.memoizedProps=y,l.memoizedState=ft),$.props=y,$.state=ft,$.context=ve,y=Ae):(typeof $.componentDidUpdate!="function"||ue===s.memoizedProps&&He===s.memoizedState||(l.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ue===s.memoizedProps&&He===s.memoizedState||(l.flags|=1024),y=!1)}return wf(s,l,d,y,M,k)}function wf(s,l,d,y,k,M){Dg(s,l);var $=(l.flags&128)!==0;if(!y&&!$)return k&&Vp(l,d,!1),ms(s,l,M);y=l.stateNode,x_.current=l;var ue=$&&typeof d.getDerivedStateFromError!="function"?null:y.render();return l.flags|=1,s!==null&&$?(l.child=po(l,s.child,null,M),l.child=po(l,null,ue,M)):pr(s,l,ue,M),l.memoizedState=y.state,k&&Vp(l,d,!0),l.child}function Ng(s){var l=s.stateNode;l.pendingContext?Bp(s,l.pendingContext,l.pendingContext!==l.context):l.context&&Bp(s,l.context,!1),rf(s,l.containerInfo)}function Fg(s,l,d,y,k){return fo(),Zh(k),l.flags|=256,pr(s,l,d,y),l.child}var bf={dehydrated:null,treeContext:null,retryLane:0};function Sf(s){return{baseLanes:s,cachePool:null,transitions:null}}function Bg(s,l,d){var y=l.pendingProps,k=_n.current,M=!1,$=(l.flags&128)!==0,ue;if((ue=$)||(ue=s!==null&&s.memoizedState===null?!1:(k&2)!==0),ue?(M=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(k|=1),un(_n,k&1),s===null)return Kh(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((l.mode&1)===0?l.lanes=1:s.data==="$!"?l.lanes=8:l.lanes=1073741824,null):($=y.children,s=y.fallback,M?(y=l.mode,M=l.child,$={mode:"hidden",children:$},(y&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=$):M=uc($,y,0,null),s=Ma(s,y,d,null),M.return=l,s.return=l,M.sibling=s,l.child=M,l.child.memoizedState=Sf(d),l.memoizedState=bf,s):Cf(l,$));if(k=s.memoizedState,k!==null&&(ue=k.dehydrated,ue!==null))return w_(s,l,$,y,ue,k,d);if(M){M=y.fallback,$=l.mode,k=s.child,ue=k.sibling;var ve={mode:"hidden",children:y.children};return($&1)===0&&l.child!==k?(y=l.child,y.childLanes=0,y.pendingProps=ve,l.deletions=null):(y=Js(k,ve),y.subtreeFlags=k.subtreeFlags&14680064),ue!==null?M=Js(ue,M):(M=Ma(M,$,d,null),M.flags|=2),M.return=l,y.return=l,y.sibling=M,l.child=y,y=M,M=l.child,$=s.child.memoizedState,$=$===null?Sf(d):{baseLanes:$.baseLanes|d,cachePool:null,transitions:$.transitions},M.memoizedState=$,M.childLanes=s.childLanes&~d,l.memoizedState=bf,y}return M=s.child,s=M.sibling,y=Js(M,{mode:"visible",children:y.children}),(l.mode&1)===0&&(y.lanes=d),y.return=l,y.sibling=null,s!==null&&(d=l.deletions,d===null?(l.deletions=[s],l.flags|=16):d.push(s)),l.child=y,l.memoizedState=null,y}function Cf(s,l){return l=uc({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function Zu(s,l,d,y){return y!==null&&Zh(y),po(l,s.child,null,d),s=Cf(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function w_(s,l,d,y,k,M,$){if(d)return l.flags&256?(l.flags&=-257,y=yf(Error(t(422))),Zu(s,l,$,y)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(M=y.fallback,k=l.mode,y=uc({mode:"visible",children:y.children},k,0,null),M=Ma(M,k,$,null),M.flags|=2,y.return=l,M.return=l,y.sibling=M,l.child=y,(l.mode&1)!==0&&po(l,s.child,null,$),l.child.memoizedState=Sf($),l.memoizedState=bf,M);if((l.mode&1)===0)return Zu(s,l,$,null);if(k.data==="$!"){if(y=k.nextSibling&&k.nextSibling.dataset,y)var ue=y.dgst;return y=ue,M=Error(t(419)),y=yf(M,y,void 0),Zu(s,l,$,y)}if(ue=($&s.childLanes)!==0,Er||ue){if(y=qn,y!==null){switch($&-$){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(y.suspendedLanes|$))!==0?0:k,k!==0&&k!==M.retryLane&&(M.retryLane=k,ps(s,k),Ci(y,s,k,-1))}return zf(),y=yf(Error(t(421))),Zu(s,l,$,y)}return k.data==="$?"?(l.flags|=128,l.child=s.child,l=L_.bind(null,s),k._reactRetry=l,null):(s=M.treeContext,Hr=Vs(k.nextSibling),Ur=l,gn=!0,xi=null,s!==null&&($r[ei++]=fs,$r[ei++]=ds,$r[ei++]=ba,fs=s.id,ds=s.overflow,ba=l),l=Cf(l,y.children),l.flags|=4096,l)}function zg(s,l,d){s.lanes|=l;var y=s.alternate;y!==null&&(y.lanes|=l),ef(s.return,l,d)}function kf(s,l,d,y,k){var M=s.memoizedState;M===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:y,tail:d,tailMode:k}:(M.isBackwards=l,M.rendering=null,M.renderingStartTime=0,M.last=y,M.tail=d,M.tailMode=k)}function Vg(s,l,d){var y=l.pendingProps,k=y.revealOrder,M=y.tail;if(pr(s,l,y.children,d),y=_n.current,(y&2)!==0)y=y&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&zg(s,d,l);else if(s.tag===19)zg(s,d,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}y&=1}if(un(_n,y),(l.mode&1)===0)l.memoizedState=null;else switch(k){case"forwards":for(d=l.child,k=null;d!==null;)s=d.alternate,s!==null&&Uu(s)===null&&(k=d),d=d.sibling;d=k,d===null?(k=l.child,l.child=null):(k=d.sibling,d.sibling=null),kf(l,!1,k,d,M);break;case"backwards":for(d=null,k=l.child,l.child=null;k!==null;){if(s=k.alternate,s!==null&&Uu(s)===null){l.child=k;break}s=k.sibling,k.sibling=d,d=k,k=s}kf(l,!0,d,null,M);break;case"together":kf(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Qu(s,l){(l.mode&1)===0&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function ms(s,l,d){if(s!==null&&(l.dependencies=s.dependencies),Ea|=l.lanes,(d&l.childLanes)===0)return null;if(s!==null&&l.child!==s.child)throw Error(t(153));if(l.child!==null){for(s=l.child,d=Js(s,s.pendingProps),l.child=d,d.return=l;s.sibling!==null;)s=s.sibling,d=d.sibling=Js(s,s.pendingProps),d.return=l;d.sibling=null}return l.child}function b_(s,l,d){switch(l.tag){case 3:Ng(l),fo();break;case 5:tg(l);break;case 1:Tr(l.type)&&Iu(l);break;case 4:rf(l,l.stateNode.containerInfo);break;case 10:var y=l.type._context,k=l.memoizedProps.value;un(Bu,y._currentValue),y._currentValue=k;break;case 13:if(y=l.memoizedState,y!==null)return y.dehydrated!==null?(un(_n,_n.current&1),l.flags|=128,null):(d&l.child.childLanes)!==0?Bg(s,l,d):(un(_n,_n.current&1),s=ms(s,l,d),s!==null?s.sibling:null);un(_n,_n.current&1);break;case 19:if(y=(d&l.childLanes)!==0,(s.flags&128)!==0){if(y)return Vg(s,l,d);l.flags|=128}if(k=l.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),un(_n,_n.current),y)break;return null;case 22:case 23:return l.lanes=0,Lg(s,l,d)}return ms(s,l,d)}var Wg,Tf,Ug,Hg;Wg=function(s,l){for(var d=l.child;d!==null;){if(d.tag===5||d.tag===6)s.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Tf=function(){},Ug=function(s,l,d,y){var k=s.memoizedProps;if(k!==y){s=l.stateNode,ka(Yi.current);var M=null;switch(d){case"input":k=Os(s,k),y=Os(s,y),M=[];break;case"select":k=Qe({},k,{value:void 0}),y=Qe({},y,{value:void 0}),M=[];break;case"textarea":k=pi(s,k),y=pi(s,y),M=[];break;default:typeof k.onClick!="function"&&typeof y.onClick=="function"&&(s.onclick=Au)}N(d,y);var $;d=null;for(Ae in k)if(!y.hasOwnProperty(Ae)&&k.hasOwnProperty(Ae)&&k[Ae]!=null)if(Ae==="style"){var ue=k[Ae];for($ in ue)ue.hasOwnProperty($)&&(d||(d={}),d[$]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(i.hasOwnProperty(Ae)?M||(M=[]):(M=M||[]).push(Ae,null));for(Ae in y){var ve=y[Ae];if(ue=k?.[Ae],y.hasOwnProperty(Ae)&&ve!==ue&&(ve!=null||ue!=null))if(Ae==="style")if(ue){for($ in ue)!ue.hasOwnProperty($)||ve&&ve.hasOwnProperty($)||(d||(d={}),d[$]="");for($ in ve)ve.hasOwnProperty($)&&ue[$]!==ve[$]&&(d||(d={}),d[$]=ve[$])}else d||(M||(M=[]),M.push(Ae,d)),d=ve;else Ae==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,ue=ue?ue.__html:void 0,ve!=null&&ue!==ve&&(M=M||[]).push(Ae,ve)):Ae==="children"?typeof ve!="string"&&typeof ve!="number"||(M=M||[]).push(Ae,""+ve):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ae)?(ve!=null&&Ae==="onScroll"&&hn("scroll",s),M||ue===ve||(M=[])):(M=M||[]).push(Ae,ve))}d&&(M=M||[]).push("style",d);var Ae=M;(l.updateQueue=Ae)&&(l.flags|=4)}},Hg=function(s,l,d,y){d!==y&&(l.flags|=4)};function fl(s,l){if(!gn)switch(s.tailMode){case"hidden":l=s.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?s.tail=null:d.sibling=null;break;case"collapsed":d=s.tail;for(var y=null;d!==null;)d.alternate!==null&&(y=d),d=d.sibling;y===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:y.sibling=null}}function or(s){var l=s.alternate!==null&&s.alternate.child===s.child,d=0,y=0;if(l)for(var k=s.child;k!==null;)d|=k.lanes|k.childLanes,y|=k.subtreeFlags&14680064,y|=k.flags&14680064,k.return=s,k=k.sibling;else for(k=s.child;k!==null;)d|=k.lanes|k.childLanes,y|=k.subtreeFlags,y|=k.flags,k.return=s,k=k.sibling;return s.subtreeFlags|=y,s.childLanes=d,l}function S_(s,l,d){var y=l.pendingProps;switch(Yh(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return or(l),null;case 1:return Tr(l.type)&&ju(),or(l),null;case 3:return y=l.stateNode,vo(),fn(kr),fn(sr),of(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(s===null||s.child===null)&&(Nu(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,xi!==null&&(Nf(xi),xi=null))),Tf(s,l),or(l),null;case 5:sf(l);var k=ka(ol.current);if(d=l.type,s!==null&&l.stateNode!=null)Ug(s,l,d,y,k),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!y){if(l.stateNode===null)throw Error(t(166));return or(l),null}if(s=ka(Yi.current),Nu(l)){y=l.stateNode,d=l.type;var M=l.memoizedProps;switch(y[Gi]=l,y[nl]=M,s=(l.mode&1)!==0,d){case"dialog":hn("cancel",y),hn("close",y);break;case"iframe":case"object":case"embed":hn("load",y);break;case"video":case"audio":for(k=0;k<$o.length;k++)hn($o[k],y);break;case"source":hn("error",y);break;case"img":case"image":case"link":hn("error",y),hn("load",y);break;case"details":hn("toggle",y);break;case"input":Di(y,M),hn("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!M.multiple},hn("invalid",y);break;case"textarea":Gt(y,M),hn("invalid",y)}N(d,M),k=null;for(var $ in M)if(M.hasOwnProperty($)){var ue=M[$];$==="children"?typeof ue=="string"?y.textContent!==ue&&(M.suppressHydrationWarning!==!0&&Pu(y.textContent,ue,s),k=["children",ue]):typeof ue=="number"&&y.textContent!==""+ue&&(M.suppressHydrationWarning!==!0&&Pu(y.textContent,ue,s),k=["children",""+ue]):i.hasOwnProperty($)&&ue!=null&&$==="onScroll"&&hn("scroll",y)}switch(d){case"input":en(y),Ri(y,M,!0);break;case"textarea":en(y),Nt(y);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(y.onclick=Au)}y=k,l.updateQueue=y,y!==null&&(l.flags|=4)}else{$=k.nodeType===9?k:k.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=r(d)),s==="http://www.w3.org/1999/xhtml"?d==="script"?(s=$.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof y.is=="string"?s=$.createElement(d,{is:y.is}):(s=$.createElement(d),d==="select"&&($=s,y.multiple?$.multiple=!0:y.size&&($.size=y.size))):s=$.createElementNS(s,d),s[Gi]=l,s[nl]=y,Wg(s,l,!1,!1),l.stateNode=s;e:{switch($=B(d,y),d){case"dialog":hn("cancel",s),hn("close",s),k=y;break;case"iframe":case"object":case"embed":hn("load",s),k=y;break;case"video":case"audio":for(k=0;k<$o.length;k++)hn($o[k],s);k=y;break;case"source":hn("error",s),k=y;break;case"img":case"image":case"link":hn("error",s),hn("load",s),k=y;break;case"details":hn("toggle",s),k=y;break;case"input":Di(s,y),k=Os(s,y),hn("invalid",s);break;case"option":k=y;break;case"select":s._wrapperState={wasMultiple:!!y.multiple},k=Qe({},y,{value:void 0}),hn("invalid",s);break;case"textarea":Gt(s,y),k=pi(s,y),hn("invalid",s);break;default:k=y}N(d,k),ue=k;for(M in ue)if(ue.hasOwnProperty(M)){var ve=ue[M];M==="style"?T(s,ve):M==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,ve!=null&&g(s,ve)):M==="children"?typeof ve=="string"?(d!=="textarea"||ve!=="")&&v(s,ve):typeof ve=="number"&&v(s,""+ve):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(i.hasOwnProperty(M)?ve!=null&&M==="onScroll"&&hn("scroll",s):ve!=null&&le(s,M,ve,$))}switch(d){case"input":en(s),Ri(s,y,!1);break;case"textarea":en(s),Nt(s);break;case"option":y.value!=null&&s.setAttribute("value",""+Ut(y.value));break;case"select":s.multiple=!!y.multiple,M=y.value,M!=null?tn(s,!!y.multiple,M,!1):y.defaultValue!=null&&tn(s,!!y.multiple,y.defaultValue,!0);break;default:typeof k.onClick=="function"&&(s.onclick=Au)}switch(d){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return or(l),null;case 6:if(s&&l.stateNode!=null)Hg(s,l,s.memoizedProps,y);else{if(typeof y!="string"&&l.stateNode===null)throw Error(t(166));if(d=ka(ol.current),ka(Yi.current),Nu(l)){if(y=l.stateNode,d=l.memoizedProps,y[Gi]=l,(M=y.nodeValue!==d)&&(s=Ur,s!==null))switch(s.tag){case 3:Pu(y.nodeValue,d,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Pu(y.nodeValue,d,(s.mode&1)!==0)}M&&(l.flags|=4)}else y=(d.nodeType===9?d:d.ownerDocument).createTextNode(y),y[Gi]=l,l.stateNode=y}return or(l),null;case 13:if(fn(_n),y=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(gn&&Hr!==null&&(l.mode&1)!==0&&(l.flags&128)===0)Yp(),fo(),l.flags|=98560,M=!1;else if(M=Nu(l),y!==null&&y.dehydrated!==null){if(s===null){if(!M)throw Error(t(318));if(M=l.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(t(317));M[Gi]=l}else fo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;or(l),M=!1}else xi!==null&&(Nf(xi),xi=null),M=!0;if(!M)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=d,l):(y=y!==null,y!==(s!==null&&s.memoizedState!==null)&&y&&(l.child.flags|=8192,(l.mode&1)!==0&&(s===null||(_n.current&1)!==0?Vn===0&&(Vn=3):zf())),l.updateQueue!==null&&(l.flags|=4),or(l),null);case 4:return vo(),Tf(s,l),s===null&&el(l.stateNode.containerInfo),or(l),null;case 10:return $h(l.type._context),or(l),null;case 17:return Tr(l.type)&&ju(),or(l),null;case 19:if(fn(_n),M=l.memoizedState,M===null)return or(l),null;if(y=(l.flags&128)!==0,$=M.rendering,$===null)if(y)fl(M,!1);else{if(Vn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if($=Uu(s),$!==null){for(l.flags|=128,fl(M,!1),y=$.updateQueue,y!==null&&(l.updateQueue=y,l.flags|=4),l.subtreeFlags=0,y=d,d=l.child;d!==null;)M=d,s=y,M.flags&=14680066,$=M.alternate,$===null?(M.childLanes=0,M.lanes=s,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=$.childLanes,M.lanes=$.lanes,M.child=$.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=$.memoizedProps,M.memoizedState=$.memoizedState,M.updateQueue=$.updateQueue,M.type=$.type,s=$.dependencies,M.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),d=d.sibling;return un(_n,_n.current&1|2),l.child}s=s.sibling}M.tail!==null&&lt()>wo&&(l.flags|=128,y=!0,fl(M,!1),l.lanes=4194304)}else{if(!y)if(s=Uu($),s!==null){if(l.flags|=128,y=!0,d=s.updateQueue,d!==null&&(l.updateQueue=d,l.flags|=4),fl(M,!0),M.tail===null&&M.tailMode==="hidden"&&!$.alternate&&!gn)return or(l),null}else 2*lt()-M.renderingStartTime>wo&&d!==1073741824&&(l.flags|=128,y=!0,fl(M,!1),l.lanes=4194304);M.isBackwards?($.sibling=l.child,l.child=$):(d=M.last,d!==null?d.sibling=$:l.child=$,M.last=$)}return M.tail!==null?(l=M.tail,M.rendering=l,M.tail=l.sibling,M.renderingStartTime=lt(),l.sibling=null,d=_n.current,un(_n,y?d&1|2:d&1),l):(or(l),null);case 22:case 23:return Bf(),y=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==y&&(l.flags|=8192),y&&(l.mode&1)!==0?(Xr&1073741824)!==0&&(or(l),l.subtreeFlags&6&&(l.flags|=8192)):or(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function C_(s,l){switch(Yh(l),l.tag){case 1:return Tr(l.type)&&ju(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return vo(),fn(kr),fn(sr),of(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 5:return sf(l),null;case 13:if(fn(_n),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(t(340));fo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return fn(_n),null;case 4:return vo(),null;case 10:return $h(l.type._context),null;case 22:case 23:return Bf(),null;case 24:return null;default:return null}}var Ju=!1,lr=!1,k_=typeof WeakSet=="function"?WeakSet:Set,ht=null;function _o(s,l){var d=s.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(y){Tn(s,l,y)}else d.current=null}function Ef(s,l,d){try{d()}catch(y){Tn(s,l,y)}}var Xg=!1;function T_(s,l){if(Fh=Kr,s=St(),kt(s)){if("selectionStart"in s)var d={start:s.selectionStart,end:s.selectionEnd};else e:{d=(d=s.ownerDocument)&&d.defaultView||window;var y=d.getSelection&&d.getSelection();if(y&&y.rangeCount!==0){d=y.anchorNode;var k=y.anchorOffset,M=y.focusNode;y=y.focusOffset;try{d.nodeType,M.nodeType}catch{d=null;break e}var $=0,ue=-1,ve=-1,Ae=0,Ye=0,Je=s,He=null;t:for(;;){for(var ut;Je!==d||k!==0&&Je.nodeType!==3||(ue=$+k),Je!==M||y!==0&&Je.nodeType!==3||(ve=$+y),Je.nodeType===3&&($+=Je.nodeValue.length),(ut=Je.firstChild)!==null;)He=Je,Je=ut;for(;;){if(Je===s)break t;if(He===d&&++Ae===k&&(ue=$),He===M&&++Ye===y&&(ve=$),(ut=Je.nextSibling)!==null)break;Je=He,He=Je.parentNode}Je=ut}d=ue===-1||ve===-1?null:{start:ue,end:ve}}else d=null}d=d||{start:0,end:0}}else d=null;for(Bh={focusedElem:s,selectionRange:d},Kr=!1,ht=l;ht!==null;)if(l=ht,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,ht=s;else for(;ht!==null;){l=ht;try{var ft=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var gt=ft.memoizedProps,An=ft.memoizedState,Te=l.stateNode,_e=Te.getSnapshotBeforeUpdate(l.elementType===l.type?gt:wi(l.type,gt),An);Te.__reactInternalSnapshotBeforeUpdate=_e}break;case 3:var Pe=l.stateNode.containerInfo;Pe.nodeType===1?Pe.textContent="":Pe.nodeType===9&&Pe.documentElement&&Pe.removeChild(Pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(nt){Tn(l,l.return,nt)}if(s=l.sibling,s!==null){s.return=l.return,ht=s;break}ht=l.return}return ft=Xg,Xg=!1,ft}function dl(s,l,d){var y=l.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var k=y=y.next;do{if((k.tag&s)===s){var M=k.destroy;k.destroy=void 0,M!==void 0&&Ef(l,d,M)}k=k.next}while(k!==y)}}function $u(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&s)===s){var y=d.create;d.destroy=y()}d=d.next}while(d!==l)}}function Of(s){var l=s.ref;if(l!==null){var d=s.stateNode;switch(s.tag){case 5:s=d;break;default:s=d}typeof l=="function"?l(s):l.current=s}}function Gg(s){var l=s.alternate;l!==null&&(s.alternate=null,Gg(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[Gi],delete l[nl],delete l[Uh],delete l[l_],delete l[u_])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Yg(s){return s.tag===5||s.tag===3||s.tag===4}function qg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Yg(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Pf(s,l,d){var y=s.tag;if(y===5||y===6)s=s.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(s,l):d.insertBefore(s,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(s,d)):(l=d,l.appendChild(s)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=Au));else if(y!==4&&(s=s.child,s!==null))for(Pf(s,l,d),s=s.sibling;s!==null;)Pf(s,l,d),s=s.sibling}function Af(s,l,d){var y=s.tag;if(y===5||y===6)s=s.stateNode,l?d.insertBefore(s,l):d.appendChild(s);else if(y!==4&&(s=s.child,s!==null))for(Af(s,l,d),s=s.sibling;s!==null;)Af(s,l,d),s=s.sibling}var Qn=null,bi=!1;function Ys(s,l,d){for(d=d.child;d!==null;)Kg(s,l,d),d=d.sibling}function Kg(s,l,d){if(Ht&&typeof Ht.onCommitFiberUnmount=="function")try{Ht.onCommitFiberUnmount(Ke,d)}catch{}switch(d.tag){case 5:lr||_o(d,l);case 6:var y=Qn,k=bi;Qn=null,Ys(s,l,d),Qn=y,bi=k,Qn!==null&&(bi?(s=Qn,d=d.stateNode,s.nodeType===8?s.parentNode.removeChild(d):s.removeChild(d)):Qn.removeChild(d.stateNode));break;case 18:Qn!==null&&(bi?(s=Qn,d=d.stateNode,s.nodeType===8?Wh(s.parentNode,d):s.nodeType===1&&Wh(s,d),Kt(s)):Wh(Qn,d.stateNode));break;case 4:y=Qn,k=bi,Qn=d.stateNode.containerInfo,bi=!0,Ys(s,l,d),Qn=y,bi=k;break;case 0:case 11:case 14:case 15:if(!lr&&(y=d.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){k=y=y.next;do{var M=k,$=M.destroy;M=M.tag,$!==void 0&&((M&2)!==0||(M&4)!==0)&&Ef(d,l,$),k=k.next}while(k!==y)}Ys(s,l,d);break;case 1:if(!lr&&(_o(d,l),y=d.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=d.memoizedProps,y.state=d.memoizedState,y.componentWillUnmount()}catch(ue){Tn(d,l,ue)}Ys(s,l,d);break;case 21:Ys(s,l,d);break;case 22:d.mode&1?(lr=(y=lr)||d.memoizedState!==null,Ys(s,l,d),lr=y):Ys(s,l,d);break;default:Ys(s,l,d)}}function Zg(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var d=s.stateNode;d===null&&(d=s.stateNode=new k_),l.forEach(function(y){var k=D_.bind(null,s,y);d.has(y)||(d.add(y),y.then(k,k))})}}function Si(s,l){var d=l.deletions;if(d!==null)for(var y=0;y<d.length;y++){var k=d[y];try{var M=s,$=l,ue=$;e:for(;ue!==null;){switch(ue.tag){case 5:Qn=ue.stateNode,bi=!1;break e;case 3:Qn=ue.stateNode.containerInfo,bi=!0;break e;case 4:Qn=ue.stateNode.containerInfo,bi=!0;break e}ue=ue.return}if(Qn===null)throw Error(t(160));Kg(M,$,k),Qn=null,bi=!1;var ve=k.alternate;ve!==null&&(ve.return=null),k.return=null}catch(Ae){Tn(k,l,Ae)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Qg(l,s),l=l.sibling}function Qg(s,l){var d=s.alternate,y=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Si(l,s),Ki(s),y&4){try{dl(3,s,s.return),$u(3,s)}catch(gt){Tn(s,s.return,gt)}try{dl(5,s,s.return)}catch(gt){Tn(s,s.return,gt)}}break;case 1:Si(l,s),Ki(s),y&512&&d!==null&&_o(d,d.return);break;case 5:if(Si(l,s),Ki(s),y&512&&d!==null&&_o(d,d.return),s.flags&32){var k=s.stateNode;try{v(k,"")}catch(gt){Tn(s,s.return,gt)}}if(y&4&&(k=s.stateNode,k!=null)){var M=s.memoizedProps,$=d!==null?d.memoizedProps:M,ue=s.type,ve=s.updateQueue;if(s.updateQueue=null,ve!==null)try{ue==="input"&&M.type==="radio"&&M.name!=null&&ua(k,M),B(ue,$);var Ae=B(ue,M);for($=0;$<ve.length;$+=2){var Ye=ve[$],Je=ve[$+1];Ye==="style"?T(k,Je):Ye==="dangerouslySetInnerHTML"?g(k,Je):Ye==="children"?v(k,Je):le(k,Ye,Je,Ae)}switch(ue){case"input":Nr(k,M);break;case"textarea":Ps(k,M);break;case"select":var He=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!M.multiple;var ut=M.value;ut!=null?tn(k,!!M.multiple,ut,!1):He!==!!M.multiple&&(M.defaultValue!=null?tn(k,!!M.multiple,M.defaultValue,!0):tn(k,!!M.multiple,M.multiple?[]:"",!1))}k[nl]=M}catch(gt){Tn(s,s.return,gt)}}break;case 6:if(Si(l,s),Ki(s),y&4){if(s.stateNode===null)throw Error(t(162));k=s.stateNode,M=s.memoizedProps;try{k.nodeValue=M}catch(gt){Tn(s,s.return,gt)}}break;case 3:if(Si(l,s),Ki(s),y&4&&d!==null&&d.memoizedState.isDehydrated)try{Kt(l.containerInfo)}catch(gt){Tn(s,s.return,gt)}break;case 4:Si(l,s),Ki(s);break;case 13:Si(l,s),Ki(s),k=s.child,k.flags&8192&&(M=k.memoizedState!==null,k.stateNode.isHidden=M,!M||k.alternate!==null&&k.alternate.memoizedState!==null||(If=lt())),y&4&&Zg(s);break;case 22:if(Ye=d!==null&&d.memoizedState!==null,s.mode&1?(lr=(Ae=lr)||Ye,Si(l,s),lr=Ae):Si(l,s),Ki(s),y&8192){if(Ae=s.memoizedState!==null,(s.stateNode.isHidden=Ae)&&!Ye&&(s.mode&1)!==0)for(ht=s,Ye=s.child;Ye!==null;){for(Je=ht=Ye;ht!==null;){switch(He=ht,ut=He.child,He.tag){case 0:case 11:case 14:case 15:dl(4,He,He.return);break;case 1:_o(He,He.return);var ft=He.stateNode;if(typeof ft.componentWillUnmount=="function"){y=He,d=He.return;try{l=y,ft.props=l.memoizedProps,ft.state=l.memoizedState,ft.componentWillUnmount()}catch(gt){Tn(y,d,gt)}}break;case 5:_o(He,He.return);break;case 22:if(He.memoizedState!==null){e0(Je);continue}}ut!==null?(ut.return=He,ht=ut):e0(Je)}Ye=Ye.sibling}e:for(Ye=null,Je=s;;){if(Je.tag===5){if(Ye===null){Ye=Je;try{k=Je.stateNode,Ae?(M=k.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(ue=Je.stateNode,ve=Je.memoizedProps.style,$=ve!=null&&ve.hasOwnProperty("display")?ve.display:null,ue.style.display=C("display",$))}catch(gt){Tn(s,s.return,gt)}}}else if(Je.tag===6){if(Ye===null)try{Je.stateNode.nodeValue=Ae?"":Je.memoizedProps}catch(gt){Tn(s,s.return,gt)}}else if((Je.tag!==22&&Je.tag!==23||Je.memoizedState===null||Je===s)&&Je.child!==null){Je.child.return=Je,Je=Je.child;continue}if(Je===s)break e;for(;Je.sibling===null;){if(Je.return===null||Je.return===s)break e;Ye===Je&&(Ye=null),Je=Je.return}Ye===Je&&(Ye=null),Je.sibling.return=Je.return,Je=Je.sibling}}break;case 19:Si(l,s),Ki(s),y&4&&Zg(s);break;case 21:break;default:Si(l,s),Ki(s)}}function Ki(s){var l=s.flags;if(l&2){try{e:{for(var d=s.return;d!==null;){if(Yg(d)){var y=d;break e}d=d.return}throw Error(t(160))}switch(y.tag){case 5:var k=y.stateNode;y.flags&32&&(v(k,""),y.flags&=-33);var M=qg(s);Af(s,M,k);break;case 3:case 4:var $=y.stateNode.containerInfo,ue=qg(s);Pf(s,ue,$);break;default:throw Error(t(161))}}catch(ve){Tn(s,s.return,ve)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function E_(s,l,d){ht=s,Jg(s)}function Jg(s,l,d){for(var y=(s.mode&1)!==0;ht!==null;){var k=ht,M=k.child;if(k.tag===22&&y){var $=k.memoizedState!==null||Ju;if(!$){var ue=k.alternate,ve=ue!==null&&ue.memoizedState!==null||lr;ue=Ju;var Ae=lr;if(Ju=$,(lr=ve)&&!Ae)for(ht=k;ht!==null;)$=ht,ve=$.child,$.tag===22&&$.memoizedState!==null?t0(k):ve!==null?(ve.return=$,ht=ve):t0(k);for(;M!==null;)ht=M,Jg(M),M=M.sibling;ht=k,Ju=ue,lr=Ae}$g(s)}else(k.subtreeFlags&8772)!==0&&M!==null?(M.return=k,ht=M):$g(s)}}function $g(s){for(;ht!==null;){var l=ht;if((l.flags&8772)!==0){var d=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:lr||$u(5,l);break;case 1:var y=l.stateNode;if(l.flags&4&&!lr)if(d===null)y.componentDidMount();else{var k=l.elementType===l.type?d.memoizedProps:wi(l.type,d.memoizedProps);y.componentDidUpdate(k,d.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var M=l.updateQueue;M!==null&&eg(l,M,y);break;case 3:var $=l.updateQueue;if($!==null){if(d=null,l.child!==null)switch(l.child.tag){case 5:d=l.child.stateNode;break;case 1:d=l.child.stateNode}eg(l,$,d)}break;case 5:var ue=l.stateNode;if(d===null&&l.flags&4){d=ue;var ve=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ve.autoFocus&&d.focus();break;case"img":ve.src&&(d.src=ve.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var Ae=l.alternate;if(Ae!==null){var Ye=Ae.memoizedState;if(Ye!==null){var Je=Ye.dehydrated;Je!==null&&Kt(Je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}lr||l.flags&512&&Of(l)}catch(He){Tn(l,l.return,He)}}if(l===s){ht=null;break}if(d=l.sibling,d!==null){d.return=l.return,ht=d;break}ht=l.return}}function e0(s){for(;ht!==null;){var l=ht;if(l===s){ht=null;break}var d=l.sibling;if(d!==null){d.return=l.return,ht=d;break}ht=l.return}}function t0(s){for(;ht!==null;){var l=ht;try{switch(l.tag){case 0:case 11:case 15:var d=l.return;try{$u(4,l)}catch(ve){Tn(l,d,ve)}break;case 1:var y=l.stateNode;if(typeof y.componentDidMount=="function"){var k=l.return;try{y.componentDidMount()}catch(ve){Tn(l,k,ve)}}var M=l.return;try{Of(l)}catch(ve){Tn(l,M,ve)}break;case 5:var $=l.return;try{Of(l)}catch(ve){Tn(l,$,ve)}}}catch(ve){Tn(l,l.return,ve)}if(l===s){ht=null;break}var ue=l.sibling;if(ue!==null){ue.return=l.return,ht=ue;break}ht=l.return}}var O_=Math.ceil,ec=ge.ReactCurrentDispatcher,Mf=ge.ReactCurrentOwner,ri=ge.ReactCurrentBatchConfig,Qt=0,qn=null,Ln=null,Jn=0,Xr=0,xo=Ws(0),Vn=0,pl=null,Ea=0,tc=0,jf=0,gl=null,Or=null,If=0,wo=1/0,vs=null,nc=!1,Lf=null,qs=null,rc=!1,Ks=null,ic=0,ml=0,Df=null,sc=-1,ac=0;function gr(){return(Qt&6)!==0?lt():sc!==-1?sc:sc=lt()}function Zs(s){return(s.mode&1)===0?1:(Qt&2)!==0&&Jn!==0?Jn&-Jn:h_.transition!==null?(ac===0&&(ac=Ms()),ac):(s=Vt,s!==0||(s=window.event,s=s===void 0?16:ca(s.type)),s)}function Ci(s,l,d,y){if(50<ml)throw ml=0,Df=null,Error(t(185));Fi(s,d,y),((Qt&2)===0||s!==qn)&&(s===qn&&((Qt&2)===0&&(tc|=d),Vn===4&&Qs(s,Jn)),Pr(s,y),d===1&&Qt===0&&(l.mode&1)===0&&(wo=lt()+500,Lu&&Hs()))}function Pr(s,l){var d=s.callbackNode;Fn(s,l);var y=nr(s,s===qn?Jn:0);if(y===0)d!==null&&st(d),s.callbackNode=null,s.callbackPriority=0;else if(l=y&-y,s.callbackPriority!==l){if(d!=null&&st(d),l===1)s.tag===0?c_(r0.bind(null,s)):Wp(r0.bind(null,s)),a_(function(){(Qt&6)===0&&Hs()}),d=null;else{switch(zi(y)){case 1:d=bt;break;case 4:d=pn;break;case 16:d=sn;break;case 536870912:d=ln;break;default:d=sn}d=h0(d,n0.bind(null,s))}s.callbackPriority=l,s.callbackNode=d}}function n0(s,l){if(sc=-1,ac=0,(Qt&6)!==0)throw Error(t(327));var d=s.callbackNode;if(bo()&&s.callbackNode!==d)return null;var y=nr(s,s===qn?Jn:0);if(y===0)return null;if((y&30)!==0||(y&s.expiredLanes)!==0||l)l=oc(s,y);else{l=y;var k=Qt;Qt|=2;var M=s0();(qn!==s||Jn!==l)&&(vs=null,wo=lt()+500,Pa(s,l));do try{M_();break}catch(ue){i0(s,ue)}while(!0);Jh(),ec.current=M,Qt=k,Ln!==null?l=0:(qn=null,Jn=0,l=Vn)}if(l!==0){if(l===2&&(k=As(s),k!==0&&(y=k,l=Rf(s,k))),l===1)throw d=pl,Pa(s,0),Qs(s,y),Pr(s,lt()),d;if(l===6)Qs(s,y);else{if(k=s.current.alternate,(y&30)===0&&!P_(k)&&(l=oc(s,y),l===2&&(M=As(s),M!==0&&(y=M,l=Rf(s,M))),l===1))throw d=pl,Pa(s,0),Qs(s,y),Pr(s,lt()),d;switch(s.finishedWork=k,s.finishedLanes=y,l){case 0:case 1:throw Error(t(345));case 2:Aa(s,Or,vs);break;case 3:if(Qs(s,y),(y&130023424)===y&&(l=If+500-lt(),10<l)){if(nr(s,0)!==0)break;if(k=s.suspendedLanes,(k&y)!==y){gr(),s.pingedLanes|=s.suspendedLanes&k;break}s.timeoutHandle=Vh(Aa.bind(null,s,Or,vs),l);break}Aa(s,Or,vs);break;case 4:if(Qs(s,y),(y&4194240)===y)break;for(l=s.eventTimes,k=-1;0<y;){var $=31-qt(y);M=1<<$,$=l[$],$>k&&(k=$),y&=~M}if(y=k,y=lt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*O_(y/1960))-y,10<y){s.timeoutHandle=Vh(Aa.bind(null,s,Or,vs),y);break}Aa(s,Or,vs);break;case 5:Aa(s,Or,vs);break;default:throw Error(t(329))}}}return Pr(s,lt()),s.callbackNode===d?n0.bind(null,s):null}function Rf(s,l){var d=gl;return s.current.memoizedState.isDehydrated&&(Pa(s,l).flags|=256),s=oc(s,l),s!==2&&(l=Or,Or=d,l!==null&&Nf(l)),s}function Nf(s){Or===null?Or=s:Or.push.apply(Or,s)}function P_(s){for(var l=s;;){if(l.flags&16384){var d=l.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var y=0;y<d.length;y++){var k=d[y],M=k.getSnapshot;k=k.value;try{if(!In(M(),k))return!1}catch{return!1}}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Qs(s,l){for(l&=~jf,l&=~tc,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var d=31-qt(l),y=1<<d;s[d]=-1,l&=~y}}function r0(s){if((Qt&6)!==0)throw Error(t(327));bo();var l=nr(s,0);if((l&1)===0)return Pr(s,lt()),null;var d=oc(s,l);if(s.tag!==0&&d===2){var y=As(s);y!==0&&(l=y,d=Rf(s,y))}if(d===1)throw d=pl,Pa(s,0),Qs(s,l),Pr(s,lt()),d;if(d===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,Aa(s,Or,vs),Pr(s,lt()),null}function Ff(s,l){var d=Qt;Qt|=1;try{return s(l)}finally{Qt=d,Qt===0&&(wo=lt()+500,Lu&&Hs())}}function Oa(s){Ks!==null&&Ks.tag===0&&(Qt&6)===0&&bo();var l=Qt;Qt|=1;var d=ri.transition,y=Vt;try{if(ri.transition=null,Vt=1,s)return s()}finally{Vt=y,ri.transition=d,Qt=l,(Qt&6)===0&&Hs()}}function Bf(){Xr=xo.current,fn(xo)}function Pa(s,l){s.finishedWork=null,s.finishedLanes=0;var d=s.timeoutHandle;if(d!==-1&&(s.timeoutHandle=-1,s_(d)),Ln!==null)for(d=Ln.return;d!==null;){var y=d;switch(Yh(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&ju();break;case 3:vo(),fn(kr),fn(sr),of();break;case 5:sf(y);break;case 4:vo();break;case 13:fn(_n);break;case 19:fn(_n);break;case 10:$h(y.type._context);break;case 22:case 23:Bf()}d=d.return}if(qn=s,Ln=s=Js(s.current,null),Jn=Xr=l,Vn=0,pl=null,jf=tc=Ea=0,Or=gl=null,Ca!==null){for(l=0;l<Ca.length;l++)if(d=Ca[l],y=d.interleaved,y!==null){d.interleaved=null;var k=y.next,M=d.pending;if(M!==null){var $=M.next;M.next=k,y.next=$}d.pending=y}Ca=null}return s}function i0(s,l){do{var d=Ln;try{if(Jh(),Hu.current=qu,Xu){for(var y=xn.memoizedState;y!==null;){var k=y.queue;k!==null&&(k.pending=null),y=y.next}Xu=!1}if(Ta=0,Yn=zn=xn=null,ll=!1,ul=0,Mf.current=null,d===null||d.return===null){Vn=1,pl=l,Ln=null;break}e:{var M=s,$=d.return,ue=d,ve=l;if(l=Jn,ue.flags|=32768,ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var Ae=ve,Ye=ue,Je=Ye.tag;if((Ye.mode&1)===0&&(Je===0||Je===11||Je===15)){var He=Ye.alternate;He?(Ye.updateQueue=He.updateQueue,Ye.memoizedState=He.memoizedState,Ye.lanes=He.lanes):(Ye.updateQueue=null,Ye.memoizedState=null)}var ut=Pg($);if(ut!==null){ut.flags&=-257,Ag(ut,$,ue,M,l),ut.mode&1&&Og(M,Ae,l),l=ut,ve=Ae;var ft=l.updateQueue;if(ft===null){var gt=new Set;gt.add(ve),l.updateQueue=gt}else ft.add(ve);break e}else{if((l&1)===0){Og(M,Ae,l),zf();break e}ve=Error(t(426))}}else if(gn&&ue.mode&1){var An=Pg($);if(An!==null){(An.flags&65536)===0&&(An.flags|=256),Ag(An,$,ue,M,l),Zh(yo(ve,ue));break e}}M=ve=yo(ve,ue),Vn!==4&&(Vn=2),gl===null?gl=[M]:gl.push(M),M=$;do{switch(M.tag){case 3:M.flags|=65536,l&=-l,M.lanes|=l;var Te=Tg(M,ve,l);$p(M,Te);break e;case 1:ue=ve;var _e=M.type,Pe=M.stateNode;if((M.flags&128)===0&&(typeof _e.getDerivedStateFromError=="function"||Pe!==null&&typeof Pe.componentDidCatch=="function"&&(qs===null||!qs.has(Pe)))){M.flags|=65536,l&=-l,M.lanes|=l;var nt=Eg(M,ue,l);$p(M,nt);break e}}M=M.return}while(M!==null)}o0(d)}catch(mt){l=mt,Ln===d&&d!==null&&(Ln=d=d.return);continue}break}while(!0)}function s0(){var s=ec.current;return ec.current=qu,s===null?qu:s}function zf(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),qn===null||(Ea&268435455)===0&&(tc&268435455)===0||Qs(qn,Jn)}function oc(s,l){var d=Qt;Qt|=2;var y=s0();(qn!==s||Jn!==l)&&(vs=null,Pa(s,l));do try{A_();break}catch(k){i0(s,k)}while(!0);if(Jh(),Qt=d,ec.current=y,Ln!==null)throw Error(t(261));return qn=null,Jn=0,Vn}function A_(){for(;Ln!==null;)a0(Ln)}function M_(){for(;Ln!==null&&!xt();)a0(Ln)}function a0(s){var l=c0(s.alternate,s,Xr);s.memoizedProps=s.pendingProps,l===null?o0(s):Ln=l,Mf.current=null}function o0(s){var l=s;do{var d=l.alternate;if(s=l.return,(l.flags&32768)===0){if(d=S_(d,l,Xr),d!==null){Ln=d;return}}else{if(d=C_(d,l),d!==null){d.flags&=32767,Ln=d;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Vn=6,Ln=null;return}}if(l=l.sibling,l!==null){Ln=l;return}Ln=l=s}while(l!==null);Vn===0&&(Vn=5)}function Aa(s,l,d){var y=Vt,k=ri.transition;try{ri.transition=null,Vt=1,j_(s,l,d,y)}finally{ri.transition=k,Vt=y}return null}function j_(s,l,d,y){do bo();while(Ks!==null);if((Qt&6)!==0)throw Error(t(327));d=s.finishedWork;var k=s.finishedLanes;if(d===null)return null;if(s.finishedWork=null,s.finishedLanes=0,d===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var M=d.lanes|d.childLanes;if(Za(s,M),s===qn&&(Ln=qn=null,Jn=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||rc||(rc=!0,h0(sn,function(){return bo(),null})),M=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||M){M=ri.transition,ri.transition=null;var $=Vt;Vt=1;var ue=Qt;Qt|=4,Mf.current=null,T_(s,d),Qg(d,s),It(Bh),Kr=!!Fh,Bh=Fh=null,s.current=d,E_(d),vt(),Qt=ue,Vt=$,ri.transition=M}else s.current=d;if(rc&&(rc=!1,Ks=s,ic=k),M=s.pendingLanes,M===0&&(qs=null),an(d.stateNode),Pr(s,lt()),l!==null)for(y=s.onRecoverableError,d=0;d<l.length;d++)k=l[d],y(k.value,{componentStack:k.stack,digest:k.digest});if(nc)throw nc=!1,s=Lf,Lf=null,s;return(ic&1)!==0&&s.tag!==0&&bo(),M=s.pendingLanes,(M&1)!==0?s===Df?ml++:(ml=0,Df=s):ml=0,Hs(),null}function bo(){if(Ks!==null){var s=zi(ic),l=ri.transition,d=Vt;try{if(ri.transition=null,Vt=16>s?16:s,Ks===null)var y=!1;else{if(s=Ks,Ks=null,ic=0,(Qt&6)!==0)throw Error(t(331));var k=Qt;for(Qt|=4,ht=s.current;ht!==null;){var M=ht,$=M.child;if((ht.flags&16)!==0){var ue=M.deletions;if(ue!==null){for(var ve=0;ve<ue.length;ve++){var Ae=ue[ve];for(ht=Ae;ht!==null;){var Ye=ht;switch(Ye.tag){case 0:case 11:case 15:dl(8,Ye,M)}var Je=Ye.child;if(Je!==null)Je.return=Ye,ht=Je;else for(;ht!==null;){Ye=ht;var He=Ye.sibling,ut=Ye.return;if(Gg(Ye),Ye===Ae){ht=null;break}if(He!==null){He.return=ut,ht=He;break}ht=ut}}}var ft=M.alternate;if(ft!==null){var gt=ft.child;if(gt!==null){ft.child=null;do{var An=gt.sibling;gt.sibling=null,gt=An}while(gt!==null)}}ht=M}}if((M.subtreeFlags&2064)!==0&&$!==null)$.return=M,ht=$;else e:for(;ht!==null;){if(M=ht,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:dl(9,M,M.return)}var Te=M.sibling;if(Te!==null){Te.return=M.return,ht=Te;break e}ht=M.return}}var _e=s.current;for(ht=_e;ht!==null;){$=ht;var Pe=$.child;if(($.subtreeFlags&2064)!==0&&Pe!==null)Pe.return=$,ht=Pe;else e:for($=_e;ht!==null;){if(ue=ht,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:$u(9,ue)}}catch(mt){Tn(ue,ue.return,mt)}if(ue===$){ht=null;break e}var nt=ue.sibling;if(nt!==null){nt.return=ue.return,ht=nt;break e}ht=ue.return}}if(Qt=k,Hs(),Ht&&typeof Ht.onPostCommitFiberRoot=="function")try{Ht.onPostCommitFiberRoot(Ke,s)}catch{}y=!0}return y}finally{Vt=d,ri.transition=l}}return!1}function l0(s,l,d){l=yo(d,l),l=Tg(s,l,1),s=Gs(s,l,1),l=gr(),s!==null&&(Fi(s,1,l),Pr(s,l))}function Tn(s,l,d){if(s.tag===3)l0(s,s,d);else for(;l!==null;){if(l.tag===3){l0(l,s,d);break}else if(l.tag===1){var y=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(qs===null||!qs.has(y))){s=yo(d,s),s=Eg(l,s,1),l=Gs(l,s,1),s=gr(),l!==null&&(Fi(l,1,s),Pr(l,s));break}}l=l.return}}function I_(s,l,d){var y=s.pingCache;y!==null&&y.delete(l),l=gr(),s.pingedLanes|=s.suspendedLanes&d,qn===s&&(Jn&d)===d&&(Vn===4||Vn===3&&(Jn&130023424)===Jn&&500>lt()-If?Pa(s,0):jf|=d),Pr(s,l)}function u0(s,l){l===0&&((s.mode&1)===0?l=1:(l=Cn,Cn<<=1,(Cn&130023424)===0&&(Cn=4194304)));var d=gr();s=ps(s,l),s!==null&&(Fi(s,l,d),Pr(s,d))}function L_(s){var l=s.memoizedState,d=0;l!==null&&(d=l.retryLane),u0(s,d)}function D_(s,l){var d=0;switch(s.tag){case 13:var y=s.stateNode,k=s.memoizedState;k!==null&&(d=k.retryLane);break;case 19:y=s.stateNode;break;default:throw Error(t(314))}y!==null&&y.delete(l),u0(s,d)}var c0;c0=function(s,l,d){if(s!==null)if(s.memoizedProps!==l.pendingProps||kr.current)Er=!0;else{if((s.lanes&d)===0&&(l.flags&128)===0)return Er=!1,b_(s,l,d);Er=(s.flags&131072)!==0}else Er=!1,gn&&(l.flags&1048576)!==0&&Up(l,Ru,l.index);switch(l.lanes=0,l.tag){case 2:var y=l.type;Qu(s,l),s=l.pendingProps;var k=uo(l,sr.current);mo(l,d),k=cf(null,l,y,s,k,d);var M=hf();return l.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Tr(y)?(M=!0,Iu(l)):M=!1,l.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,nf(l),k.updater=Ku,l.stateNode=k,k._reactInternals=l,vf(l,y,s,d),l=wf(null,l,y,!0,M,d)):(l.tag=0,gn&&M&&Gh(l),pr(null,l,k,d),l=l.child),l;case 16:y=l.elementType;e:{switch(Qu(s,l),s=l.pendingProps,k=y._init,y=k(y._payload),l.type=y,k=l.tag=N_(y),s=wi(y,s),k){case 0:l=xf(null,l,y,s,d);break e;case 1:l=Rg(null,l,y,s,d);break e;case 11:l=Mg(null,l,y,s,d);break e;case 14:l=jg(null,l,y,wi(y.type,s),d);break e}throw Error(t(306,y,""))}return l;case 0:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:wi(y,k),xf(s,l,y,k,d);case 1:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:wi(y,k),Rg(s,l,y,k,d);case 3:e:{if(Ng(l),s===null)throw Error(t(387));y=l.pendingProps,M=l.memoizedState,k=M.element,Jp(s,l),Wu(l,y,null,d);var $=l.memoizedState;if(y=$.element,M.isDehydrated)if(M={element:y,isDehydrated:!1,cache:$.cache,pendingSuspenseBoundaries:$.pendingSuspenseBoundaries,transitions:$.transitions},l.updateQueue.baseState=M,l.memoizedState=M,l.flags&256){k=yo(Error(t(423)),l),l=Fg(s,l,y,d,k);break e}else if(y!==k){k=yo(Error(t(424)),l),l=Fg(s,l,y,d,k);break e}else for(Hr=Vs(l.stateNode.containerInfo.firstChild),Ur=l,gn=!0,xi=null,d=Zp(l,null,y,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(fo(),y===k){l=ms(s,l,d);break e}pr(s,l,y,d)}l=l.child}return l;case 5:return tg(l),s===null&&Kh(l),y=l.type,k=l.pendingProps,M=s!==null?s.memoizedProps:null,$=k.children,zh(y,k)?$=null:M!==null&&zh(y,M)&&(l.flags|=32),Dg(s,l),pr(s,l,$,d),l.child;case 6:return s===null&&Kh(l),null;case 13:return Bg(s,l,d);case 4:return rf(l,l.stateNode.containerInfo),y=l.pendingProps,s===null?l.child=po(l,null,y,d):pr(s,l,y,d),l.child;case 11:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:wi(y,k),Mg(s,l,y,k,d);case 7:return pr(s,l,l.pendingProps,d),l.child;case 8:return pr(s,l,l.pendingProps.children,d),l.child;case 12:return pr(s,l,l.pendingProps.children,d),l.child;case 10:e:{if(y=l.type._context,k=l.pendingProps,M=l.memoizedProps,$=k.value,un(Bu,y._currentValue),y._currentValue=$,M!==null)if(In(M.value,$)){if(M.children===k.children&&!kr.current){l=ms(s,l,d);break e}}else for(M=l.child,M!==null&&(M.return=l);M!==null;){var ue=M.dependencies;if(ue!==null){$=M.child;for(var ve=ue.firstContext;ve!==null;){if(ve.context===y){if(M.tag===1){ve=gs(-1,d&-d),ve.tag=2;var Ae=M.updateQueue;if(Ae!==null){Ae=Ae.shared;var Ye=Ae.pending;Ye===null?ve.next=ve:(ve.next=Ye.next,Ye.next=ve),Ae.pending=ve}}M.lanes|=d,ve=M.alternate,ve!==null&&(ve.lanes|=d),ef(M.return,d,l),ue.lanes|=d;break}ve=ve.next}}else if(M.tag===10)$=M.type===l.type?null:M.child;else if(M.tag===18){if($=M.return,$===null)throw Error(t(341));$.lanes|=d,ue=$.alternate,ue!==null&&(ue.lanes|=d),ef($,d,l),$=M.sibling}else $=M.child;if($!==null)$.return=M;else for($=M;$!==null;){if($===l){$=null;break}if(M=$.sibling,M!==null){M.return=$.return,$=M;break}$=$.return}M=$}pr(s,l,k.children,d),l=l.child}return l;case 9:return k=l.type,y=l.pendingProps.children,mo(l,d),k=ti(k),y=y(k),l.flags|=1,pr(s,l,y,d),l.child;case 14:return y=l.type,k=wi(y,l.pendingProps),k=wi(y.type,k),jg(s,l,y,k,d);case 15:return Ig(s,l,l.type,l.pendingProps,d);case 17:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:wi(y,k),Qu(s,l),l.tag=1,Tr(y)?(s=!0,Iu(l)):s=!1,mo(l,d),Cg(l,y,k),vf(l,y,k,d),wf(null,l,y,!0,s,d);case 19:return Vg(s,l,d);case 22:return Lg(s,l,d)}throw Error(t(156,l.tag))};function h0(s,l){return at(s,l)}function R_(s,l,d,y){this.tag=s,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(s,l,d,y){return new R_(s,l,d,y)}function Vf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function N_(s){if(typeof s=="function")return Vf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Ze)return 11;if(s===Bt)return 14}return 2}function Js(s,l){var d=s.alternate;return d===null?(d=ii(s.tag,l,s.key,s.mode),d.elementType=s.elementType,d.type=s.type,d.stateNode=s.stateNode,d.alternate=s,s.alternate=d):(d.pendingProps=l,d.type=s.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=s.flags&14680064,d.childLanes=s.childLanes,d.lanes=s.lanes,d.child=s.child,d.memoizedProps=s.memoizedProps,d.memoizedState=s.memoizedState,d.updateQueue=s.updateQueue,l=s.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=s.sibling,d.index=s.index,d.ref=s.ref,d}function lc(s,l,d,y,k,M){var $=2;if(y=s,typeof s=="function")Vf(s)&&($=1);else if(typeof s=="string")$=5;else e:switch(s){case Ne:return Ma(d.children,k,M,l);case Ve:$=8,k|=8;break;case qe:return s=ii(12,d,l,k|2),s.elementType=qe,s.lanes=M,s;case dt:return s=ii(13,d,l,k),s.elementType=dt,s.lanes=M,s;case We:return s=ii(19,d,l,k),s.elementType=We,s.lanes=M,s;case wt:return uc(d,k,M,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ot:$=10;break e;case je:$=9;break e;case Ze:$=11;break e;case Bt:$=14;break e;case Le:$=16,y=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return l=ii($,d,l,k),l.elementType=s,l.type=y,l.lanes=M,l}function Ma(s,l,d,y){return s=ii(7,s,y,l),s.lanes=d,s}function uc(s,l,d,y){return s=ii(22,s,y,l),s.elementType=wt,s.lanes=d,s.stateNode={isHidden:!1},s}function Wf(s,l,d){return s=ii(6,s,null,l),s.lanes=d,s}function Uf(s,l,d){return l=ii(4,s.children!==null?s.children:[],s.key,l),l.lanes=d,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function F_(s,l,d,y,k){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=js(0),this.expirationTimes=js(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=js(0),this.identifierPrefix=y,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Hf(s,l,d,y,k,M,$,ue,ve){return s=new F_(s,l,d,ue,ve),l===1?(l=1,M===!0&&(l|=8)):l=0,M=ii(3,null,null,l),s.current=M,M.stateNode=s,M.memoizedState={element:y,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},nf(M),s}function B_(s,l,d){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:y==null?null:""+y,children:s,containerInfo:l,implementation:d}}function f0(s){if(!s)return Us;s=s._reactInternals;e:{if(Ue(s)!==s||s.tag!==1)throw Error(t(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Tr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(s.tag===1){var d=s.type;if(Tr(d))return zp(s,d,l)}return l}function d0(s,l,d,y,k,M,$,ue,ve){return s=Hf(d,y,!0,s,k,M,$,ue,ve),s.context=f0(null),d=s.current,y=gr(),k=Zs(d),M=gs(y,k),M.callback=l??null,Gs(d,M,k),s.current.lanes=k,Fi(s,k,y),Pr(s,y),s}function cc(s,l,d,y){var k=l.current,M=gr(),$=Zs(k);return d=f0(d),l.context===null?l.context=d:l.pendingContext=d,l=gs(M,$),l.payload={element:s},y=y===void 0?null:y,y!==null&&(l.callback=y),s=Gs(k,l,$),s!==null&&(Ci(s,k,$,M),Vu(s,k,$)),$}function hc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function p0(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var d=s.retryLane;s.retryLane=d!==0&&d<l?d:l}}function Xf(s,l){p0(s,l),(s=s.alternate)&&p0(s,l)}function z_(){return null}var g0=typeof reportError=="function"?reportError:function(s){console.error(s)};function Gf(s){this._internalRoot=s}fc.prototype.render=Gf.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(t(409));cc(s,l,null,null)},fc.prototype.unmount=Gf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;Oa(function(){cc(null,s,null,null)}),l[cs]=null}};function fc(s){this._internalRoot=s}fc.prototype.unstable_scheduleHydration=function(s){if(s){var l=Pt();s={blockedOn:null,target:s,priority:l};for(var d=0;d<x.length&&l!==0&&l<x[d].priority;d++);x.splice(d,0,s),d===0&&Oe(s)}};function Yf(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function dc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function m0(){}function V_(s,l,d,y,k){if(k){if(typeof y=="function"){var M=y;y=function(){var Ae=hc($);M.call(Ae)}}var $=d0(l,y,s,0,null,!1,!1,"",m0);return s._reactRootContainer=$,s[cs]=$.current,el(s.nodeType===8?s.parentNode:s),Oa(),$}for(;k=s.lastChild;)s.removeChild(k);if(typeof y=="function"){var ue=y;y=function(){var Ae=hc(ve);ue.call(Ae)}}var ve=Hf(s,0,!1,null,null,!1,!1,"",m0);return s._reactRootContainer=ve,s[cs]=ve.current,el(s.nodeType===8?s.parentNode:s),Oa(function(){cc(l,ve,d,y)}),ve}function pc(s,l,d,y,k){var M=d._reactRootContainer;if(M){var $=M;if(typeof k=="function"){var ue=k;k=function(){var ve=hc($);ue.call(ve)}}cc(l,$,s,k)}else $=V_(d,l,s,k,y);return hc($)}Vi=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var d=On(l.pendingLanes);d!==0&&(Bi(l,d|1),Pr(l,lt()),(Qt&6)===0&&(wo=lt()+500,Hs()))}break;case 13:Oa(function(){var y=ps(s,1);if(y!==null){var k=gr();Ci(y,s,1,k)}}),Xf(s,1)}},Br=function(s){if(s.tag===13){var l=ps(s,134217728);if(l!==null){var d=gr();Ci(l,s,134217728,d)}Xf(s,134217728)}},dr=function(s){if(s.tag===13){var l=Zs(s),d=ps(s,l);if(d!==null){var y=gr();Ci(d,s,l,y)}Xf(s,l)}},Pt=function(){return Vt},rr=function(s,l){var d=Vt;try{return Vt=s,l()}finally{Vt=d}},Y=function(s,l,d){switch(l){case"input":if(Nr(s,d),l=d.name,d.type==="radio"&&l!=null){for(d=s;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<d.length;l++){var y=d[l];if(y!==s&&y.form===s.form){var k=Mu(y);if(!k)throw Error(t(90));la(y),Nr(y,k)}}}break;case"textarea":Ps(s,d);break;case"select":l=d.value,l!=null&&tn(s,!!d.multiple,l,!1)}},V=Ff,q=Oa;var W_={usingClientEntryPoint:!1,Events:[rl,oo,Mu,U,A,Ff]},vl={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},U_={bundleType:vl.bundleType,version:vl.version,rendererPackageName:vl.rendererPackageName,rendererConfig:vl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ge.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=De(s),s===null?null:s.stateNode},findFiberByHostInstance:vl.findFiberByHostInstance||z_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gc.isDisabled&&gc.supportsFiber)try{Ke=gc.inject(U_),Ht=gc}catch{}}return Ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W_,Ar.createPortal=function(s,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yf(l))throw Error(t(200));return B_(s,l,null,d)},Ar.createRoot=function(s,l){if(!Yf(s))throw Error(t(299));var d=!1,y="",k=g0;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),l=Hf(s,1,!1,null,null,d,!1,y,k),s[cs]=l.current,el(s.nodeType===8?s.parentNode:s),new Gf(l)},Ar.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=De(l),s=s===null?null:s.stateNode,s},Ar.flushSync=function(s){return Oa(s)},Ar.hydrate=function(s,l,d){if(!dc(l))throw Error(t(200));return pc(null,s,l,!0,d)},Ar.hydrateRoot=function(s,l,d){if(!Yf(s))throw Error(t(405));var y=d!=null&&d.hydratedSources||null,k=!1,M="",$=g0;if(d!=null&&(d.unstable_strictMode===!0&&(k=!0),d.identifierPrefix!==void 0&&(M=d.identifierPrefix),d.onRecoverableError!==void 0&&($=d.onRecoverableError)),l=d0(l,null,s,1,d??null,k,!1,M,$),s[cs]=l.current,el(s),y)for(s=0;s<y.length;s++)d=y[s],k=d._getVersion,k=k(d._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[d,k]:l.mutableSourceEagerHydrationData.push(d,k);return new fc(l)},Ar.render=function(s,l,d){if(!dc(l))throw Error(t(200));return pc(null,s,l,!1,d)},Ar.unmountComponentAtNode=function(s){if(!dc(s))throw Error(t(40));return s._reactRootContainer?(Oa(function(){pc(null,null,s,!1,function(){s._reactRootContainer=null,s[cs]=null})}),!0):!1},Ar.unstable_batchedUpdates=Ff,Ar.unstable_renderSubtreeIntoContainer=function(s,l,d,y){if(!dc(d))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return pc(s,l,d,!1,y)},Ar.version="18.3.1-next-f1338f8080-20240426",Ar}var C0;function jm(){if(C0)return Zf.exports;C0=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(e){console.error(e)}}return o(),Zf.exports=Q_(),Zf.exports}var k0;function J_(){if(k0)return mc;k0=1;var o=jm();return mc.createRoot=o.createRoot,mc.hydrateRoot=o.hydrateRoot,mc}var $_=J_();/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var T0="popstate";function e1(o={}){function e(i,a){let{pathname:h="/",search:p="",hash:m=""}=Ua(i.location.hash.substring(1));return!h.startsWith("/")&&!h.startsWith(".")&&(h="/"+h),md("",{pathname:h,search:p,hash:m},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(i,a){let h=i.document.querySelector("base"),p="";if(h&&h.getAttribute("href")){let m=i.location.href,_=m.indexOf("#");p=_===-1?m:m.slice(0,_)}return p+"#"+(typeof a=="string"?a:Kl(a))}function n(i,a){ci(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(a)})`)}return n1(e,t,n,o)}function bn(o,e){if(o===!1||o===null||typeof o>"u")throw new Error(e)}function ci(o,e){if(!o){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function t1(){return Math.random().toString(36).substring(2,10)}function E0(o,e){return{usr:o.state,key:o.key,idx:e}}function md(o,e,t=null,n){return{pathname:typeof o=="string"?o:o.pathname,search:"",hash:"",...typeof e=="string"?Ua(e):e,state:t,key:e&&e.key||n||t1()}}function Kl({pathname:o="/",search:e="",hash:t=""}){return e&&e!=="?"&&(o+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(o+=t.charAt(0)==="#"?t:"#"+t),o}function Ua(o){let e={};if(o){let t=o.indexOf("#");t>=0&&(e.hash=o.substring(t),o=o.substring(0,t));let n=o.indexOf("?");n>=0&&(e.search=o.substring(n),o=o.substring(0,n)),o&&(e.pathname=o)}return e}function n1(o,e,t,n={}){let{window:i=document.defaultView,v5Compat:a=!1}=n,h=i.history,p="POP",m=null,_=b();_==null&&(_=0,h.replaceState({...h.state,idx:_},""));function b(){return(h.state||{idx:null}).idx}function E(){p="POP";let ee=b(),K=ee==null?null:ee-_;_=ee,m&&m({action:p,location:W.location,delta:K})}function I(ee,K){p="PUSH";let ae=md(W.location,ee,K);t&&t(ae,ee),_=b()+1;let le=E0(ae,_),ge=W.createHref(ae);try{h.pushState(le,"",ge)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;i.location.assign(ge)}a&&m&&m({action:p,location:W.location,delta:1})}function O(ee,K){p="REPLACE";let ae=md(W.location,ee,K);t&&t(ae,ee),_=b();let le=E0(ae,_),ge=W.createHref(ae);h.replaceState(le,"",ge),a&&m&&m({action:p,location:W.location,delta:0})}function Q(ee){return r1(ee)}let W={get action(){return p},get location(){return o(i,h)},listen(ee){if(m)throw new Error("A history only accepts one active listener");return i.addEventListener(T0,E),m=ee,()=>{i.removeEventListener(T0,E),m=null}},createHref(ee){return e(i,ee)},createURL:Q,encodeLocation(ee){let K=Q(ee);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:I,replace:O,go(ee){return h.go(ee)}};return W}function r1(o,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),bn(t,"No window.location.(origin|href) available to create URL");let n=typeof o=="string"?o:Kl(o);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Im(o,e,t="/"){return i1(o,e,t,!1)}function i1(o,e,t,n){let i=typeof e=="string"?Ua(e):e,a=Ss(i.pathname||"/",t);if(a==null)return null;let h=Lm(o);s1(h);let p=null;for(let m=0;p==null&&m<h.length;++m){let _=m1(a);p=p1(h[m],_,n)}return p}function Lm(o,e=[],t=[],n="",i=!1){let a=(h,p,m=i,_)=>{let b={relativePath:_===void 0?h.path||"":_,caseSensitive:h.caseSensitive===!0,childrenIndex:p,route:h};if(b.relativePath.startsWith("/")){if(!b.relativePath.startsWith(n)&&m)return;bn(b.relativePath.startsWith(n),`Absolute route path "${b.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),b.relativePath=b.relativePath.slice(n.length)}let E=ws([n,b.relativePath]),I=t.concat(b);h.children&&h.children.length>0&&(bn(h.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),Lm(h.children,e,I,E,m)),!(h.path==null&&!h.index)&&e.push({path:E,score:f1(E,h.index),routesMeta:I})};return o.forEach((h,p)=>{if(h.path===""||!h.path?.includes("?"))a(h,p);else for(let m of Dm(h.path))a(h,p,!0,m)}),e}function Dm(o){let e=o.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),a=t.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let h=Dm(n.join("/")),p=[];return p.push(...h.map(m=>m===""?a:[a,m].join("/"))),i&&p.push(...h),p.map(m=>o.startsWith("/")&&m===""?"/":m)}function s1(o){o.sort((e,t)=>e.score!==t.score?t.score-e.score:d1(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var a1=/^:[\w-]+$/,o1=3,l1=2,u1=1,c1=10,h1=-2,O0=o=>o==="*";function f1(o,e){let t=o.split("/"),n=t.length;return t.some(O0)&&(n+=h1),e&&(n+=l1),t.filter(i=>!O0(i)).reduce((i,a)=>i+(a1.test(a)?o1:a===""?u1:c1),n)}function d1(o,e){return o.length===e.length&&o.slice(0,-1).every((n,i)=>n===e[i])?o[o.length-1]-e[e.length-1]:0}function p1(o,e,t=!1){let{routesMeta:n}=o,i={},a="/",h=[];for(let p=0;p<n.length;++p){let m=n[p],_=p===n.length-1,b=a==="/"?e:e.slice(a.length)||"/",E=Bc({path:m.relativePath,caseSensitive:m.caseSensitive,end:_},b),I=m.route;if(!E&&_&&t&&!n[n.length-1].route.index&&(E=Bc({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},b)),!E)return null;Object.assign(i,E.params),h.push({params:i,pathname:ws([a,E.pathname]),pathnameBase:x1(ws([a,E.pathnameBase])),route:I}),E.pathnameBase!=="/"&&(a=ws([a,E.pathnameBase]))}return h}function Bc(o,e){typeof o=="string"&&(o={path:o,caseSensitive:!1,end:!0});let[t,n]=g1(o.path,o.caseSensitive,o.end),i=e.match(t);if(!i)return null;let a=i[0],h=a.replace(/(.)\/+$/,"$1"),p=i.slice(1);return{params:n.reduce((_,{paramName:b,isOptional:E},I)=>{if(b==="*"){let Q=p[I]||"";h=a.slice(0,a.length-Q.length).replace(/(.)\/+$/,"$1")}const O=p[I];return E&&!O?_[b]=void 0:_[b]=(O||"").replace(/%2F/g,"/"),_},{}),pathname:a,pathnameBase:h,pattern:o}}function g1(o,e=!1,t=!0){ci(o==="*"||!o.endsWith("*")||o.endsWith("/*"),`Route path "${o}" will be treated as if it were "${o.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${o.replace(/\*$/,"/*")}".`);let n=[],i="^"+o.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,p,m)=>(n.push({paramName:p,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return o.endsWith("*")?(n.push({paramName:"*"}),i+=o==="*"||o==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":o!==""&&o!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function m1(o){try{return o.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ci(!1,`The URL path "${o}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),o}}function Ss(o,e){if(e==="/")return o;if(!o.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=o.charAt(t);return n&&n!=="/"?null:o.slice(t)||"/"}var Rm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,v1=o=>Rm.test(o);function y1(o,e="/"){let{pathname:t,search:n="",hash:i=""}=typeof o=="string"?Ua(o):o,a;if(t)if(v1(t))a=t;else{if(t.includes("//")){let h=t;t=t.replace(/\/\/+/g,"/"),ci(!1,`Pathnames cannot have embedded double slashes - normalizing ${h} -> ${t}`)}t.startsWith("/")?a=P0(t.substring(1),"/"):a=P0(t,e)}else a=e;return{pathname:a,search:w1(n),hash:b1(i)}}function P0(o,e){let t=e.replace(/\/+$/,"").split("/");return o.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function $f(o,e,t,n){return`Cannot include a '${o}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _1(o){return o.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Nm(o){let e=_1(o);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Fm(o,e,t,n=!1){let i;typeof o=="string"?i=Ua(o):(i={...o},bn(!i.pathname||!i.pathname.includes("?"),$f("?","pathname","search",i)),bn(!i.pathname||!i.pathname.includes("#"),$f("#","pathname","hash",i)),bn(!i.search||!i.search.includes("#"),$f("#","search","hash",i)));let a=o===""||i.pathname==="",h=a?"/":i.pathname,p;if(h==null)p=t;else{let E=e.length-1;if(!n&&h.startsWith("..")){let I=h.split("/");for(;I[0]==="..";)I.shift(),E-=1;i.pathname=I.join("/")}p=E>=0?e[E]:"/"}let m=y1(i,p),_=h&&h!=="/"&&h.endsWith("/"),b=(a||h===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(_||b)&&(m.pathname+="/"),m}var ws=o=>o.join("/").replace(/\/\/+/g,"/"),x1=o=>o.replace(/\/+$/,"").replace(/^\/*/,"/"),w1=o=>!o||o==="?"?"":o.startsWith("?")?o:"?"+o,b1=o=>!o||o==="#"?"":o.startsWith("#")?o:"#"+o,S1=class{constructor(o,e,t,n=!1){this.status=o,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function C1(o){return o!=null&&typeof o.status=="number"&&typeof o.statusText=="string"&&typeof o.internal=="boolean"&&"data"in o}function k1(o){return o.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Bm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function zm(o,e){let t=o;if(typeof t!="string"||!Rm.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let n=t,i=!1;if(Bm)try{let a=new URL(window.location.href),h=t.startsWith("//")?new URL(a.protocol+t):new URL(t),p=Ss(h.pathname,e);h.origin===a.origin&&p!=null?t=p+h.search+h.hash:i=!0}catch{ci(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:n,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Vm=["POST","PUT","PATCH","DELETE"];new Set(Vm);var T1=["GET",...Vm];new Set(T1);var zo=ke.createContext(null);zo.displayName="DataRouter";var rh=ke.createContext(null);rh.displayName="DataRouterState";var E1=ke.createContext(!1),Wm=ke.createContext({isTransitioning:!1});Wm.displayName="ViewTransition";var O1=ke.createContext(new Map);O1.displayName="Fetchers";var P1=ke.createContext(null);P1.displayName="Await";var di=ke.createContext(null);di.displayName="Navigation";var iu=ke.createContext(null);iu.displayName="Location";var Ts=ke.createContext({outlet:null,matches:[],isDataRoute:!1});Ts.displayName="Route";var zd=ke.createContext(null);zd.displayName="RouteError";var Um="REACT_ROUTER_ERROR",A1="REDIRECT",M1="ROUTE_ERROR_RESPONSE";function j1(o){if(o.startsWith(`${Um}:${A1}:{`))try{let e=JSON.parse(o.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function I1(o){if(o.startsWith(`${Um}:${M1}:{`))try{let e=JSON.parse(o.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new S1(e.status,e.statusText,e.data)}catch{}}function L1(o,{relative:e}={}){bn(su(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=ke.useContext(di),{hash:i,pathname:a,search:h}=au(o,{relative:e}),p=a;return t!=="/"&&(p=a==="/"?t:ws([t,a])),n.createHref({pathname:p,search:h,hash:i})}function su(){return ke.useContext(iu)!=null}function Ha(){return bn(su(),"useLocation() may be used only in the context of a <Router> component."),ke.useContext(iu).location}var Hm="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Xm(o){ke.useContext(di).static||ke.useLayoutEffect(o)}function Vd(){let{isDataRoute:o}=ke.useContext(Ts);return o?Y1():D1()}function D1(){bn(su(),"useNavigate() may be used only in the context of a <Router> component.");let o=ke.useContext(zo),{basename:e,navigator:t}=ke.useContext(di),{matches:n}=ke.useContext(Ts),{pathname:i}=Ha(),a=JSON.stringify(Nm(n)),h=ke.useRef(!1);return Xm(()=>{h.current=!0}),ke.useCallback((m,_={})=>{if(ci(h.current,Hm),!h.current)return;if(typeof m=="number"){t.go(m);return}let b=Fm(m,JSON.parse(a),i,_.relative==="path");o==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:ws([e,b.pathname])),(_.replace?t.replace:t.push)(b,_.state,_)},[e,t,a,i,o])}ke.createContext(null);function au(o,{relative:e}={}){let{matches:t}=ke.useContext(Ts),{pathname:n}=Ha(),i=JSON.stringify(Nm(t));return ke.useMemo(()=>Fm(o,JSON.parse(i),n,e==="path"),[o,i,n,e])}function R1(o,e){return Gm(o,e)}function Gm(o,e,t,n,i){bn(su(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ke.useContext(di),{matches:h}=ke.useContext(Ts),p=h[h.length-1],m=p?p.params:{},_=p?p.pathname:"/",b=p?p.pathnameBase:"/",E=p&&p.route;{let ae=E&&E.path||"";qm(_,!E||ae.endsWith("*")||ae.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${ae}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ae}"> to <Route path="${ae==="/"?"*":`${ae}/*`}">.`)}let I=Ha(),O;if(e){let ae=typeof e=="string"?Ua(e):e;bn(b==="/"||ae.pathname?.startsWith(b),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${b}" but pathname "${ae.pathname}" was given in the \`location\` prop.`),O=ae}else O=I;let Q=O.pathname||"/",W=Q;if(b!=="/"){let ae=b.replace(/^\//,"").split("/");W="/"+Q.replace(/^\//,"").split("/").slice(ae.length).join("/")}let ee=Im(o,{pathname:W});ci(E||ee!=null,`No routes matched location "${O.pathname}${O.search}${O.hash}" `),ci(ee==null||ee[ee.length-1].route.element!==void 0||ee[ee.length-1].route.Component!==void 0||ee[ee.length-1].route.lazy!==void 0,`Matched leaf route at location "${O.pathname}${O.search}${O.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=V1(ee&&ee.map(ae=>Object.assign({},ae,{params:Object.assign({},m,ae.params),pathname:ws([b,a.encodeLocation?a.encodeLocation(ae.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathname]),pathnameBase:ae.pathnameBase==="/"?b:ws([b,a.encodeLocation?a.encodeLocation(ae.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:ae.pathnameBase])})),h,t,n,i);return e&&K?ke.createElement(iu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...O},navigationType:"POP"}},K):K}function N1(){let o=G1(),e=C1(o)?`${o.status} ${o.statusText}`:o instanceof Error?o.message:JSON.stringify(o),t=o instanceof Error?o.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},a={padding:"2px 4px",backgroundColor:n},h=null;return console.error("Error handled by React Router default ErrorBoundary:",o),h=ke.createElement(ke.Fragment,null,ke.createElement("p",null," Hey developer "),ke.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ke.createElement("code",{style:a},"ErrorBoundary")," or"," ",ke.createElement("code",{style:a},"errorElement")," prop on your route.")),ke.createElement(ke.Fragment,null,ke.createElement("h2",null,"Unexpected Application Error!"),ke.createElement("h3",{style:{fontStyle:"italic"}},e),t?ke.createElement("pre",{style:i},t):null,h)}var F1=ke.createElement(N1,null),Ym=class extends ke.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,e){return e.location!==o.location||e.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:e.error,location:e.location,revalidation:o.revalidation||e.revalidation}}componentDidCatch(o,e){this.props.onError?this.props.onError(o,e):console.error("React Router caught the following error during render",o)}render(){let o=this.state.error;if(this.context&&typeof o=="object"&&o&&"digest"in o&&typeof o.digest=="string"){const t=I1(o.digest);t&&(o=t)}let e=o!==void 0?ke.createElement(Ts.Provider,{value:this.props.routeContext},ke.createElement(zd.Provider,{value:o,children:this.props.component})):this.props.children;return this.context?ke.createElement(B1,{error:o},e):e}};Ym.contextType=E1;var ed=new WeakMap;function B1({children:o,error:e}){let{basename:t}=ke.useContext(di);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let n=j1(e.digest);if(n){let i=ed.get(e);if(i)throw i;let a=zm(n.location,t);if(Bm&&!ed.get(e))if(a.isExternal||n.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const h=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:n.replace}));throw ed.set(e,h),h}return ke.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return o}function z1({routeContext:o,match:e,children:t}){let n=ke.useContext(zo);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ke.createElement(Ts.Provider,{value:o},t)}function V1(o,e=[],t=null,n=null,i=null){if(o==null){if(!t)return null;if(t.errors)o=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)o=t.matches;else return null}let a=o,h=t?.errors;if(h!=null){let b=a.findIndex(E=>E.route.id&&h?.[E.route.id]!==void 0);bn(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(h).join(",")}`),a=a.slice(0,Math.min(a.length,b+1))}let p=!1,m=-1;if(t)for(let b=0;b<a.length;b++){let E=a[b];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(m=b),E.route.id){let{loaderData:I,errors:O}=t,Q=E.route.loader&&!I.hasOwnProperty(E.route.id)&&(!O||O[E.route.id]===void 0);if(E.route.lazy||Q){p=!0,m>=0?a=a.slice(0,m+1):a=[a[0]];break}}}let _=t&&n?(b,E)=>{n(b,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:k1(t.matches),errorInfo:E})}:void 0;return a.reduceRight((b,E,I)=>{let O,Q=!1,W=null,ee=null;t&&(O=h&&E.route.id?h[E.route.id]:void 0,W=E.route.errorElement||F1,p&&(m<0&&I===0?(qm("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),Q=!0,ee=null):m===I&&(Q=!0,ee=E.route.hydrateFallbackElement||null)));let K=e.concat(a.slice(0,I+1)),ae=()=>{let le;return O?le=W:Q?le=ee:E.route.Component?le=ke.createElement(E.route.Component,null):E.route.element?le=E.route.element:le=b,ke.createElement(z1,{match:E,routeContext:{outlet:b,matches:K,isDataRoute:t!=null},children:le})};return t&&(E.route.ErrorBoundary||E.route.errorElement||I===0)?ke.createElement(Ym,{location:t.location,revalidation:t.revalidation,component:W,error:O,children:ae(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:_}):ae()},null)}function Wd(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function W1(o){let e=ke.useContext(zo);return bn(e,Wd(o)),e}function U1(o){let e=ke.useContext(rh);return bn(e,Wd(o)),e}function H1(o){let e=ke.useContext(Ts);return bn(e,Wd(o)),e}function Ud(o){let e=H1(o),t=e.matches[e.matches.length-1];return bn(t.route.id,`${o} can only be used on routes that contain a unique "id"`),t.route.id}function X1(){return Ud("useRouteId")}function G1(){let o=ke.useContext(zd),e=U1("useRouteError"),t=Ud("useRouteError");return o!==void 0?o:e.errors?.[t]}function Y1(){let{router:o}=W1("useNavigate"),e=Ud("useNavigate"),t=ke.useRef(!1);return Xm(()=>{t.current=!0}),ke.useCallback(async(i,a={})=>{ci(t.current,Hm),t.current&&(typeof i=="number"?await o.navigate(i):await o.navigate(i,{fromRouteId:e,...a}))},[o,e])}var A0={};function qm(o,e,t){!e&&!A0[o]&&(A0[o]=!0,ci(!1,t))}ke.memo(q1);function q1({routes:o,future:e,state:t,onError:n}){return Gm(o,void 0,t,n,e)}function To(o){bn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function K1({basename:o="/",children:e=null,location:t,navigationType:n="POP",navigator:i,static:a=!1,unstable_useTransitions:h}){bn(!su(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let p=o.replace(/^\/*/,"/"),m=ke.useMemo(()=>({basename:p,navigator:i,static:a,unstable_useTransitions:h,future:{}}),[p,i,a,h]);typeof t=="string"&&(t=Ua(t));let{pathname:_="/",search:b="",hash:E="",state:I=null,key:O="default"}=t,Q=ke.useMemo(()=>{let W=Ss(_,p);return W==null?null:{location:{pathname:W,search:b,hash:E,state:I,key:O},navigationType:n}},[p,_,b,E,I,O,n]);return ci(Q!=null,`<Router basename="${p}"> is not able to match the URL "${_}${b}${E}" because it does not start with the basename, so the <Router> won't render anything.`),Q==null?null:ke.createElement(di.Provider,{value:m},ke.createElement(iu.Provider,{children:e,value:Q}))}function Z1({children:o,location:e}){return R1(vd(o),e)}function vd(o,e=[]){let t=[];return ke.Children.forEach(o,(n,i)=>{if(!ke.isValidElement(n))return;let a=[...e,i];if(n.type===ke.Fragment){t.push.apply(t,vd(n.props.children,a));return}bn(n.type===To,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bn(!n.props.index||!n.props.children,"An index route cannot have child routes.");let h={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=vd(n.props.children,a)),t.push(h)}),t}var Ac="get",Mc="application/x-www-form-urlencoded";function ih(o){return typeof HTMLElement<"u"&&o instanceof HTMLElement}function Q1(o){return ih(o)&&o.tagName.toLowerCase()==="button"}function J1(o){return ih(o)&&o.tagName.toLowerCase()==="form"}function $1(o){return ih(o)&&o.tagName.toLowerCase()==="input"}function ex(o){return!!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)}function tx(o,e){return o.button===0&&(!e||e==="_self")&&!ex(o)}var vc=null;function nx(){if(vc===null)try{new FormData(document.createElement("form"),0),vc=!1}catch{vc=!0}return vc}var rx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function td(o){return o!=null&&!rx.has(o)?(ci(!1,`"${o}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Mc}"`),null):o}function ix(o,e){let t,n,i,a,h;if(J1(o)){let p=o.getAttribute("action");n=p?Ss(p,e):null,t=o.getAttribute("method")||Ac,i=td(o.getAttribute("enctype"))||Mc,a=new FormData(o)}else if(Q1(o)||$1(o)&&(o.type==="submit"||o.type==="image")){let p=o.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=o.getAttribute("formaction")||p.getAttribute("action");if(n=m?Ss(m,e):null,t=o.getAttribute("formmethod")||p.getAttribute("method")||Ac,i=td(o.getAttribute("formenctype"))||td(p.getAttribute("enctype"))||Mc,a=new FormData(p,o),!nx()){let{name:_,type:b,value:E}=o;if(b==="image"){let I=_?`${_}.`:"";a.append(`${I}x`,"0"),a.append(`${I}y`,"0")}else _&&a.append(_,E)}}else{if(ih(o))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ac,n=null,i=Mc,h=o}return a&&i==="text/plain"&&(h=a,a=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:a,body:h}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hd(o,e){if(o===!1||o===null||typeof o>"u")throw new Error(e)}function sx(o,e,t){let n=typeof o=="string"?new URL(o,typeof window>"u"?"server://singlefetch/":window.location.origin):o;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&Ss(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function ax(o,e){if(o.id in e)return e[o.id];try{let t=await import(o.module);return e[o.id]=t,t}catch(t){return console.error(`Error loading route module \`${o.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ox(o){return o==null?!1:o.href==null?o.rel==="preload"&&typeof o.imageSrcSet=="string"&&typeof o.imageSizes=="string":typeof o.rel=="string"&&typeof o.href=="string"}async function lx(o,e,t){let n=await Promise.all(o.map(async i=>{let a=e.routes[i.route.id];if(a){let h=await ax(a,t);return h.links?h.links():[]}return[]}));return fx(n.flat(1).filter(ox).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function M0(o,e,t,n,i,a){let h=(m,_)=>t[_]?m.route.id!==t[_].route.id:!0,p=(m,_)=>t[_].pathname!==m.pathname||t[_].route.path?.endsWith("*")&&t[_].params["*"]!==m.params["*"];return a==="assets"?e.filter((m,_)=>h(m,_)||p(m,_)):a==="data"?e.filter((m,_)=>{let b=n.routes[m.route.id];if(!b||!b.hasLoader)return!1;if(h(m,_)||p(m,_))return!0;if(m.route.shouldRevalidate){let E=m.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(o,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function ux(o,e,{includeHydrateFallback:t}={}){return cx(o.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function cx(o){return[...new Set(o)]}function hx(o){let e={},t=Object.keys(o).sort();for(let n of t)e[n]=o[n];return e}function fx(o,e){let t=new Set;return new Set(e),o.reduce((n,i)=>{let a=JSON.stringify(hx(i));return t.has(a)||(t.add(a),n.push({key:a,link:i})),n},[])}function Km(){let o=ke.useContext(zo);return Hd(o,"You must render this element inside a <DataRouterContext.Provider> element"),o}function dx(){let o=ke.useContext(rh);return Hd(o,"You must render this element inside a <DataRouterStateContext.Provider> element"),o}var Xd=ke.createContext(void 0);Xd.displayName="FrameworkContext";function Zm(){let o=ke.useContext(Xd);return Hd(o,"You must render this element inside a <HydratedRouter> element"),o}function px(o,e){let t=ke.useContext(Xd),[n,i]=ke.useState(!1),[a,h]=ke.useState(!1),{onFocus:p,onBlur:m,onMouseEnter:_,onMouseLeave:b,onTouchStart:E}=e,I=ke.useRef(null);ke.useEffect(()=>{if(o==="render"&&h(!0),o==="viewport"){let W=K=>{K.forEach(ae=>{h(ae.isIntersecting)})},ee=new IntersectionObserver(W,{threshold:.5});return I.current&&ee.observe(I.current),()=>{ee.disconnect()}}},[o]),ke.useEffect(()=>{if(n){let W=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(W)}}},[n]);let O=()=>{i(!0)},Q=()=>{i(!1),h(!1)};return t?o!=="intent"?[a,I,{}]:[a,I,{onFocus:_l(p,O),onBlur:_l(m,Q),onMouseEnter:_l(_,O),onMouseLeave:_l(b,Q),onTouchStart:_l(E,O)}]:[!1,I,{}]}function _l(o,e){return t=>{o&&o(t),t.defaultPrevented||e(t)}}function gx({page:o,...e}){let{router:t}=Km(),n=ke.useMemo(()=>Im(t.routes,o,t.basename),[t.routes,o,t.basename]);return n?ke.createElement(vx,{page:o,matches:n,...e}):null}function mx(o){let{manifest:e,routeModules:t}=Zm(),[n,i]=ke.useState([]);return ke.useEffect(()=>{let a=!1;return lx(o,e,t).then(h=>{a||i(h)}),()=>{a=!0}},[o,e,t]),n}function vx({page:o,matches:e,...t}){let n=Ha(),{manifest:i,routeModules:a}=Zm(),{basename:h}=Km(),{loaderData:p,matches:m}=dx(),_=ke.useMemo(()=>M0(o,e,m,i,n,"data"),[o,e,m,i,n]),b=ke.useMemo(()=>M0(o,e,m,i,n,"assets"),[o,e,m,i,n]),E=ke.useMemo(()=>{if(o===n.pathname+n.search+n.hash)return[];let Q=new Set,W=!1;if(e.forEach(K=>{let ae=i.routes[K.route.id];!ae||!ae.hasLoader||(!_.some(le=>le.route.id===K.route.id)&&K.route.id in p&&a[K.route.id]?.shouldRevalidate||ae.hasClientLoader?W=!0:Q.add(K.route.id))}),Q.size===0)return[];let ee=sx(o,h,"data");return W&&Q.size>0&&ee.searchParams.set("_routes",e.filter(K=>Q.has(K.route.id)).map(K=>K.route.id).join(",")),[ee.pathname+ee.search]},[h,p,n,i,_,e,o,a]),I=ke.useMemo(()=>ux(b,i),[b,i]),O=mx(b);return ke.createElement(ke.Fragment,null,E.map(Q=>ke.createElement("link",{key:Q,rel:"prefetch",as:"fetch",href:Q,...t})),I.map(Q=>ke.createElement("link",{key:Q,rel:"modulepreload",href:Q,...t})),O.map(({key:Q,link:W})=>ke.createElement("link",{key:Q,nonce:t.nonce,...W})))}function yx(...o){return e=>{o.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var _x=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{_x&&(window.__reactRouterVersion="7.11.0")}catch{}function xx({basename:o,children:e,unstable_useTransitions:t,window:n}){let i=ke.useRef();i.current==null&&(i.current=e1({window:n,v5Compat:!0}));let a=i.current,[h,p]=ke.useState({action:a.action,location:a.location}),m=ke.useCallback(_=>{t===!1?p(_):ke.startTransition(()=>p(_))},[t]);return ke.useLayoutEffect(()=>a.listen(m),[a,m]),ke.createElement(K1,{basename:o,children:e,location:h.location,navigationType:h.action,navigator:a,unstable_useTransitions:t})}var Qm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gd=ke.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:i,reloadDocument:a,replace:h,state:p,target:m,to:_,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:I,...O},Q){let{basename:W,unstable_useTransitions:ee}=ke.useContext(di),K=typeof _=="string"&&Qm.test(_),ae=zm(_,W);_=ae.to;let le=L1(_,{relative:i}),[ge,xe,F]=px(n,O),Ne=Cx(_,{replace:h,state:p,target:m,preventScrollReset:b,relative:i,viewTransition:E,unstable_defaultShouldRevalidate:I,unstable_useTransitions:ee});function Ve(ot){e&&e(ot),ot.defaultPrevented||Ne(ot)}let qe=ke.createElement("a",{...O,...F,href:ae.absoluteURL||le,onClick:ae.isExternal||a?e:Ve,ref:yx(Q,xe),target:m,"data-discover":!K&&t==="render"?"true":void 0});return ge&&!K?ke.createElement(ke.Fragment,null,qe,ke.createElement(gx,{page:le})):qe});Gd.displayName="Link";var wx=ke.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:i=!1,style:a,to:h,viewTransition:p,children:m,..._},b){let E=au(h,{relative:_.relative}),I=Ha(),O=ke.useContext(rh),{navigator:Q,basename:W}=ke.useContext(di),ee=O!=null&&Px(E)&&p===!0,K=Q.encodeLocation?Q.encodeLocation(E).pathname:E.pathname,ae=I.pathname,le=O&&O.navigation&&O.navigation.location?O.navigation.location.pathname:null;t||(ae=ae.toLowerCase(),le=le?le.toLowerCase():null,K=K.toLowerCase()),le&&W&&(le=Ss(le,W)||le);const ge=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let xe=ae===K||!i&&ae.startsWith(K)&&ae.charAt(ge)==="/",F=le!=null&&(le===K||!i&&le.startsWith(K)&&le.charAt(K.length)==="/"),Ne={isActive:xe,isPending:F,isTransitioning:ee},Ve=xe?e:void 0,qe;typeof n=="function"?qe=n(Ne):qe=[n,xe?"active":null,F?"pending":null,ee?"transitioning":null].filter(Boolean).join(" ");let ot=typeof a=="function"?a(Ne):a;return ke.createElement(Gd,{..._,"aria-current":Ve,className:qe,ref:b,style:ot,to:h,viewTransition:p},typeof m=="function"?m(Ne):m)});wx.displayName="NavLink";var bx=ke.forwardRef(({discover:o="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:i,state:a,method:h=Ac,action:p,onSubmit:m,relative:_,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:I,...O},Q)=>{let{unstable_useTransitions:W}=ke.useContext(di),ee=Ex(),K=Ox(p,{relative:_}),ae=h.toLowerCase()==="get"?"get":"post",le=typeof p=="string"&&Qm.test(p),ge=xe=>{if(m&&m(xe),xe.defaultPrevented)return;xe.preventDefault();let F=xe.nativeEvent.submitter,Ne=F?.getAttribute("formmethod")||h,Ve=()=>ee(F||xe.currentTarget,{fetcherKey:e,method:Ne,navigate:t,replace:i,state:a,relative:_,preventScrollReset:b,viewTransition:E,unstable_defaultShouldRevalidate:I});W&&t!==!1?ke.startTransition(()=>Ve()):Ve()};return ke.createElement("form",{ref:Q,method:ae,action:K,onSubmit:n?m:ge,...O,"data-discover":!le&&o==="render"?"true":void 0})});bx.displayName="Form";function Sx(o){return`${o} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jm(o){let e=ke.useContext(zo);return bn(e,Sx(o)),e}function Cx(o,{target:e,replace:t,state:n,preventScrollReset:i,relative:a,viewTransition:h,unstable_defaultShouldRevalidate:p,unstable_useTransitions:m}={}){let _=Vd(),b=Ha(),E=au(o,{relative:a});return ke.useCallback(I=>{if(tx(I,e)){I.preventDefault();let O=t!==void 0?t:Kl(b)===Kl(E),Q=()=>_(o,{replace:O,state:n,preventScrollReset:i,relative:a,viewTransition:h,unstable_defaultShouldRevalidate:p});m?ke.startTransition(()=>Q()):Q()}},[b,_,E,t,n,e,o,i,a,h,p,m])}var kx=0,Tx=()=>`__${String(++kx)}__`;function Ex(){let{router:o}=Jm("useSubmit"),{basename:e}=ke.useContext(di),t=X1(),n=o.fetch,i=o.navigate;return ke.useCallback(async(a,h={})=>{let{action:p,method:m,encType:_,formData:b,body:E}=ix(a,e);if(h.navigate===!1){let I=h.fetcherKey||Tx();await n(I,t,h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||m,formEncType:h.encType||_,flushSync:h.flushSync})}else await i(h.action||p,{unstable_defaultShouldRevalidate:h.unstable_defaultShouldRevalidate,preventScrollReset:h.preventScrollReset,formData:b,body:E,formMethod:h.method||m,formEncType:h.encType||_,replace:h.replace,state:h.state,fromRouteId:t,flushSync:h.flushSync,viewTransition:h.viewTransition})},[n,i,e,t])}function Ox(o,{relative:e}={}){let{basename:t}=ke.useContext(di),n=ke.useContext(Ts);bn(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),a={...au(o||".",{relative:e})},h=Ha();if(o==null){a.search=h.search;let p=new URLSearchParams(a.search),m=p.getAll("index");if(m.some(b=>b==="")){p.delete("index"),m.filter(E=>E).forEach(E=>p.append("index",E));let b=p.toString();a.search=b?`?${b}`:""}}return(!o||o===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:ws([t,a.pathname])),Kl(a)}function Px(o,{relative:e}={}){let t=ke.useContext(Wm);bn(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Jm("useViewTransitionState"),i=au(o,{relative:e});if(!t.isTransitioning)return!1;let a=Ss(t.currentLocation.pathname,n)||t.currentLocation.pathname,h=Ss(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Bc(i.pathname,h)!=null||Bc(i.pathname,a)!=null}var $m=jm();const Ax=({header:o,leftSidebar:e,undoRedoSidebar:t,canvasBoard:n,rightSidebar:i,footer:a,rightPanel:h})=>Z.jsxs("div",{className:"flex flex-col w-full h-screen bg-stone-300",children:[o&&Z.jsx("div",{className:"flex-none",children:o}),Z.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e&&Z.jsx("div",{className:"flex-none",children:e}),t&&Z.jsx("div",{className:"flex-none",children:t}),Z.jsx("div",{className:"flex-1 flex justify-center items-center overflow-hidden",children:n}),i&&Z.jsx("div",{className:"flex-none",children:i}),h&&Z.jsx("div",{className:"flex-none h-full",children:h})]}),a&&Z.jsx("div",{className:"flex-none",children:a})]});function de(o,e,t){return(e=(function(n){var i=(function(a,h){if(typeof a!="object"||!a)return a;var p=a[Symbol.toPrimitive];if(p!==void 0){var m=p.call(a,h);if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(h==="string"?String:Number)(a)})(n,"string");return typeof i=="symbol"?i:i+""})(e))in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function j0(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);e&&(n=n.filter((function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable}))),t.push.apply(t,n)}return t}function me(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?j0(Object(t),!0).forEach((function(n){de(o,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):j0(Object(t)).forEach((function(n){Object.defineProperty(o,n,Object.getOwnPropertyDescriptor(t,n))}))}return o}function dn(o,e){if(o==null)return{};var t,n,i=(function(h,p){if(h==null)return{};var m={};for(var _ in h)if({}.hasOwnProperty.call(h,_)){if(p.indexOf(_)>=0)continue;m[_]=h[_]}return m})(o,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(o);for(n=0;n<a.length;n++)t=a[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(o,t)&&(i[t]=o[t])}return i}function ss(o,e){return e||(e=o.slice(0)),Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(e)}}))}class I0{constructor(){de(this,"browserShadowBlurConstant",1),de(this,"DPI",96),de(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),de(this,"perfLimitSizeTotal",2097152),de(this,"maxCacheSideLimit",4096),de(this,"minCacheSideLimit",256),de(this,"disableStyleCopyPaste",!1),de(this,"enableGLFiltering",!0),de(this,"textureSize",4096),de(this,"forceGLPutImageData",!1),de(this,"cachesBoundsOfCurve",!1),de(this,"fontPaths",{}),de(this,"NUM_FRACTION_DIGITS",4)}}const Yt=new class extends I0{constructor(o){super(),this.configure(o)}configure(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,o)}addFonts(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=me(me({},this.fontPaths),o)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach((o=>{delete this.fontPaths[o]}))}clearFonts(){this.fontPaths={}}restoreDefaults(o){const e=new I0,t=o?.reduce(((n,i)=>(n[i]=e[i],n)),{})||e;this.configure(t)}},Cs=function(o){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[o]("fabric",...t)};class $i extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class Yd extends $i{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}let Mx=class{};class jx extends Mx{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),i=e.createShader(e.FRAGMENT_SHADER);return!!i&&(e.shaderSource(i,n),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find((n=>this.testPrecision(t,n))),t.getExtension("WEBGL_lose_context").loseContext(),Cs("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const Ix={};let yd;const Lx=o=>{yd=o},ji=()=>yd||(yd={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new jx,dispose(){},copyPasteData:Ix}),Xa=()=>ji().document,Oi=()=>ji().window,ev=()=>{var o;return Math.max((o=Yt.devicePixelRatio)!==null&&o!==void 0?o:Oi().devicePixelRatio,1)},Mo=new class{constructor(){de(this,"boundsOfCurveCache",{}),this.charWidthsCache=new Map}getFontCache(o){let{fontFamily:e,fontStyle:t,fontWeight:n}=o;e=e.toLowerCase();const i=this.charWidthsCache;i.has(e)||i.set(e,new Map);const a=i.get(e),h="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return a.has(h)||a.set(h,new Map),a.get(h)}clearFontCache(o){o?this.charWidthsCache.delete((o||"").toLowerCase()):this.charWidthsCache=new Map}limitDimsByArea(o){const{perfLimitSizeTotal:e}=Yt,t=Math.sqrt(e*o);return[Math.floor(t),Math.floor(e/t)]}},zc="6.9.1";function Fa(){}const ra=Math.PI/2,ks=2*Math.PI,qd=Math.PI/180,hr=Object.freeze([1,0,0,1,0,0]),Kd=16,ea=.4477152502,Rt="center",nn="left",Lr="top",_d="bottom",Mn="right",_r="none",Zd=/\r?\n/,tv="moving",sh="scaling",nv="rotating",Qd="rotate",rv="skewing",Zl="resizing",iv="modifyPoly",Dx="modifyPath",Vc="changed",ah="scale",br="scaleX",Yr="scaleY",Vo="skewX",Wo="skewY",Rn="fill",xr="stroke",Wc="modified",So="json",nd="svg",ct=new class{constructor(){this[So]=new Map,this[nd]=new Map}has(o){return this[So].has(o)}getClass(o){const e=this[So].get(o);if(!e)throw new $i("No class registered for ".concat(o));return e}setClass(o,e){e?this[So].set(e,o):(this[So].set(o.type,o),this[So].set(o.type.toLowerCase(),o))}getSVGClass(o){return this[nd].get(o)}setSVGClass(o,e){this[nd].set(e??o.type.toLowerCase(),o)}},Ql=new class extends Array{remove(o){const e=this.indexOf(o);e>-1&&this.splice(e,1)}cancelAll(){const o=this.splice(0);return o.forEach((e=>e.abort())),o}cancelByCanvas(o){if(!o)return[];const e=this.filter((t=>{var n;return t.target===o||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===o}));return e.forEach((t=>t.abort())),e}cancelByTarget(o){if(!o)return[];const e=this.filter((t=>t.target===o));return e.forEach((t=>t.abort())),e}};class sv{constructor(){de(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach((n=>{let[i,a]=n;this.on(i,a)})),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach((i=>{let[a,h]=i;n.push(this.once(a,h))})),()=>n.forEach((i=>i()))}if(t){const n=this.on(e,(function(){for(var i=arguments.length,a=new Array(i),h=0;h<i;h++)a[h]=arguments[h];t.call(this,...a),n()}));return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],i=n.indexOf(t);i>-1&&n.splice(i,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach((n=>{let[i,a]=n;this._removeEventListener(i,a)})):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const i=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(i)for(let a=0;a<i.length;a++)i[a].call(this,t||{})}}const Ia=(o,e)=>{const t=o.indexOf(e);return t!==-1&&o.splice(t,1),o},Ii=o=>{if(o===0)return 1;switch(Math.abs(o)/ra){case 1:case 3:return 0;case 2:return-1}return Math.cos(o)},Li=o=>{if(o===0)return 0;const e=o/ra,t=Math.sign(o);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(o)};class Ce{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Ce(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Ce(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Ce(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Ce(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Ce(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Ce(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Ce(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Ce(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Ce(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new Ce(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Ce(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new Ce(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jd;const n=Li(e),i=Ii(e),a=this.subtract(t);return new Ce(a.x*i-a.y*n,a.x*n+a.y*i).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ce(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const Jd=new Ce(0,0),jc=o=>!!o&&Array.isArray(o._objects);function $d(o){class e extends o{constructor(){super(...arguments),de(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];const h=this._objects.push(...i);return i.forEach((p=>this._onObjectAdded(p))),h}insertAt(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),h=1;h<i;h++)a[h-1]=arguments[h];return this._objects.splice(n,0,...a),a.forEach((p=>this._onObjectAdded(p))),this._objects.length}remove(){const n=this._objects,i=[];for(var a=arguments.length,h=new Array(a),p=0;p<a;p++)h[p]=arguments[p];return h.forEach((m=>{const _=n.indexOf(m);_!==-1&&(n.splice(_,1),i.push(m),this._onObjectRemoved(m))})),i}forEachObject(n){this.getObjects().forEach(((i,a,h)=>n(i,a,h)))}getObjects(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.length===0?[...this._objects]:this._objects.filter((h=>h.isType(...i)))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,i){return!!this._objects.includes(n)||!!i&&this._objects.some((a=>a instanceof e&&a.contains(n,!0)))}complexity(){return this._objects.reduce(((n,i)=>n+=i.complexity?i.complexity():0),0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Ia(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Ia(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,i){if(!n)return!1;const a=this._objects.indexOf(n);if(a!==0){const h=this.findNewLowerIndex(n,a,i);return Ia(this._objects,n),this._objects.splice(h,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,i){if(!n)return!1;const a=this._objects.indexOf(n);if(a!==this._objects.length-1){const h=this.findNewUpperIndex(n,a,i);return Ia(this._objects,n),this._objects.splice(h,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,i){return n!==this._objects[i]&&(Ia(this._objects,n),this._objects.splice(i,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,i,a){let h;if(a){h=i;for(let p=i-1;p>=0;--p)if(n.isOverlapping(this._objects[p])){h=p;break}}else h=i-1;return h}findNewUpperIndex(n,i,a){let h;if(a){h=i;for(let p=i+1;p<this._objects.length;++p)if(n.isOverlapping(this._objects[p])){h=p;break}}else h=i+1;return h}collectObjects(n){let{left:i,top:a,width:h,height:p}=n,{includeIntersecting:m=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const _=[],b=new Ce(i,a),E=b.add(new Ce(h,p));for(let I=this._objects.length-1;I>=0;I--){const O=this._objects[I];O.selectable&&O.visible&&(m&&O.intersectsWithRect(b,E)||O.isContainedWithinRect(b,E)||m&&O.containsPoint(b)||m&&O.containsPoint(E))&&_.push(O)}return _}}return e}class av extends sv{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function Ul(o){return Oi().requestAnimationFrame(o)}function ov(o){return Oi().cancelAnimationFrame(o)}let Rx=0;const ia=()=>Rx++,hi=()=>{const o=Xa().createElement("canvas");if(!o||o.getContext===void 0)throw new $i("Failed to create `canvas` element");return o},lv=()=>Xa().createElement("img"),Dr=o=>{const e=hi();return e.width=o.width,e.height=o.height,e},ep=(o,e,t)=>o.toDataURL("image/".concat(e),t),tp=(o,e,t)=>new Promise(((n,i)=>{o.toBlob(n,"image/".concat(e),t)})),En=o=>o*qd,is=o=>o/qd,uv=o=>o.every(((e,t)=>e===hr[t])),ur=(o,e,t)=>new Ce(o).transform(e,t),Ir=o=>{const e=1/(o[0]*o[3]-o[1]*o[2]),t=[e*o[3],-e*o[1],-e*o[2],e*o[0],0,0],{x:n,y:i}=new Ce(o[4],o[5]).transform(t,!0);return t[4]=-n,t[5]=-i,t},wn=(o,e,t)=>[o[0]*e[0]+o[2]*e[1],o[1]*e[0]+o[3]*e[1],o[0]*e[2]+o[2]*e[3],o[1]*e[2]+o[3]*e[3],t?0:o[0]*e[4]+o[2]*e[5]+o[4],t?0:o[1]*e[4]+o[3]*e[5]+o[5]],oh=(o,e)=>o.reduceRight(((t,n)=>n&&t?wn(n,t,e):n||t),void 0)||hr.concat(),cv=o=>{let[e,t]=o;return Math.atan2(t,e)},Ba=o=>{const e=cv(o),t=Math.pow(o[0],2)+Math.pow(o[1],2),n=Math.sqrt(t),i=(o[0]*o[3]-o[2]*o[1])/n,a=Math.atan2(o[0]*o[2]+o[1]*o[3],t);return{angle:is(e),scaleX:n,scaleY:i,skewX:is(a),skewY:0,translateX:o[4]||0,translateY:o[5]||0}},Uo=function(o){return[1,0,0,1,o,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function Ga(){let{angle:o=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=En(o),i=Ii(n),a=Li(n);return[i,a,-a,i,e?e-(i*e-a*t):0,t?t-(a*e+i*t):0]}const lh=function(o){return[o,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,0,0]},hv=o=>Math.tan(En(o)),np=o=>[1,0,hv(o),1,0,0],rp=o=>[1,hv(o),0,1,0,0],ou=o=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:i=!1,skewX:a=0,skewY:h=0}=o,p=lh(n?-e:e,i?-t:t);return a&&(p=wn(p,np(a),!0)),h&&(p=wn(p,rp(h),!0)),p},fv=o=>{const{translateX:e=0,translateY:t=0,angle:n=0}=o;let i=Uo(e,t);n&&(i=wn(i,Ga({angle:n})));const a=ou(o);return uv(a)||(i=wn(i,a)),i},Hl=function(o){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((function(n,i){if(e&&e.aborted)return i(new Yd("loadImage"));const a=lv();let h;e&&(h=function(m){a.src="",i(m)},e.addEventListener("abort",h,{once:!0}));const p=function(){a.onload=a.onerror=null,h&&e?.removeEventListener("abort",h),n(a)};o?(a.onload=p,a.onerror=function(){h&&e?.removeEventListener("abort",h),i(new $i("Error loading ".concat(a.src)))},t&&(a.crossOrigin=t),a.src=o):p()}))},Lo=function(o){let{signal:e,reviver:t=Fa}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((n,i)=>{const a=[];e&&e.addEventListener("abort",i,{once:!0}),Promise.all(o.map((h=>ct.getClass(h.type).fromObject(h,{signal:e}).then((p=>(t(h,p),a.push(p),p)))))).then(n).catch((h=>{a.forEach((p=>{p.dispose&&p.dispose()})),i(h)})).finally((()=>{e&&e.removeEventListener("abort",i)}))}))},lu=function(o){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(((t,n)=>{const i=[];e&&e.addEventListener("abort",n,{once:!0});const a=Object.values(o).map((p=>p&&p.type&&ct.has(p.type)?Lo([p],{signal:e}).then((m=>{let[_]=m;return i.push(_),_})):p)),h=Object.keys(o);Promise.all(a).then((p=>p.reduce(((m,_,b)=>(m[h[b]]=_,m)),{}))).then(t).catch((p=>{i.forEach((m=>{m.dispose&&m.dispose()})),n(p)})).finally((()=>{e&&e.removeEventListener("abort",n)}))}))},Ya=function(o){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce(((e,t)=>(t in o&&(e[t]=o[t]),e)),{})},ip=(o,e)=>Object.keys(o).reduce(((t,n)=>(e(o[n],n,o)&&(t[n]=o[n]),t)),{}),on=(o,e)=>parseFloat(Number(o).toFixed(e)),Do=o=>"matrix("+o.map((e=>on(e,Yt.NUM_FRACTION_DIGITS))).join(" ")+")",oi=o=>!!o&&o.toLive!==void 0,L0=o=>!!o&&typeof o.toObject=="function",D0=o=>!!o&&o.offsetX!==void 0&&"source"in o,La=o=>!!o&&"multiSelectionStacking"in o;function dv(o){const e=o&&Ei(o);let t=0,n=0;if(!o||!e)return{left:t,top:n};let i=o;const a=e.documentElement,h=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&(i=i.parentNode||i.host,i===e?(t=h.scrollLeft||a.scrollLeft||0,n=h.scrollTop||a.scrollTop||0):(t+=i.scrollLeft||0,n+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:t,top:n}}const Ei=o=>o.ownerDocument||null,pv=o=>{var e;return((e=o.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},gv=function(o,e,t){let{width:n,height:i}=t,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;o.width=n,o.height=i,a>1&&(o.setAttribute("width",(n*a).toString()),o.setAttribute("height",(i*a).toString()),e.scale(a,a))},xd=(o,e)=>{let{width:t,height:n}=e;t&&(o.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(o.style.height=typeof n=="number"?"".concat(n,"px"):n)};function R0(o){return o.onselectstart!==void 0&&(o.onselectstart=()=>!1),o.style.userSelect=_r,o}class sp{constructor(e){de(this,"_originalCanvasStyle",void 0),de(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&Xa().getElementById(e)||hi();var n;if(t.hasAttribute("data-fabric"))throw new $i("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:i}=this.lower;i.classList.remove("lower-canvas"),i.removeAttribute("data-fabric"),i.setAttribute("width","".concat(t)),i.setAttribute("height","".concat(n)),i.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:i}=this.lower;gv(n,i,e,t)}setCSSDimensions(e){xd(this.lower.el,e)}calcOffset(){return(function(e){var t;const n=e&&Ei(e),i={left:0,top:0};if(!n)return i;const a=((t=pv(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};i.left+=parseInt(a.borderLeftWidth,10)||0,i.top+=parseInt(a.borderTopWidth,10)||0,i.left+=parseInt(a.paddingLeft,10)||0,i.top+=parseInt(a.paddingTop,10)||0;let h={left:0,top:0};const p=n.documentElement;e.getBoundingClientRect!==void 0&&(h=e.getBoundingClientRect());const m=dv(e);return{left:h.left+m.left-(p.clientLeft||0)+i.left,top:h.top+m.top-(p.clientTop||0)+i.top}})(this.lower.el)}dispose(){ji().dispose(this.lower.el),delete this.lower}}const Nx={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...hr]},Fx=["objects"];class Ho extends $d(av){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Ho.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new sp(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),a}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Cs("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?ev():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const i=me({width:this.width,height:this.height},e);this.elements.setDimensions(i,this.getRetinaScaling()),this.hasLostContext=!0,this.width=i.width,this.height=i.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,i=[...this.viewportTransform],a=ur(e,Ir(i));i[0]=t,i[3]=t;const h=ur(a,i);i[4]+=n.x-h.x,i[5]+=n.y-h.y,this.setViewportTransform(i)}setZoom(e){this.zoomToPoint(new Ce(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new Ce(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Ul((()=>this.renderAndReset())))}calcViewportBoundaries(){const e=this.width,t=this.height,n=Ir(this.viewportTransform),i=ur({x:0,y:0},n),a=ur({x:e,y:t},n),h=i.min(a),p=i.max(a);return this.vptCoords={tl:h,tr:new Ce(p.x,h.y),bl:new Ce(h.x,p.y),br:p}}cancelRequestedRender(){this.nextRenderHandle&&(ov(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,i=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),i&&(i._set("canvas",this),i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,i)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,i=t.length;n<i;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],i=this["".concat(t,"Image")],a=this.viewportTransform,h=this["".concat(t,"Vpt")];if(!n&&!i)return;const p=oi(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=p?n.toLive(e):n,h&&e.transform(...a),p){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const m=n.gradientTransform||n.patternTransform;m&&e.transform(...m)}e.fill(),e.restore()}if(i){e.save();const{skipOffscreen:m}=this;this.skipOffscreen=h,h&&e.transform(...a),i.render(e),this.skipOffscreen=m,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new Ce(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new Ce(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new Ce(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new Ce(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new Ce(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return ur(this.getCenterPoint(),Ir(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Rt,Rt),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,i=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return me(me(me({version:zc},Ya(this,t)),{},{objects:this._objects.filter((a=>!a.excludeFromExport)).map((a=>this._toObject(a,e,t)))},this.__serializeBgOverlay(e,t)),i?{clipPath:i}:null)}_toObject(e,t,n){let i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);const a=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!i),a}__serializeBgOverlay(e,t){const n={},i=this.backgroundImage,a=this.overlayImage,h=this.backgroundColor,p=this.overlayColor;return oi(h)?h.excludeFromExport||(n.background=h.toObject(t)):h&&(n.background=h),oi(p)?p.excludeFromExport||(n.overlay=p.toObject(t)):p&&(n.overlay=p),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,e,t)),a&&!a.excludeFromExport&&(n.overlayImage=this._toObject(a,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),i=t.height||"".concat(this.height),a=Yt.NUM_FRACTION_DIGITS,h=t.viewBox;let p;if(h)p='viewBox="'.concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height,'" ');else if(this.svgViewportTransformation){const m=this.viewportTransform;p='viewBox="'.concat(on(-m[4]/m[0],a)," ").concat(on(-m[5]/m[3],a)," ").concat(on(this.width/m[0],a)," ").concat(on(this.height/m[3],a),'" ')}else p='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',i,'" ',p,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",zc,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(ia()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map((e=>{const t=this["".concat(e,"Color")];if(oi(t)){const n=this["".concat(e,"Vpt")],i=this.viewportTransform,a={isType:()=>!1,width:this.width/(n?i[0]:1),height:this.height/(n?i[3]:1)};return t.toSVG(a,{additionalTransform:n?Do(i):""})}})).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=Yt.fontPaths;this._objects.forEach((function a(h){e.push(h),jc(h)&&h._objects.forEach(a)})),e.forEach((a=>{if(!(h=a)||typeof h._renderText!="function")return;var h;const{styles:p,fontFamily:m}=a;!t[m]&&n[m]&&(t[m]=!0,p&&Object.values(p).forEach((_=>{Object.values(_).forEach((b=>{let{fontFamily:E=""}=b;!t[E]&&n[E]&&(t[E]=!0)}))})))}));const i=Object.keys(t).map((a=>`		@font-face {
			font-family: '`.concat(a,`';
			src: url('`).concat(n[a],`');
		}
`))).join("");return i?`	<style type="text/css"><![CDATA[
`.concat(i,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject((n=>{n.excludeFromExport||this._setSVGObject(e,n,t)}))}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const i=this[t];i&&!i.excludeFromExport&&i.toSVG&&e.push(i.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(oi(n)){const i=n.repeat||"",a=this.width,h=this.height,p=this["".concat(t,"Vpt")]?Do(Ir(this.viewportTransform)):"";e.push('<rect transform="'.concat(p," translate(").concat(a/2,",").concat(h/2,')" x="').concat(n.offsetX-a/2,'" y="').concat(n.offsetY-h/2,'" width="').concat(i!=="repeat-y"&&i!=="no-repeat"||!D0(n)?a:n.source.width,'" height="').concat(i!=="repeat-x"&&i!=="no-repeat"||!D0(n)?h:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new $i("`json` is undefined"));const i=typeof e=="string"?JSON.parse(e):e,{objects:a=[]}=i,h=dn(i,Fx),{backgroundImage:p,background:m,overlayImage:_,overlay:b,clipPath:E}=h,I=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Lo(a,{reviver:t,signal:n}),lu({backgroundImage:p,backgroundColor:m,overlayImage:_,overlayColor:b,clipPath:E},{signal:n})]).then((O=>{let[Q,W]=O;return this.clear(),this.add(...Q),this.set(h),this.set(W),this.renderOnAddRemove=I,this}))}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Dr(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:i=1,enableRetinaScaling:a=!1}=e,h=i*(a?this.getRetinaScaling():1);return ep(this.toCanvasElement(h,e),t,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:i=1,enableRetinaScaling:a=!1}=e,h=i*(a?this.getRetinaScaling():1);return tp(this.toCanvasElement(h,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:i,top:a,filter:h}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const p=(t||this.width)*e,m=(n||this.height)*e,_=this.getZoom(),b=this.width,E=this.height,I=this.skipControlsDrawing,O=_*e,Q=this.viewportTransform,W=[O,0,0,O,(Q[4]-(i||0))*e,(Q[5]-(a||0))*e],ee=this.enableRetinaScaling,K=Dr({width:p,height:m}),ae=h?this._objects.filter((le=>h(le))):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=W,this.width=p,this.height=m,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(K.getContext("2d"),ae),this.viewportTransform=Q,this.width=b,this.height=E,this.calcViewportBoundaries(),this.enableRetinaScaling=ee,this.skipControlsDrawing=I,K}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Ql.cancelByCanvas(this),this.disposed=!0,new Promise(((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()}))}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject((e=>e.dispose())),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}de(Ho,"ownDefaults",Nx);const Bx=["touchstart","touchmove","touchend"],mv=o=>{const e=dv(o.target),t=(function(n){const i=n.changedTouches;return i&&i[0]?i[0]:n})(o);return new Ce(t.clientX+e.left,t.clientY+e.top)},Uc=o=>Bx.includes(o.type)||o.pointerType==="touch",N0=o=>{o.preventDefault(),o.stopPropagation()},rs=o=>{let e=0,t=0,n=0,i=0;for(let a=0,h=o.length;a<h;a++){const{x:p,y:m}=o[a];(p>n||!a)&&(n=p),(p<e||!a)&&(e=p),(m>i||!a)&&(i=m),(m<t||!a)&&(t=m)}return{left:e,top:t,width:n-e,height:i-t}},zx=["translateX","translateY","scaleX","scaleY"],vv=(o,e)=>Ro(o,wn(e,o.calcOwnMatrix())),Ro=(o,e)=>{const t=Ba(e),{translateX:n,translateY:i,scaleX:a,scaleY:h}=t,p=dn(t,zx),m=new Ce(n,i);o.flipX=!1,o.flipY=!1,Object.assign(o,p),o.set({scaleX:a,scaleY:h}),o.setPositionByOrigin(m,Rt,Rt)},yv=o=>{o.scaleX=1,o.scaleY=1,o.skewX=0,o.skewY=0,o.flipX=!1,o.flipY=!1,o.rotate(0)},ap=o=>({scaleX:o.scaleX,scaleY:o.scaleY,skewX:o.skewX,skewY:o.skewY,angle:o.angle,left:o.left,flipX:o.flipX,flipY:o.flipY,top:o.top}),uh=(o,e,t)=>{const n=o/2,i=e/2,a=[new Ce(-n,-i),new Ce(n,-i),new Ce(-n,i),new Ce(n,i)].map((p=>p.transform(t))),h=rs(a);return new Ce(h.width,h.height)},uu=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hr;return wn(Ir(arguments.length>1&&arguments[1]!==void 0?arguments[1]:hr),o)},bs=function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hr;return o.transform(uu(e,t))},_v=function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hr,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hr;return o.transform(uu(e,t),!0)},wd=(o,e,t)=>{const n=uu(e,t);return Ro(o,wn(n,o.calcOwnMatrix())),n},op=(o,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(o),me(me({},e),{},{target:n})),n.fire(o,e)},Vx={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Dn=o=>typeof o=="string"?Vx[o]:o-.5,Hc="not-allowed";function xv(o){return Dn(o.originX)===Dn(Rt)&&Dn(o.originY)===Dn(Rt)}function F0(o){return .5-Dn(o)}const Mi=(o,e)=>o[e],lp=(o,e,t,n)=>({e:o,transform:e,pointer:new Ce(t,n)});function wv(o,e){const t=o.getTotalAngle()+is(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function ch(o,e,t,n,i){var a;let{target:h,corner:p}=o;const m=h.controls[p],_=((a=h.canvas)===null||a===void 0?void 0:a.getZoom())||1,b=h.padding/_,E=(function(I,O,Q,W){const ee=I.getRelativeCenterPoint(),K=Q!==void 0&&W!==void 0?I.translateToGivenOrigin(ee,Rt,Rt,Q,W):new Ce(I.left,I.top);return(I.angle?O.rotate(-En(I.angle),ee):O).subtract(K)})(h,new Ce(n,i),e,t);return E.x>=b&&(E.x-=b),E.x<=-b&&(E.x+=b),E.y>=b&&(E.y-=b),E.y<=b&&(E.y+=b),E.x-=m.offsetX,E.y-=m.offsetY,E}const bv=(o,e,t,n)=>{const{target:i,offsetX:a,offsetY:h}=e,p=t-a,m=n-h,_=!Mi(i,"lockMovementX")&&i.left!==p,b=!Mi(i,"lockMovementY")&&i.top!==m;return _&&i.set(nn,p),b&&i.set(Lr,m),(_||b)&&op(tv,lp(o,e,t,n)),_||b},Xc=o=>o.replace(/\s+/g," "),B0={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},rd=(o,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?o+6*(e-o)*t:t<.5?e:t<2/3?o+(e-o)*(2/3-t)*6:o),z0=(o,e,t,n)=>{o/=255,e/=255,t/=255;const i=Math.max(o,e,t),a=Math.min(o,e,t);let h,p;const m=(i+a)/2;if(i===a)h=p=0;else{const _=i-a;switch(p=m>.5?_/(2-i-a):_/(i+a),i){case o:h=(e-t)/_+(e<t?6:0);break;case e:h=(t-o)/_+2;break;case t:h=(o-e)/_+4}h/=6}return[Math.round(360*h),Math.round(100*p),Math.round(100*m),n]},V0=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(o)/(o.endsWith("%")?100:1)},yc=o=>Math.min(Math.round(o),255).toString(16).toUpperCase().padStart(2,"0"),W0=o=>{let[e,t,n,i=1]=o;const a=Math.round(.3*e+.59*t+.11*n);return[a,a,a,i]};class $t{constructor(e){if(de(this,"isUnrecognised",!1),e)if(e instanceof $t)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,i,a=1]=e;this.setSource([t,n,i,a])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in B0&&(e=B0[e]),e==="transparent"?[255,255,255,0]:$t.sourceFromHex(e)||$t.sourceFromRgb(e)||$t.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=z0(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,i]=z0(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(i,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,i]=this.getSource();return"".concat(yc(e)).concat(yc(t)).concat(yc(n)).concat(yc(Math.round(255*i)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(W0(this.getSource())),this}toBlackWhite(e){const[t,,,n]=W0(this.getSource()),i=t<(e||127)?0:255;return this.setSource([i,i,i,n]),this}overlayWith(e){e instanceof $t||(e=new $t(e));const t=this.getSource(),n=e.getSource(),[i,a,h]=t.map(((p,m)=>Math.round(.5*p+.5*n[m])));return this.setSource([i,a,h,t[3]]),this}static fromRgb(e){return $t.fromRgba(e)}static fromRgba(e){return new $t($t.sourceFromRgb(e))}static sourceFromRgb(e){const t=Xc(e).match(/^rgba?\(\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d{0,3}(?:\.\d+)?%?)\s?)?\)$/i);if(t){const[n,i,a]=t.slice(1,4).map((h=>{const p=parseFloat(h);return h.endsWith("%")?Math.round(2.55*p):p}));return[n,i,a,V0(t[4])]}}static fromHsl(e){return $t.fromHsla(e)}static fromHsla(e){return new $t($t.sourceFromHsl(e))}static sourceFromHsl(e){const t=Xc(e).match(/^hsla?\(\s?([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?[\s|,]\s?(\d{0,3}(?:\.\d+)?%?)\s?(?:\s?[,/]\s?(\d*(?:\.\d+)?%?)\s?)?\)$/i);if(!t)return;const n=($t.parseAngletoDegrees(t[1])%360+360)%360/360,i=parseFloat(t[2])/100,a=parseFloat(t[3])/100;let h,p,m;if(i===0)h=p=m=a;else{const _=a<=.5?a*(i+1):a+i-a*i,b=2*a-_;h=rd(b,_,n+1/3),p=rd(b,_,n),m=rd(b,_,n-1/3)}return[Math.round(255*h),Math.round(255*p),Math.round(255*m),V0(t[4])]}static fromHex(e){return new $t($t.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map((m=>m+m)):t.match(/.{2}/g);const[i,a,h,p=255]=n.map((m=>parseInt(m,16)));return[i,a,h,p/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?is(n):t.includes("turn")?360*n:n}}const mr=function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kd;const t=/\D{0,2}$/.exec(o),n=parseFloat(o),i=Yt.DPI;switch(t?.[0]){case"mm":return n*i/25.4;case"cm":return n*i/2.54;case"in":return n*i;case"pt":return n*i/72;case"pc":return n*i/72*12;case"em":return n*e;default:return n}},up=o=>{const[e,t]=o.trim().split(" "),[n,i]=(a=e)&&a!==_r?[a.slice(1,4),a.slice(5,8)]:a===_r?[a,a]:["Mid","Mid"];var a;return{meetOrSlice:t||"meet",alignX:n,alignY:i}},Jl=function(o,e){let t,n,i=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const a=new $t(e),h=a.getAlpha();t=a.toRgb(),h!==1&&(n=h.toString())}else t="none";return i?"".concat(o,": ").concat(t,"; ").concat(n?"".concat(o,"-opacity: ").concat(n,"; "):""):"".concat(o,'="').concat(t,'" ').concat(n?"".concat(o,'-opacity="').concat(n,'" '):"")};class Sv{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):_r,a=this.strokeDashOffset?this.strokeDashOffset:"0",h=this.strokeLineCap?this.strokeLineCap:"butt",p=this.strokeLineJoin?this.strokeLineJoin:"miter",m=this.strokeMiterLimit?this.strokeMiterLimit:"4",_=this.opacity!==void 0?this.opacity:"1",b=this.visible?"":" visibility: hidden;",E=e?"":this.getSvgFilter(),I=Jl(Rn,this.fill);return[Jl(xr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",h,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",p,"; ","stroke-miterlimit: ",m,"; ",I,"fill-rule: ",t,"; ","opacity: ",_,";",E,b].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'.concat(Do(n));return"".concat(i).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),a=e.indexOf("COMMON_PARTS");return e[a]=i,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:i,additionalTransform:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const h=t?"":'style="'.concat(this.getSvgStyles(),'" '),p=i?'style="'.concat(this.getSvgFilter(),'" '):"",m=this.clipPath,_=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",b=m&&m.absolutePositioned,E=this.stroke,I=this.fill,O=this.shadow,Q=[],W=e.indexOf("COMMON_PARTS");let ee;m&&(m.clipPathId="CLIPPATH_".concat(ia()),ee='<clipPath id="'.concat(m.clipPathId,`" >
`).concat(m.toClipPathSVG(n),`</clipPath>
`)),b&&Q.push("<g ",p,this.getSvgCommons(),` >
`),Q.push("<g ",this.getSvgTransform(!1),b?"":p+this.getSvgCommons(),` >
`);const K=[h,_,t?"":this.addPaintOrder()," ",a?'transform="'.concat(a,'" '):""].join("");return e[W]=K,oi(I)&&Q.push(I.toSVG(this)),oi(E)&&Q.push(E.toSVG(this)),O&&Q.push(O.toSVG(this)),m&&Q.push(ee),Q.push(e.join("")),Q.push(`</g>
`),b&&Q.push(`</g>
`),n?n(Q.join("")):Q.join("")}addPaintOrder(){return this.paintFirst!==Rn?' paint-order="'.concat(this.paintFirst,'" '):""}}function hh(o){return new RegExp("^("+o.join("|")+")\\b","i")}const za="textDecorationThickness",Cv=["fontSize","fontWeight","fontFamily","fontStyle"],kv=["underline","overline","linethrough"],Tv=[...Cv,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Ev=[...Tv,...kv,"textBackgroundColor","direction",za],Wx=[...Cv,...kv,xr,"strokeWidth",Rn,"deltaY","textBackgroundColor",za],Ux={_reNewline:Zd,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:nn,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:nn,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[za]:66.667},Qi="justify",Gc="justify-left",Xl="justify-right",Gl="justify-center";var U0,H0,X0;const Pi=String.raw(U0||(U0=ss(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),id=String.raw(H0||(H0=ss(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),bd="http://www.w3.org/2000/svg",Hx=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Pi+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Pi+"))?\\s+(.*)"),Xx={cx:nn,x:nn,r:"radius",cy:Lr,y:Lr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":za},sd="font-size",ad="clip-path",Gx=hh(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),Yx=hh(["symbol","image","marker","pattern","view","svg"]),G0=hh(["symbol","g","a","svg","clipPath","defs"]),Y0=new RegExp(String.raw(X0||(X0=ss(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),Pi,id,Pi,id,Pi,id,Pi)),qx=new Ce(1,0),Ov=new Ce,cp=(o,e)=>o.rotate(e),Yc=(o,e)=>new Ce(e).subtract(o),qc=o=>o.distanceFrom(Ov),Kc=(o,e)=>Math.atan2(jo(o,e),Av(o,e)),Pv=o=>Kc(qx,o),fh=o=>o.eq(Ov)?o:o.scalarDivide(qc(o)),hp=function(o){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return fh(new Ce(-o.y,o.x).scalarMultiply(e?1:-1))},jo=(o,e)=>o.x*e.y-o.y*e.x,Av=(o,e)=>o.x*e.x+o.y*e.y,Sd=(o,e,t)=>{if(o.eq(e)||o.eq(t))return!0;const n=jo(e,t),i=jo(e,o),a=jo(t,o);return n>=0?i>=0&&a<=0:!(i<=0&&a>=0)},q0="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",K0=new RegExp("(?:\\s|^)"+q0+q0+"("+Pi+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class wr{constructor(e){const t=typeof e=="string"?wr.parseShadow(e):e;Object.assign(this,wr.ownDefaults,t),this.id=ia()}static parseShadow(e){const t=e.trim(),[,n=0,i=0,a=0]=(K0.exec(t)||[]).map((h=>parseFloat(h)||0));return{color:(t.replace(K0,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:i,blur:a}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=cp(new Ce(this.offsetX,this.offsetY),En(-e.angle)),n=new $t(this.color);let i=40,a=40;return e.width&&e.height&&(i=100*on((Math.abs(t.x)+this.blur)/e.width,Yt.NUM_FRACTION_DIGITS)+20,a=100*on((Math.abs(t.y)+this.blur)/e.height,Yt.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(a,'%" height="').concat(100+2*a,'%" x="-').concat(i,'%" width="').concat(100+2*i,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(on(this.blur?this.blur/2:0,Yt.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(on(t.x,Yt.NUM_FRACTION_DIGITS),'" dy="').concat(on(t.y,Yt.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=wr.ownDefaults;return this.includeDefaultValues?e:ip(e,((n,i)=>n!==t[i]))}static async fromObject(e){return new this(e)}}de(wr,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),de(wr,"type","shadow"),ct.setClass(wr,"shadow");const Va=(o,e,t)=>Math.max(o,Math.min(e,t)),Kx=[Lr,nn,br,Yr,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Vo,Wo],Es=[Rn,xr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],Zx={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:nn,originY:Lr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Rn,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},od=(o,e,t,n)=>(o<Math.abs(e)?(o=e,n=t/4):n=e===0&&o===0?t/ks*Math.asin(1):t/ks*Math.asin(e/o),{a:o,c:e,p:t,s:n}),Z0=(o,e,t,n,i)=>o*Math.pow(2,10*(n-=1))*Math.sin((n*i-e)*ks/t),Mv=(o,e,t,n)=>-t*Math.cos(o/n*ra)+t+e,Cd=(o,e,t,n)=>(o/=n)<1/2.75?t*(7.5625*o*o)+e:o<2/2.75?t*(7.5625*(o-=1.5/2.75)*o+.75)+e:o<2.5/2.75?t*(7.5625*(o-=2.25/2.75)*o+.9375)+e:t*(7.5625*(o-=2.625/2.75)*o+.984375)+e,Q0=(o,e,t,n)=>t-Cd(n-o,0,t,n)+e;var Qx=Object.freeze({__proto__:null,defaultEasing:Mv,easeInBack:function(o,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(o/=n)*o*((i+1)*o-i)+e},easeInBounce:Q0,easeInCirc:(o,e,t,n)=>-t*(Math.sqrt(1-(o/=n)*o)-1)+e,easeInCubic:(o,e,t,n)=>t*(o/n)**3+e,easeInElastic:(o,e,t,n)=>{const i=t;let a=0;if(o===0)return e;if((o/=n)===1)return e+t;a||(a=.3*n);const{a:h,s:p,p:m}=od(i,t,a,1.70158);return-Z0(h,p,m,o,n)+e},easeInExpo:(o,e,t,n)=>o===0?e:t*2**(10*(o/n-1))+e,easeInOutBack:function(o,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(o/=n/2)<1?t/2*(o*o*((1+(i*=1.525))*o-i))+e:t/2*((o-=2)*o*((1+(i*=1.525))*o+i)+2)+e},easeInOutBounce:(o,e,t,n)=>o<n/2?.5*Q0(2*o,0,t,n)+e:.5*Cd(2*o-n,0,t,n)+.5*t+e,easeInOutCirc:(o,e,t,n)=>(o/=n/2)<1?-t/2*(Math.sqrt(1-o**2)-1)+e:t/2*(Math.sqrt(1-(o-=2)*o)+1)+e,easeInOutCubic:(o,e,t,n)=>(o/=n/2)<1?t/2*o**3+e:t/2*((o-2)**3+2)+e,easeInOutElastic:(o,e,t,n)=>{const i=t;let a=0;if(o===0)return e;if((o/=n/2)===2)return e+t;a||(a=n*(.3*1.5));const{a:h,s:p,p:m,c:_}=od(i,t,a,1.70158);return o<1?-.5*Z0(h,p,m,o,n)+e:h*Math.pow(2,-10*(o-=1))*Math.sin((o*n-p)*ks/m)*.5+_+e},easeInOutExpo:(o,e,t,n)=>o===0?e:o===n?e+t:(o/=n/2)<1?t/2*2**(10*(o-1))+e:t/2*-(2**(-10*--o)+2)+e,easeInOutQuad:(o,e,t,n)=>(o/=n/2)<1?t/2*o**2+e:-t/2*(--o*(o-2)-1)+e,easeInOutQuart:(o,e,t,n)=>(o/=n/2)<1?t/2*o**4+e:-t/2*((o-=2)*o**3-2)+e,easeInOutQuint:(o,e,t,n)=>(o/=n/2)<1?t/2*o**5+e:t/2*((o-2)**5+2)+e,easeInOutSine:(o,e,t,n)=>-t/2*(Math.cos(Math.PI*o/n)-1)+e,easeInQuad:(o,e,t,n)=>t*(o/=n)*o+e,easeInQuart:(o,e,t,n)=>t*(o/=n)*o**3+e,easeInQuint:(o,e,t,n)=>t*(o/n)**5+e,easeInSine:(o,e,t,n)=>-t*Math.cos(o/n*ra)+t+e,easeOutBack:function(o,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((o=o/n-1)*o*((i+1)*o+i)+1)+e},easeOutBounce:Cd,easeOutCirc:(o,e,t,n)=>t*Math.sqrt(1-(o=o/n-1)*o)+e,easeOutCubic:(o,e,t,n)=>t*((o/n-1)**3+1)+e,easeOutElastic:(o,e,t,n)=>{const i=t;let a=0;if(o===0)return e;if((o/=n)===1)return e+t;a||(a=.3*n);const{a:h,s:p,p:m,c:_}=od(i,t,a,1.70158);return h*2**(-10*o)*Math.sin((o*n-p)*ks/m)+_+e},easeOutExpo:(o,e,t,n)=>o===n?e+t:t*-(2**(-10*o/n)+1)+e,easeOutQuad:(o,e,t,n)=>-t*(o/=n)*(o-2)+e,easeOutQuart:(o,e,t,n)=>-t*((o=o/n-1)*o**3-1)+e,easeOutQuint:(o,e,t,n)=>t*((o/n-1)**5+1)+e,easeOutSine:(o,e,t,n)=>t*Math.sin(o/n*ra)+e});const Jx=()=>!1;class fp{constructor(e){let{startValue:t,byValue:n,duration:i=500,delay:a=0,easing:h=Mv,onStart:p=Fa,onChange:m=Fa,onComplete:_=Fa,abort:b=Jx,target:E}=e;de(this,"_state","pending"),de(this,"durationProgress",0),de(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=i,this.delay=a,this.easing=h,this._onStart=p,this._onChange=m,this._onComplete=_,this._abort=b,this.target=E,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout((()=>Ul(e)),this.delay):Ul(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:i,valueProgress:a}=this.calculate(n);this.value=Object.freeze(i),this.valueProgress=a,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Ul(this.tick)))}register(){Ql.push(this)}unregister(){Ql.remove(this)}abort(){this._state="aborted",this.unregister()}}const $x=["startValue","endValue"];class ew extends fp{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(me(me({},dn(e,$x)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const tw=["startValue","endValue"];class nw extends fp{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(me(me({},dn(e,tw)),{},{startValue:t,byValue:n.map(((i,a)=>i-t[a]))}))}calculate(e){const t=this.startValue.map(((n,i)=>this.easing(e,n,this.byValue[i],this.duration,i)));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const rw=["startValue","endValue","easing","onChange","onComplete","abort"],iw=(o,e,t,n)=>e+t*(1-Math.cos(o/n*ra)),ld=o=>o&&((e,t,n)=>o(new $t(e).toRgba(),t,n));class sw extends fp{constructor(e){let{startValue:t,endValue:n,easing:i=iw,onChange:a,onComplete:h,abort:p}=e,m=dn(e,rw);const _=new $t(t).getSource(),b=new $t(n).getSource();super(me(me({},m),{},{startValue:_,byValue:b.map(((E,I)=>E-_[I])),easing:i,onChange:ld(a),onComplete:ld(h),abort:ld(p)}))}calculate(e){const[t,n,i,a]=this.startValue.map(((p,m)=>this.easing(e,p,this.byValue[m],this.duration,m))),h=[...[t,n,i].map(Math.round),Va(0,a,1)];return{value:h,valueProgress:h.map(((p,m)=>this.byValue[m]!==0?Math.abs((p-this.startValue[m])/this.byValue[m]):0)).find((p=>p!==0))||0}}}function dp(o){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(o)?new nw(o):new ew(o);return e.start(),e}function jv(o){const e=new sw(o);return e.start(),e}class mn{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some((t=>t.eq(e)))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter((i=>!this.includes(i)))),this}static isPointContained(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(i||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(i||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const a=Yc(t,n),h=Yc(t,e).divide(a);return i?Math.abs(h.x)===Math.abs(h.y):h.x===h.y&&h.x>=0&&h.x<=1}}static isPointInPolygon(e,t){const n=new Ce(e).setX(Math.min(e.x-1,...t.map((a=>a.x))));let i=0;for(let a=0;a<t.length;a++){const h=this.intersectSegmentSegment(t[a],t[(a+1)%t.length],e,n);if(h.includes(e))return!0;i+=+(h.status==="Intersection")}return i%2==1}static intersectLineLine(e,t,n,i){let a=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],h=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const p=t.x-e.x,m=t.y-e.y,_=i.x-n.x,b=i.y-n.y,E=e.x-n.x,I=e.y-n.y,O=_*I-b*E,Q=p*I-m*E,W=b*p-_*m;if(W!==0){const ee=O/W,K=Q/W;return(a||0<=ee&&ee<=1)&&(h||0<=K&&K<=1)?new mn("Intersection").append(new Ce(e.x+ee*p,e.y+ee*m)):new mn}if(O===0||Q===0){const ee=a||h||mn.isPointContained(e,n,i)||mn.isPointContained(t,n,i)||mn.isPointContained(n,e,t)||mn.isPointContained(i,e,t);return new mn(ee?"Coincident":void 0)}return new mn("Parallel")}static intersectSegmentLine(e,t,n,i){return mn.intersectLineLine(e,t,n,i,!1,!0)}static intersectSegmentSegment(e,t,n,i){return mn.intersectLineLine(e,t,n,i,!1,!1)}static intersectLinePolygon(e,t,n){let i=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const a=new mn,h=n.length;for(let p,m,_,b=0;b<h;b++){if(p=n[b],m=n[(b+1)%h],_=mn.intersectLineLine(e,t,p,m,i,!1),_.status==="Coincident")return _;a.append(..._.points)}return a.points.length>0&&(a.status="Intersection"),a}static intersectSegmentPolygon(e,t,n){return mn.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new mn,i=e.length,a=[];for(let h=0;h<i;h++){const p=e[h],m=e[(h+1)%i],_=mn.intersectSegmentPolygon(p,m,t);_.status==="Coincident"?(a.push(_),n.append(p,m)):n.append(..._.points)}return a.length>0&&a.length===e.length?new mn("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const i=t.min(n),a=t.max(n),h=new Ce(a.x,i.y),p=new Ce(i.x,a.y);return mn.intersectPolygonPolygon(e,[i,h,a,p])}}class aw extends av{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?ur(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=ur(e,Ir(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new Ce(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:i}=this.aCoords||(this.aCoords=this.calcACoords()),a=[e,t,n,i];if(this.group){const h=this.group.calcTransformMatrix();return a.map((p=>ur(p,h)))}return a}intersectsWithRect(e,t){return mn.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=mn.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every((t=>e.containsPoint(t)))}isContainedWithinRect(e,t){const{left:n,top:i,width:a,height:h}=this.getBoundingRect();return n>=e.x&&n+a<=t.x&&i>=e.y&&i+h<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return mn.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some((n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y))||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every((n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y)))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return rs(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(br,e),this._set(Yr,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?is(cv(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||hr.concat()}calcACoords(){const e=Ga({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),i=Uo(t,n),a=wn(i,e),h=this._getTransformedDimensions(),p=h.x/2,m=h.y/2;return{tl:ur({x:-p,y:-m},a),tr:ur({x:p,y:-m},a),bl:ur({x:-p,y:m},a),br:ur({x:p,y:m},a)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Dn(this.originX),Dn(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),i=this.matrixCache;return i&&i.key.every(((a,h)=>a===n[h]))?i.value:(this.group&&(t=wn(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),i={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},a=fv(i);return this.ownMatrixCache={key:e,value:a},a}_getNonTransformedDimensions(){return new Ce(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=me({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let i=n,a=0;this.strokeUniform&&(i=0,a=n);const h=t.width+i,p=t.height+i;let m;return m=t.skewX===0&&t.skewY===0?new Ce(h*t.scaleX,p*t.scaleY):uh(h,p,ou(t)),m.scalarAdd(a)}translateToGivenOrigin(e,t,n,i,a){let h=e.x,p=e.y;const m=Dn(i)-Dn(t),_=Dn(a)-Dn(n);if(m||_){const b=this._getTransformedDimensions();h+=m*b.x,p+=_*b.y}return new Ce(h,p)}translateToCenterPoint(e,t,n){if(t===Rt&&n===Rt)return e;const i=this.translateToGivenOrigin(e,t,n,Rt,Rt);return this.angle?i.rotate(En(this.angle),e):i}translateToOriginPoint(e,t,n){const i=this.translateToGivenOrigin(e,Rt,Rt,t,n);return this.angle?i.rotate(En(this.angle),e):i}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?ur(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new Ce(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const i=this.translateToCenterPoint(e,t,n),a=this.translateToOriginPoint(i,this.originX,this.originY);this.set({left:a.x,top:a.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),nn,Lr)}}const ow=["type"],lw=["extraParam"];let Zi=class Ic extends aw{static getDefaults(){return Ic.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Cs("warn","Setting type has no effect",e)}constructor(e){super(),de(this,"_cacheContext",null),Object.assign(this,Ic.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=hi(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,i=Yt.maxCacheSideLimit,a=Yt.minCacheSideLimit;if(t<=i&&n<=i&&t*n<=Yt.perfLimitSizeTotal)return t<a&&(e.width=a),n<a&&(e.height=a),e;const h=t/n,[p,m]=Mo.limitDimsByArea(h),_=Va(a,p,i),b=Va(a,m,i);return t>_&&(e.zoomX/=t/_,e.width=_,e.capped=!0),n>b&&(e.zoomY/=n/b,e.height=b,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,i=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(i+2),zoomX:e.x,zoomY:e.y,x:n,y:i}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:i,zoomX:a,zoomY:h,x:p,y:m}=this._limitCacheSize(this._getCacheCanvasDimensions()),_=n!==e.width||i!==e.height,b=this.zoomX!==a||this.zoomY!==h;if(!e||!t)return!1;if(_||b){n!==e.width||i!==e.height?(e.width=n,e.height=i):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const E=p/2,I=m/2;return this.cacheTranslationX=Math.round(e.width/2-E)+E,this.cacheTranslationY=Math.round(e.height/2-I)+I,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(a,h),this.zoomX=a,this.zoomY=h,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new Ce(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Ba(this.calcTransformMatrix());return new Ce(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==br&&e!==Yr||(t=this._constrainScale(t)),e===br&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof wr||(t=new wr(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:i,cacheTranslationY:a}=this,{width:h,height:p}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:i,cacheTranslationY:a,width:h,height:p,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===xr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const i=this.fill,a=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=i,this.stroke=a}createClipPathLayer(e,t){const n=Dr(t),i=n.getContext("2d");if(i.translate(t.cacheTranslationX,t.cacheTranslationY),i.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach((a=>{a.transform(i)})),t.parentClipPaths.push(e),e.absolutePositioned){const a=Ir(this.calcTransformMatrix());i.transform(a[0],a[1],a[2],a[3],a[4],a[5])}return e.transform(i),e.drawObject(i,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const i=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,i)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,oi(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(oi(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,i=this.getCanvasRetinaScaling(),[a,,,h]=n?.viewportTransform||hr,p=a*i,m=h*i,_=t.nonScaling?new Ce(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Yt.browserShadowBlurConstant*(p+m)*(_.x+_.y)/4,e.shadowOffsetX=t.offsetX*p*_.x,e.shadowOffsetY=t.offsetY*m*_.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!oi(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,a=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,i,a):e.transform(1,0,0,1,i,a),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:a}}_renderPaintInOrder(e){this.paintFirst===xr?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const i=this._limitCacheSize(this._getCacheCanvasDimensions()),a=this.getCanvasRetinaScaling(),h=i.x/this.scaleX/a,p=i.y/this.scaleY/a,m=Dr({width:Math.ceil(h),height:Math.ceil(p)}),_=m.getContext("2d");_&&(_.beginPath(),_.moveTo(0,0),_.lineTo(h,0),_.lineTo(h,p),_.lineTo(0,p),_.closePath(),_.translate(h/2,p/2),_.scale(i.zoomX/this.scaleX/a,i.zoomY/this.scaleY/a),this._applyPatternGradientTransform(_,t),_.fillStyle=t.toLive(e),_.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(a*this.scaleX/i.zoomX,a*this.scaleY/i.zoomY),e.strokeStyle=(n=_.createPattern(m,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new Ce(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(ct.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=ap(this),n=this.group,i=this.shadow,a=Math.abs,h=e.enableRetinaScaling?ev():1,p=(e.multiplier||1)*h,m=e.canvasProvider||(ae=>new Ho(ae,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&yv(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&wd(this,this.getViewportTransform()),this.setCoords();const _=hi(),b=this.getBoundingRect(),E=this.shadow,I=new Ce;if(E){const ae=E.blur,le=E.nonScaling?new Ce(1,1):this.getObjectScaling();I.x=2*Math.round(a(E.offsetX)+ae)*a(le.x),I.y=2*Math.round(a(E.offsetY)+ae)*a(le.y)}const O=b.width+I.x,Q=b.height+I.y;_.width=Math.ceil(O),_.height=Math.ceil(Q);const W=m(_);e.format==="jpeg"&&(W.backgroundColor="#fff"),this.setPositionByOrigin(new Ce(W.width/2,W.height/2),Rt,Rt);const ee=this.canvas;W._objects=[this],this.set("canvas",W),this.setCoords();const K=W.toCanvasElement(p||1,e);return this.set("canvas",ee),this.shadow=i,n&&(this.group=n),this.set(t),this.setCoords(),W._objects=[],W.destroy(),K}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ep(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return tp(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:i}=this;if(t){const{x:a,y:h}=this.getRelativeCenterPoint();this.originX=Rt,this.originY=Rt,this.left=a,this.top=h}if(this.set("angle",e),t){const{x:a,y:h}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,i);this.left=a,this.top=h,this.originX=n,this.originY=i}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Ql.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&ji().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce(((n,i)=>{let[a,h]=i;return n[a]=this._animate(a,h,t),n}),{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=e.split("."),a=this.constructor.colorProperties.includes(i[i.length-1]),{abort:h,startValue:p,onChange:m,onComplete:_}=n,b=me(me({},n),{},{target:this,startValue:p??i.reduce(((E,I)=>E[I]),this),endValue:t,abort:h?.bind(this),onChange:(E,I,O)=>{i.reduce(((Q,W,ee)=>(ee===i.length-1&&(Q[W]=E),Q[W])),this),m&&m(E,I,O)},onComplete:(E,I,O)=>{this.setCoords(),_&&_(E,I,O)}});return a?jv(b):dp(b)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let i,a=0;a<t.length;a++){if(i=t[a],i===e)return{fork:[this,...t.slice(0,a)],otherFork:[],common:t.slice(a)};for(let h=0;h<n.length;h++){if(this===n[h])return{fork:[],otherFork:[e,...n.slice(0,h)],common:[this,...t]};if(i===n[h])return{fork:[this,...t.slice(0,a)],otherFork:[e,...n.slice(0,h)],common:t.slice(a)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const i=t.fork.pop(),a=t.otherFork.pop(),h=n._objects.indexOf(i),p=n._objects.indexOf(a);return h>-1&&h>p}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Ic.customProperties,this.constructor.customProperties||[]);let t;const n=Yt.NUM_FRACTION_DIGITS,{clipPath:i,fill:a,stroke:h,shadow:p,strokeDashArray:m,left:_,top:b,originX:E,originY:I,width:O,height:Q,strokeWidth:W,strokeLineCap:ee,strokeDashOffset:K,strokeLineJoin:ae,strokeUniform:le,strokeMiterLimit:ge,scaleX:xe,scaleY:F,angle:Ne,flipX:Ve,flipY:qe,opacity:ot,visible:je,backgroundColor:Ze,fillRule:dt,paintFirst:We,globalCompositeOperation:Bt,skewX:Le,skewY:wt}=this;i&&!i.excludeFromExport&&(t=i.toObject(e.concat("inverted","absolutePositioned")));const ze=Qe=>on(Qe,n),Xe=me(me({},Ya(this,e)),{},{type:this.constructor.type,version:zc,originX:E,originY:I,left:ze(_),top:ze(b),width:ze(O),height:ze(Q),fill:L0(a)?a.toObject():a,stroke:L0(h)?h.toObject():h,strokeWidth:ze(W),strokeDashArray:m&&m.concat(),strokeLineCap:ee,strokeDashOffset:K,strokeLineJoin:ae,strokeUniform:le,strokeMiterLimit:ze(ge),scaleX:ze(xe),scaleY:ze(F),angle:ze(Ne),flipX:Ve,flipY:qe,opacity:ze(ot),shadow:p&&p.toObject(),visible:je,backgroundColor:Ze,fillRule:dt,paintFirst:We,globalCompositeOperation:Bt,skewX:ze(Le),skewY:ze(wt)},t?{clipPath:t}:null);return this.includeDefaultValues?Xe:this._removeDefaultValues(Xe)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return ip(e,((i,a)=>{if(a===nn||a===Lr||a==="type")return!0;const h=n[a];return i!==h&&!(Array.isArray(i)&&Array.isArray(h)&&i.length===0&&h.length===0)}))}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=dn(e,ow),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:i}=n,a=dn(n,lw);return lu(t,a).then((h=>i?(delete h[i],new this(t[i],h)):new this(h)))}static fromObject(e,t){return this._fromObject(e,t)}};de(Zi,"stateProperties",Kx),de(Zi,"cacheProperties",Es),de(Zi,"ownDefaults",Zx),de(Zi,"type","FabricObject"),de(Zi,"colorProperties",[Rn,xr,"backgroundColor"]),de(Zi,"customProperties",[]),ct.setClass(Zi),ct.setClass(Zi,"object");const aa=(o,e,t)=>(n,i,a,h)=>{const p=e(n,i,a,h);return p&&op(o,me(me({},lp(n,i,a,h)),t)),p};function qa(o){return(e,t,n,i)=>{const{target:a,originX:h,originY:p}=t,m=a.getRelativeCenterPoint(),_=a.translateToOriginPoint(m,h,p),b=o(e,t,n,i);return a.setPositionByOrigin(_,t.originX,t.originY),b}}const kd=aa(Zl,qa(((o,e,t,n)=>{const i=ch(e,e.originX,e.originY,t,n);if(Dn(e.originX)===Dn(Rt)||Dn(e.originX)===Dn(Mn)&&i.x<0||Dn(e.originX)===Dn(nn)&&i.x>0){const{target:a}=e,h=a.strokeWidth/(a.strokeUniform?a.scaleX:1),p=xv(e)?2:1,m=a.width,_=Math.abs(i.x*p/a.scaleX)-h;return a.set("width",Math.max(_,1)),m!==a.width}return!1})));function Iv(o,e,t,n,i){n=n||{};const a=this.sizeX||n.cornerSize||i.cornerSize,h=this.sizeY||n.cornerSize||i.cornerSize,p=n.transparentCorners!==void 0?n.transparentCorners:i.transparentCorners,m=p?xr:Rn,_=!p&&(n.cornerStrokeColor||i.cornerStrokeColor);let b,E=e,I=t;o.save(),o.fillStyle=n.cornerColor||i.cornerColor||"",o.strokeStyle=n.cornerStrokeColor||i.cornerStrokeColor||"",a>h?(b=a,o.scale(1,h/a),I=t*a/h):h>a?(b=h,o.scale(a/h,1),E=e*h/a):b=a,o.beginPath(),o.arc(E,I,b/2,0,ks,!1),o[m](),_&&o.stroke(),o.restore()}function Lv(o,e,t,n,i){n=n||{};const a=this.sizeX||n.cornerSize||i.cornerSize,h=this.sizeY||n.cornerSize||i.cornerSize,p=n.transparentCorners!==void 0?n.transparentCorners:i.transparentCorners,m=p?xr:Rn,_=!p&&(n.cornerStrokeColor||i.cornerStrokeColor),b=a/2,E=h/2;o.save(),o.fillStyle=n.cornerColor||i.cornerColor||"",o.strokeStyle=n.cornerStrokeColor||i.cornerStrokeColor||"",o.translate(e,t);const I=i.getTotalAngle();o.rotate(En(I)),o["".concat(m,"Rect")](-b,-E,a,h),_&&o.strokeRect(-b,-E,a,h),o.restore()}class Mr{constructor(e){de(this,"visible",!0),de(this,"actionName",ah),de(this,"angle",0),de(this,"x",0),de(this,"y",0),de(this,"offsetX",0),de(this,"offsetY",0),de(this,"sizeX",0),de(this,"sizeY",0),de(this,"touchSizeX",0),de(this,"touchSizeY",0),de(this,"cursorStyle","crosshair"),de(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,i){var a;let{tl:h,tr:p,br:m,bl:_}=i;return((a=t.canvas)===null||a===void 0?void 0:a.getActiveObject())===t&&t.isControlVisible(e)&&mn.isPointInPolygon(n,[h,p,m,_])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,i;return(n=(i=e._controlsVisibility)===null||i===void 0?void 0:i[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,i){return new Ce(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,i,a,h){const p=oh([Uo(n,i),Ga({angle:e}),lh((a?this.touchSizeX:this.sizeX)||t,(a?this.touchSizeY:this.sizeY)||t)]);return{tl:new Ce(-.5,-.5).transform(p),tr:new Ce(.5,-.5).transform(p),br:new Ce(.5,.5).transform(p),bl:new Ce(-.5,.5).transform(p)}}render(e,t,n,i,a){((i=i||{}).cornerStyle||a.cornerStyle)==="circle"?Iv.call(this,e,t,n,i,a):Lv.call(this,e,t,n,i,a)}}const Dv=(o,e,t)=>t.lockRotation?Hc:e.cursorStyle,Rv=aa(nv,qa(((o,e,t,n)=>{let{target:i,ex:a,ey:h,theta:p,originX:m,originY:_}=e;const b=i.translateToOriginPoint(i.getRelativeCenterPoint(),m,_);if(Mi(i,"lockRotation"))return!1;const E=Math.atan2(h-b.y,a-b.x),I=Math.atan2(n-b.y,t-b.x);let O=is(I-E+p);if(i.snapAngle&&i.snapAngle>0){const W=i.snapAngle,ee=i.snapThreshold||W,K=Math.ceil(O/W)*W,ae=Math.floor(O/W)*W;Math.abs(O-ae)<ee?O=ae:Math.abs(O-K)<ee&&(O=K)}O<0&&(O=360+O),O%=360;const Q=i.angle!==O;return i.angle=O,Q})));function Nv(o,e){const t=e.canvas,n=o[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function Fv(o,e,t){const n=Mi(o,"lockScalingX"),i=Mi(o,"lockScalingY");if(n&&i||!e&&(n||i)&&t||n&&e==="x"||i&&e==="y")return!0;const{width:a,height:h,strokeWidth:p}=o;return a===0&&p===0&&e!=="y"||h===0&&p===0&&e!=="x"}const uw=["e","se","s","sw","w","nw","n","ne","e"],Oo=(o,e,t)=>{const n=Nv(o,t);if(Fv(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return Hc;const i=wv(t,e);return"".concat(uw[i],"-resize")};function pp(o,e,t,n){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const a=e.target,h=i.by,p=Nv(o,a);let m,_,b,E,I,O;if(Fv(a,h,p))return!1;if(e.gestureScale)_=e.scaleX*e.gestureScale,b=e.scaleY*e.gestureScale;else{if(m=ch(e,e.originX,e.originY,t,n),I=h!=="y"?Math.sign(m.x||e.signX||1):1,O=h!=="x"?Math.sign(m.y||e.signY||1):1,e.signX||(e.signX=I),e.signY||(e.signY=O),Mi(a,"lockScalingFlip")&&(e.signX!==I||e.signY!==O))return!1;if(E=a._getTransformedDimensions(),p&&!h){const ee=Math.abs(m.x)+Math.abs(m.y),{original:K}=e,ae=ee/(Math.abs(E.x*K.scaleX/a.scaleX)+Math.abs(E.y*K.scaleY/a.scaleY));_=K.scaleX*ae,b=K.scaleY*ae}else _=Math.abs(m.x*a.scaleX/E.x),b=Math.abs(m.y*a.scaleY/E.y);xv(e)&&(_*=2,b*=2),e.signX!==I&&h!=="y"&&(e.originX=F0(e.originX),_*=-1,e.signX=I),e.signY!==O&&h!=="x"&&(e.originY=F0(e.originY),b*=-1,e.signY=O)}const Q=a.scaleX,W=a.scaleY;return h?(h==="x"&&a.set(br,_),h==="y"&&a.set(Yr,b)):(!Mi(a,"lockScalingX")&&a.set(br,_),!Mi(a,"lockScalingY")&&a.set(Yr,b)),Q!==a.scaleX||W!==a.scaleY}const Cl=aa(sh,qa(((o,e,t,n)=>pp(o,e,t,n)))),Bv=aa(sh,qa(((o,e,t,n)=>pp(o,e,t,n,{by:"x"})))),zv=aa(sh,qa(((o,e,t,n)=>pp(o,e,t,n,{by:"y"})))),cw=["target","ex","ey","skewingSide"],ud={x:{counterAxis:"y",scale:br,skew:Vo,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Yr,skew:Wo,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},hw=["ns","nesw","ew","nwse"],Vv=(o,e,t)=>{if(e.x!==0&&Mi(t,"lockSkewingY")||e.y!==0&&Mi(t,"lockSkewingX"))return Hc;const n=wv(t,e)%4;return"".concat(hw[n],"-resize")};function Wv(o,e,t,n,i){const{target:a}=t,{counterAxis:h,origin:p,lockSkewing:m,skew:_,flip:b}=ud[o];if(Mi(a,m))return!1;const{origin:E,flip:I}=ud[h],O=Dn(t[E])*(a[I]?-1:1),Q=-Math.sign(O)*(a[b]?-1:1),W=.5*-((a[_]===0&&ch(t,Rt,Rt,n,i)[o]>0||a[_]>0?1:-1)*Q)+.5;return aa(rv,qa(((K,ae,le,ge)=>(function(xe,F,Ne){let{target:Ve,ex:qe,ey:ot,skewingSide:je}=F,Ze=dn(F,cw);const{skew:dt}=ud[xe],We=Ne.subtract(new Ce(qe,ot)).divide(new Ce(Ve.scaleX,Ve.scaleY))[xe],Bt=Ve[dt],Le=Ze[dt],wt=Math.tan(En(Le)),ze=xe==="y"?Ve._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:Ve._getTransformedDimensions({scaleX:1,scaleY:1}).y,Xe=2*We*je/Math.max(ze,1)+wt,Qe=is(Math.atan(Xe));Ve.set(dt,Qe);const be=Bt!==Ve[dt];if(be&&xe==="y"){const{skewX:Fe,scaleX:yt}=Ve,Ct=Ve._getTransformedDimensions({skewY:Bt}),pt=Ve._getTransformedDimensions(),Mt=Fe!==0?Ct.x/pt.x:1;Mt!==1&&Ve.set(br,Mt*yt)}return be})(o,ae,new Ce(le,ge)))))(e,me(me({},t),{},{[p]:W,skewingSide:Q}),n,i)}const Uv=(o,e,t,n)=>Wv("x",o,e,t,n),Hv=(o,e,t,n)=>Wv("y",o,e,t,n);function dh(o,e){return o[e.canvas.altActionKey]}const kl=(o,e,t)=>{const n=dh(o,t);return e.x===0?n?Vo:Yr:e.y===0?n?Wo:br:""},Da=(o,e,t)=>dh(o,t)?Vv(0,e,t):Oo(o,e,t),Td=(o,e,t,n)=>dh(o,e.target)?Hv(o,e,t,n):Bv(o,e,t,n),Ed=(o,e,t,n)=>dh(o,e.target)?Uv(o,e,t,n):zv(o,e,t,n),gp=()=>({ml:new Mr({x:-.5,y:0,cursorStyleHandler:Da,actionHandler:Td,getActionName:kl}),mr:new Mr({x:.5,y:0,cursorStyleHandler:Da,actionHandler:Td,getActionName:kl}),mb:new Mr({x:0,y:.5,cursorStyleHandler:Da,actionHandler:Ed,getActionName:kl}),mt:new Mr({x:0,y:-.5,cursorStyleHandler:Da,actionHandler:Ed,getActionName:kl}),tl:new Mr({x:-.5,y:-.5,cursorStyleHandler:Oo,actionHandler:Cl}),tr:new Mr({x:.5,y:-.5,cursorStyleHandler:Oo,actionHandler:Cl}),bl:new Mr({x:-.5,y:.5,cursorStyleHandler:Oo,actionHandler:Cl}),br:new Mr({x:.5,y:.5,cursorStyleHandler:Oo,actionHandler:Cl}),mtr:new Mr({x:0,y:-.5,actionHandler:Rv,cursorStyleHandler:Dv,offsetY:-40,withConnection:!0,actionName:Qd})}),Xv=()=>({mr:new Mr({x:.5,y:0,actionHandler:kd,cursorStyleHandler:Da,actionName:Zl}),ml:new Mr({x:-.5,y:0,actionHandler:kd,cursorStyleHandler:Da,actionName:Zl})}),Gv=()=>me(me({},gp()),Xv());class No extends Zi{static getDefaults(){return me(me({},super.getDefaults()),No.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),No.ownDefaults),this.setOptions(e)}static createControls(){return{controls:gp()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,i=t.action;if(this===n&&i&&i.startsWith(ah))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let i=n.length-1;i>=0;i--){const[a,h]=n[i],p=this.controls[a];if(p.shouldActivate(a,this,e,t?h.touchCorner:h.corner))return this.__corner=a,{key:a,control:p,coord:this.oCoords[a]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=Uo(t.x,t.y),i=Ga({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),a=wn(n,i),h=wn(e,a),p=wn(h,[1/e[0],0,0,1/e[3],0,0]),m=this.group?Ba(this.calcTransformMatrix()):void 0;m&&(m.scaleX=Math.abs(m.scaleX),m.scaleY=Math.abs(m.scaleY));const _=this._calculateCurrentDimensions(m),b={};return this.forEachControl(((E,I)=>{const O=E.positionHandler(_,p,this,E);b[I]=Object.assign(O,this._calcCornerCoords(E,O))})),b}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),i=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/i[0],1/i[3]),e.rotate(En(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=me({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=i.borderColor,this._setLineDash(e,i.borderDashArray),this.strokeBorders(e,t),i.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:i}=this,a=me({hasBorders:n,hasControls:i},t),h=this.getViewportTransform(),p=a.hasBorders,m=a.hasControls,_=wn(h,this.calcTransformMatrix()),b=Ba(_);e.save(),e.translate(b.translateX,b.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(b.angle-=180),e.rotate(En(this.group?b.angle:this.angle)),p&&this.drawBorders(e,b,t),m&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let i;if(n&&n.forActiveSelection||this.group){const a=uh(this.width,this.height,ou(t)),h=this.isStrokeAccountedForInDimensions()?Jd:(this.strokeUniform?new Ce().scalarAdd(this.canvas?this.canvas.getZoom():1):new Ce(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);i=a.add(h).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else i=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,i,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl(((i,a)=>{i.withConnection&&i.getVisibility(this,a)&&(n=!0,e.moveTo(i.x*t.x,i.y*t.y),e.lineTo(i.x*t.x+i.offsetX,i.y*t.y+i.offsetY))})),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:i,cornerDashArray:a,cornerColor:h}=this,p=me({cornerStrokeColor:i,cornerDashArray:a,cornerColor:h},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=p.cornerColor,this.transparentCorners||(e.strokeStyle=p.cornerStrokeColor),this._setLineDash(e,p.cornerDashArray),this.forEachControl(((m,_)=>{if(m.getVisibility(this,_)){const b=this.oCoords[_];m.render(e,b.x,b.y,p,this)}})),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach((t=>{let[n,i]=t;return this.setControlVisible(n,i)}))}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const i=this.width+4,a=this.height+4;return t.clearRect(-i/2,-a/2,i,a),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function Yv(o,e){return e.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((n=>{n!=="constructor"&&Object.defineProperty(o.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}))})),o}de(No,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class Zn extends No{}Yv(Zn,[Sv]),ct.setClass(Zn),ct.setClass(Zn,"object");const qv=(o,e,t,n)=>{const i=2*(n=Math.round(n))+1,{data:a}=o.getImageData(e-n,t-n,i,i);for(let h=3;h<a.length;h+=4)if(a[h]>0)return!1;return!0};class Kv{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new Ce(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new Ce(1/this.options.scaleX,1/this.options.scaleY):new Ce(1,1)}createSideVector(e,t){const n=Yc(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new Ce(e);return t.y+=t.x*Math.tan(En(this.options.skewY)),t.x+=t.y*Math.tan(En(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const fw=new Ce;class Io extends Kv{static getOrthogonalRotationFactor(e,t){const n=t?Kc(e,t):Pv(e);return Math.abs(n)<ra?-1:1}constructor(e,t,n,i){super(i),de(this,"AB",void 0),de(this,"AC",void 0),de(this,"alpha",void 0),de(this,"bisector",void 0),this.A=new Ce(e),this.B=new Ce(t),this.C=new Ce(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=Kc(this.AB,this.AC),this.bisector=fh(cp(this.AB.eq(fw)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(e,t),a=hp(i),h=Io.getOrthogonalRotationFactor(a,this.bisector);return this.scaleUnitVector(a,n*h)}projectBevel(){const e=[];return(this.alpha%ks==0?[this.B]:[this.B,this.C]).forEach((t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))})),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),i=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),a=this.options.strokeUniform?qc(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return qc(i)/this.strokeProjectionMagnitude<=a&&e.push(this.applySkew(this.A.add(i))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],i=new Ce(Io.getOrthogonalRotationFactor(this.bisector),Io.getOrthogonalRotationFactor(new Ce(this.bisector.y,this.bisector.x)));return[new Ce(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i),new Ce(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(i)].forEach((a=>{Sd(a,e,t)&&n.push(this.A.add(a))})),n}projectRoundWithSkew(e,t){const n=[],{skewX:i,skewY:a,scaleX:h,scaleY:p,strokeUniform:m}=this.options,_=new Ce(Math.tan(En(i)),Math.tan(En(a))),b=this.strokeProjectionMagnitude,E=m?b/p/Math.sqrt(1/p**2+1/h**2*_.y**2):b/Math.sqrt(1+_.y**2),I=new Ce(Math.sqrt(Math.max(b**2-E**2,0)),E),O=m?b/Math.sqrt(1+_.x**2*(1/p)**2/(1/h+1/h*_.x*_.y)**2):b/Math.sqrt(1+_.x**2/(1+_.x*_.y)**2),Q=new Ce(O,Math.sqrt(Math.max(b**2-O**2,0)));return[Q,Q.scalarMultiply(-1),I,I.scalarMultiply(-1)].map((W=>this.applySkew(m?W.multiply(this.strokeUniformScalar):W))).forEach((W=>{Sd(W,e,t)&&n.push(this.applySkew(this.A).add(W))})),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%ks==0,n=this.applySkew(this.A),i=e[t?0:2].subtract(n),a=e[t?1:0].subtract(n),h=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),p=jo(i,h)>0,m=p?i:a,_=p?a:i;return this.isSkewed()?e.push(...this.projectRoundWithSkew(m,_)):e.push(...this.projectRoundNoSkew(m,_)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector})))}}class J0 extends Kv{constructor(e,t,n){super(n),this.A=new Ce(e),this.T=new Ce(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const i=this.createSideVector(e,t);return this.scaleUnitVector(hp(i),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new Ce(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Io(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new Ce(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(fh(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),i=this.A.add(n);e.push(i.add(t),i.subtract(t))}return e.map((t=>this.applySkew(t)))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map((e=>({originPoint:this.A,projectedPoint:e})))}}const Zv=function(o,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(o.length===0)return n;const i=o.reduce(((a,h)=>(a[a.length-1].eq(h)||a.push(new Ce(h)),a)),[new Ce(o[0])]);if(i.length===1)t=!0;else if(!t){const a=i[0],h=((p,m)=>{for(let _=p.length-1;_>=0;_--)if(m(p[_],_,p))return _;return-1})(i,(p=>!p.eq(a)));i.splice(h+1)}return i.forEach(((a,h,p)=>{let m,_;h===0?(_=p[1],m=t?a:p[p.length-1]):h===p.length-1?(m=p[h-1],_=t?a:p[0]):(m=p[h-1],_=p[h+1]),t&&p.length===1?n.push(...new J0(a,a,e).project()):!t||h!==0&&h!==p.length-1?n.push(...new Io(a,m,_,e).project()):n.push(...new J0(a,h===0?_:m,e).project())})),n},mp=o=>{const e={};return Object.keys(o).forEach((t=>{e[t]={},Object.keys(o[t]).forEach((n=>{e[t][n]=me({},o[t][n])}))})),e},Qv=o=>o.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let xl;const ph=o=>{if(xl||xl||(xl="Intl"in Oi()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),xl){const e=xl.segment(o);return Array.from(e).map((t=>{let{segment:n}=t;return n}))}return dw(o)},dw=o=>{const e=[];for(let t,n=0;n<o.length;n++)(t=pw(o,n))!==!1&&e.push(t);return e},pw=(o,e)=>{const t=o.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return o.charAt(e);if(55296<=t&&t<=56319){if(o.length<=e+1)throw"High surrogate without following low surrogate";const i=o.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return o.charAt(e)+o.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=o.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1};var gw=Object.freeze({__proto__:null,capitalize:function(o){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(o.charAt(0).toUpperCase()).concat(e?o.slice(1):o.slice(1).toLowerCase())},escapeXml:Qv,graphemeSplit:ph});const gh=function(o,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return o.fill!==e.fill||o.stroke!==e.stroke||o.strokeWidth!==e.strokeWidth||o.fontSize!==e.fontSize||o.fontFamily!==e.fontFamily||o.fontWeight!==e.fontWeight||o.fontStyle!==e.fontStyle||o.textDecorationThickness!==e.textDecorationThickness||o.textBackgroundColor!==e.textBackgroundColor||o.deltaY!==e.deltaY||t&&(o.overline!==e.overline||o.underline!==e.underline||o.linethrough!==e.linethrough)},Jv=(o,e)=>{const t=e.split(`
`),n=[];let i=-1,a={};o=mp(o);for(let h=0;h<t.length;h++){const p=ph(t[h]);if(o[h])for(let m=0;m<p.length;m++){i++;const _=o[h][m];_&&Object.keys(_).length>0&&(gh(a,_,!0)?n.push({start:i,end:i+1,style:_}):n[n.length-1].end++),a=_||{}}else i+=p.length,a={}}return n},$v=(o,e)=>{if(!Array.isArray(o))return mp(o);const t=e.split(Zd),n={};let i=-1,a=0;for(let h=0;h<t.length;h++){const p=ph(t[h]);for(let m=0;m<p.length;m++)i++,o[a]&&o[a].start<=i&&i<o[a].end&&(n[h]=n[h]||{},n[h][m]=me({},o[a].style),i===o[a].end-1&&a++)}return n},oa=["display","transform",Rn,"fill-opacity","fill-rule","opacity",xr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function $0(o,e){const t=o.nodeName,n=o.getAttribute("class"),i=o.getAttribute("id"),a="(?![a-zA-Z\\-]+)";let h;if(h=new RegExp("^"+t,"i"),e=e.replace(h,""),i&&e.length&&(h=new RegExp("#"+i+a,"i"),e=e.replace(h,"")),n&&e.length){const p=n.split(" ");for(let m=p.length;m--;)h=new RegExp("\\."+p[m]+a,"i"),e=e.replace(h,"")}return e.length===0}function mw(o,e){let t=!0;const n=$0(o,e.pop());return n&&e.length&&(t=(function(i,a){let h,p=!0;for(;i.parentElement&&i.parentElement.nodeType===1&&a.length;)p&&(h=a.pop()),p=$0(i=i.parentElement,h);return a.length===0})(o,e)),n&&t&&e.length===0}const vw=o=>{var e;return(e=Xx[o])!==null&&e!==void 0?e:o},yw=new RegExp("(".concat(Pi,")"),"gi"),_w=o=>Xc(o.replace(yw," $1 ").replace(/,/gi," "));var em,tm,nm,rm,im,sm,am;const vr="(".concat(Pi,")"),xw=String.raw(em||(em=ss(["(skewX)(",")"],["(skewX)\\(","\\)"])),vr),ww=String.raw(tm||(tm=ss(["(skewY)(",")"],["(skewY)\\(","\\)"])),vr),bw=String.raw(nm||(nm=ss(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),vr,vr,vr),Sw=String.raw(rm||(rm=ss(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),vr,vr),Cw=String.raw(im||(im=ss(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),vr,vr),kw=String.raw(sm||(sm=ss(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),vr,vr,vr,vr,vr,vr),vp="(?:".concat(kw,"|").concat(Cw,"|").concat(bw,"|").concat(Sw,"|").concat(xw,"|").concat(ww,")"),Tw="(?:".concat(vp,"*)"),Ew=String.raw(am||(am=ss(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),Tw),Ow=new RegExp(Ew),Pw=new RegExp(vp),Aw=new RegExp(vp,"g");function $l(o){const e=[];if(!(o=_w(o).replace(/\s*([()])\s*/gi,"$1"))||o&&!Ow.test(o))return[...hr];for(const t of o.matchAll(Aw)){const n=Pw.exec(t[0]);if(!n)continue;let i=hr;const a=n.filter((Q=>!!Q)),[,h,...p]=a,[m,_,b,E,I,O]=p.map((Q=>parseFloat(Q)));switch(h){case"translate":i=Uo(m,_);break;case Qd:i=Ga({angle:m},{x:_,y:b});break;case ah:i=lh(m,_);break;case Vo:i=np(m);break;case Wo:i=rp(m);break;case"matrix":i=[m,_,b,E,I,O]}e.push(i)}return oh(e)}function Mw(o,e,t,n){const i=Array.isArray(e);let a,h=e;if(o!==Rn&&o!==xr||e!==_r){if(o==="strokeUniform")return e==="non-scaling-stroke";if(o==="strokeDashArray")h=e===_r?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(o==="transformMatrix")h=t&&t.transformMatrix?wn(t.transformMatrix,$l(e)):$l(e);else if(o==="visible")h=e!==_r&&e!=="hidden",t&&t.visible===!1&&(h=!1);else if(o==="opacity")h=parseFloat(e),t&&t.opacity!==void 0&&(h*=t.opacity);else if(o==="textAnchor")h=e==="start"?nn:e==="end"?Mn:Rt;else if(o==="charSpacing"||o===za)a=mr(e,n)/n*1e3;else if(o==="paintFirst"){const p=e.indexOf(Rn),m=e.indexOf(xr);h=Rn,(p>-1&&m>-1&&m<p||p===-1&&m>-1)&&(h=xr)}else{if(o==="href"||o==="xlink:href"||o==="font"||o==="id")return e;if(o==="imageSmoothing")return e==="optimizeQuality";a=i?e.map(mr):mr(e,n)}}else h="";return!i&&isNaN(a)?h:a}function ey(o,e){const t=o.match(Hx);if(!t)return;const n=t[1],i=t[3],a=t[4],h=t[5],p=t[6];n&&(e.fontStyle=n),i&&(e.fontWeight=isNaN(parseFloat(i))?i:parseFloat(i)),a&&(e.fontSize=mr(a)),p&&(e.fontFamily=p),h&&(e.lineHeight=h==="normal"?1:h)}function Od(o,e){o.replace(/;\s*$/,"").split(";").forEach((t=>{if(!t)return;const[n,i]=t.split(":");e[n.trim().toLowerCase()]=i.trim()}))}function ty(o){const e={},t=o.getAttribute("style");return t&&(typeof t=="string"?Od(t,e):(function(n,i){Object.entries(n).forEach((a=>{let[h,p]=a;p!==void 0&&(i[h.toLowerCase()]=p)}))})(t,e)),e}const jw={stroke:"strokeOpacity",fill:"fillOpacity"};function as(o,e,t){if(!o)return{};let n,i={},a=Kd;o.parentNode&&G0.test(o.parentNode.nodeName)&&(i=as(o.parentElement,e,t),i.fontSize&&(n=a=mr(i.fontSize)));const h=me(me(me({},e.reduce(((_,b)=>{const E=o.getAttribute(b);return E&&(_[b]=E),_}),{})),(function(_){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={};for(const I in b)mw(_,I.split(" "))&&(E=me(me({},E),b[I]));return E})(o,t)),ty(o));h[ad]&&o.setAttribute(ad,h[ad]),h[sd]&&(n=mr(h[sd],a),h[sd]="".concat(n));const p={};for(const _ in h){const b=vw(_),E=Mw(b,h[_],i,n);p[b]=E}p&&p.font&&ey(p.font,p);const m=me(me({},i),p);return G0.test(o.nodeName)?m:(function(_){const b=Zn.getDefaults();return Object.entries(jw).forEach((E=>{let[I,O]=E;if(_[O]===void 0||_[I]==="")return;if(_[I]===void 0){if(!b[I])return;_[I]=b[I]}if(_[I].indexOf("url(")===0)return;const Q=new $t(_[I]);_[I]=Q.setAlpha(on(Q.getAlpha()*_[O],2)).toRgba()})),_})(m)}const Iw=["left","top","width","height","visible"],ny=["rx","ry"];class yr extends Zn{static getDefaults(){return me(me({},super.getDefaults()),yr.ownDefaults)}constructor(e){super(),Object.assign(this,yr.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,i=-t/2,a=-n/2,h=this.rx?Math.min(this.rx,t/2):0,p=this.ry?Math.min(this.ry,n/2):0,m=h!==0||p!==0;e.beginPath(),e.moveTo(i+h,a),e.lineTo(i+t-h,a),m&&e.bezierCurveTo(i+t-ea*h,a,i+t,a+ea*p,i+t,a+p),e.lineTo(i+t,a+n-p),m&&e.bezierCurveTo(i+t,a+n-ea*p,i+t-ea*h,a+n,i+t-h,a+n),e.lineTo(i+h,a+n),m&&e.bezierCurveTo(i+ea*h,a+n,i,a+n-ea*p,i,a+n-p),e.lineTo(i,a+p),m&&e.bezierCurveTo(i,a+ea*p,i+ea*h,a,i+h,a),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...ny,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:i}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(i,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const i=as(e,this.ATTRIBUTE_NAMES,n),{left:a=0,top:h=0,width:p=0,height:m=0,visible:_=!0}=i,b=dn(i,Iw);return new this(me(me(me({},t),b),{},{left:a,top:h,width:p,height:m,visible:!!(_&&p&&m)}))}}de(yr,"type","Rect"),de(yr,"cacheProperties",[...Es,...ny]),de(yr,"ownDefaults",{rx:0,ry:0}),de(yr,"ATTRIBUTE_NAMES",[...oa,"x","y","rx","ry","width","height"]),ct.setClass(yr),ct.setSVGClass(yr);const xs="initialization",Zc="added",yp="removed",Qc="imperative",ry=(o,e)=>{const{strokeUniform:t,strokeWidth:n,width:i,height:a,group:h}=e,p=h&&h!==o?uu(h.calcTransformMatrix(),o.calcTransformMatrix()):null,m=p?e.getRelativeCenterPoint().transform(p):e.getRelativeCenterPoint(),_=!e.isStrokeAccountedForInDimensions(),b=t&&_?_v(new Ce(n,n),void 0,o.calcTransformMatrix()):Jd,E=!t&&_?n:0,I=uh(i+E,a+E,oh([p,e.calcOwnMatrix()],!0)).add(b).scalarDivide(2);return[m.subtract(I),m.add(I)]};class cu{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:i}=e;return t===xs||t===Qc||!!n&&i!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==xs&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:i}=t;if(n===Qc&&t.overrides)return t.overrides;if(e.length===0)return;const{left:a,top:h,width:p,height:m}=rs(e.map((E=>ry(i,E))).reduce(((E,I)=>E.concat(I)),[])),_=new Ce(p,m),b=new Ce(a,h).add(_.scalarDivide(2));if(n===xs){const E=this.getInitialSize(t,{size:_,center:b});return{center:b,relativeCorrection:new Ce(0,0),size:E}}return{center:b.transform(i.calcOwnMatrix()),size:_}}}de(cu,"type","strategy");class Jc extends cu{shouldPerformLayout(e){return!0}}de(Jc,"type","fit-content"),ct.setClass(Jc);const Lw=["strategy"],Dw=["target","strategy","bubbles","prevStrategy"],iy="layoutManager";class Fo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Jc;de(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=me(me({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[Wc,tv,Zl,nv,sh,rv,Vc,iv,Dx].map((i=>e.on(i,(a=>this.performLayout(i===Wc?{type:"object_modified",trigger:i,e:a,target:n}:{type:"object_modifying",trigger:i,e:a,target:n})))))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach((n=>n())),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach((t=>this.unsubscribe(t,e)))}subscribeTargets(e){e.targets.forEach((t=>this.subscribe(t,e)))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:i}=t;if(n===xs||n===Zc?this.subscribeTargets(e):n===yp&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),i&&i.fire("object:layout:before",{target:t,context:e}),n===Qc&&e.deep){const a=dn(e,Lw);t.forEachObject((h=>h.layoutManager&&h.layoutManager.performLayout(me(me({},a),{},{bubbles:!1,target:h}))))}}getLayoutResult(e){const{target:t,strategy:n,type:i}=e,a=n.calcLayoutResult(e,t.getObjects());if(!a)return;const h=i===xs?new Ce:t.getRelativeCenterPoint(),{center:p,correction:m=new Ce,relativeCorrection:_=new Ce}=a,b=h.subtract(p).add(m).transform(i===xs?hr:Ir(t.calcOwnMatrix()),!0).add(_);return{result:a,prevCenter:h,nextCenter:p,offset:b}}commitLayout(e,t){const{target:n}=e,{result:{size:i},nextCenter:a}=t;var h,p;n.set({width:i.x,height:i.y}),this.layoutObjects(e,t),e.type===xs?n.set({left:(h=e.x)!==null&&h!==void 0?h:a.x+i.x*Dn(n.originX),top:(p=e.y)!==null&&p!==void 0?p:a.y+i.y*Dn(n.originY)}):(n.setPositionByOrigin(a,Rt,Rt),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject((i=>{i.group===n&&this.layoutObject(e,t,i)})),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:i}=t;n.set({left:n.left+i.x,top:n.top+i.y})}onAfterLayout(e,t){const{target:n,strategy:i,bubbles:a,prevStrategy:h}=e,p=dn(e,Dw),{canvas:m}=n;n.fire("layout:after",{context:e,result:t}),m&&m.fire("object:layout:after",{context:e,result:t,target:n});const _=n.parent;a&&_!=null&&_.layoutManager&&((p.path||(p.path=[])).push(n),_.layoutManager.performLayout(me(me({},p),{},{target:_}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach((t=>t.forEach((n=>n())))),e.clear()}toObject(){return{type:iy,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}ct.setClass(Fo,iy);const Rw=["type","objects","layoutManager"];class Nw extends Fo{performLayout(){}}class er extends $d(Zn){static getDefaults(){return me(me({},super.getDefaults()),er.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),de(this,"_activeObjects",[]),de(this,"__objectSelectionTracker",void 0),de(this,"__objectSelectionDisposer",void 0),Object.assign(this,er.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject((i=>{this.enterGroup(i,!1)})),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new Fo,this.layoutManager.performLayout({type:xs,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Cs("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Cs("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter(((t,n,i)=>this.canEnterGroup(t)&&i.indexOf(t)===n))}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=this._filterObjectsBeforeEnteringGroup(t),a=super.add(...i);return this._onAfterObjectsChange(Zc,i),a}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];const a=this._filterObjectsBeforeEnteringGroup(n),h=super.insertAt(e,...a);return this._onAfterObjectsChange(Zc,a),h}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(yp,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach((i=>{i._set(e,t)})),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const i=this._activeObjects;if(e)i.push(n),this._set("dirty",!0);else if(i.length>0){const a=i.indexOf(n);a>-1&&(i.splice(a,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&Ro(e,wn(Ir(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(Ro(e,wn(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=Zn.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let a=0;a<this._objects.length;a++){var i;const h=this._objects[a];(i=this.canvas)!==null&&i!==void 0&&i.preserveObjectStacking&&h.group!==this?(e.save(),e.transform(...Ir(this.calcTransformMatrix())),h.render(e),e.restore()):h.group===this&&h.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject((e=>e.setCoords()))}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(me({target:this,type:Qc},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter((function(i){return!i.excludeFromExport})).map((function(i){const a=i.includeDefaultValues;i.includeDefaultValues=n;const h=i[e||"toObject"](t);return i.includeDefaultValues=a,h}))}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return me(me(me({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject((e=>{this._watchObject(!1,e),e.dispose()})),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=yr.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const i=t.join("");return e?e(i):i}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let i=0;i<this._objects.length;i++)t.push("		",this._objects[i].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let i=0;i<this._objects.length;i++)t.push("	",this._objects[i].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:i=[],layoutManager:a}=e,h=dn(e,Rw);return Promise.all([Lo(i,t),lu(h,t)]).then((p=>{let[m,_]=p;const b=new this(m,me(me(me({},h),_),{},{layoutManager:new Nw}));if(a){const E=ct.getClass(a.type),I=ct.getClass(a.strategy);b.layoutManager=new E(new I)}else b.layoutManager=new Fo;return b.layoutManager.subscribeTargets({type:xs,target:b,targets:b.getObjects()}),b.setCoords(),b}))}}de(er,"type","Group"),de(er,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),ct.setClass(er);const sy=(o,e)=>Math.min(e.width/o.width,e.height/o.height),ay=(o,e)=>Math.max(e.width/o.width,e.height/o.height),Pd="\\s*,?\\s*",wl="".concat(Pd,"(").concat(Pi,")"),Fw="".concat(wl).concat(wl).concat(wl).concat(Pd,"([01])").concat(Pd,"([01])").concat(wl).concat(wl),Bw={m:"l",M:"L"},zw=(o,e,t,n,i,a,h,p,m,_,b)=>{const E=Ii(o),I=Li(o),O=Ii(e),Q=Li(e),W=t*i*O-n*a*Q+h,ee=n*i*O+t*a*Q+p;return["C",_+m*(-t*i*I-n*a*E),b+m*(-n*i*I+t*a*E),W+m*(t*i*Q+n*a*O),ee+m*(n*i*Q-t*a*O),W,ee]},om=(o,e,t,n)=>{const i=Math.atan2(e,o),a=Math.atan2(n,t);return a>=i?a-i:2*Math.PI-(i-a)};function Ad(o,e,t,n,i,a,h,p){let m;if(Yt.cachesBoundsOfCurve&&(m=[...arguments].join(),Mo.boundsOfCurveCache[m]))return Mo.boundsOfCurveCache[m];const _=Math.sqrt,b=Math.abs,E=[],I=[[0,0],[0,0]];let O=6*o-12*t+6*i,Q=-3*o+9*t-9*i+3*h,W=3*t-3*o;for(let ge=0;ge<2;++ge){if(ge>0&&(O=6*e-12*n+6*a,Q=-3*e+9*n-9*a+3*p,W=3*n-3*e),b(Q)<1e-12){if(b(O)<1e-12)continue;const qe=-W/O;0<qe&&qe<1&&E.push(qe);continue}const xe=O*O-4*W*Q;if(xe<0)continue;const F=_(xe),Ne=(-O+F)/(2*Q);0<Ne&&Ne<1&&E.push(Ne);const Ve=(-O-F)/(2*Q);0<Ve&&Ve<1&&E.push(Ve)}let ee=E.length;const K=ee,ae=ly(o,e,t,n,i,a,h,p);for(;ee--;){const{x:ge,y:xe}=ae(E[ee]);I[0][ee]=ge,I[1][ee]=xe}I[0][K]=o,I[1][K]=e,I[0][K+1]=h,I[1][K+1]=p;const le=[new Ce(Math.min(...I[0]),Math.min(...I[1])),new Ce(Math.max(...I[0]),Math.max(...I[1]))];return Yt.cachesBoundsOfCurve&&(Mo.boundsOfCurveCache[m]=le),le}const Vw=(o,e,t)=>{let[n,i,a,h,p,m,_,b]=t;const E=((I,O,Q,W,ee,K,ae)=>{if(Q===0||W===0)return[];let le=0,ge=0,xe=0;const F=Math.PI,Ne=ae*qd,Ve=Li(Ne),qe=Ii(Ne),ot=.5*(-qe*I-Ve*O),je=.5*(-qe*O+Ve*I),Ze=Q**2,dt=W**2,We=je**2,Bt=ot**2,Le=Ze*dt-Ze*We-dt*Bt;let wt=Math.abs(Q),ze=Math.abs(W);if(Le<0){const At=Math.sqrt(1-Le/(Ze*dt));wt*=At,ze*=At}else xe=(ee===K?-1:1)*Math.sqrt(Le/(Ze*We+dt*Bt));const Xe=xe*wt*je/ze,Qe=-xe*ze*ot/wt,be=qe*Xe-Ve*Qe+.5*I,Fe=Ve*Xe+qe*Qe+.5*O;let yt=om(1,0,(ot-Xe)/wt,(je-Qe)/ze),Ct=om((ot-Xe)/wt,(je-Qe)/ze,(-ot-Xe)/wt,(-je-Qe)/ze);K===0&&Ct>0?Ct-=2*F:K===1&&Ct<0&&(Ct+=2*F);const pt=Math.ceil(Math.abs(Ct/F*2)),Mt=[],zt=Ct/pt,Ut=8/3*Math.sin(zt/4)*Math.sin(zt/4)/Math.sin(zt/2);let _t=yt+zt;for(let At=0;At<pt;At++)Mt[At]=zw(yt,_t,qe,Ve,wt,ze,be,Fe,Ut,le,ge),le=Mt[At][5],ge=Mt[At][6],yt=_t,_t+=zt;return Mt})(_-o,b-e,i,a,p,m,h);for(let I=0,O=E.length;I<O;I++)E[I][1]+=o,E[I][2]+=e,E[I][3]+=o,E[I][4]+=e,E[I][5]+=o,E[I][6]+=e;return E},oy=o=>{let e=0,t=0,n=0,i=0;const a=[];let h,p=0,m=0;for(const _ of o){const b=[..._];let E;switch(b[0]){case"l":b[1]+=e,b[2]+=t;case"L":e=b[1],t=b[2],E=["L",e,t];break;case"h":b[1]+=e;case"H":e=b[1],E=["L",e,t];break;case"v":b[1]+=t;case"V":t=b[1],E=["L",e,t];break;case"m":b[1]+=e,b[2]+=t;case"M":e=b[1],t=b[2],n=b[1],i=b[2],E=["M",e,t];break;case"c":b[1]+=e,b[2]+=t,b[3]+=e,b[4]+=t,b[5]+=e,b[6]+=t;case"C":p=b[3],m=b[4],e=b[5],t=b[6],E=["C",b[1],b[2],p,m,e,t];break;case"s":b[1]+=e,b[2]+=t,b[3]+=e,b[4]+=t;case"S":h==="C"?(p=2*e-p,m=2*t-m):(p=e,m=t),e=b[3],t=b[4],E=["C",p,m,b[1],b[2],e,t],p=E[3],m=E[4];break;case"q":b[1]+=e,b[2]+=t,b[3]+=e,b[4]+=t;case"Q":p=b[1],m=b[2],e=b[3],t=b[4],E=["Q",p,m,e,t];break;case"t":b[1]+=e,b[2]+=t;case"T":h==="Q"?(p=2*e-p,m=2*t-m):(p=e,m=t),e=b[1],t=b[2],E=["Q",p,m,e,t];break;case"a":b[6]+=e,b[7]+=t;case"A":Vw(e,t,b).forEach((I=>a.push(I))),e=b[6],t=b[7];break;case"z":case"Z":e=n,t=i,E=["Z"]}E?(a.push(E),h=E[0]):h=""}return a},$c=(o,e,t,n)=>Math.sqrt((t-o)**2+(n-e)**2),ly=(o,e,t,n,i,a,h,p)=>m=>{const _=m**3,b=(O=>3*O**2*(1-O))(m),E=(O=>3*O*(1-O)**2)(m),I=(O=>(1-O)**3)(m);return new Ce(h*_+i*b+t*E+o*I,p*_+a*b+n*E+e*I)},uy=o=>o**2,cy=o=>2*o*(1-o),hy=o=>(1-o)**2,Ww=(o,e,t,n,i,a,h,p)=>m=>{const _=uy(m),b=cy(m),E=hy(m),I=3*(E*(t-o)+b*(i-t)+_*(h-i)),O=3*(E*(n-e)+b*(a-n)+_*(p-a));return Math.atan2(O,I)},Uw=(o,e,t,n,i,a)=>h=>{const p=uy(h),m=cy(h),_=hy(h);return new Ce(i*p+t*m+o*_,a*p+n*m+e*_)},Hw=(o,e,t,n,i,a)=>h=>{const p=1-h,m=2*(p*(t-o)+h*(i-t)),_=2*(p*(n-e)+h*(a-n));return Math.atan2(_,m)},lm=(o,e,t)=>{let n=new Ce(e,t),i=0;for(let a=1;a<=100;a+=1){const h=o(a/100);i+=$c(n.x,n.y,h.x,h.y),n=h}return i},Xw=(o,e)=>{let t,n=0,i=0,a={x:o.x,y:o.y},h=me({},a),p=.01,m=0;const _=o.iterator,b=o.angleFinder;for(;i<e&&p>1e-4;)h=_(n),m=n,t=$c(a.x,a.y,h.x,h.y),t+i>e?(n-=p,p/=2):(a=h,n+=p,i+=t);return me(me({},h),{},{angle:b(m)})},_p=o=>{let e,t,n=0,i=0,a=0,h=0,p=0;const m=[];for(const _ of o){const b={x:i,y:a,command:_[0],length:0};switch(_[0]){case"M":t=b,t.x=h=i=_[1],t.y=p=a=_[2];break;case"L":t=b,t.length=$c(i,a,_[1],_[2]),i=_[1],a=_[2];break;case"C":e=ly(i,a,_[1],_[2],_[3],_[4],_[5],_[6]),t=b,t.iterator=e,t.angleFinder=Ww(i,a,_[1],_[2],_[3],_[4],_[5],_[6]),t.length=lm(e,i,a),i=_[5],a=_[6];break;case"Q":e=Uw(i,a,_[1],_[2],_[3],_[4]),t=b,t.iterator=e,t.angleFinder=Hw(i,a,_[1],_[2],_[3],_[4]),t.length=lm(e,i,a),i=_[3],a=_[4];break;case"Z":t=b,t.destX=h,t.destY=p,t.length=$c(i,a,h,p),i=h,a=p}n+=t.length,m.push(t)}return m.push({length:n,x:i,y:a}),m},fy=function(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_p(o),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const i=t[n],a=e/i.length,h=o[n];switch(i.command){case"M":return{x:i.x,y:i.y,angle:0};case"Z":return me(me({},new Ce(i.x,i.y).lerp(new Ce(i.destX,i.destY),a)),{},{angle:Math.atan2(i.destY-i.y,i.destX-i.x)});case"L":return me(me({},new Ce(i.x,i.y).lerp(new Ce(h[1],h[2]),a)),{},{angle:Math.atan2(h[2]-i.y,h[1]-i.x)});case"C":case"Q":return Xw(i,e)}},Gw=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),um=new RegExp(Fw,"g"),Yw=new RegExp(Pi,"gi"),qw={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},dy=o=>{var e;const t=[],n=(e=o.match(Gw))!==null&&e!==void 0?e:[];for(const i of n){const a=i[0];if(a==="z"||a==="Z"){t.push([a]);continue}const h=qw[a.toLowerCase()];let p=[];if(a==="a"||a==="A"){um.lastIndex=0;for(let m=null;m=um.exec(i);)p.push(...m.slice(1))}else p=i.match(Yw)||[];for(let m=0;m<p.length;m+=h){const _=new Array(h),b=Bw[a];_[0]=m>0&&b?b:a;for(let E=0;E<h;E++)_[E+1]=parseFloat(p[m+E]);t.push(_)}}return t},py=function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new Ce(o[0]),n=new Ce(o[1]),i=1,a=0;const h=[],p=o.length,m=p>2;let _;for(m&&(i=o[2].x<n.x?-1:o[2].x===n.x?0:1,a=o[2].y<n.y?-1:o[2].y===n.y?0:1),h.push(["M",t.x-i*e,t.y-a*e]),_=1;_<p;_++){if(!t.eq(n)){const b=t.midPointFrom(n);h.push(["Q",t.x,t.y,b.x,b.y])}t=o[_],_+1<o.length&&(n=o[_+1])}return m&&(i=t.x>o[_-2].x?1:t.x===o[_-2].x?0:-1,a=t.y>o[_-2].y?1:t.y===o[_-2].y?0:-1),h.push(["L",t.x+i*e,t.y+a*e]),h},xp=(o,e)=>o.map((t=>t.map(((n,i)=>i===0||e===void 0?n:on(n,e))).join(" "))).join(" ");function eh(o,e){const t=o.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach((n=>{let[i,a]=n;return t.setProperty(i,a)})))}const Ra=(o,e)=>Math.floor(Math.random()*(e-o+1))+o;function gy(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=e.onComplete||Fa,n=new(Oi()).XMLHttpRequest,i=e.signal,a=function(){n.abort()},h=function(){i&&i.removeEventListener("abort",a),n.onerror=n.ontimeout=Fa};if(i&&i.aborted)throw new Yd("request");return i&&i.addEventListener("abort",a,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(h(),t(n),n.onreadystatechange=Fa)},n.onerror=n.ontimeout=h,n.open("get",o,!0),n.send(),n}const Lc=(o,e)=>{let t=o._findCenterFromElement();o.transformMatrix&&((n=>{if(n.transformMatrix){const{scaleX:i,scaleY:a,angle:h,skewX:p}=Ba(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set(br,i),n.set(Yr,a),n.angle=h,n.skewX=p,n.skewY=0}})(o),t=t.transform(o.transformMatrix)),delete o.transformMatrix,e&&(o.scaleX*=e.scaleX,o.scaleY*=e.scaleY,o.cropX=e.cropX,o.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,o.width=e.width,o.height=e.height),o.setPositionByOrigin(t,Rt,Rt)};var Md=Object.freeze({__proto__:null,addTransformToObject:vv,animate:dp,animateColor:jv,applyTransformToObject:Ro,calcAngleBetweenVectors:Kc,calcDimensionsMatrix:ou,calcPlaneChangeMatrix:uu,calcVectorRotation:Pv,cancelAnimFrame:ov,capValue:Va,composeMatrix:fv,copyCanvasElement:o=>{var e;const t=Dr(o);return(e=t.getContext("2d"))===null||e===void 0||e.drawImage(o,0,0),t},cos:Ii,createCanvasElement:hi,createImage:lv,createRotateMatrix:Ga,createScaleMatrix:lh,createSkewXMatrix:np,createSkewYMatrix:rp,createTranslateMatrix:Uo,createVector:Yc,crossProduct:jo,degreesToRadians:En,dotProduct:Av,ease:Qx,enlivenObjectEnlivables:lu,enlivenObjects:Lo,findScaleToCover:ay,findScaleToFit:sy,getBoundsOfCurve:Ad,getOrthonormalVector:hp,getPathSegmentsInfo:_p,getPointOnPath:fy,getPointer:mv,getRandomInt:Ra,getRegularPolygonPath:(o,e)=>{const t=2*Math.PI/o;let n=-ra;o%2==0&&(n+=t/2);const i=new Array(o+1);for(let a=0;a<o;a++){const h=a*t+n,{x:p,y:m}=new Ce(Ii(h),Li(h)).scalarMultiply(e);i[a]=[a===0?"M":"L",p,m]}return i[o]=["Z"],i},getSmoothPathFromPoints:py,getSvgAttributes:o=>{const e=["instantiated_by_use","style","id","class"];switch(o){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:fh,groupSVGElements:(o,e)=>o&&o.length===1?o[0]:new er(o,e),hasStyleChanged:gh,invertTransform:Ir,isBetweenVectors:Sd,isIdentityMatrix:uv,isTouchEvent:Uc,isTransparent:qv,joinPath:xp,loadImage:Hl,magnitude:qc,makeBoundingBoxFromPoints:rs,makePathSimpler:oy,matrixToSVG:Do,mergeClipPaths:(o,e)=>{var t;let n=o,i=e;n.inverted&&!i.inverted&&(n=e,i=o),wd(i,(t=i.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());const a=n.inverted&&i.inverted;return a&&(n.inverted=i.inverted=!1),new er([n],{clipPath:i,inverted:a})},multiplyTransformMatrices:wn,multiplyTransformMatrixArray:oh,parsePath:dy,parsePreserveAspectRatioAttribute:up,parseUnit:mr,pick:Ya,projectStrokeOnPoints:Zv,qrDecompose:Ba,radiansToDegrees:is,removeFromArray:Ia,removeTransformFromObject:(o,e)=>{const t=Ir(e),n=wn(t,o.calcOwnMatrix());Ro(o,n)},removeTransformMatrixForSvgParsing:Lc,request:gy,requestAnimFrame:Ul,resetObjectTransform:yv,rotatePoint:(o,e,t)=>o.rotate(t,e),rotateVector:cp,saveObjectTransform:ap,sendObjectToPlane:wd,sendPointToPlane:bs,sendVectorToPlane:_v,setStyle:eh,sin:Li,sizeAfterTransform:uh,string:gw,stylesFromArray:$v,stylesToArray:Jv,toBlob:tp,toDataURL:ep,toFixed:on,transformPath:(o,e,t)=>(t&&(e=wn(e,[1,0,0,1,-t.x,-t.y])),o.map((n=>{const i=[...n];for(let a=1;a<n.length-1;a+=2){const{x:h,y:p}=ur({x:n[a],y:n[a+1]},e);i[a]=h,i[a+1]=p}return i}))),transformPoint:ur});class my extends sp{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),de(this,"upper",void 0),de(this,"container",void 0);const{el:i}=this.lower,a=this.createUpperCanvas();this.upper={el:a,ctx:a.getContext("2d")},this.applyCanvasStyle(i,{allowTouchScrolling:t}),this.applyCanvasStyle(a,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const h=this.createContainerElement();h.classList.add(n),i.parentNode&&i.parentNode.replaceChild(h,i),h.append(i,a),this.container=h}createUpperCanvas(){const{el:e}=this.lower,t=hi();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Xa().createElement("div");return e.setAttribute("data-fabric","wrapper"),eh(e,{position:"relative"}),R0(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:i}=t;eh(e,me(me({},n),{},{"touch-action":i?"manipulation":_r})),R0(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:i}=this.upper;gv(n,i,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),xd(this.upper.el,e),xd(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:i}=this.upper;super.cleanupDOM(e),t.removeChild(i),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),ji().dispose(this.upper.el),delete this.upper,delete this.container}}class mh extends Ho{constructor(){super(...arguments),de(this,"targets",[]),de(this,"_hoveredTargets",[]),de(this,"_currentTransform",null),de(this,"_groupSelector",null),de(this,"contextTopDirty",!1)}static getDefaults(){return me(me({},super.getDefaults()),mh.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new my(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter((t=>!t.group&&t!==e)).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const i=this.targetFindTolerance,a=this.pixelFindContext;this.clearContext(a),a.save(),a.translate(-t+i,-n+i),a.transform(...this.viewportTransform);const h=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(a),e.selectionBackgroundColor=h,a.restore();const p=Math.round(i*this.getRetinaScaling());return qv(a,p,p,p)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find((n=>!!n&&e[n]===!0)):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),i=this._activeObject;return!!(!t||t&&i&&n.length>1&&n.indexOf(t)===-1&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let i;return t===ah||t===br||t===Yr||t===Zl?i=this.centeredScaling||e.centeredScaling:t===Qd&&(i=this.centeredRotation||e.centeredRotation),i?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=Mn:["mr","tr","br"].includes(t)&&(n.x=nn),["tl","mt","tr"].includes(t)?n.y=_d:["bl","mb","br"].includes(t)&&(n.y=Lr)),n}_setupCurrentTransform(e,t,n){var i;const a=t.group?bs(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:h="",control:p}=t.getActiveControl()||{},m=n&&p?(i=p.getActionHandler(e,t,p))===null||i===void 0?void 0:i.bind(p):bv,_=((O,Q,W,ee)=>{if(!Q||!O)return"drag";const K=ee.controls[Q];return K.getActionName(W,K,ee)})(n,h,e,t),b=e[this.centeredKey],E=this._shouldCenterTransform(t,_,b)?{x:Rt,y:Rt}:this._getOriginFromCorner(t,h),I={target:t,action:_,actionHandler:m,actionPerformed:!1,corner:h,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:a.x-t.left,offsetY:a.y-t.top,originX:E.x,originY:E.y,ex:a.x,ey:a.y,lastX:a.x,lastY:a.y,theta:En(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:b,original:me(me({},ap(t)),{},{originX:E.x,originY:E.y})};this._currentTransform=I,this.fire("before:transform",{e,transform:I})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:i,deltaY:a}=this._groupSelector,h=new Ce(t,n).transform(this.viewportTransform),p=new Ce(t+i,n+a).transform(this.viewportTransform),m=this.selectionLineWidth/2;let _=Math.min(h.x,p.x),b=Math.min(h.y,p.y),E=Math.max(h.x,p.x),I=Math.max(h.y,p.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(_,b,E-_,I-b)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,_+=m,b+=m,E-=m,I-=m,Zn.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(_,b,E-_,I-b))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,i=this.getActiveObjects();if(this.targets=[],n&&i.length>=1){if(n.findControl(t,Uc(e))||i.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const a=this.targets;this.targets=[];const h=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&h&&h!==n?(this.targets=a,n):h}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const i=this.getZoom(),a=e.padding/i;if(a){const[h,p,m,_]=n,b=Math.atan2(p.y-h.y,p.x-h.x),E=Ii(b)*a,I=Li(b)*a,O=E+I,Q=E-I;n=[new Ce(h.x-Q,h.y-O),new Ce(p.x+O,p.y-Q),new Ce(m.x+Q,m.y+O),new Ce(_.x-O,_.y+Q)]}return mn.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,bs(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const i=e[n];if(this._checkTarget(i,t)){if(jc(i)&&i.subTargetCheck){const a=this._searchPossibleTargets(i._objects,t);a&&this.targets.push(a)}return i}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&jc(n)&&n.interactive&&this.targets[0]){const i=this.targets;for(let a=i.length-1;a>0;a--){const h=i[a];if(!jc(h)||!h.interactive)return h}return i[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,i=n.getBoundingClientRect();let a=mv(e),h=i.width||0,p=i.height||0;h&&p||(Lr in i&&_d in i&&(p=Math.abs(i.top-i.bottom)),Mn in i&&nn in i&&(h=Math.abs(i.right-i.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,t||(a=bs(a,void 0,this.viewportTransform));const m=this.getRetinaScaling();m!==1&&(a.x/=m,a.y/=m);const _=h===0||p===0?new Ce(1,1):new Ce(n.width/h,n.height/p);return a.multiply(_)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=hi(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return La(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,i=!1;const a=this.getActiveObjects(),h=[],p=[];e.forEach((m=>{a.includes(m)||(n=!0,m.fire("deselected",{e:t,target:m}),p.push(m))})),a.forEach((m=>{e.includes(m)||(n=!0,m.fire("selected",{e:t,target:m}),h.push(m))})),e.length>0&&a.length>0?(i=!0,n&&this.fire("selection:updated",{e:t,selected:h,deselected:p})):a.length>0?(i=!0,this.fire("selection:created",{e:t,selected:h})):e.length>0&&(i=!0,this.fire("selection:cleared",{e:t,deselected:p})),i&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),i=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),i}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,La(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),La(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const i=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),i}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,i={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",i),n.fire(Wc,i))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;La(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const i=this._realizeGroupTransformOnObject(e),a=super._toObject(e,t,n);return e.set(i),a}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&La(t)&&this._activeObject===t){const n=Ya(e,["angle","flipX","flipY",nn,br,Yr,Vo,Wo,Lr]);return vv(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const i=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(i)}}de(mh,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class Kw{constructor(e){de(this,"targets",[]),de(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:i}=e.getActiveObject()||{};i&&i.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach((e=>{e.isEditing&&e.exitEditing()}))}add(e){this.targets.push(e)}remove(e){this.unregister(e),Ia(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const Zw=["target","oldTarget","fireCanvas","e"],Gr={passive:!1},Co=(o,e)=>{const t=o.getViewportPoint(e),n=o.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},ta=function(o){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return o.addEventListener(...t)},si=function(o){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return o.removeEventListener(...t)},Qw={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class eu extends mh{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),de(this,"_isClick",void 0),de(this,"textEditingManager",new Kw(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach((t=>{this[t]=this[t].bind(this)})),this.addOrRemove(ta,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,i=this._getEventPrefix();e(pv(n),"resize",this._onResize),e(n,i+"down",this._onMouseDown),e(n,"".concat(i,"move"),this._onMouseMove,Gr),e(n,"".concat(i,"out"),this._onMouseOut),e(n,"".concat(i,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel,{passive:!1}),e(n,"contextmenu",this._onContextMenu),e(n,"click",this._onClick),e(n,"dblclick",this._onClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,Gr)}removeListeners(){this.addOrRemove(si,"remove");const e=this._getEventPrefix(),t=Ei(this.upperCanvasEl);si(t,"".concat(e,"up"),this._onMouseUp),si(t,"touchend",this._onTouchEnd,Gr),si(t,"".concat(e,"move"),this._onMouseMove,Gr),si(t,"touchmove",this._onMouseMove,Gr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=me({e},Co(this,e));this.fire("mouse:out",me(me({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",me({},n)),this._hoveredTargets.forEach((i=>{this.fire("mouse:out",me(me({},n),{},{target:i})),i&&i.fire("mouseout",me({},n))})),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",me({e},Co(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void ta(this.upperCanvasEl,"drag",this._onDragProgress)}N0(e)}_renderDragEffects(e,t,n){let i=!1;const a=this._dropTarget;a&&a!==t&&a!==n&&(a.clearContextTop(),i=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();const h=this.contextTop;h.save(),h.transform(...this.viewportTransform),t&&(h.save(),t.transform(h),t.renderDragSourceEffect(e),h.restore(),i=!0),n&&(h.save(),n.transform(h),n.renderDropTargetEffect(e),h.restore(),i=!0),h.restore(),i&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==_r,n=t?this._activeObject:void 0,i={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};si(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",i),this._dragSource&&this._dragSource.fire("dragend",i),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:i}=this.findDragTargets(e),a=this._dragSource,h={e,target:n,subTargets:i,dragSource:a,canDrop:!1,dropTarget:void 0};let p;this.fire(t,h),this._fireEnterLeaveEvents(n,h),n&&(n.canDrop(e)&&(p=n),n.fire(t,h));for(let m=0;m<i.length;m++){const _=i[m];_.canDrop(e)&&(p=_),_.fire(t,h)}this._renderDragEffects(e,a,p),this._dropTarget=p}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),i={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",i),this._fireEnterLeaveEvents(t,i)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),i=this._basicEventHandler("drop:before",me({e,target:t,subTargets:n,dragSource:this._dragSource},Co(this,e)));i.didDrop=!1,i.dropTarget=void 0,this._basicEventHandler("drop",i),this.fire("drop:after",i)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],i=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&N0(e),this._basicEventHandler("contextmenu",i),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const i=this.upperCanvasEl,a=this._getEventPrefix(),h=Ei(i);ta(h,"touchend",this._onTouchEnd,Gr),t&&ta(h,"touchmove",this._onMouseMove,Gr),si(i,"".concat(a,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();si(t,"".concat(n,"move"),this._onMouseMove,Gr);const i=Ei(t);ta(i,"".concat(n,"up"),this._onMouseUp),ta(i,"".concat(n,"move"),this._onMouseMove,Gr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=Ei(this.upperCanvasEl);si(n,"touchend",this._onTouchEnd,Gr),si(n,"touchmove",this._onMouseMove,Gr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((()=>{ta(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0}),400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const i=Ei(this.upperCanvasEl);si(i,"".concat(n,"up"),this._onMouseUp),si(i,"".concat(n,"move"),this._onMouseMove,Gr),ta(t,"".concat(n,"move"),this._onMouseMove,Gr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,i=this._isClick,a=this._target,{button:h}=e;if(h)return(this.fireMiddleClick&&h===1||this.fireRightClick&&h===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let p,m,_=!1;if(n&&(this._finalizeCurrentTransform(e),_=n.actionPerformed),!i){const b=a===this._activeObject;this.handleSelection(e),_||(_=this._shouldRender(a)||!b&&a===this._activeObject)}if(a){const b=a.findControl(this.getViewportPoint(e),Uc(e)),{key:E,control:I}=b||{};if(m=E,a.selectable&&a!==this._activeObject&&a.activeOn==="up")this.setActiveObject(a,e),_=!0;else if(I){const O=I.getMouseUpHandler(e,a,I);O&&(p=this.getScenePoint(e),O.call(I,e,n,p.x,p.y))}a.isMoving=!1}if(n&&(n.target!==a||n.corner!==m)){const b=n.target&&n.target.controls[n.corner],E=b&&b.getMouseUpHandler(e,n.target,b);p=p||this.getScenePoint(e),E&&E.call(b,e,n,p.x,p.y)}this._setCursorFromEvent(e,a),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,a&&(a.__corner=void 0),_?this.requestRenderAll():i||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:i=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let a=0;a<i.length;a++)i[a]!==n&&i[a].fire(e,t);return t}_handleEvent(e,t,n){const i=this._target,a=this.targets||[],h=me(me(me({e,target:i,subTargets:a},Co(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?n:{});this.fire("mouse:".concat(t),h),i&&i.fire("mouse".concat(t),h);for(let p=0;p<a.length;p++)a[p]!==i&&a[p].fire("mouse".concat(t),h)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,n=!!t&&t===this._activeObject;const{button:i}=e;if(i)return(this.fireMiddleClick&&i===1||this.fireRightClick&&i===2)&&this._handleEvent(e,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let a=this._shouldRender(t),h=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,h=!0,a=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const p=this.getScenePoint(e);this._groupSelector={x:p.x,y:p.y,deltaY:0,deltaX:0}}if(n=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const p=t.findControl(this.getViewportPoint(e),Uc(e));if(t===this._activeObject&&(p||!h)){this._setupCurrentTransform(e,t,n);const m=p?p.control:void 0,_=this.getScenePoint(e),b=m&&m.getMouseDownHandler(e,t,m);b&&b.call(m,e,this._currentTransform,_.x,_.y)}}a&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),a&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=bs(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,i=this._hoveredTargets,a=this.targets,h=Math.max(i.length,a.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let p=0;p<h;p++)a[p]===t||i[p]&&i[p]===n||this.fireSyntheticInOutEvents("mouse",{e,target:a[p],oldTarget:i[p]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,i=this._hoveredTargets,a=this.targets,h=Math.max(i.length,a.length);this.fireSyntheticInOutEvents("drag",me(me({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let p=0;p<h;p++)this.fireSyntheticInOutEvents("drag",me(me({},t),{},{target:a[p],oldTarget:i[p]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:i,fireCanvas:a,e:h}=t,p=dn(t,Zw);const{targetIn:m,targetOut:_,canvasIn:b,canvasOut:E}=Qw[e],I=i!==n;if(i&&I){const O=me(me({},p),{},{e:h,target:i,nextTarget:n},Co(this,h));a&&this.fire(E,O),i.fire(_,O)}if(n&&I){const O=me(me({},p),{},{e:h,target:n,previousTarget:i},Co(this,h));a&&this.fire(b,O),n.fire(m,O)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,i=n.target,a=i.group?bs(t,void 0,i.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,a),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:i,actionHandler:a,target:h}=t,p=!!a&&a(e,t,n.x,n.y);p&&h.setCoords(),i==="drag"&&p&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||p}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const i=La(this._activeObject)?this._activeObject:null,a=(!i||t.group!==i)&&t.findControl(this.getViewportPoint(e));if(a){const h=a.control;this.setCursor(h.cursorStyleHandler(e,h,t))}else t.subTargetCheck&&this.targets.concat().reverse().map((h=>{n=h.hoverCursor||n})),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,i=La(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||i)&&(i||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(i){const a=n.getObjects();if(t===n){const h=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(a,h)||this.searchPossibleTargets(this._objects,h))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(a,e)}else{n.isEditing&&n.exitEditing();const a=new(ct.getClass("ActiveSelection"))([],{canvas:this});a.multiSelectAdd(n,t),this._hoveredTarget=a,this._setActiveObject(a,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:i,deltaY:a}=this._groupSelector,h=new Ce(t,n),p=h.add(new Ce(i,a)),m=h.min(p),_=h.max(p).subtract(m),b=this.collectObjects({left:m.x,top:m.y,width:_.x,height:_.y},{includeIntersecting:!this.selectionFullyContained}),E=h.eq(p)?b[0]?[b[0]]:[]:b.length>1?b.filter((I=>!I.onSelect({e}))).reverse():b;if(E.length===1)this.setActiveObject(E[0],e);else if(E.length>1){const I=ct.getClass("ActiveSelection");this.setActiveObject(new I(E,{canvas:this}),e)}return this._groupSelector=null,!0}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;const{upper:n}=this.elements;n.ctx=void 0;const i=super.toCanvasElement(e,t);return n.ctx=n.el.getContext("2d"),i}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const vy={x1:0,y1:0,x2:0,y2:0},Jw=me(me({},vy),{},{r1:0,r2:0}),Po=(o,e)=>isNaN(o)&&typeof e=="number"?e:o;function yy(o){return o&&/%$/.test(o)&&Number.isFinite(parseFloat(o))}function _y(o,e){const t=typeof o=="number"?o:typeof o=="string"?parseFloat(o)/(yy(o)?100:1):NaN;return Va(0,Po(t,e),1)}const $w=/\s*;\s*/,eb=/\s*:\s*/;function tb(o,e){let t,n;const i=o.getAttribute("style");if(i){const h=i.split($w);h[h.length-1]===""&&h.pop();for(let p=h.length;p--;){const[m,_]=h[p].split(eb).map((b=>b.trim()));m==="stop-color"?t=_:m==="stop-opacity"&&(n=_)}}const a=new $t(t||o.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:_y(o.getAttribute("offset"),0),color:a.toRgb(),opacity:Po(parseFloat(n||o.getAttribute("stop-opacity")||""),1)*a.getAlpha()*e}}function nb(o,e){const t=[],n=o.getElementsByTagName("stop"),i=_y(e,1);for(let a=n.length;a--;)t.push(tb(n[a],i));return t}function xy(o){return o.nodeName==="linearGradient"||o.nodeName==="LINEARGRADIENT"?"linear":"radial"}function wy(o){return o.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function ki(o,e){return o.getAttribute(e)}function rb(o,e){return(function(t,n){let i,{width:a,height:h,gradientUnits:p}=n;return Object.entries(t).reduce(((m,_)=>{let[b,E]=_;if(E==="Infinity")i=1;else if(E==="-Infinity")i=0;else{const I=typeof E=="string";i=I?parseFloat(E):E,I&&yy(E)&&(i*=.01,p==="pixels"&&(b!=="x1"&&b!=="x2"&&b!=="r2"||(i*=a),b!=="y1"&&b!=="y2"||(i*=h)))}return m[b]=i,m}),{})})(xy(o)==="linear"?(function(t){return{x1:ki(t,"x1")||0,y1:ki(t,"y1")||0,x2:ki(t,"x2")||"100%",y2:ki(t,"y2")||0}})(o):(function(t){return{x1:ki(t,"fx")||ki(t,"cx")||"50%",y1:ki(t,"fy")||ki(t,"cy")||"50%",r1:0,x2:ki(t,"cx")||"50%",y2:ki(t,"cy")||"50%",r2:ki(t,"r")||"50%"}})(o),me(me({},e),{},{gradientUnits:wy(o)}))}class Ai{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:i={},colorStops:a=[],offsetX:h=0,offsetY:p=0,gradientTransform:m,id:_}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:me(me({},t==="radial"?Jw:vy),i),colorStops:a,offsetX:h,offsetY:p,gradientTransform:m,id:_?"".concat(_,"_").concat(ia()):ia()})}addColorStop(e){for(const t in e){const n=new $t(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return me(me({},Ya(this,e)),{},{type:this.type,coords:me({},this.coords),colorStops:this.colorStops.map((t=>me({},t))),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],i=this.gradientTransform?this.gradientTransform.concat():hr.concat(),a=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",h=this.colorStops.map((E=>me({},E))).sort(((E,I)=>E.offset-I.offset));let p=-this.offsetX,m=-this.offsetY;var _;a==="objectBoundingBox"?(p/=e.width,m/=e.height):(p+=e.width/2,m+=e.height/2),(_=e)&&typeof _._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(p-=e.pathOffset.x,m-=e.pathOffset.y),i[4]-=p,i[5]-=m;const b=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(a,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(Do(i),'"'),""].join(" ");if(this.type==="linear"){const{x1:E,y1:I,x2:O,y2:Q}=this.coords;n.push("<linearGradient ",b,' x1="',E,'" y1="',I,'" x2="',O,'" y2="',Q,`">
`)}else if(this.type==="radial"){const{x1:E,y1:I,x2:O,y2:Q,r1:W,r2:ee}=this.coords,K=W>ee;n.push("<radialGradient ",b,' cx="',K?E:O,'" cy="',K?I:Q,'" r="',K?W:ee,'" fx="',K?O:E,'" fy="',K?Q:I,`">
`),K&&(h.reverse(),h.forEach((le=>{le.offset=1-le.offset})));const ae=Math.min(W,ee);if(ae>0){const le=ae/Math.max(W,ee);h.forEach((ge=>{ge.offset+=le*(1-ge.offset)}))}}return h.forEach((E=>{let{color:I,offset:O,opacity:Q}=E;n.push("<stop ",'offset="',100*O+"%",'" style="stop-color:',I,Q!==void 0?";stop-opacity: "+Q:";",`"/>
`)})),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:i,y2:a,r1:h,r2:p}=this.coords,m=this.type==="linear"?e.createLinearGradient(t,n,i,a):e.createRadialGradient(t,n,h,i,a,p);return this.colorStops.forEach((_=>{let{color:b,opacity:E,offset:I}=_;m.addColorStop(I,E!==void 0?new $t(b).setAlpha(E).toRgba():b)})),m}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(me(me({},e),{},{colorStops:t?t.map((i=>me({},i))):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const i=wy(e),a=t._findCenterFromElement();return new this(me({id:e.getAttribute("id")||void 0,type:xy(e),coords:rb(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:nb(e,n.opacity),gradientUnits:i,gradientTransform:$l(e.getAttribute("gradientTransform")||"")},i==="pixels"?{offsetX:t.width/2-a.x,offsetY:t.height/2-a.y}:{offsetX:0,offsetY:0}))}}de(Ai,"type","Gradient"),ct.setClass(Ai,"gradient"),ct.setClass(Ai,"linear"),ct.setClass(Ai,"radial");const ib=["type","source","patternTransform"];class Yl{get type(){return"pattern"}set type(e){Cs("warn","Setting type has no effect",e)}constructor(e){de(this,"repeat","repeat"),de(this,"offsetX",0),de(this,"offsetY",0),de(this,"crossOrigin",""),this.id=ia(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return me(me({},Ya(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:on(this.offsetX,Yt.NUM_FRACTION_DIGITS),offsetY:on(this.offsetY,Yt.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:i,repeat:a,id:h}=this,p=Po(this.offsetX/t,0),m=Po(this.offsetY/n,0),_=a==="repeat-y"||a==="no-repeat"?1+Math.abs(p||0):Po(i.width/t,0),b=a==="repeat-x"||a==="no-repeat"?1+Math.abs(m||0):Po(i.height/n,0);return['<pattern id="SVGID_'.concat(h,'" x="').concat(p,'" y="').concat(m,'" width="').concat(_,'" height="').concat(b,'">'),'<image x="0" y="0" width="'.concat(i.width,'" height="').concat(i.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:i,patternTransform:a}=e,h=dn(e,ib);const p=await Hl(i,me(me({},t),{},{crossOrigin:h.crossOrigin}));return new this(me(me({},h),{},{patternTransform:a&&a.slice(0),source:p}))}}de(Yl,"type","Pattern"),ct.setClass(Yl),ct.setClass(Yl,"pattern");class vh{constructor(e){de(this,"color","rgb(0, 0, 0)"),de(this,"width",1),de(this,"shadow",null),de(this,"strokeLineCap","round"),de(this,"strokeLineJoin","round"),de(this,"strokeMiterLimit",10),de(this,"strokeDashArray",null),de(this,"limitedToCanvasSize",!1),this.canvas=e}_setBrushStyles(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])}_saveAndTransform(e){const t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])}needsFullRender(){return new $t(this.color).getAlpha()<1||!!this.shadow}_setShadow(){if(!this.shadow||!this.canvas)return;const e=this.canvas,t=this.shadow,n=e.contextTop,i=e.getZoom()*e.getRetinaScaling();n.shadowColor=t.color,n.shadowBlur=t.blur*i,n.shadowOffsetX=t.offsetX*i,n.shadowOffsetY=t.offsetY*i}_resetShadow(){const e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}_isOutSideCanvas(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}}const sb=["path","left","top"],ab=["d"];class Ji extends Zn{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:i,top:a}=t,h=dn(t,sb);super(),Object.assign(this,Ji.ownDefaults),this.setOptions(h),this._setPath(e||[],!0),typeof i=="number"&&this.set(nn,i),typeof a=="number"&&this.set(Lr,a)}_setPath(e,t){this.path=oy(Array.isArray(e)?e:dy(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new Ce(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const i of this.path)switch(i[0]){case"L":e.lineTo(i[1]+t,i[2]+n);break;case"M":e.moveTo(i[1]+t,i[2]+n);break;case"C":e.bezierCurveTo(i[1]+t,i[2]+n,i[3]+t,i[4]+n,i[5]+t,i[6]+n);break;case"Q":e.quadraticCurveTo(i[1]+t,i[2]+n,i[3]+t,i[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return me(me({},super.toObject(e)),{},{path:this.path.map((t=>t.slice()))})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=xp(this.path,Yt.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Yt.NUM_FRACTION_DIGITS;return" translate(".concat(on(-this.pathOffset.x,e),", ").concat(on(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:i}=this._calcDimensions();this.set({width:t,height:n,pathOffset:i}),e&&this.setPositionByOrigin(i,Rt,Rt)}_calcBoundsFromPath(){const e=[];let t=0,n=0,i=0,a=0;for(const h of this.path)switch(h[0]){case"L":i=h[1],a=h[2],e.push({x:t,y:n},{x:i,y:a});break;case"M":i=h[1],a=h[2],t=i,n=a;break;case"C":e.push(...Ad(i,a,h[1],h[2],h[3],h[4],h[5],h[6])),i=h[5],a=h[6];break;case"Q":e.push(...Ad(i,a,h[1],h[2],h[1],h[2],h[3],h[4])),i=h[3],a=h[4];break;case"Z":i=t,a=n}return rs(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return me(me({},e),{},{pathOffset:new Ce(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const i=as(e,this.ATTRIBUTE_NAMES,n),{d:a}=i;return new this(a,me(me(me({},dn(i,ab)),t),{},{left:void 0,top:void 0}))}}de(Ji,"type","Path"),de(Ji,"cacheProperties",[...Es,"path","fillRule"]),de(Ji,"ATTRIBUTE_NAMES",[...oa,"d"]),ct.setClass(Ji),ct.setSVGClass(Ji);class Wa extends vh{constructor(e){super(e),de(this,"decimate",.4),de(this,"drawStraightLine",!1),de(this,"straightLineKey","shiftKey"),this._points=[],this._hasStraightLine=!1}needsFullRender(){return super.needsFullRender()||this._hasStraightLine}static drawSegment(e,t,n){const i=t.midPointFrom(n);return e.quadraticCurveTo(t.x,t.y,i.x,i.y),i}onMouseDown(e,t){let{e:n}=t;this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],this._prepareForDrawing(e),this._addPoint(e),this._render())}onMouseMove(e,t){let{e:n}=t;if(this.canvas._isMainEvent(n)&&(this.drawStraightLine=!!this.straightLineKey&&n[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(e))&&this._addPoint(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{const i=this._points,a=i.length,h=this.canvas.contextTop;this._saveAndTransform(h),this.oldEnd&&(h.beginPath(),h.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=Wa.drawSegment(h,i[a-2],i[a-1]),h.stroke(),h.restore()}}onMouseUp(e){let{e:t}=e;return!this.canvas._isMainEvent(t)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}_prepareForDrawing(e){this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)}_addPoint(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1]))&&(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),!0)}_reset(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1}_render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.canvas.contextTop,t=this._points[0],n=this._points[1];if(this._saveAndTransform(e),e.beginPath(),this._points.length===2&&t.x===n.x&&t.y===n.y){const i=this.width/1e3;t.x-=i,n.x+=i}e.moveTo(t.x,t.y);for(let i=1;i<this._points.length;i++)Wa.drawSegment(e,t,n),t=this._points[i],n=this._points[i+1];e.lineTo(t.x,t.y),e.stroke(),e.restore()}convertPointsToSVGPath(e){const t=this.width/1e3;return py(e,t)}createPath(e){const t=new Ji(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new wr(this.shadow)),t}decimatePoints(e,t){if(e.length<=2)return e;let n,i=e[0];const a=this.canvas.getZoom(),h=Math.pow(t/a,2),p=e.length-1,m=[i];for(let _=1;_<p-1;_++)n=Math.pow(i.x-e[_].x,2)+Math.pow(i.y-e[_].y,2),n>=h&&(i=e[_],m.push(i));return m.push(e[p]),m}_finalizeAndAddPath(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));const e=this.convertPointsToSVGPath(this._points);if((function(n){return xp(n)==="M 0 0 Q 0 0 0 0 L 0 0"})(e))return void this.canvas.requestRenderAll();const t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}}const ob=["left","top","radius"],by=["radius","startAngle","endAngle","counterClockwise"];class jr extends Zn{static getDefaults(){return me(me({},super.getDefaults()),jr.ownDefaults)}constructor(e){super(),Object.assign(this,jr.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,En(this.startAngle),En(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(br)}getRadiusY(){return this.get("radius")*this.get(Yr)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...by,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=En(this.startAngle),i=En(this.endAngle),a=Ii(n)*t,h=Li(n)*t,p=Ii(i)*t,m=Li(i)*t,_=e>180?1:0,b=this.counterClockwise?0:1;return['<path d="M '.concat(a," ").concat(h," A ").concat(t," ").concat(t," 0 ").concat(_," ").concat(b," ").concat(p," ").concat(m,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const i=as(e,this.ATTRIBUTE_NAMES,n),{left:a=0,top:h=0,radius:p=0}=i;return new this(me(me({},dn(i,ob)),{},{radius:p,left:a-p,top:h-p}))}static fromObject(e){return super._fromObject(e)}}de(jr,"type","Circle"),de(jr,"cacheProperties",[...Es,...by]),de(jr,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),de(jr,"ATTRIBUTE_NAMES",["cx","cy","r",...oa]),ct.setClass(jr),ct.setSVGClass(jr);class Sy extends vh{constructor(e){super(e),de(this,"width",10),this.points=[]}drawDot(e){const t=this.addPoint(e),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,t),n.restore()}dot(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.closePath(),e.fill()}onMouseDown(e){this.points=[],this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)}_render(){const e=this.canvas.contextTop,t=this.points;this._saveAndTransform(e);for(let n=0;n<t.length;n++)this.dot(e,t[n]);e.restore()}onMouseMove(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))}onMouseUp(){const e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;const t=[];for(let i=0;i<this.points.length;i++){const a=this.points[i],h=new jr({radius:a.radius,left:a.x,top:a.y,originX:Rt,originY:Rt,fill:a.fill});this.shadow&&(h.shadow=new wr(this.shadow)),t.push(h)}const n=new er(t,{canvas:this.canvas});this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.fire("path:created",{path:n}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()}addPoint(e){let{x:t,y:n}=e;const i={x:t,y:n,radius:Ra(Math.max(0,this.width-20),this.width+20)/2,fill:new $t(this.color).setAlpha(Ra(0,100)/100).toRgba()};return this.points.push(i),i}}class Cy extends vh{constructor(e){super(e),de(this,"width",10),de(this,"density",20),de(this,"dotWidth",1),de(this,"dotWidthVariance",1),de(this,"randomOpacity",!1),de(this,"optimizeOverlapping",!0),this.sprayChunks=[],this.sprayChunk=[]}onMouseDown(e){this.sprayChunks=[],this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.renderChunck(this.sprayChunk)}onMouseMove(e){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.renderChunck(this.sprayChunk))}onMouseUp(){const e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;const t=[];for(let i=0;i<this.sprayChunks.length;i++){const a=this.sprayChunks[i];for(let h=0;h<a.length;h++){const p=a[h],m=new yr({width:p.width,height:p.width,left:p.x+1,top:p.y+1,originX:Rt,originY:Rt,fill:this.color});t.push(m)}}const n=new er(this.optimizeOverlapping?(function(i){const a={},h=[];for(let p,m=0;m<i.length;m++)p="".concat(i[m].left).concat(i[m].top),a[p]||(a[p]=!0,h.push(i[m]));return h})(t):t,{objectCaching:!0,subTargetCheck:!1,interactive:!1});this.shadow&&n.set("shadow",new wr(this.shadow)),this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.fire("path:created",{path:n}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()}renderChunck(e){const t=this.canvas.contextTop;t.fillStyle=this.color,this._saveAndTransform(t);for(let n=0;n<e.length;n++){const i=e[n];t.globalAlpha=i.opacity,t.fillRect(i.x,i.y,i.width,i.width)}t.restore()}_render(){const e=this.canvas.contextTop;e.fillStyle=this.color,this._saveAndTransform(e);for(let t=0;t<this.sprayChunks.length;t++)this.renderChunck(this.sprayChunks[t]);e.restore()}addSprayChunk(e){this.sprayChunk=[];const t=this.width/2;for(let n=0;n<this.density;n++)this.sprayChunk.push({x:Ra(e.x-t,e.x+t),y:Ra(e.y-t,e.y+t),width:this.dotWidthVariance?Ra(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth,opacity:this.randomOpacity?Ra(0,100)/100:1});this.sprayChunks.push(this.sprayChunk)}}class ky extends Wa{constructor(e){super(e)}getPatternSrc(){const e=hi(),t=e.getContext("2d");return e.width=e.height=25,t&&(t.fillStyle=this.color,t.beginPath(),t.arc(10,10,10,0,2*Math.PI,!1),t.closePath(),t.fill()),e}getPattern(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")}_setBrushStyles(e){super._setBrushStyles(e);const t=this.getPattern(e);t&&(e.strokeStyle=t)}createPath(e){const t=super.createPath(e),n=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new Yl({source:this.source||this.getPatternSrc(),offsetX:-n.x,offsetY:-n.y}),t}}const lb=["x1","y1","x2","y2"],ub=["x1","y1","x2","y2"],jd=["x1","x2","y1","y2"];class li extends Zn{constructor(){let[e,t,n,i]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,li.ownDefaults),this.setOptions(a),this.x1=e,this.x2=n,this.y1=t,this.y2=i,this._setWidthHeight();const{left:h,top:p}=a;typeof h=="number"&&this.set(nn,h),typeof p=="number"&&this.set(Lr,p)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:i}=this;this.width=Math.abs(n-e),this.height=Math.abs(i-t);const{left:a,top:h,width:p,height:m}=rs([{x:e,y:t},{x:n,y:i}]),_=new Ce(a+p/2,h+m/2);this.setPositionByOrigin(_,Rt,Rt)}_set(e,t){return super._set(e,t),jd.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var i;oi(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(i=this.stroke)!==null&&i!==void 0?i:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new Ce((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return me(me({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:i,width:a,height:h}=this,p=e<=t?-1:1,m=n<=i?-1:1;return{x1:p*a/2,x2:p*-a/2,y1:m*h/2,y2:m*-h/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:i}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(i,`" />
`)]}static async fromElement(e,t,n){const i=as(e,this.ATTRIBUTE_NAMES,n),{x1:a=0,y1:h=0,x2:p=0,y2:m=0}=i;return new this([a,h,p,m],dn(i,lb))}static fromObject(e){let{x1:t,y1:n,x2:i,y2:a}=e,h=dn(e,ub);return this._fromObject(me(me({},h),{},{points:[t,n,i,a]}),{extraParam:"points"})}}de(li,"type","Line"),de(li,"cacheProperties",[...Es,...jd]),de(li,"ATTRIBUTE_NAMES",oa.concat(jd)),ct.setClass(li),ct.setSVGClass(li);class es extends Zn{static getDefaults(){return me(me({},super.getDefaults()),es.ownDefaults)}constructor(e){super(),Object.assign(this,es.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}de(es,"type","Triangle"),de(es,"ownDefaults",{width:100,height:100}),ct.setClass(es),ct.setSVGClass(es);const Ty=["rx","ry"];class Ti extends Zn{static getDefaults(){return me(me({},super.getDefaults()),Ti.ownDefaults)}constructor(e){super(),Object.assign(this,Ti.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(br)}getRy(){return this.get("ry")*this.get(Yr)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Ty,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,ks,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const i=as(e,this.ATTRIBUTE_NAMES,n);return i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,new this(i)}}function Ey(o){if(!o)return[];const e=o.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}de(Ti,"type","Ellipse"),de(Ti,"cacheProperties",[...Es,...Ty]),de(Ti,"ownDefaults",{rx:0,ry:0}),de(Ti,"ATTRIBUTE_NAMES",[...oa,"cx","cy","rx","ry"]),ct.setClass(Ti),ct.setSVGClass(Ti);const cb=["left","top"],Oy={exactBoundingBox:!1};class ai extends Zn{static getDefaults(){return me(me({},super.getDefaults()),ai.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),de(this,"strokeDiff",void 0),Object.assign(this,ai.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:i}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(nn,n),typeof i=="number"&&this.set(Lr,i)}isOpen(){return!0}_projectStrokeOnPoints(e){return Zv(this.points,e,this.isOpen())}_calcDimensions(e){e=me({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map((_=>_.projectedPoint)):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new Ce,strokeOffset:new Ce,strokeDiff:new Ce};const n=rs(t),i=ou(me(me({},e),{},{scaleX:1,scaleY:1})),a=rs(this.points.map((_=>ur(_,i,!0)))),h=new Ce(this.scaleX,this.scaleY);let p=n.left+n.width/2,m=n.top+n.height/2;return this.exactBoundingBox&&(p-=m*Math.tan(En(this.skewX)),m-=p*Math.tan(En(this.skewY))),me(me({},n),{},{pathOffset:new Ce(p,m),strokeOffset:new Ce(a.left,a.top).subtract(new Ce(n.left,n.top)).multiply(h),strokeDiff:new Ce(n.width,n.height).subtract(new Ce(a.width,a.height)).multiply(h)})}_findCenterFromElement(){const e=rs(this.points);return new Ce(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:i,height:a,pathOffset:h,strokeOffset:p,strokeDiff:m}=this._calcDimensions();this.set({width:i,height:a,pathOffset:h,strokeOffset:p,strokeDiff:m}),e&&this.setPositionByOrigin(new Ce(t+i/2,n+a/2),Rt,Rt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new Ce(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let h;if(Object.keys(e).some((p=>this.strokeUniform||this.constructor.layoutProperties.includes(p)))){var t,n;const{width:p,height:m}=this._calcDimensions(e);h=new Ce((t=e.width)!==null&&t!==void 0?t:p,(n=e.height)!==null&&n!==void 0?n:m)}else{var i,a;h=new Ce((i=e.width)!==null&&i!==void 0?i:this.width,(a=e.height)!==null&&a!==void 0?a:this.height)}return h.multiply(new Ce(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,i=super._set(e,t);return this.exactBoundingBox&&n&&((e===br||e===Yr)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),i}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return me(me({},super.toObject(e)),{},{points:this.points.map((t=>{let{x:n,y:i}=t;return{x:n,y:i}}))})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,i=Yt.NUM_FRACTION_DIGITS;for(let a=0,h=this.points.length;a<h;a++)e.push(on(this.points[a].x-t,i),",",on(this.points[a].y-n,i)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,i=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-i);for(let a=0;a<t;a++){const h=this.points[a];e.lineTo(h.x-n,h.y-i)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(Ey(e.getAttribute("points")),me(me({},dn(as(e,this.ATTRIBUTE_NAMES,n),cb)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}de(ai,"ownDefaults",Oy),de(ai,"type","Polyline"),de(ai,"layoutProperties",[Vo,Wo,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),de(ai,"cacheProperties",[...Es,"points"]),de(ai,"ATTRIBUTE_NAMES",[...oa]),ct.setClass(ai),ct.setSVGClass(ai);class na extends ai{isOpen(){return!1}}de(na,"ownDefaults",Oy),de(na,"type","Polygon"),ct.setClass(na),ct.setSVGClass(na);class Py extends Zn{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const i in t[n])for(const a in t[n][i])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const i in n)for(const a in n[i])if(n[i][a][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,i,a=0,h=!0,p=0;for(const m in t){n=0;for(const _ in t[m]){const b=t[m][_]||{};a++,b[e]!==void 0?(i?b[e]!==i&&(h=!1):i=b[e],b[e]===this[e]&&delete b[e]):h=!1,Object.keys(b).length!==0?n++:delete t[m][_]}n===0&&delete t[m]}for(let m=0;m<this._textLines.length;m++)p+=this._textLines[m].length;h&&a===p&&(this[e]=i,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,i,a;for(i in t){for(a in n=t[i],n)delete n[a][e],Object.keys(n[a]).length===0&&delete n[a];Object.keys(n).length===0&&delete t[i]}}_extendStyles(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const a=ip(me(me({},this._getStyleDeclaration(n,i)),t),(h=>h!==void 0));this._setStyleDeclaration(n,i,a)}getSelectionStyles(e,t,n){const i=[];for(let a=e;a<(t||e);a++)i.push(this.getStyleAtPosition(a,n));return i}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,i):this._getStyleDeclaration(n,i)}setSelectionStyles(e,t,n){for(let i=t;i<(n||t);i++)this._extendStyles(i,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const i=this.styles&&this.styles[e];return i&&(n=i[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return me(me({},Ya(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}de(Py,"_styleProperties",Wx);const hb=/  +/g,fb=/"/g;function cd(o,e,t,n,i){return"		".concat((function(a,h){let{left:p,top:m,width:_,height:b}=h,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Yt.NUM_FRACTION_DIGITS;const I=Jl(Rn,a,!1),[O,Q,W,ee]=[p,m,_,b].map((K=>on(K,E)));return"<rect ".concat(I,' x="').concat(O,'" y="').concat(Q,'" width="').concat(W,'" height="').concat(ee,'"></rect>')})(o,{left:e,top:t,width:n,height:i}),`
`)}const db=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let hd;class $n extends Py{static getDefaults(){return me(me({},super.getDefaults()),$n.ownDefaults)}constructor(e,t){super(),de(this,"__charBounds",[]),Object.assign(this,$n.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=_p(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Qi)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,i,a,h,p;for(let m=0,_=this._textLines.length;m<_;m++)if((this.textAlign===Qi||m!==_-1&&!this.isEndOfWrapping(m))&&(i=0,a=this._textLines[m],t=this.getLineWidth(m),t<this.width&&(p=this.textLines[m].match(this._reSpacesAndTabs)))){n=p.length,e=(this.width-t)/n;for(let b=0;b<=a.length;b++)h=this.__charBounds[m][b],this._reSpaceAndTab.test(a[b])?(h.width+=e,h.kernedWidth+=e,h.left+=i,i+=e):h.left+=i}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let i;for(i=0;i<n.length;i++){if(e<=n[i].length)return{lineIndex:i,charIndex:e};e-=n[i].length+this.missingNewlineOffset(i,t)}return{lineIndex:i-1,charIndex:n[i-1].length<e?n[i-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===xr?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Rt:e.textBaseline="middle";break;case"ascender":e.textBaseline=Lr;break;case"descender":e.textBaseline=_d}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const i=this.getLineWidth(t);i>e&&(e=i)}return e}_renderTextLine(e,t,n,i,a,h){this._renderChars(e,t,n,i,a,h)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let i=this._getTopOffset();for(let a=0,h=this._textLines.length;a<h;a++){const p=this.getHeightOfLine(a);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",a)){i+=p;continue}const m=this._textLines[a].length,_=this._getLineLeftOffset(a);let b,E,I=0,O=0,Q=this.getValueOfPropertyAt(a,0,"textBackgroundColor");const W=this.getHeightOfLineImpl(a);for(let ee=0;ee<m;ee++){const K=this.__charBounds[a][ee];E=this.getValueOfPropertyAt(a,ee,"textBackgroundColor"),this.path?(e.save(),e.translate(K.renderLeft,K.renderTop),e.rotate(K.angle),e.fillStyle=E,E&&e.fillRect(-K.width/2,-W*(1-this._fontSizeFraction),K.width,W),e.restore()):E!==Q?(b=n+_+O,this.direction==="rtl"&&(b=this.width-b-I),e.fillStyle=Q,Q&&e.fillRect(b,i,I,W),O=K.left,I=K.width,Q=E):I+=K.kernedWidth}E&&!this.path&&(b=n+_+O,this.direction==="rtl"&&(b=this.width-b-I),e.fillStyle=E,e.fillRect(b,i,I,W)),i+=p}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,i){const a=Mo.getFontCache(t),h=this._getFontDeclaration(t),p=n?n+e:e,m=n&&h===this._getFontDeclaration(i),_=t.fontSize/this.CACHE_FONT_SIZE;let b,E,I,O;if(n&&a.has(n)&&(I=a.get(n)),a.has(e)&&(O=b=a.get(e)),m&&a.has(p)&&(E=a.get(p),O=E-I),b===void 0||I===void 0||E===void 0){const Q=(function(){return hd||(hd=Dr({width:0,height:0}).getContext("2d")),hd})();this._setTextStyles(Q,t,!0),b===void 0&&(O=b=Q.measureText(e).width,a.set(e,b)),I===void 0&&m&&n&&(I=Q.measureText(n).width,a.set(n,I)),m&&E===void 0&&(E=Q.measureText(p).width,a.set(p,E),O=E-I)}return{width:b*_,kernedWidth:O*_}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,i=0;const a=this.pathSide===Mn,h=this.path,p=this._textLines[e],m=p.length,_=new Array(m);this.__charBounds[e]=_;for(let b=0;b<m;b++){const E=p[b];n=this._getGraphemeBox(E,e,b,t),_[b]=n,i+=n.kernedWidth,t=E}if(_[m]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},h&&h.segmentsInfo){let b=0;const E=h.segmentsInfo[h.segmentsInfo.length-1].length;switch(this.textAlign){case nn:b=a?E-i:0;break;case Rt:b=(E-i)/2;break;case Mn:b=a?0:E-i}b+=this.pathStartOffset*(a?-1:1);for(let I=a?m-1:0;a?I>=0:I<m;a?I--:I++)n=_[I],b>E?b%=E:b<0&&(b+=E),this._setGraphemeOnPath(b,n),b+=n.kernedWidth}return{width:i,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,i=this.path,a=fy(i.path,n,i.segmentsInfo);t.renderLeft=a.x-i.pathOffset.x,t.renderTop=a.y-i.pathOffset.y,t.angle=a.angle+(this.pathSide===Mn?Math.PI:0)}_getGraphemeBox(e,t,n,i,a){const h=this.getCompleteStyleDeclaration(t,n),p=i?this.getCompleteStyleDeclaration(t,n-1):{},m=this._measureChar(e,h,i,p);let _,b=m.kernedWidth,E=m.width;this.charSpacing!==0&&(_=this._getWidthOfCharSpacing(),E+=_,b+=_);const I={width:E,left:0,height:h.fontSize,kernedWidth:b,deltaY:h.deltaY};if(n>0&&!a){const O=this.__charBounds[t][n-1];I.left=O.left+O.width+m.kernedWidth-m.width}return I}getHeightOfLineImpl(e){const t=this.__lineHeights;if(t[e])return t[e];let n=this.getHeightOfChar(e,0);for(let i=1,a=this._textLines[e].length;i<a;i++)n=Math.max(this.getHeightOfChar(e,i),n);return t[e]=n*this._fontSizeMult}getHeightOfLine(e){return this.getHeightOfLineImpl(e)*this.lineHeight}calcTextHeight(){let e=0;for(let t=0,n=this._textLines.length;t<n;t++)e+=t===n-1?this.getHeightOfLineImpl(t):this.getHeightOfLine(t);return e}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const i=this._getLeftOffset(),a=this._getTopOffset();for(let h=0,p=this._textLines.length;h<p;h++)this._renderTextLine(t,e,this._textLines[h],i+this._getLineLeftOffset(h),a+n+this.getHeightOfLineImpl(h),h),n+=this.getHeightOfLine(h);e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Rn))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,i,a,h){const p=this.textAlign.includes(Qi),m=this.path,_=!p&&this.charSpacing===0&&this.isEmptyStyles(h)&&!m,b=this.direction==="ltr",E=this.direction==="ltr"?1:-1,I=t.direction;let O,Q,W,ee,K,ae="",le=0;if(t.save(),I!==this.direction&&(t.canvas.setAttribute("dir",b?"ltr":"rtl"),t.direction=b?"ltr":"rtl",t.textAlign=b?nn:Mn),a-=this.getHeightOfLineImpl(h)*this._fontSizeFraction,_)return this._renderChar(e,t,h,0,n.join(""),i,a),void t.restore();for(let ge=0,xe=n.length-1;ge<=xe;ge++)ee=ge===xe||this.charSpacing||m,ae+=n[ge],W=this.__charBounds[h][ge],le===0?(i+=E*(W.kernedWidth-W.width),le+=W.width):le+=W.kernedWidth,p&&!ee&&this._reSpaceAndTab.test(n[ge])&&(ee=!0),ee||(O=O||this.getCompleteStyleDeclaration(h,ge),Q=this.getCompleteStyleDeclaration(h,ge+1),ee=gh(O,Q,!1)),ee&&(m?(t.save(),t.translate(W.renderLeft,W.renderTop),t.rotate(W.angle),this._renderChar(e,t,h,ge,ae,-le/2,0),t.restore()):(K=i,this._renderChar(e,t,h,ge,ae,K,a)),ae="",O=Q,i+=E*le,le=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,i=Dr({width:t,height:n}),a=i.getContext("2d");return i.width=t,i.height=n,a.beginPath(),a.moveTo(0,0),a.lineTo(t,0),a.lineTo(t,n),a.lineTo(0,n),a.closePath(),a.translate(t/2,n/2),a.fillStyle=e.toLive(a),this._applyPatternGradientTransform(a,e),a.fill(),a.createPattern(i,"no-repeat")}handleFiller(e,t,n){let i,a;return oi(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(i=-this.width/2,a=-this.height/2,e.translate(i,a),e[t]=this._applyPatternGradientTransformText(n),{offsetX:i,offsetY:a}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:i}=t;return e.lineWidth=i,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,i,a,h,p){const m=this._getStyleDeclaration(n,i),_=this.getCompleteStyleDeclaration(n,i),b=e==="fillText"&&_.fill,E=e==="strokeText"&&_.stroke&&_.strokeWidth;if(E||b){if(t.save(),t.font=this._getFontDeclaration(_),m.textBackgroundColor&&this._removeShadow(t),m.deltaY&&(p+=m.deltaY),b){const I=this._setFillStyles(t,_);t.fillText(a,h-I.offsetX,p-I.offsetY)}if(E){const I=this._setStrokeStyles(t,_);t.strokeText(a,h-I.offsetX,p-I.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const i=this.get2DCursorLocation(e,!0),a=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),h=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),p={fontSize:a*n.size,deltaY:h+a*n.baseline};this.setSelectionStyles(p,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,i=this.textAlign,a=this.direction,h=this.isEndOfWrapping(e);let p=0;return i===Qi||i===Gl&&!h||i===Xl&&!h||i===Gc&&!h?0:(i===Rt&&(p=n/2),i===Mn&&(p=n),i===Gl&&(p=n/2),i===Xl&&(p=n),a==="rtl"&&(i===Mn||i===Qi||i===Xl?p=0:i===nn||i===Gc?p=-n:i!==Rt&&i!==Gl||(p=-n/2)),p)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var i;return(i=this._getStyleDeclaration(e,t)[n])!==null&&i!==void 0?i:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const i=this._getLeftOffset(),a=this.path,h=this._getWidthOfCharSpacing(),p=t==="linethrough"?.5:t==="overline"?1:0,m=this.offsets[t];for(let _=0,b=this._textLines.length;_<b;_++){const E=this.getHeightOfLine(_);if(!this[t]&&!this.styleHas(t,_)){n+=E;continue}const I=this._textLines[_],O=E/this.lineHeight,Q=this._getLineLeftOffset(_);let W=0,ee=0,K=this.getValueOfPropertyAt(_,0,t),ae=this.getValueOfPropertyAt(_,0,Rn),le=this.getValueOfPropertyAt(_,0,za),ge=K,xe=ae,F=le;const Ne=n+O*(1-this._fontSizeFraction);let Ve=this.getHeightOfChar(_,0),qe=this.getValueOfPropertyAt(_,0,"deltaY");for(let Ze=0,dt=I.length;Ze<dt;Ze++){const We=this.__charBounds[_][Ze];ge=this.getValueOfPropertyAt(_,Ze,t),xe=this.getValueOfPropertyAt(_,Ze,Rn),F=this.getValueOfPropertyAt(_,Ze,za);const Bt=this.getHeightOfChar(_,Ze),Le=this.getValueOfPropertyAt(_,Ze,"deltaY");if(a&&ge&&xe){const wt=this.fontSize*F/1e3;e.save(),e.fillStyle=ae,e.translate(We.renderLeft,We.renderTop),e.rotate(We.angle),e.fillRect(-We.kernedWidth/2,m*Bt+Le-p*wt,We.kernedWidth,wt),e.restore()}else if((ge!==K||xe!==ae||Bt!==Ve||F!==le||Le!==qe)&&ee>0){const wt=this.fontSize*le/1e3;let ze=i+Q+W;this.direction==="rtl"&&(ze=this.width-ze-ee),K&&ae&&le&&(e.fillStyle=ae,e.fillRect(ze,Ne+m*Ve+qe-p*wt,ee,wt)),W=We.left,ee=We.width,K=ge,le=F,ae=xe,Ve=Bt,qe=Le}else ee+=We.kernedWidth}let ot=i+Q+W;this.direction==="rtl"&&(ot=this.width-ot-ee),e.fillStyle=xe;const je=this.fontSize*F/1e3;ge&&xe&&F&&e.fillRect(ot,Ne+m*Ve+qe-p*je,ee-h,je),n+=E}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:i=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;const h=e.includes("'")||e.includes('"')||e.includes(",")||$n.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(a?this.CACHE_FONT_SIZE:i,"px"),h].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return ph(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),i=[`
`];let a=[];for(let h=0;h<t.length;h++)n[h]=this.graphemeSplit(t[h]),a=a.concat(n[h],i);return a.pop(),{_unwrappedLines:n,lines:t,graphemeText:a,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return me(me({},super.toObject([...Ev,...e])),{},{styles:Jv(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let i=!1,a=!1;if(typeof e=="object")for(const h in e)h==="path"&&this.setPathInfo(),i=i||n.includes(h),a=a||h==="path";else i=n.includes(e),a=e==="path";return a&&this.setPathInfo(),i&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const i=as(e,$n.ATTRIBUTE_NAMES,n),a=me(me({},t),i),{textAnchor:h=nn,textDecoration:p="",dx:m=0,dy:_=0,top:b=0,left:E=0,fontSize:I=Kd,strokeWidth:O=1}=a,Q=dn(a,db),W=new this(Xc(e.textContent||"").trim(),me({left:E+m,top:b+_,underline:p.includes("underline"),overline:p.includes("overline"),linethrough:p.includes("line-through"),strokeWidth:0,fontSize:I},Q)),ee=W.getScaledHeight()/W.height,K=((W.height+W.strokeWidth)*W.lineHeight-W.height)*ee,ae=W.getScaledHeight()+K;let le=0;return h===Rt&&(le=W.getScaledWidth()/2),h===Mn&&(le=W.getScaledWidth()),W.set({left:W.left-le,top:W.top-(ae-W.fontSize*(.07+W._fontSizeFraction))/W.lineHeight,strokeWidth:O}),W}static fromObject(e){return this._fromObject(me(me({},e),{},{styles:$v(e.styles||{},e.text)}),{extraParam:"text"})}}de($n,"textLayoutProperties",Tv),de($n,"cacheProperties",[...Es,...Ev]),de($n,"ownDefaults",Ux),de($n,"type","Text"),de($n,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),de($n,"ATTRIBUTE_NAMES",oa.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),Yv($n,[class extends Sv{_toSVG(){const o=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(o.textTop,o.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(o){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:o,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:o,withShadow:!0,additionalTransform:Do(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(o){let{textBgRects:e,textSpans:t}=o;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(fb,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(o,e){const t=[],n=[];let i,a=o;this.backgroundColor&&n.push(...cd(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let h=0,p=this._textLines.length;h<p;h++)i=this._getLineLeftOffset(h),this.direction==="rtl"&&(i+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",h))&&this._setSVGTextLineBg(n,h,e+i,a),this._setSVGTextLineText(t,h,e+i,a),a+=this.getHeightOfLine(h);return{textSpans:t,textBgRects:n}}_createTextCharSpan(o,e,t,n,i){const a=Yt.NUM_FRACTION_DIGITS,h=this.getSvgSpanStyles(e,o!==o.trim()||!!o.match(hb)),p=h?'style="'.concat(h,'"'):"",m=e.deltaY,_=m?' dy="'.concat(on(m,a),'" '):"",{angle:b,renderLeft:E,renderTop:I,width:O}=i;let Q="";if(E!==void 0){const W=O/2;b&&(Q=' rotate="'.concat(on(is(b),a),'"'));const ee=Ga({angle:is(b)});ee[4]=E,ee[5]=I;const K=new Ce(-W,0).transform(ee);t=K.x,n=K.y}return'<tspan x="'.concat(on(t,a),'" y="').concat(on(n,a),'" ').concat(_).concat(Q).concat(p,">").concat(Qv(o),"</tspan>")}_setSVGTextLineText(o,e,t,n){const i=this.getHeightOfLine(e),a=this.textAlign.includes(Qi),h=this._textLines[e];let p,m,_,b,E,I="",O=0;n+=i*(1-this._fontSizeFraction)/this.lineHeight;for(let Q=0,W=h.length-1;Q<=W;Q++)E=Q===W||this.charSpacing||this.path,I+=h[Q],_=this.__charBounds[e][Q],O===0?(t+=_.kernedWidth-_.width,O+=_.width):O+=_.kernedWidth,a&&!E&&this._reSpaceAndTab.test(h[Q])&&(E=!0),E||(p=p||this.getCompleteStyleDeclaration(e,Q),m=this.getCompleteStyleDeclaration(e,Q+1),E=gh(p,m,!0)),E&&(b=this._getStyleDeclaration(e,Q),o.push(this._createTextCharSpan(I,b,t,n,_)),I="",p=m,this.direction==="rtl"?t-=O:t+=O,O=0)}_setSVGTextLineBg(o,e,t,n){const i=this._textLines[e],a=this.getHeightOfLine(e)/this.lineHeight;let h,p=0,m=0,_=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let b=0;b<i.length;b++){const{left:E,width:I,kernedWidth:O}=this.__charBounds[e][b];h=this.getValueOfPropertyAt(e,b,"textBackgroundColor"),h!==_?(_&&o.push(...cd(_,t+m,n,p,a)),m=E,p=I,_=h):p+=O}h&&o.push(...cd(_,t+m,n,p,a))}_getSVGLineTopOffset(o){let e,t=0;for(e=0;e<o;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(o){return"".concat(super.getSvgStyles(o)," text-decoration-thickness: ").concat(on(this.textDecorationThickness*this.getObjectScaling().y/10,Yt.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(o,e){const{fontFamily:t,strokeWidth:n,stroke:i,fill:a,fontSize:h,fontStyle:p,fontWeight:m,deltaY:_,textDecorationThickness:b,linethrough:E,overline:I,underline:O}=o,Q=this.getSvgTextDecoration({underline:O??this.underline,overline:I??this.overline,linethrough:E??this.linethrough}),W=b||this.textDecorationThickness;return[i?Jl(xr,i):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",h?"font-size: ".concat(h,"px; "):"",p?"font-style: ".concat(p,"; "):"",m?"font-weight: ".concat(m,"; "):"",Q?"text-decoration: ".concat(Q,"; text-decoration-thickness: ").concat(on(W*this.getObjectScaling().y/10,Yt.NUM_FRACTION_DIGITS),"%; "):"",a?Jl(Rn,a):"",_?"baseline-shift: ".concat(-_,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(o){return["overline","underline","line-through"].filter((e=>o[e.replace("-","")])).join(" ")}}]),ct.setClass($n),ct.setSVGClass($n);class pb{constructor(e){de(this,"target",void 0),de(this,"__mouseDownInPlace",!1),de(this,"__dragStartFired",!1),de(this,"__isDraggingOver",!1),de(this,"__dragStartSelection",void 0),de(this,"__dragImageDisposer",void 0),de(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach((n=>n())),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:i,selectionEnd:a}=t;const h=this.target,p=h.canvas,m=new Ce(h.flipX?-1:1,h.flipY?-1:1),_=h._getCursorBoundaries(i),b=new Ce(_.left+_.leftOffset,_.top+_.topOffset).multiply(m).transform(h.calcTransformMatrix()),E=p.getScenePoint(e).subtract(b),I=h.getCanvasRetinaScaling(),O=h.getBoundingRect(),Q=b.subtract(new Ce(O.left,O.top)),W=p.viewportTransform,ee=Q.add(E).transform(W,!0),K=h.backgroundColor,ae=mp(h.styles);h.backgroundColor="";const le={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};h.setSelectionStyles(le,0,i),h.setSelectionStyles(le,a,h.text.length),h.dirty=!0;const ge=h.toCanvasElement({enableRetinaScaling:p.enableRetinaScaling,viewportTransform:!0});h.backgroundColor=K,h.styles=ae,h.dirty=!0,eh(ge,{position:"fixed",left:"".concat(-ge.width,"px"),border:_r,width:"".concat(ge.width/I,"px"),height:"".concat(ge.height/I,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{ge.remove()},Ei(e.target||this.target.hiddenTextarea).body.appendChild(ge),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(ge,ee.x,ee.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const i=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},a=t._text.slice(i.selectionStart,i.selectionEnd).join(""),h=me({text:t.text,value:a},i);e.dataTransfer.setData("text/plain",a),e.dataTransfer.setData("application/fabric",JSON.stringify({value:a,styles:t.getSelectionStyles(i.selectionStart,i.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,h)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,i=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let a=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(a&&!i){const h=this.target,p=h.canvas;let m=h.getSelectionStartFromPointer(n);const{styles:_}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},b=a[Math.max(0,a.length-1)],E=0;if(this.__dragStartSelection){const I=this.__dragStartSelection.selectionStart,O=this.__dragStartSelection.selectionEnd;m>I&&m<=O?m=I:m>O&&(m-=O-I),h.removeChars(I,O),delete this.__dragStartSelection}h._reNewline.test(b)&&(h._reNewline.test(h._text[m])||m===h._text.length)&&(a=a.trimEnd()),e.didDrop=!0,e.dropTarget=h,h.insertChars(a,_,m),p.setActiveObject(h),h.enterEditing(n),h.selectionStart=Math.min(m+E,h._text.length),h.selectionEnd=Math.min(h.selectionStart+a.length,h._text.length),h.hiddenTextarea.value=h.text,h._updateTextarea(),h.hiddenTextarea.focus(),h.fire(Vc,{index:m+E,action:"drop"}),p.fire("text:changed",{target:h}),p.contextTopDirty=!0,p.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const i=this.target,a=this.target.canvas,{selectionStart:h,selectionEnd:p}=this.__dragStartSelection,m=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||_r;m===_r?(i.selectionStart=h,i.selectionEnd=p,i._updateTextarea(),i.hiddenTextarea.focus()):(i.clearContextTop(),m==="move"&&(i.removeChars(h,p),i.selectionStart=i.selectionEnd=h,i.hiddenTextarea&&(i.hiddenTextarea.value=i.text),i._updateTextarea(),i.fire(Vc,{index:h,action:"dragend"}),a.fire("text:changed",{target:i}),a.requestRenderAll()),i.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const cm=/[ \n\.,;!\?\-]/;class gb extends $n{constructor(){super(...arguments),de(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:i,onComplete:a}=e;return dp({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:i,onComplete:a,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:h=>{this._currentCursorOpacity=h,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach((t=>{t&&!t.isDone()&&(e=!0,t.abort())})),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some((e=>!e||e.isDone()))&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let i=e>0&&this._reSpace.test(n[e])&&(t===-1||!Zd.test(n[e-1]))?e-1:e,a=n[i];for(;i>0&&i<n.length&&!cm.test(a);)i+=t,a=n[i];return t===-1&&cm.test(a)&&i++,i}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.searchWordBoundary(e,-1),i=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.findLineBoundaryLeft(e),i=this.findLineBoundaryRight(e);this.selectionStart=n,this.selectionEnd=i,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;Ei(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),i=this.selectionStart,a=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&i!==a||i!==n&&a!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===i&&this.selectionEnd===a||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const i=n.slice(0,e),a=this.graphemeSplit(i).length;if(e===t)return{selectionStart:a,selectionEnd:a};const h=n.slice(e,t);return{selectionStart:a,selectionEnd:a+this.graphemeSplit(h).length}}fromGraphemeToStringSelection(e,t,n){const i=n.slice(0,e).join("").length;return e===t?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),i=n.lineIndex,a=n.charIndex,h=this.getValueOfPropertyAt(i,a,"fontSize")*this.lineHeight,p=t.leftOffset,m=this.getCanvasRetinaScaling(),_=this.canvas.upperCanvasEl,b=_.width/m,E=_.height/m,I=b-h,O=E-h,Q=new Ce(t.left+p,t.top+t.topOffset+h).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new Ce(_.clientWidth/b,_.clientHeight/E));return Q.x<0&&(Q.x=0),Q.x>I&&(Q.x=I),Q.y<0&&(Q.y=0),Q.y>O&&(Q.y=O),Q.x+=this.canvas._offset.left,Q.y+=this.canvas._offset.top,{left:"".concat(Q.x,"px"),top:"".concat(Q.y,"px"),fontSize:"".concat(h,"px"),charHeight:h}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Wc),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:i}=this.get2DCursorLocation(e,!0),{lineIndex:a,charIndex:h}=this.get2DCursorLocation(t,!0);if(n!==a){if(this.styles[n])for(let p=i;p<this._unwrappedTextLines[n].length;p++)delete this.styles[n][p];if(this.styles[a])for(let p=h;p<this._unwrappedTextLines[a].length;p++){const m=this.styles[a][p];m&&(this.styles[n]||(this.styles[n]={}),this.styles[n][i+p-h]=m)}for(let p=n+1;p<=a;p++)delete this.styles[p];this.shiftLineStyles(a,n-a)}else if(this.styles[n]){const p=this.styles[n],m=h-i;for(let _=i;_<h;_++)delete p[_];for(const _ in this.styles[n]){const b=parseInt(_,10);b>=h&&(p[b-m]=p[_],delete p[_])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const i in this.styles){const a=parseInt(i,10);a>e&&(this.styles[a+t]=n[a],n[a-t]||delete this.styles[a])}}insertNewlineStyleObject(e,t,n,i){const a={},h=this._unwrappedTextLines[e].length,p=h===t;let m=!1;n||(n=1),this.shiftLineStyles(e,n);const _=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const E in this.styles[e]){const I=parseInt(E,10);I>=t&&(m=!0,a[I-t]=this.styles[e][E],p&&t===0||delete this.styles[e][E])}let b=!1;for(m&&!p&&(this.styles[e+n]=a,b=!0),(b||h>t)&&n--;n>0;)i&&i[n-1]?this.styles[e+n]={0:me({},i[n-1])}:_?this.styles[e+n]={0:me({},_)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,i){this.styles||(this.styles={});const a=this.styles[e],h=a?me({},a):{};n||(n=1);for(const m in h){const _=parseInt(m,10);_>=t&&(a[_+n]=h[_],h[_-n]||delete a[_])}if(this._forceClearCache=!0,i){for(;n--;)Object.keys(i[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=me({},i[n]));return}if(!a)return;const p=a[t?t-1:1];for(;p&&n--;)this.styles[e][t+n]=me({},p)}insertNewStyleBlock(e,t,n){const i=this.get2DCursorLocation(t,!0),a=[0];let h,p=0;for(let m=0;m<e.length;m++)e[m]===`
`?(p++,a[p]=0):a[p]++;for(a[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,a[0],n),n=n&&n.slice(a[0]+1)),p&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+a[0],p),h=1;h<p;h++)a[h]>0?this.insertCharStyleObject(i.lineIndex+h,0,a[h],n):n&&this.styles[i.lineIndex+h]&&n[0]&&(this.styles[i.lineIndex+h][0]=n[0]),n=n&&n.slice(a[h]+1);a[h]>0&&this.insertCharStyleObject(i.lineIndex+h,0,a[h],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;i>n&&this.removeStyleFromTo(n,i);const a=this.graphemeSplit(e);this.insertNewStyleBlock(a,n,t),this._text=[...this._text.slice(0,n),...a,...this._text.slice(i)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=nn:this._selectionDirection===Mn&&(this._selectionDirection=nn,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===Mn?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=Mn:this._selectionDirection===nn&&(this._selectionDirection=Mn,this.selectionStart=t),this.selectionEnd=n)}}class mb extends gb{initHiddenTextarea(){const e=this.canvas&&Ei(this.canvas.getElement())||Xa(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off",name:"fabricTextarea"}).map((h=>{let[p,m]=h;return t.setAttribute(p,m)}));const{top:n,left:i,fontSize:a}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(i,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(a,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map((h=>{let[p,m]=h;return t.addEventListener(p,this[m].bind(this))})),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:n,selectionStart:i,selectionEnd:a}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const h=()=>{this.updateFromTextArea(),this.fire(Vc),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void h();const p=this._splitTextIntoLines(n).graphemeText,m=this._text.length,_=p.length,b=this.selectionStart,E=this.selectionEnd,I=b!==E;let O,Q,W,ee,K=_-m;const ae=this.fromStringToGraphemeSelection(i,a,n),le=b>ae.selectionStart;I?(Q=this._text.slice(b,E),K+=E-b):_<m&&(Q=le?this._text.slice(E+K,E):this._text.slice(b,b-K));const ge=p.slice(ae.selectionEnd-K,ae.selectionEnd);if(Q&&Q.length&&(ge.length&&(O=this.getSelectionStyles(b,b+1,!1),O=ge.map((()=>O[0]))),I?(W=b,ee=E):le?(W=E-Q.length,ee=E):(W=E,ee=E+Q.length),this.removeStyleFromTo(W,ee)),ge.length){const{copyPasteData:xe}=ji();t&&ge.join("")===xe.copiedText&&!Yt.disableStyleCopyPaste&&(O=xe.copiedTextStyle),this.insertNewStyleBlock(ge,b,O)}h()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:i}=t;this.compositionStart=n,this.compositionEnd=i,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=ji();e.copiedText=this.getSelectedText(),Yt.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,i=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],i+=n.left+n.width),i}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),a=i.lineIndex;if(a===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const h=i.charIndex,p=this._getWidthBeforeCursor(a,h),m=this._getIndexOnLine(a+1,p);return this._textLines[a].slice(h).length+m+1+this.missingNewlineOffset(a)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),a=i.lineIndex;if(a===0||e.metaKey||e.keyCode===33)return-n;const h=i.charIndex,p=this._getWidthBeforeCursor(a,h),m=this._getIndexOnLine(a-1,p),_=this._textLines[a].slice(0,h),b=this.missingNewlineOffset(a-1);return-this._textLines[a-1].length+m-_.length+(1-b)}_getIndexOnLine(e,t){const n=this._textLines[e];let i,a,h=this._getLineLeftOffset(e),p=0;for(let m=0,_=n.length;m<_;m++)if(i=this.__charBounds[e][m].width,h+=i,h>t){a=!0;const b=h-i,E=h,I=Math.abs(b-t);p=Math.abs(E-t)<I?m:m-1;break}return a||(p=n.length-1),p}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Mn);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const i=this.text.length;this.selectionStart=Va(0,this.selectionStart,i),this.selectionEnd=Va(0,this.selectionEnd,i),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===nn?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let i;if(e.altKey)i=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;i=this["findLineBoundary".concat(n)](this[t])}return i!==void 0&&this[t]!==i&&(this[t]=i,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=nn,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Mn&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=nn,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===nn&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Mn,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Mn,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const hm=o=>!!o.button;class vb extends mb{constructor(){super(...arguments),de(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new pb(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:n}=e;this.canvas&&this.editable&&!hm(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:n}=e;const i=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const a=this.canvas._activeObject;if(a&&a!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||hm(t)||i||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Ir(this.calcTransformMatrix())).add(new Ce(-this._getLeftOffset(),-this._getTopOffset()));let n=0,i=0,a=0;for(let _=0;_<this._textLines.length&&n<=t.y;_++)n+=this.getHeightOfLine(_),a=_,_>0&&(i+=this._textLines[_-1].length+this.missingNewlineOffset(_-1));let h=Math.abs(this._getLineLeftOffset(a));const p=this._textLines[a].length,m=this.__charBounds[a];for(let _=0;_<p;_++){const b=h+m[_].kernedWidth;if(t.x<=b){Math.abs(t.x-b)<=Math.abs(t.x-h)&&i++;break}h=b,i++}return Math.min(this.flipX?p-i:i,this._text.length)}}const _c="moveCursorUp",xc="moveCursorDown",wc="moveCursorLeft",bc="moveCursorRight",Sc="exitEditing",fm=(o,e)=>{const t=e.getRetinaScaling();o.setTransform(t,0,0,t,0,0);const n=e.viewportTransform;o.transform(n[0],n[1],n[2],n[3],n[4],n[5])},yb=me({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Sc,27:Sc,33:_c,34:xc,35:bc,36:wc,37:wc,38:_c,39:bc,40:xc},keysMapRtl:{9:Sc,27:Sc,33:_c,34:xc,35:wc,36:bc,37:bc,38:_c,39:wc,40:xc},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class ts extends vb{static getDefaults(){return me(me({},super.getDefaults()),ts.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,me(me({},ts.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof eu&&this.canvas.textEditingManager.remove(this),t instanceof eu&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),i=n.length>0;let a,h=e;if(i){a=Dr(e.canvas),h=a.getContext("2d"),fm(h,this.canvas);const p=this.calcTransformMatrix();h.transform(p[0],p[1],p[2],p[3],p[4],p[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(h,t):this.renderCursor(h,t),i)for(const p of n){const m=p.clipPath,_=Dr(e.canvas),b=_.getContext("2d");if(fm(b,this.canvas),!m.absolutePositioned){const E=p.calcTransformMatrix();b.transform(E[0],E[1],E[2],E[3],E[4],E[5])}m.transform(b),m.drawObject(b,!0,{}),this.drawClipPathOnCache(h,m,_)}i&&(e.setTransform(1,0,0,1,0,0),e.drawImage(a,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),i=this._getTopOffset(),a=this._getCursorBoundariesOffsets(e,t);return{left:n,top:i,leftOffset:a.left,topOffset:a.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:i,lineIndex:a}=this.get2DCursorLocation(e);for(let _=0;_<a;_++)t+=this.getHeightOfLine(_);const h=this._getLineLeftOffset(a),p=this.__charBounds[a][i];p&&(n=p.left),this.charSpacing!==0&&i===this._textLines[a].length&&(n-=this._getWidthOfCharSpacing());const m={top:t,left:h+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===Mn||this.textAlign===Qi||this.textAlign===Xl?m.left*=-1:this.textAlign===nn||this.textAlign===Gc?m.left=h-(n>0?n:0):this.textAlign!==Rt&&this.textAlign!==Gl||(m.left=h-(n>0?n:0))),m}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),i=n.lineIndex,a=n.charIndex>0?n.charIndex-1:0,h=this.getValueOfPropertyAt(i,a,"fontSize"),p=this.getObjectScaling().x*this.canvas.getZoom(),m=this.cursorWidth/p,_=this.getValueOfPropertyAt(i,a,"deltaY"),b=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-h*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(i,a,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-m/2,top:b+t.top+_,width:m,height:h}}_renderCursor(e,t,n){const{color:i,opacity:a,left:h,top:p,width:m,height:_}=this.getCursorRenderingData(n,t);e.fillStyle=i,e.globalAlpha=a,e.fillRect(h,p,m,_)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const i=t.selectionStart,a=t.selectionEnd,h=this.textAlign.includes(Qi),p=this.get2DCursorLocation(i),m=this.get2DCursorLocation(a),_=p.lineIndex,b=m.lineIndex,E=p.charIndex<0?0:p.charIndex,I=m.charIndex<0?0:m.charIndex;for(let O=_;O<=b;O++){const Q=this._getLineLeftOffset(O)||0;let W=this.getHeightOfLine(O),ee=0,K=0,ae=0;if(O===_&&(K=this.__charBounds[_][E].left),O>=_&&O<b)ae=h&&!this.isEndOfWrapping(O)?this.width:this.getLineWidth(O)||5;else if(O===b)if(I===0)ae=this.__charBounds[b][I].left;else{const Ne=this._getWidthOfCharSpacing();ae=this.__charBounds[b][I-1].left+this.__charBounds[b][I-1].width-Ne}ee=W,(this.lineHeight<1||O===b&&this.lineHeight>1)&&(W/=this.lineHeight);let le=n.left+Q+K,ge=W,xe=0;const F=ae-K;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",ge=1,xe=W):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Mn||this.textAlign===Qi||this.textAlign===Xl?le=this.width-le-F:this.textAlign===nn||this.textAlign===Gc?le=n.left+Q-ae:this.textAlign!==Rt&&this.textAlign!==Gl||(le=n.left+Q-ae)),e.fillRect(le,n.top+n.topOffset+xe,F,ge),n.topOffset+=ee}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Rn)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}de(ts,"ownDefaults",yb),de(ts,"type","IText"),ct.setClass(ts),ct.setClass(ts,"i-text");class ns extends ts{static getDefaults(){return me(me({},super.getDefaults()),ns.ownDefaults)}constructor(e,t){super(e,me(me({},ns.ownDefaults),t))}static createControls(){return{controls:Gv()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Qi)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,i=0;const a={};for(let h=0;h<e.graphemeLines.length;h++)e.graphemeText[i]===`
`&&h>0?(n=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&h>0&&(n++,i++),a[h]={line:t,offset:n},i+=e.graphemeLines[h].length,n+=e.graphemeLines[h].length;return a}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,i=e+1,a=!1;const h=this._styleMap[e],p=this._styleMap[e+1];h&&(e=h.line,n=h.offset),p&&(i=p.line,a=i===e,t=p.offset);const m=e===void 0?this.styles:{line:this.styles[e]};for(const _ in m)for(const b in m[_]){const E=parseInt(b,10);if(E>=n&&(!a||E<t))for(const I in m[_][b])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const i=this._styleMap[e];super._setStyleDeclaration(i.line,i.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),i=[];for(let a=0;a<n.wordsData.length;a++)i.push(...this._wrapLine(a,t,n));return this.isWrapping=!1,i}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let i=0;return{wordsData:e.map(((a,h)=>{let p=0;const m=t?this.graphemeSplit(a):this.wordSplit(a);return m.length===0?[{word:[],width:0}]:m.map((_=>{const b=t?[_]:this.graphemeSplit(_),E=this._measureWord(b,h,p);return i=Math.max(E,i),p+=b.length+n.length,{word:b,width:E}}))})),largestWordWidth:i}}_measureWord(e,t){let n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=0;for(let h=0,p=e.length;h<p;h++)a+=this._getGraphemeBox(e[h],t,h+i,n,!0).kernedWidth,n=e[h];return a}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:i,wordsData:a}=n,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const p=this._getWidthOfCharSpacing(),m=this.splitByGrapheme,_=[],b=m?"":" ";let E=0,I=[],O=0,Q=0,W=!0;t-=h;const ee=Math.max(t,i,this.dynamicMinWidth),K=a[e];let ae;for(O=0,ae=0;ae<K.length;ae++){const{word:le,width:ge}=K[ae];O+=le.length,E+=Q+ge-p,E>ee&&!W?(_.push(I),I=[],E=ge,W=!0):E+=p,W||m||I.push(b),I=I.concat(le),Q=m?0:this._measureWord([b],e,O),O++,W=!1}return ae&&_.push(I),i+h>this.dynamicMinWidth&&(this.dynamicMinWidth=i-p+h),_}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),i=new Array(n.length);for(let a=0;a<n.length;a++)i[a]=n[a].join("");return t.lines=i,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const i=this._styleMap[t].line;e.set("".concat(i),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}de(ns,"type","Textbox"),de(ns,"textLayoutProperties",[...ts.textLayoutProperties,"width"]),de(ns,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),ct.setClass(ns);class Id extends cu{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:i,group:a}=n;if(!i||!this.shouldPerformLayout(e))return;const{width:h,height:p}=rs(ry(n,i)),m=new Ce(h,p);if(i.absolutePositioned)return{center:bs(i.getRelativeCenterPoint(),void 0,a?a.calcTransformMatrix():void 0),size:m};{const _=i.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:b=new Ce,correction:E=new Ce}=this.calcBoundingBox(t,e)||{};return{center:b.add(_),correction:E.subtract(_),size:m}}return{center:n.getRelativeCenterPoint().add(_),size:m}}}}de(Id,"type","clip-path"),ct.setClass(Id);class Ld extends cu{getInitialSize(e,t){let{target:n}=e,{size:i}=t;return new Ce(n.width||i.x,n.height||i.y)}}de(Ld,"type","fixed"),ct.setClass(Ld);class _b extends Fo{subscribeTargets(e){const t=e.target;e.targets.reduce(((n,i)=>(i.parent&&n.add(i.parent),n)),new Set).forEach((n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})}))}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce(((i,a)=>(a.parent&&i.add(a.parent),i)),new Set).forEach((i=>{!n.some((a=>a.parent===i))&&i.layoutManager.unsubscribeTargets({target:i,targets:[t]})}))}}class ui extends er{static getDefaults(){return me(me({},super.getDefaults()),ui.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,ui.ownDefaults),this.setOptions(t);const{left:n,top:i,layoutManager:a}=t;this.groupInit(e,{left:n,top:i,layoutManager:a??new _b})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach((i=>{const a=this._objects.findIndex((p=>p.isInFrontOf(i))),h=a===-1?this.size():a;this.insertAt(h,i)}))}canEnterGroup(e){return this.getObjects().some((t=>t.isDescendantOf(e)||e.isDescendantOf(t)))?(Cs("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach((i=>{const{parent:a}=i;a&&n.add(a)})),e===yp?n.forEach((i=>{i._onAfterObjectsChange(Zc,t)})):n.forEach((i=>{i._set("dirty",!0)}))}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const i=me(me({hasControls:!1},n),{},{forActiveSelection:!0});for(let a=0;a<this._objects.length;a++)this._objects[a]._renderControls(e,i);super._renderControls(e,t),e.restore()}}de(ui,"type","ActiveSelection"),de(ui,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),ct.setClass(ui),ct.setClass(ui,"activeSelection");class Ay{constructor(){de(this,"resources",{})}applyFilters(e,t,n,i,a){const h=a.getContext("2d");if(!h)return;h.drawImage(t,0,0,n,i);const p={sourceWidth:n,sourceHeight:i,imageData:h.getImageData(0,0,n,i),originalEl:t,originalImageData:h.getImageData(0,0,n,i),canvasEl:a,ctx:h,filterBackend:this};e.forEach((_=>{_.applyTo(p)}));const{imageData:m}=p;return m.width===n&&m.height===i||(a.width=m.width,a.height=m.height),h.putImageData(m,0,0),p}}class tu{constructor(){let{tileSize:e=Yt.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};de(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),de(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=Dr({width:e,height:t}),i=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});i&&(i.clearColor(0,0,0,0),this.canvas=n,this.gl=i)}applyFilters(e,t,n,i,a,h){const p=this.gl,m=a.getContext("2d");if(!p||!m)return;let _;h&&(_=this.getCachedTexture(h,t));const b={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:i,destinationWidth:n,destinationHeight:i,context:p,sourceTexture:this.createTexture(p,n,i,_?void 0:t),targetTexture:this.createTexture(p,n,i),originalTexture:_||this.createTexture(p,n,i,_?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},E=p.createFramebuffer();return p.bindFramebuffer(p.FRAMEBUFFER,E),e.forEach((I=>{I&&I.applyTo(b)})),(function(I){const O=I.targetCanvas,Q=O.width,W=O.height,ee=I.destinationWidth,K=I.destinationHeight;Q===ee&&W===K||(O.width=ee,O.height=K)})(b),this.copyGLTo2D(p,b),p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(b.sourceTexture),p.deleteTexture(b.targetTexture),p.deleteFramebuffer(E),m.setTransform(1,0,0,1,0,0),b}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,i,a){const{NEAREST:h,TEXTURE_2D:p,RGBA:m,UNSIGNED_BYTE:_,CLAMP_TO_EDGE:b,TEXTURE_MAG_FILTER:E,TEXTURE_MIN_FILTER:I,TEXTURE_WRAP_S:O,TEXTURE_WRAP_T:Q}=e,W=e.createTexture();return e.bindTexture(p,W),e.texParameteri(p,E,a||h),e.texParameteri(p,I,a||h),e.texParameteri(p,O,b),e.texParameteri(p,Q,b),i?e.texImage2D(p,0,m,m,_,i):e.texImage2D(p,0,m,t,n,0,m,_,null),W}getCachedTexture(e,t,n){const{textureCache:i}=this;if(i[e])return i[e];{const a=this.createTexture(this.gl,t.width,t.height,t,n);return a&&(i[e]=a),a}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,i=t.targetCanvas,a=i.getContext("2d");if(!a)return;a.translate(0,i.height),a.scale(1,-1);const h=n.height-i.height;a.drawImage(n,0,h,i.width,i.height,0,0,i.width,i.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),i=t.destinationWidth,a=t.destinationHeight,h=i*a*4;if(!n)return;const p=new Uint8Array(this.imageBuffer,0,h),m=new Uint8ClampedArray(this.imageBuffer,0,h);e.readPixels(0,0,i,a,e.RGBA,e.UNSIGNED_BYTE,p);const _=new ImageData(m,i,a);n.putImageData(_,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const i=e.getParameter(n.UNMASKED_RENDERER_WEBGL),a=e.getParameter(n.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),a&&(t.vendor=a.toLowerCase())}return this.gpuInfo=t,t}}let Dc;function My(){const{WebGLProbe:o}=ji();return o.queryWebGL(hi()),Yt.enableGLFiltering&&o.isSupported(Yt.textureSize)?new tu({tileSize:Yt.textureSize}):new Ay}function Rc(){return!Dc&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Dc=My()),Dc}function xb(o){Dc=o}const wb=["filters","resizeFilter","src","crossOrigin","type"],jy=["cropX","cropY"];class cr extends Zn{static getDefaults(){return me(me({},super.getDefaults()),cr.ownDefaults)}constructor(e,t){super(),de(this,"_lastScaleX",1),de(this,"_lastScaleY",1),de(this,"_filterScalingX",1),de(this,"_filterScalingY",1),this.filters=[],Object.assign(this,cr.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(ia()),this.setElement(typeof e=="string"?(this.canvas&&Ei(this.canvas.getElement())||Xa()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),(t=e.classList)===null||t===void 0||t.add(cr.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=Rc(!1);t instanceof tu&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((e=>{const t=this[e];t&&ji().dispose(t),this[e]=void 0}))}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach((n=>{n&&t.push(n.toObject())})),me(me({},super.toObject([...jy,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,i=-this.height/2;let a=[],h=[],p="",m="";if(!t)return[];if(this.hasCrop()){const _=ia();a.push('<clipPath id="imageCrop_'+_+`">
`,'	<rect x="'+n+'" y="'+i+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),p=' clip-path="url(#imageCrop_'+_+')" '}if(this.imageSmoothing||(m=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(i-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(m).concat(p,`></image>
`)),this.stroke||this.strokeDashArray){const _=this.fill;this.fill=null,h=['	<rect x="'.concat(n,'" y="').concat(i,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=_}return a=this.paintFirst!==Rn?a.concat(h,e):a.concat(e,h),a}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Hl(e,{crossOrigin:t,signal:n}).then((i=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(i)}))}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.x,a=n.y,h=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&a>t)return this._element=h,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=a);const p=Dr(h),{width:m,height:_}=h;this._element=p,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=a,Rc().applyFilters([e],h,m,_,this._element),this._filterScalingX=p.width/this._originalElement.width,this._filterScalingY=p.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter((a=>a&&!a.isNeutralState())),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){const a=Dr({width:n,height:i});this._element=a,this._filteredEl=a}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1);Rc().applyFilters(e,this._originalElement,n,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,i=this._filterScalingY,a=this.width,h=this.height,p=Math.max(this.cropX,0),m=Math.max(this.cropY,0),_=t.naturalWidth||t.width,b=t.naturalHeight||t.height,E=p*n,I=m*i,O=Math.min(a*n,_-E),Q=Math.min(h*i,b-I),W=-a/2,ee=-h/2,K=Math.min(a,_/n-p),ae=Math.min(h,b/i-m);t&&e.drawImage(t,E,I,O,Q,W,ee,K,ae)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=up(this.preserveAspectRatio||""),t=this.width,n=this.height,i={width:t,height:n};let a,h=this._element.width,p=this._element.height,m=1,_=1,b=0,E=0,I=0,O=0;return!e||e.alignX===_r&&e.alignY===_r?(m=t/h,_=n/p):(e.meetOrSlice==="meet"&&(m=_=sy(this._element,i),a=(t-h*m)/2,e.alignX==="Min"&&(b=-a),e.alignX==="Max"&&(b=a),a=(n-p*_)/2,e.alignY==="Min"&&(E=-a),e.alignY==="Max"&&(E=a)),e.meetOrSlice==="slice"&&(m=_=ay(this._element,i),a=h-t/m,e.alignX==="Mid"&&(I=a/2),e.alignX==="Max"&&(I=a),a=p-n/_,e.alignY==="Mid"&&(O=a/2),e.alignY==="Max"&&(O=a),h=t/m,p=n/_)),{width:h,height:p,scaleX:m,scaleY:_,offsetLeft:b,offsetTop:E,cropX:I,cropY:O}}static fromObject(e,t){let{filters:n,resizeFilter:i,src:a,crossOrigin:h,type:p}=e,m=dn(e,wb);return Promise.all([Hl(a,me(me({},t),{},{crossOrigin:h})),n&&Lo(n,t),i&&Lo([i],t),lu(m,t)]).then((_=>{let[b,E=[],[I]=[],O={}]=_;return new this(b,me(me({},m),{},{src:a,filters:E,resizeFilter:I},O))}))}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;return Hl(e,{crossOrigin:t,signal:n}).then((a=>new this(a,i)))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const i=as(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(i["xlink:href"]||i.href,t,i).catch((a=>(Cs("log","Unable to parse Image",a),null)))}}function fd(o){if(!Yx.test(o.nodeName))return{};const e=o.getAttribute("viewBox");let t,n,i=1,a=1,h=0,p=0;const m=o.getAttribute("width"),_=o.getAttribute("height"),b=o.getAttribute("x")||0,E=o.getAttribute("y")||0,I=!(e&&Y0.test(e)),O=!m||!_||m==="100%"||_==="100%";let Q="",W=0,ee=0;if(I&&(b||E)&&o.parentNode&&o.parentNode.nodeName!=="#document"&&(Q=" translate("+mr(b||"0")+" "+mr(E||"0")+") ",t=(o.getAttribute("transform")||"")+Q,o.setAttribute("transform",t),o.removeAttribute("x"),o.removeAttribute("y")),I&&O)return{width:0,height:0};const K={width:0,height:0};if(I)return K.width=mr(m),K.height=mr(_),K;const ae=e.match(Y0);h=-parseFloat(ae[1]),p=-parseFloat(ae[2]);const le=parseFloat(ae[3]),ge=parseFloat(ae[4]);K.minX=h,K.minY=p,K.viewBoxWidth=le,K.viewBoxHeight=ge,O?(K.width=le,K.height=ge):(K.width=mr(m),K.height=mr(_),i=K.width/le,a=K.height/ge);const xe=up(o.getAttribute("preserveAspectRatio")||"");if(xe.alignX!==_r&&(xe.meetOrSlice==="meet"&&(a=i=i>a?a:i),xe.meetOrSlice==="slice"&&(a=i=i>a?i:a),W=K.width-le*i,ee=K.height-ge*i,xe.alignX==="Mid"&&(W/=2),xe.alignY==="Mid"&&(ee/=2),xe.alignX==="Min"&&(W=0),xe.alignY==="Min"&&(ee=0)),i===1&&a===1&&h===0&&p===0&&b===0&&E===0)return K;if((b||E)&&o.parentNode.nodeName!=="#document"&&(Q=" translate("+mr(b||"0")+" "+mr(E||"0")+") "),t=Q+" matrix("+i+" 0 0 "+a+" "+(h*i+W)+" "+(p*a+ee)+") ",o.nodeName==="svg"){for(n=o.ownerDocument.createElementNS(bd,"g");o.firstChild;)n.appendChild(o.firstChild);o.appendChild(n)}else n=o,n.removeAttribute("x"),n.removeAttribute("y"),t=n.getAttribute("transform")+t;return n.setAttribute("transform",t),K}de(cr,"type","Image"),de(cr,"cacheProperties",[...Es,...jy]),de(cr,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),de(cr,"CSS_CANVAS","canvas-img"),de(cr,"ATTRIBUTE_NAMES",[...oa,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),ct.setClass(cr),ct.setSVGClass(cr);const th=o=>o.tagName.replace("svg:",""),bb=hh(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);function Iy(o,e){let t,n,i,a,h=[];for(i=0,a=e.length;i<a;i++)t=e[i],n=o.getElementsByTagNameNS("http://www.w3.org/2000/svg",t),h=h.concat(Array.from(n));return h}const Sb=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],dd="xlink:href";function Ly(o,e){var t;const n=((t=e.getAttribute(dd))===null||t===void 0?void 0:t.slice(1))||"",i=o.getElementById(n);if(i&&i.getAttribute(dd)&&Ly(o,i),i&&(Sb.forEach((a=>{const h=i.getAttribute(a);!e.hasAttribute(a)&&h&&e.setAttribute(a,h)})),!e.children.length)){const a=i.cloneNode(!0);for(;a.firstChild;)e.appendChild(a.firstChild)}e.removeAttribute(dd)}const Cb=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"];function Dy(o){const e=o.getElementsByTagName("style"),t={};for(let n=0;n<e.length;n++){const i=(e[n].textContent||"").replace(/\/\*[\s\S]*?\*\//g,"");i.trim()!==""&&i.split("}").filter(((a,h,p)=>p.length>1&&a.trim())).forEach((a=>{if((a.match(/{/g)||[]).length>1&&a.trim().startsWith("@"))return;const h=a.split("{"),p={},m=h[1].trim().split(";").filter((function(_){return _.trim()}));for(let _=0;_<m.length;_++){const b=m[_].split(":"),E=b[0].trim(),I=b[1].trim();p[E]=I}(a=h[0].trim()).split(",").forEach((_=>{(_=_.replace(/^svg/i,"").trim())!==""&&(t[_]=me(me({},t[_]||{}),p))}))}))}return t}const dm=o=>ct.getSVGClass(th(o).toLowerCase());class kb{constructor(e,t,n,i,a){this.elements=e,this.options=t,this.reviver=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=i,this.clipPaths=a,this.gradientDefs=(function(h){const p=Iy(h,Cb),m={};let _=p.length;for(;_--;){const b=p[_];b.getAttribute("xlink:href")&&Ly(h,b);const E=b.getAttribute("id");E&&(m[E]=b)}return m})(i),this.cssRules=Dy(i)}parse(){return Promise.all(this.elements.map((e=>this.createObject(e))))}async createObject(e){const t=dm(e);if(t){const n=await t.fromElement(e,this.options,this.cssRules);return this.resolveGradient(n,e,Rn),this.resolveGradient(n,e,xr),n instanceof cr&&n._originalElement?Lc(n,n.parsePreserveAspectRatioAttribute()):Lc(n),await this.resolveClipPath(n,e),this.reviver&&this.reviver(e,n),n}return null}extractPropertyDefinition(e,t,n){const i=e[t],a=this.regexUrl;if(!a.test(i))return;a.lastIndex=0;const h=a.exec(i)[1];return a.lastIndex=0,n[h]}resolveGradient(e,t,n){const i=this.extractPropertyDefinition(e,n,this.gradientDefs);if(i){const a=t.getAttribute(n+"-opacity"),h=Ai.fromElement(i,e,me(me({},this.options),{},{opacity:a}));e.set(n,h)}}async resolveClipPath(e,t,n){const i=this.extractPropertyDefinition(e,"clipPath",this.clipPaths);if(i){const a=Ir(e.calcTransformMatrix()),h=i[0].parentElement;let p=t;for(;!n&&p.parentElement&&p.getAttribute("clip-path")!==e.clipPath;)p=p.parentElement;p.parentElement.appendChild(h);const m=$l("".concat(p.getAttribute("transform")||""," ").concat(h.getAttribute("originalTransform")||""));h.setAttribute("transform","matrix(".concat(m.join(","),")"));const _=await Promise.all(i.map((ae=>dm(ae).fromElement(ae,this.options,this.cssRules).then((le=>(Lc(le),le.fillRule=le.clipRule,delete le.clipRule,le)))))),b=_.length===1?_[0]:new er(_),E=wn(a,b.calcTransformMatrix());b.clipPath&&await this.resolveClipPath(b,p,h.getAttribute("clip-path")?p:void 0);const{scaleX:I,scaleY:O,angle:Q,skewX:W,translateX:ee,translateY:K}=Ba(E);b.set({flipX:!1,flipY:!1}),b.set({scaleX:I,scaleY:O,angle:Q,skewX:W,skewY:0}),b.setPositionByOrigin(new Ce(ee,K),Rt,Rt),e.clipPath=b}else delete e.clipPath}}const pm=o=>Gx.test(th(o)),Dd=()=>({objects:[],elements:[],options:{},allElements:[]});async function wp(o,e){let{crossOrigin:t,signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n&&n.aborted)return Cs("log",new Yd("parseSVGDocument")),Dd();const i=o.documentElement;(function(b){const E=Iy(b,["use","svg:use"]),I=["x","y","xlink:href","href","transform"];for(const O of E){const Q=O.attributes,W={};for(const qe of Q)qe.value&&(W[qe.name]=qe.value);const ee=(W["xlink:href"]||W.href||"").slice(1);if(ee==="")return;const K=b.getElementById(ee);if(K===null)return;let ae=K.cloneNode(!0);const le=ae.attributes,ge={};for(const qe of le)qe.value&&(ge[qe.name]=qe.value);const{x:xe=0,y:F=0,transform:Ne=""}=W,Ve="".concat(Ne," ").concat(ge.transform||""," translate(").concat(xe,", ").concat(F,")");if(fd(ae),/^svg$/i.test(ae.nodeName)){const qe=ae.ownerDocument.createElementNS(bd,"g");Object.entries(ge).forEach((ot=>{let[je,Ze]=ot;return qe.setAttributeNS(bd,je,Ze)})),qe.append(...ae.childNodes),ae=qe}for(const qe of Q){if(!qe)continue;const{name:ot,value:je}=qe;if(!I.includes(ot))if(ot==="style"){const Ze={};Od(je,Ze),Object.entries(ge).forEach((We=>{let[Bt,Le]=We;Ze[Bt]=Le})),Od(ge.style||"",Ze);const dt=Object.entries(Ze).map((We=>We.join(":"))).join(";");ae.setAttribute(ot,dt)}else!ge[ot]&&ae.setAttribute(ot,je)}ae.setAttribute("transform",Ve),ae.setAttribute("instantiated_by_use","1"),ae.removeAttribute("id"),O.parentNode.replaceChild(ae,O)}})(o);const a=Array.from(i.getElementsByTagName("*")),h=me(me({},fd(i)),{},{crossOrigin:t,signal:n}),p=a.filter((b=>(fd(b),pm(b)&&!(function(E){let I=E;for(;I&&(I=I.parentElement);)if(I&&I.nodeName&&bb.test(th(I))&&!I.getAttribute("instantiated_by_use"))return!0;return!1})(b))));if(!p||p&&!p.length)return me(me({},Dd()),{},{options:h,allElements:a});const m={};return a.filter((b=>th(b)==="clipPath")).forEach((b=>{b.setAttribute("originalTransform",b.getAttribute("transform")||"");const E=b.getAttribute("id");m[E]=Array.from(b.getElementsByTagName("*")).filter((I=>pm(I)))})),{objects:await new kb(p,h,e,o,m).parse(),elements:p,options:h,allElements:a}}function Ao(o,e,t){return wp(new(Oi()).DOMParser().parseFromString(o.trim(),"text/xml"),e,t)}function Tb(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise(((n,i)=>{gy(o.replace(/^\n\s*/,"").trim(),{onComplete:a=>{const h=a.responseXML;h&&n(h),i()},signal:t.signal})})).then((n=>wp(n,e,t))).catch((()=>Dd()))}const Ry=iv,gm=o=>function(e,t,n){const{points:i,pathOffset:a}=n;return new Ce(i[o]).subtract(a).transform(wn(n.getViewportTransform(),n.calcTransformMatrix()))},Ny=(o,e,t,n)=>{const{target:i,pointIndex:a}=e,h=i,p=bs(new Ce(t,n),void 0,h.calcOwnMatrix());return h.points[a]=p.add(h.pathOffset),h.setDimensions(),h.set("dirty",!0),!0},Fy=(o,e)=>function(t,n,i,a){const h=n.target,p=new Ce(h.points[(o>0?o:h.points.length)-1]),m=p.subtract(h.pathOffset).transform(h.calcOwnMatrix()),_=e(t,me(me({},n),{},{pointIndex:o}),i,a),b=p.subtract(h.pathOffset).transform(h.calcOwnMatrix()).subtract(m);return h.left-=b.x,h.top-=b.y,_},mm=o=>aa(Ry,Fy(o,Ny)),Rd=(o,e,t)=>{const{path:n,pathOffset:i}=o,a=n[e];return new Ce(a[t]-i.x,a[t+1]-i.y).transform(wn(o.getViewportTransform(),o.calcTransformMatrix()))};function Eb(o,e,t){const{commandIndex:n,pointIndex:i}=this;return Rd(t,n,i)}function Ob(o,e,t,n){const{target:i}=e,{commandIndex:a,pointIndex:h}=this,p=((m,_,b,E,I)=>{const{path:O,pathOffset:Q}=m,W=O[(E>0?E:O.length)-1],ee=new Ce(W[I],W[I+1]),K=ee.subtract(Q).transform(m.calcOwnMatrix()),ae=bs(new Ce(_,b),void 0,m.calcOwnMatrix());O[E][I]=ae.x+Q.x,O[E][I+1]=ae.y+Q.y,m.setDimensions();const le=ee.subtract(m.pathOffset).transform(m.calcOwnMatrix()).subtract(K);return m.left-=le.x,m.top-=le.y,m.set("dirty",!0),!0})(i,t,n,a,h);return op(this.actionName,me(me({},lp(o,e,t,n)),{},{commandIndex:a,pointIndex:h})),p}class By extends Mr{constructor(e){super(e)}render(e,t,n,i,a){const h=me(me({},i),{},{cornerColor:this.controlFill,cornerStrokeColor:this.controlStroke,transparentCorners:!this.controlFill});super.render(e,t,n,h,a)}}class Pb extends By{constructor(e){super(e)}render(e,t,n,i,a){const{path:h}=a,{commandIndex:p,pointIndex:m,connectToCommandIndex:_,connectToPointIndex:b}=this;e.save(),e.strokeStyle=this.controlStroke,this.connectionDashArray&&e.setLineDash(this.connectionDashArray);const[E]=h[p],I=Rd(a,_,b);if(E==="Q"){const O=Rd(a,p,m+2);e.moveTo(O.x,O.y),e.lineTo(t,n)}else e.moveTo(t,n);e.lineTo(I.x,I.y),e.stroke(),e.restore(),super.render(e,t,n,i,a)}}const Cc=(o,e,t,n,i,a)=>new(t?Pb:By)(me(me({commandIndex:o,pointIndex:e,actionName:"modifyPath",positionHandler:Eb,actionHandler:Ob,connectToCommandIndex:i,connectToPointIndex:a},n),t?n.controlPointStyle:n.pointStyle));var Ab=Object.freeze({__proto__:null,changeWidth:kd,createObjectDefaultControls:gp,createPathControls:function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};let n="M";return o.path.forEach(((i,a)=>{const h=i[0];switch(h!=="Z"&&(t["c_".concat(a,"_").concat(h)]=Cc(a,i.length-2,!1,e)),h){case"C":t["c_".concat(a,"_C_CP_1")]=Cc(a,1,!0,e,a-1,(p=>p==="C"?5:p==="Q"?3:1)(n)),t["c_".concat(a,"_C_CP_2")]=Cc(a,3,!0,e,a,5);break;case"Q":t["c_".concat(a,"_Q_CP_1")]=Cc(a,1,!0,e,a,3)}n=h})),t},createPolyActionHandler:mm,createPolyControls:function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};for(let n=0;n<(typeof o=="number"?o:o.points.length);n++)t["p".concat(n)]=new Mr(me({actionName:Ry,positionHandler:gm(n),actionHandler:mm(n)},e));return t},createPolyPositionHandler:gm,createResizeControls:Xv,createTextboxDefaultControls:Gv,dragHandler:bv,factoryPolyActionHandler:Fy,getLocalPoint:ch,polyActionHandler:Ny,renderCircleControl:Iv,renderSquareControl:Lv,rotationStyleHandler:Dv,rotationWithSnapping:Rv,scaleCursorStyleHandler:Oo,scaleOrSkewActionName:kl,scaleSkewCursorStyleHandler:Da,scalingEqually:Cl,scalingX:Bv,scalingXOrSkewingY:Td,scalingY:zv,scalingYOrSkewingX:Ed,skewCursorStyleHandler:Vv,skewHandlerX:Uv,skewHandlerY:Hv,wrapWithFireEvent:aa,wrapWithFixedAnchor:qa});const hu=o=>o.webgl!==void 0,Mb=(o,e)=>{const t=Dr({width:o,height:e}),n=hi().getContext("webgl"),i={imageBuffer:new ArrayBuffer(o*e*4)},a={destinationWidth:o,destinationHeight:e,targetCanvas:t};let h;h=Oi().performance.now(),tu.prototype.copyGLTo2D.call(i,n,a);const p=Oi().performance.now()-h;return h=Oi().performance.now(),tu.prototype.copyGLTo2DPutImageData.call(i,n,a),p>Oi().performance.now()-h},bp="precision highp float",jb=`
    `.concat(bp,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),Ib=["type"],Lb=["type"],Db=new RegExp(bp,"g");class Nn{get type(){return this.constructor.type}constructor(){let e=dn(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ib);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return jb}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:i="highp"}}=ji();i!=="highp"&&(t=t.replace(Db,bp.replace("highp",i)));const a=e.createShader(e.VERTEX_SHADER),h=e.createShader(e.FRAGMENT_SHADER),p=e.createProgram();if(!a||!h||!p)throw new $i("Vertex, fragment shader or program creation error");if(e.shaderSource(a,n),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new $i("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(a)));if(e.shaderSource(h,t),e.compileShader(h),!e.getShaderParameter(h,e.COMPILE_STATUS))throw new $i("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(h)));if(e.attachShader(p,a),e.attachShader(p,h),e.linkProgram(p),!e.getProgramParameter(p,e.LINK_STATUS))throw new $i('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(p)));const m=this.getUniformLocations(e,p)||{};return m.uStepW=e.getUniformLocation(p,"uStepW"),m.uStepH=e.getUniformLocation(p,"uStepH"),{program:p,attributeLocations:this.getAttributeLocations(e,p),uniformLocations:m}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,i={};for(let a=0;a<n.length;a++)i[n[a]]=e.getUniformLocation(t,n[a]);return i}sendAttributeData(e,t,n){const i=t.aPosition,a=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,a),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,i=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===i||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,i)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){hu(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,i=Dr({width:t,height:n});e.helpLayer=i}}toObject(){const e=Object.keys(this.constructor.defaults||{});return me({type:this.type},e.reduce(((t,n)=>(t[n]=this[n],t)),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(dn(e,Lb))}}de(Nn,"type","BaseFilter"),de(Nn,"uniformLocations",[]);const Rb={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class Tl extends Nn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(Rb[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new $t(this.color).getSource(),i=this.alpha,a=n[0]*i,h=n[1]*i,p=n[2]*i,m=1-i;for(let _=0;_<t.length;_+=4){const b=t[_],E=t[_+1],I=t[_+2];let O,Q,W;switch(this.mode){case"multiply":O=b*a/255,Q=E*h/255,W=I*p/255;break;case"screen":O=255-(255-b)*(255-a)/255,Q=255-(255-E)*(255-h)/255,W=255-(255-I)*(255-p)/255;break;case"add":O=b+a,Q=E+h,W=I+p;break;case"difference":O=Math.abs(b-a),Q=Math.abs(E-h),W=Math.abs(I-p);break;case"subtract":O=b-a,Q=E-h,W=I-p;break;case"darken":O=Math.min(b,a),Q=Math.min(E,h),W=Math.min(I,p);break;case"lighten":O=Math.max(b,a),Q=Math.max(E,h),W=Math.max(I,p);break;case"overlay":O=a<128?2*b*a/255:255-2*(255-b)*(255-a)/255,Q=h<128?2*E*h/255:255-2*(255-E)*(255-h)/255,W=p<128?2*I*p/255:255-2*(255-I)*(255-p)/255;break;case"exclusion":O=a+b-2*a*b/255,Q=h+E-2*h*E/255,W=p+I-2*p*I/255;break;case"tint":O=a+b*m,Q=h+E*m,W=p+I*m}t[_]=O,t[_+1]=Q,t[_+2]=W}}sendUniformData(e,t){const n=new $t(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}de(Tl,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),de(Tl,"type","BlendColor"),de(Tl,"uniformLocations",["uColor"]),ct.setClass(Tl);const Nb={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},Fb=["type","image"];class El extends Nn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Nb[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:i},filterBackend:{resources:a}}=e;const h=this.image;a.blendImage||(a.blendImage=hi());const p=a.blendImage,m=p.getContext("2d");p.width!==n||p.height!==i?(p.width=n,p.height=i):m.clearRect(0,0,n,i),m.setTransform(h.scaleX,0,0,h.scaleY,h.left,h.top),m.drawImage(h.getElement(),0,0,n,i);const _=m.getImageData(0,0,n,i).data;for(let b=0;b<t.length;b+=4){const E=t[b],I=t[b+1],O=t[b+2],Q=t[b+3],W=_[b],ee=_[b+1],K=_[b+2],ae=_[b+3];switch(this.mode){case"multiply":t[b]=E*W/255,t[b+1]=I*ee/255,t[b+2]=O*K/255,t[b+3]=Q*ae/255;break;case"mask":t[b+3]=ae}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return me(me({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:i}=e,a=dn(e,Fb);return cr.fromObject(i,t).then((h=>new this(me(me({},a),{},{image:h}))))}}de(El,"type","BlendImage"),de(El,"defaults",{mode:"multiply",alpha:1}),de(El,"uniformLocations",["uTransformMatrix","uImage"]),ct.setClass(El);class Ol extends Nn{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){hu(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:n,height:i}}=e;this.aspectRatio=n/i,this.horizontal=!0;let a=this.getBlurValue()*n;const h=new Uint8ClampedArray(t),p=15,m=4*n;for(let _=0;_<t.length;_+=4){let b=0,E=0,I=0,O=0,Q=0;const W=_-_%m,ee=W+m;for(let K=-14;K<p;K++){const ae=K/p,le=4*Math.floor(a*ae),ge=1-Math.abs(ae);let xe=_+le;xe<W?xe=W:xe>ee&&(xe=ee);const F=t[xe+3]*ge;b+=t[xe]*F,E+=t[xe+1]*F,I+=t[xe+2]*F,O+=F,Q+=ge}h[_]=b/O,h[_+1]=E/O,h[_+2]=I/O,h[_+3]=O/Q}this.horizontal=!1,a=this.getBlurValue()*i;for(let _=0;_<h.length;_+=4){let b=0,E=0,I=0,O=0,Q=0;const W=_%m,ee=h.length-m+W;for(let K=-14;K<p;K++){const ae=K/p,le=Math.floor(a*ae)*m,ge=1-Math.abs(ae);let xe=_+le;xe<W?xe=W:xe>ee&&(xe=ee);const F=h[xe+3]*ge;b+=h[xe]*F,E+=h[xe+1]*F,I+=h[xe+2]*F,O+=F,Q+=ge}t[_]=b/O,t[_+1]=E/O,t[_+2]=I/O,t[_+3]=O/Q}}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:n}=this;return t?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}de(Ol,"type","Blur"),de(Ol,"defaults",{blur:0}),de(Ol,"uniformLocations",["uDelta"]),ct.setClass(Ol);class Pl extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let i=0;i<t.length;i+=4)t[i]+=n,t[i+1]+=n,t[i+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}de(Pl,"type","Brightness"),de(Pl,"defaults",{brightness:0}),de(Pl,"uniformLocations",["uBrightness"]),ct.setClass(Pl);const zy={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class Na extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,i=this.colorsOnly;for(let a=0;a<t.length;a+=4){const h=t[a],p=t[a+1],m=t[a+2];if(t[a]=h*n[0]+p*n[1]+m*n[2]+255*n[4],t[a+1]=h*n[5]+p*n[6]+m*n[7]+255*n[9],t[a+2]=h*n[10]+p*n[11]+m*n[12]+255*n[14],!i){const _=t[a+3];t[a]+=_*n[3],t[a+1]+=_*n[8],t[a+2]+=_*n[13],t[a+3]=h*n[15]+p*n[16]+m*n[17]+_*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,i=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],a=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,a)}toObject(){return me(me({},super.toObject()),{},{matrix:[...this.matrix]})}}function Ka(o,e){var t;const n=(de(t=class extends Na{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",o),de(t,"defaults",{colorsOnly:!1,matrix:e}),t);return ct.setClass(n,o),n}de(Na,"type","ColorMatrix"),de(Na,"defaults",zy),de(Na,"uniformLocations",["uColorMatrix","uConstants"]),ct.setClass(Na);const Bb=Ka("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),zb=Ka("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),Vb=Ka("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),Wb=Ka("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),Ub=Ka("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),Hb=Ka("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),Xb=Ka("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Nd extends Nn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){hu(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach((t=>{t.applyTo(e)}))}toObject(){return{type:this.type,subFilters:this.subFilters.map((e=>e.toObject()))}}isNeutralState(){return!this.subFilters.some((e=>!e.isNeutralState()))}static fromObject(e,t){return Promise.all((e.subFilters||[]).map((n=>ct.getClass(n.type).fromObject(n,t)))).then((n=>new this({subFilters:n})))}}de(Nd,"type","Composed"),ct.setClass(Nd);class Al extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),i=259*(n+255)/(255*(259-n));for(let a=0;a<t.length;a+=4)t[a]=i*(t[a]-128)+128,t[a+1]=i*(t[a+1]-128)+128,t[a+2]=i*(t[a+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}de(Al,"type","Contrast"),de(Al,"defaults",{contrast:0}),de(Al,"uniformLocations",["uContrast"]),ct.setClass(Al);const Gb={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Ml extends Nn{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return Gb[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,i=this.matrix,a=Math.round(Math.sqrt(i.length)),h=Math.floor(a/2),p=t.width,m=t.height,_=e.ctx.createImageData(p,m),b=_.data,E=this.opaque?1:0;let I,O,Q,W,ee,K,ae,le,ge,xe,F,Ne,Ve;for(F=0;F<m;F++)for(xe=0;xe<p;xe++){for(ee=4*(F*p+xe),I=0,O=0,Q=0,W=0,Ve=0;Ve<a;Ve++)for(Ne=0;Ne<a;Ne++)ae=F+Ve-h,K=xe+Ne-h,ae<0||ae>=m||K<0||K>=p||(le=4*(ae*p+K),ge=i[Ve*a+Ne],I+=n[le]*ge,O+=n[le+1]*ge,Q+=n[le+2]*ge,E||(W+=n[le+3]*ge));b[ee]=I,b[ee+1]=O,b[ee+2]=Q,b[ee+3]=E?n[ee+3]:W}e.imageData=_}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return me(me({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}de(Ml,"type","Convolute"),de(Ml,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),de(Ml,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),ct.setClass(Ml);const Vy="Gamma";class jl extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,i=1/n[0],a=1/n[1],h=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const p=this.rgbValues;for(let m=0;m<256;m++)p.r[m]=255*Math.pow(m/255,i),p.g[m]=255*Math.pow(m/255,a),p.b[m]=255*Math.pow(m/255,h);for(let m=0;m<t.length;m+=4)t[m]=p.r[t[m]],t[m+1]=p.g[t[m+1]],t[m+2]=p.b[t[m+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:Vy,gamma:this.gamma.concat()}}}de(jl,"type",Vy),de(jl,"defaults",{gamma:[1,1,1]}),de(jl,"uniformLocations",["uGamma"]),ct.setClass(jl);const Yb={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Il extends Nn{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,i=0;i<t.length;i+=4){const a=t[i],h=t[i+1],p=t[i+2];switch(this.mode){case"average":n=(a+h+p)/3;break;case"lightness":n=(Math.min(a,h,p)+Math.max(a,h,p))/2;break;case"luminosity":n=.21*a+.72*h+.07*p}t[i+2]=t[i+1]=t[i]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return Yb[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}de(Il,"type","Grayscale"),de(Il,"defaults",{mode:"average"}),de(Il,"uniformLocations",["uMode"]),ct.setClass(Il);const qb=me(me({},zy),{},{rotation:0});class Nc extends Na{calculateMatrix(){const e=this.rotation*Math.PI,t=Ii(e),n=Li(e),i=1/3,a=Math.sqrt(i)*n,h=1-t;this.matrix=[t+h/3,i*h-a,i*h+a,0,0,i*h+a,t+i*h,i*h-a,0,0,i*h-a,i*h+a,t+i*h,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}de(Nc,"type","HueRotation"),de(Nc,"defaults",qb),ct.setClass(Nc);class Ll extends Nn{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}de(Ll,"type","Invert"),de(Ll,"defaults",{alpha:!1,invert:!0}),de(Ll,"uniformLocations",["uInvert","uAlpha"]),ct.setClass(Ll);class Dl extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let i=0;i<t.length;i+=4){const a=(.5-Math.random())*n;t[i]+=a,t[i+1]+=a,t[i+2]+=a}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}de(Dl,"type","Noise"),de(Dl,"defaults",{noise:0}),de(Dl,"uniformLocations",["uNoise","uSeed"]),ct.setClass(Dl);class Rl extends Nn{applyTo2d(e){let{imageData:{data:t,width:n,height:i}}=e;for(let a=0;a<i;a+=this.blocksize)for(let h=0;h<n;h+=this.blocksize){const p=4*a*n+4*h,m=t[p],_=t[p+1],b=t[p+2],E=t[p+3];for(let I=a;I<Math.min(a+this.blocksize,i);I++)for(let O=h;O<Math.min(h+this.blocksize,n);O++){const Q=4*I*n+4*O;t[Q]=m,t[Q+1]=_,t[Q+2]=b,t[Q+3]=E}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}de(Rl,"type","Pixelate"),de(Rl,"defaults",{blocksize:4}),de(Rl,"uniformLocations",["uBlocksize"]),ct.setClass(Rl);class Nl extends Nn{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,i=new $t(this.color).getSource(),a=[i[0]-n,i[1]-n,i[2]-n],h=[i[0]+n,i[1]+n,i[2]+n];for(let p=0;p<t.length;p+=4){const m=t[p],_=t[p+1],b=t[p+2];m>a[0]&&_>a[1]&&b>a[2]&&m<h[0]&&_<h[1]&&b<h[2]&&(t[p+3]=0)}}sendUniformData(e,t){const n=new $t(this.color).getSource(),i=this.distance,a=[0+n[0]/255-i,0+n[1]/255-i,0+n[2]/255-i,1],h=[n[0]/255+i,n[1]/255+i,n[2]/255+i,1];e.uniform4fv(t.uLow,a),e.uniform4fv(t.uHigh,h)}}de(Nl,"type","RemoveColor"),de(Nl,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),de(Nl,"uniformLocations",["uLow","uHigh"]),ct.setClass(Nl);class Fl extends Nn{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),i=new Array(n);for(let a=1;a<=n;a++)i[a-1]=e(a*t);return i}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map(((n,i)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(i,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(i,`];
              sum += 2.0 * uTaps[`).concat(i,`];
            `))).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){hu(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,i=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/i;const a=t.width,h=t.height,p=Math.round(a*n),m=Math.round(h*i);let _;_=this.resizeType==="sliceHack"?this.sliceByTwo(e,a,h,p,m):this.resizeType==="hermite"?this.hermiteFastResize(e,a,h,p,m):this.resizeType==="bilinear"?this.bilinearFiltering(e,a,h,p,m):this.resizeType==="lanczos"?this.lanczosResize(e,a,h,p,m):new ImageData(p,m),e.imageData=_}sliceByTwo(e,t,n,i,a){const h=e.imageData,p=.5;let m=!1,_=!1,b=t*p,E=n*p;const I=e.filterBackend.resources;let O=0,Q=0;const W=t;let ee=0;I.sliceByTwo||(I.sliceByTwo=hi());const K=I.sliceByTwo;(K.width<1.5*t||K.height<n)&&(K.width=1.5*t,K.height=n);const ae=K.getContext("2d");for(ae.clearRect(0,0,1.5*t,n),ae.putImageData(h,0,0),i=Math.floor(i),a=Math.floor(a);!m||!_;)t=b,n=E,i<Math.floor(b*p)?b=Math.floor(b*p):(b=i,m=!0),a<Math.floor(E*p)?E=Math.floor(E*p):(E=a,_=!0),ae.drawImage(K,O,Q,t,n,W,ee,b,E),O=W,Q=ee,ee+=E;return ae.getImageData(O,Q,i,a)}lanczosResize(e,t,n,i,a){const h=e.imageData.data,p=e.ctx.createImageData(i,a),m=p.data,_=this.lanczosCreate(this.lanczosLobes),b=this.rcpScaleX,E=this.rcpScaleY,I=2/this.rcpScaleX,O=2/this.rcpScaleY,Q=Math.ceil(b*this.lanczosLobes/2),W=Math.ceil(E*this.lanczosLobes/2),ee={},K={x:0,y:0},ae={x:0,y:0};return(function le(ge){let xe,F,Ne,Ve,qe,ot,je,Ze,dt,We,Bt;for(K.x=(ge+.5)*b,ae.x=Math.floor(K.x),xe=0;xe<a;xe++){for(K.y=(xe+.5)*E,ae.y=Math.floor(K.y),qe=0,ot=0,je=0,Ze=0,dt=0,F=ae.x-Q;F<=ae.x+Q;F++)if(!(F<0||F>=t)){We=Math.floor(1e3*Math.abs(F-K.x)),ee[We]||(ee[We]={});for(let Le=ae.y-W;Le<=ae.y+W;Le++)Le<0||Le>=n||(Bt=Math.floor(1e3*Math.abs(Le-K.y)),ee[We][Bt]||(ee[We][Bt]=_(Math.sqrt(Math.pow(We*I,2)+Math.pow(Bt*O,2))/1e3)),Ne=ee[We][Bt],Ne>0&&(Ve=4*(Le*t+F),qe+=Ne,ot+=Ne*h[Ve],je+=Ne*h[Ve+1],Ze+=Ne*h[Ve+2],dt+=Ne*h[Ve+3]))}Ve=4*(xe*i+ge),m[Ve]=ot/qe,m[Ve+1]=je/qe,m[Ve+2]=Ze/qe,m[Ve+3]=dt/qe}return++ge<i?le(ge):p})(0)}bilinearFiltering(e,t,n,i,a){let h,p,m,_,b,E,I,O,Q,W,ee,K,ae,le=0;const ge=this.rcpScaleX,xe=this.rcpScaleY,F=4*(t-1),Ne=e.imageData.data,Ve=e.ctx.createImageData(i,a),qe=Ve.data;for(I=0;I<a;I++)for(O=0;O<i;O++)for(b=Math.floor(ge*O),E=Math.floor(xe*I),Q=ge*O-b,W=xe*I-E,ae=4*(E*t+b),ee=0;ee<4;ee++)h=Ne[ae+ee],p=Ne[ae+4+ee],m=Ne[ae+F+ee],_=Ne[ae+F+4+ee],K=h*(1-Q)*(1-W)+p*Q*(1-W)+m*W*(1-Q)+_*Q*W,qe[le++]=K;return Ve}hermiteFastResize(e,t,n,i,a){const h=this.rcpScaleX,p=this.rcpScaleY,m=Math.ceil(h/2),_=Math.ceil(p/2),b=e.imageData.data,E=e.ctx.createImageData(i,a),I=E.data;for(let O=0;O<a;O++)for(let Q=0;Q<i;Q++){const W=4*(Q+O*i);let ee=0,K=0,ae=0,le=0,ge=0,xe=0,F=0;const Ne=(O+.5)*p;for(let Ve=Math.floor(O*p);Ve<(O+1)*p;Ve++){const qe=Math.abs(Ne-(Ve+.5))/_,ot=(Q+.5)*h,je=qe*qe;for(let Ze=Math.floor(Q*h);Ze<(Q+1)*h;Ze++){let dt=Math.abs(ot-(Ze+.5))/m;const We=Math.sqrt(je+dt*dt);We>1&&We<-1||(ee=2*We*We*We-3*We*We+1,ee>0&&(dt=4*(Ze+Ve*t),F+=ee*b[dt+3],ae+=ee,b[dt+3]<255&&(ee=ee*b[dt+3]/250),le+=ee*b[dt],ge+=ee*b[dt+1],xe+=ee*b[dt+2],K+=ee))}}I[W]=le/K,I[W+1]=ge/K,I[W+2]=xe/K,I[W+3]=F/ae}return E}}de(Fl,"type","Resize"),de(Fl,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),de(Fl,"uniformLocations",["uDelta","uTaps"]),ct.setClass(Fl);class Bl extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let i=0;i<t.length;i+=4){const a=t[i],h=t[i+1],p=t[i+2],m=Math.max(a,h,p);t[i]+=m!==a?(m-a)*n:0,t[i+1]+=m!==h?(m-h)*n:0,t[i+2]+=m!==p?(m-p)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}de(Bl,"type","Saturation"),de(Bl,"defaults",{saturation:0}),de(Bl,"uniformLocations",["uSaturation"]),ct.setClass(Bl);class zl extends Nn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let i=0;i<t.length;i+=4){const a=t[i],h=t[i+1],p=t[i+2],m=Math.max(a,h,p),_=(a+h+p)/3,b=2*Math.abs(m-_)/255*n;t[i]+=m!==a?(m-a)*b:0,t[i+1]+=m!==h?(m-h)*b:0,t[i+2]+=m!==p?(m-p)*b:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}de(zl,"type","Vibrance"),de(zl,"defaults",{vibrance:0}),de(zl,"uniformLocations",["uVibrance"]),ct.setClass(zl);var Kb=Object.freeze({__proto__:null,BaseFilter:Nn,BlackWhite:Xb,BlendColor:Tl,BlendImage:El,Blur:Ol,Brightness:Pl,Brownie:Bb,ColorMatrix:Na,Composed:Nd,Contrast:Al,Convolute:Ml,Gamma:jl,Grayscale:Il,HueRotation:Nc,Invert:Ll,Kodachrome:Vb,Noise:Dl,Pixelate:Rl,Polaroid:Ub,RemoveColor:Nl,Resize:Fl,Saturation:Bl,Sepia:Hb,Technicolor:Wb,Vibrance:zl,Vintage:zb});const Zb=Object.freeze(Object.defineProperty({__proto__:null,ActiveSelection:ui,BaseBrush:vh,BaseFabricObject:Zi,Canvas:eu,Canvas2dFilterBackend:Ay,CanvasDOMManager:my,Circle:jr,CircleBrush:Sy,ClipPathLayout:Id,Color:$t,Control:Mr,Ellipse:Ti,FabricImage:cr,FabricObject:Zn,FabricText:$n,FitContentLayout:Jc,FixedLayout:Ld,Gradient:Ai,Group:er,IText:ts,Image:cr,InteractiveFabricObject:No,Intersection:mn,LayoutManager:Fo,LayoutStrategy:cu,Line:li,Object:Zn,Observable:sv,Path:Ji,Pattern:Yl,PatternBrush:ky,PencilBrush:Wa,Point:Ce,Polygon:na,Polyline:ai,Rect:yr,Shadow:wr,SprayBrush:Cy,StaticCanvas:Ho,StaticCanvasDOMManager:sp,Text:$n,Textbox:ns,Triangle:es,WebGLFilterBackend:tu,cache:Mo,classRegistry:ct,config:Yt,controlsUtils:Ab,createCollectionMixin:$d,filters:Kb,getCSSRules:Dy,getEnv:ji,getFabricDocument:Xa,getFabricWindow:Oi,getFilterBackend:Rc,iMatrix:hr,initFilterBackend:My,isPutImageFaster:Mb,isWebGLPipelineState:hu,loadSVGFromString:Ao,loadSVGFromURL:Tb,parseAttributes:as,parseFontDeclaration:ey,parsePointsAttribute:Ey,parseSVGDocument:wp,parseStyleAttribute:ty,parseTransformAttribute:$l,runningAnimations:Ql,setEnv:Lx,setFilterBackend:xb,util:Md,version:zc},Symbol.toStringTag,{value:"Module"})),sa={namespace:"app",separator:".",trimKeys:!0,expiry:!0};function Qb(o){sa.namespace=o}function Wy(o){sa.namespace=o}function Jb(){return sa.namespace}function $b(){return sa}function e2(o){sa.separator=o}function yh(){return sa.separator}function t2(o){return`${sa.namespace}${sa.separator}${o}`}const n2="1.2.0";var Sp={version:n2,createNamespace:Qb,getCurrentNamespace:Jb,switchNamespace:Wy,get:$b,setSeparator:e2,getSeparator:yh,generateKey:t2};function r2(o){o&&Wy(o)}function i2(o){try{return JSON.parse(o)}catch{return o}}function Uy(o){return o===void 0}function Hy(o){return o===null||o==="null"}function s2(o,e){if(o===0)return"0 B";const t=1024,n=["B","KB","MB"],i=Math.floor(Math.log(o)/Math.log(t));return(o/Math.pow(t,i)).toFixed(2)+" "+(e?n[i]:"")}function a2(o,e,t){e=e.toUpperCase();let n="";switch(e){case"B":n=o.toFixed(2);break;case"KB":n=(o/1024).toFixed(2);break;case"MB":n=(o/(1024*1024)).toFixed(2);break;default:return console.warn(`Unsupported format "${e}" provided. Falling back to auto-formatting.`),s2(o,t)}return t?`${n} ${e}`:n}var nu={parse:i2,isUndefined:Uy,isNull:Hy,units:a2};function Xy(o){return Uy(o)||Hy(o)}function o2(o,e=null){if(Xy(o))return null;const t=Sp.generateKey(o),n=this.storage.getItem(t);if(nu.isNull(n))return e;try{let i=nu.parse(n);return i.expire&&Date.now()>i.expire?(this.remove(o),e):i.value}catch{return e}}function l2(o,e,t={}){if(Xy(o))return null;const n=Sp.generateKey(o),{expire:i}=t;let a={value:e,...i?{expire:Date.now()+i}:{}};this.storage.setItem(n,JSON.stringify(a))}function u2(o){return!!this.get(o)}function c2(o){const e=this.get(o),t=Sp.generateKey(o);return this.storage.removeItem(t),e}function h2(){return this.storage.clear()}function f2(o){return this.storage.key(o)}function d2(){const o=[];for(let e=0;e<this.storage.length;e++)o.push(this.storage.key(e));return o}function p2(o){return this.storage.get(o).trim()}function g2(o,e={}){const t=this.get(o);if(t===null)return 0;const n=new Blob([JSON.stringify(t)]).size;if(e.format){let i="unit"in e?e.unit:!0;return nu.units(n,e.format,i)}return n}function m2(o,e){const t=yh();for(let n in e)n in e&&this.set(`${o}${t}${n}`,e[n])}function v2(o){const e={},t=yh();for(let n=0,i=this.storage.length;n<i;n++){const a=this.key(n),[,h,p]=a.split(`${t}`,3);h===o&&p&&(e[p]=this.get(`${h}${t}${p}`))}return e}const y2=5*1024*1024;function _2(o={}){const e=o.capacity||y2,t=this.used(),n=e-t,i=n>0?n:0;if(o.format){let a="unit"in o?o.unit:!0;return nu.units(i,o.format,a)}return i}function x2(){let o=0;const e=yh();for(let t=0;t<this.count;t++){const n=this.key(t),[,i]=n.split(`${e}`,2),a=this.get(i);o+=new Blob([JSON.stringify(n)]).size,o+=new Blob([JSON.stringify(a)]).size}return o}const w2=5*1024*1024;function b2(o={}){const e=o.capacity||w2;if(o.format){let t="unit"in o?o.unit:!0;return nu.units(e,o.format,t)}return e}var S2={size:g2,free:_2,used:x2,capacity:b2,from:r2,get:o2,set:l2,has:u2,remove:c2,clear:h2,key:f2,keys:d2,trim:p2,getFormattedData:v2,setFormattedData:m2};function vm(o){return{storage:o,get count(){return o.length},...S2}}function ym(o){if(!o)throw new Error("Storage is not supported in this environment.");return o}const C2={local:vm(ym(window.localStorage)),session:vm(ym(window.sessionStorage))},_m=o=>{let e;const t=new Set,n=(_,b)=>{const E=typeof _=="function"?_(e):_;if(!Object.is(E,e)){const I=e;e=b??(typeof E!="object"||E===null)?E:Object.assign({},e,E),t.forEach(O=>O(e,I))}},i=()=>e,p={setState:n,getState:i,getInitialState:()=>m,subscribe:_=>(t.add(_),()=>t.delete(_))},m=e=o(n,i,p);return p},k2=(o=>o?_m(o):_m),T2=o=>o;function E2(o,e=T2){const t=Eo.useSyncExternalStore(o.subscribe,Eo.useCallback(()=>e(o.getState()),[o,e]),Eo.useCallback(()=>e(o.getInitialState()),[o,e]));return Eo.useDebugValue(t),t}const xm=o=>{const e=k2(o),t=n=>E2(e,n);return Object.assign(t,e),t},O2=(o=>o?xm(o):xm),P2="landscape",A2="A4",M2="Default",j2="freehand",I2={Default:{w:1024,h:600},Freehand:{w:1920,h:1080},A4:{w:794,h:1123},A5:{w:794,h:1123},Letter:{w:816,h:1056},Legal:{w:816,h:1344}},L2={bg:"#F2F6FA"};function wm(o,e){const t=Md.invertTransform(o.calcTransformMatrix());return Md.transformPoint(e,t)}function D2(o,e=0,t=1){return Math.max(e,Math.min(t,o))}function bm(o,e,t){const n=t.x-e.x,i=t.y-e.y,a=o.x-e.x,h=o.y-e.y,p=n*n+i*i;return p===0?0:D2((a*n+h*i)/p)}class Gy{canvas;activeObj=null;start;end;line;stops=[];activeStop=null;gradientType="linear";getColor;constructor(e,t){this.canvas=e,this.getColor=t}enable(){this.canvas.on("mouse:down",this.onMouseDown)}disable(){this.canvas.off("mouse:down",this.onMouseDown),this.cleanup()}onMouseDown=e=>{const t=this.canvas.findTarget(e.e,!1);if(t&&!(t===this.start||t===this.end)){if(this.stops.includes(t)){this.setActiveStop(t);return}if(t===this.line){this.addStopFromEvent(e);return}this.attach(t)}};attach(e){this.cleanup(),this.activeObj=e;const t=e.getBoundingRect(!0,!0),n=this.getColor();this.start=this.createHandle(t.left,t.top+t.height/2),this.end=this.createHandle(t.left+t.width,t.top+t.height/2),this.line=new li([this.start.left,this.start.top,this.end.left,this.end.top],{stroke:"#6366f1",strokeWidth:1,selectable:!1,evented:!0,excludeFromExport:!0}),this.createStop(0,n),this.createStop(1,n),this.canvas.add(this.line,this.start,this.end,...this.stops),this.setActiveStop(this.stops[1]),this.update()}createHandle(e,t){const n=new jr({left:e,top:t,radius:7,fill:"#111",originX:"center",originY:"center",selectable:!0,hasControls:!1,hasBorders:!1,excludeFromExport:!0});return n.on("moving",this.update),n}createStop(e,t){const n=this.pointAt(e),i=new jr({left:n.x,top:n.y,radius:6,fill:t,originX:"center",originY:"center",selectable:!0,hasControls:!1,hasBorders:!1,excludeFromExport:!0});return i.offset=e,i.on("moving",()=>{const a=bm(new Ce(i.left,i.top),new Ce(this.start.left,this.start.top),new Ce(this.end.left,this.end.top));i.offset=a;const h=this.pointAt(a);i.set({left:h.x,top:h.y}),this.update()}),i.on("mousedown",a=>{a.e.stopPropagation(),this.setActiveStop(i)}),i.on("mousedblclick",a=>{a.e.preventDefault(),this.removeStop(i)}),this.stops.push(i),i}removeStop(e){this.stops.length<=2||(this.canvas.remove(e),this.stops=this.stops.filter(t=>t!==e),this.activeStop===e&&(this.activeStop=this.stops[0]||null),this.update())}addStopFromEvent(e){const t=this.canvas.getPointer(e.e),n=bm(new Ce(t.x,t.y),new Ce(this.start.left,this.start.top),new Ce(this.end.left,this.end.top)),i=this.createStop(n,this.getColor());this.canvas.add(i),this.setActiveStop(i),this.update()}setActiveStop(e){this.activeStop=e,this.stops.forEach(t=>t.set("stroke",t===e?"#000":void 0)),this.canvas.requestRenderAll()}updateActiveColor(e){this.activeStop&&(this.activeStop.set("fill",e),this.update())}toggleGradientType(){this.gradientType=this.gradientType==="linear"?"radial":"linear",this.update()}update=()=>{if(!this.activeObj)return;this.line.set({x1:this.start.left,y1:this.start.top,x2:this.end.left,y2:this.end.top}),this.stops.forEach(a=>{const h=this.pointAt(a.offset);a.set({left:h.x,top:h.y})});const e=wm(this.activeObj,new Ce(this.start.left,this.start.top)),t=wm(this.activeObj,new Ce(this.end.left,this.end.top)),n=this.stops.sort((a,h)=>a.offset-h.offset).map(a=>({offset:a.offset,color:a.fill})),i=this.gradientType==="linear"?new Ai({type:"linear",gradientUnits:"pixels",coords:{x1:e.x,y1:e.y,x2:t.x,y2:t.y},colorStops:n}):new Ai({type:"radial",gradientUnits:"pixels",coords:{x1:e.x,y1:e.y,r1:0,x2:t.x,y2:t.y,r2:Math.hypot(t.x-e.x,t.y-e.y)},colorStops:n});this.activeObj.set("fill",i),this.canvas.requestRenderAll()};pointAt(e){return{x:this.start.left+(this.end.left-this.start.left)*e,y:this.start.top+(this.end.top-this.start.top)*e}}cleanup(){this.canvas.remove(this.start,this.end,this.line,...this.stops),this.stops=[],this.activeStop=null,this.activeObj=null}syncFromObject(e){return!e.fill||!e.fill.type?(this.disable(),null):(this.gradientType=e.fill.type,this.gradientType)}}const Yy=[];function pd(o,e,t={}){const n={time:new Date().toLocaleTimeString(),level:o,message:e,...t};Yy.push(n),o==="error"?console.error(n):o==="warn"?console.warn(n):console.log(n)}const R2={info:(o,e)=>pd("info",o,e),warn:(o,e)=>pd("warn",o,e),error:(o,e)=>pd("error",o,e),getLogs:()=>Yy};function N2(o,e){const t=o.canvas,n=o.getCenterPoint();e.scaleX*=o.scaleX,e.scaleY*=o.scaleY,o.scaleX=1,o.scaleY=1,o.remove(e),e.set({left:n.x,top:n.y,angle:o.angle,flipX:o.flipX,flipY:o.flipY,originX:"center",originY:"center"}),t.remove(o),t.add(e),t.setActiveObject(e),e.enterEditing(),e.selectAll(),e.setCoords(),t.requestRenderAll()}const F2=(o,e,t)=>({canvas:null,activeTool:"select",isPanning:!1,isDrawingMode:!1,freeDrawingBrush:null,activePanel:null,selectedObject:"textbox",showTextToolbar:!0,hasActiveShape:!1,geditor:null,hasMultipleSelection:()=>{const n=e().canvas;return n?n.getActiveObjects().length>1:!1},init:async n=>{if(e().canvas)return;const i=new eu(n,{backgroundColor:L2.bg,preserveObjectStacking:!0});e().saveState(),o({canvas:i}),e().setPageFormat(j2,P2),e().enablePan(),e().setBrush();const a=new Gy(i,()=>e().fill);o({geditor:a});const h=p=>{const m=p.target;console.log("Don",p),o({hasActiveShape:!!m}),e().setToolbar(p),e().updateFromFabric(m)};i.on("selection:created",p=>h(p)),i.on("selection:updated",p=>h(p)),i.on("selection:cleared",()=>{e().clearToolbar()}),i.on("mouse:down",p=>h(p)),i.on("mouse:dblclick",p=>{const m=p.target;!m||m.type!=="group"||!m.__text||(console.log(m.__text),N2(m,m.__text),m.__text.on("changed",function(){const _=this.__group;if(!_)return;const b=_.__box;if(!b)return;const E=20;b.width=Math.max(this.width+E,b.width),b.height=Math.max(this.height+E,b.height),window.gradientEditor=a,_.setCoords(),i.requestRenderAll()}),m.__text.on("editing:exited",function(){const _=this.canvas,b=this.__group;if(!b)return;const E=this.getCenterPoint();this.scaleX/=b.scaleX||1,this.scaleY/=b.scaleY||1,b.add(this),b.set({left:E.x,top:E.y,angle:this.angle,flipX:this.flipX,flipY:this.flipY,scaleX:1,scaleY:1}),_.remove(this),_.add(b),_.setActiveObject(b),b.setCoords(),_.requestRenderAll()}))}),i.on("object:modified",p=>h(p))},init1:async n=>{if(e().canvas)return;const i=new eu(n,{backgroundColor:"#fff",preserveObjectStacking:!1});e().saveState(),o({canvas:i}),e().enablePan(),e().setPageFormat(A2,M2),e().setBrush();const a=_=>{!_||e()._isRestoring||(e().updateFromFabric(_),e().saveState())},h=(_,b=!1)=>{_?.type==="textbox"?(o({selectedObject:_,showTextToolbar:!0,isEditingText:b}),e().syncFromObject(_)):o({selectedObject:"shape"})},p=()=>{o({selectedObject:null,showTextToolbar:!1,isEditingText:!1})};Object.entries({"object:removed":_=>a(_.target),"selection:created":_=>h(_.target),"selection:updated":_=>h(_.target),"selection:cleared":()=>p(),"mouse:down":_=>h(_.target),"path:created":_=>{const b=_.path;console.log("New path created:",b),e().updateFromFabric(b),e().saveState()}}).forEach(([_,b])=>{i.on(_,b)})},setCanvas:n=>{o({canvas:n}),n&&(n.freeDrawingBrush=new Wa(n),n.freeDrawingBrush.color="#000",n.freeDrawingBrush.width=2,e().enablePan(),e().setPageFormat("Freehand","landscape"),n.on("path:created",()=>e().pushState()),n.on("object:added",i=>{const a=i.target||null;a&&(o({selectedObject:a}),e().syncFromObject(a))}),n.on("selection:created",i=>{const a=i.selected?.[0]||null;o({selectedObject:a}),e().syncFromObject(a)}),n.on("selection:updated",i=>{const a=i.selected?.[0]||null;o({selectedObject:a}),e().syncFromObject(a)}),n.on("selection:cleared",()=>{o({selectedObject:null}),e().syncFromObject(null)}),n.on("object:modified",i=>{const a=i.target||null;o({selectedObject:a}),e().syncFromObject(a)}),n.on("before:transform",i=>{i.target?.type==="textbox"&&o({showTextToolbar:!1})}),n.on("object:scaling",i=>{console.log("Scaling:",i.target?.type)}),n.on("after:transform",i=>{const a=i.target||null;a?.type==="textbox"&&(o({showTextToolbar:!0,selectedObject:a}),e().syncFromObject(a))}))},setSelectedObject:()=>{o({selectedObject:!1})},setActiveTool:n=>{const i=e().canvas;if(i){switch(o({activeTool:n}),n){case"pan":i.isDrawingMode=!1,i.defaultCursor="grab",i.selection=!1,i.skipTargetFind=!0;break;case"draw":console.log("here"),i.isDrawingMode=!0,i.freeDrawingBrush.color="#000";break;case"select":default:i.isDrawingMode=!1,i.defaultCursor="default",i.selection=!0,i.skipTargetFind=!1;break}i.requestRenderAll()}},enablePan:()=>{const n=e().canvas;n&&(console.log("Pan tool enabled"),n.on("mouse:wheel",i=>{const a=i.e;let h=n.getZoom();const p=Math.pow(.999,a.deltaY);h*=p,h=Math.min(Math.max(h,.1),5);const m=new Ce(a.offsetX,a.offsetY);n.zoomToPoint(m,h),a.preventDefault(),a.stopPropagation()}),n.on("mouse:down",()=>{e().activeTool==="pan"&&(o({isPanning:!0}),n.setCursor("grabbing"),n.requestRenderAll())}),n.on("mouse:move",i=>{if(!e().isPanning)return;const a=i.e;n.relativePan(new Ce(a.movementX,a.movementY)),n.requestRenderAll()}),n.on("mouse:up",()=>{e().isPanning&&(o({isPanning:!1}),n.setCursor("grab"),n.requestRenderAll())}))},syncFromObject:n=>{n&&o({fill:n.fill||"#ffffff",stroke:n.stroke||"#111827",strokeWidth:n.strokeWidth||2,strokeStyle:n.strokeDashArray?n.strokeDashArray[0]===10?"dashed":"dotted":"solid"})},updateTextStyle:n=>{const i=e().canvas,a=e().selectedObject;!i||!a||a.type!=="textbox"||(n.fontSize&&a.set("fontSize",n.fontSize),n.fill&&a.set("fill",n.fill),n.bold!==void 0&&a.set("fontWeight",n.bold?"bold":"normal"),n.italic!==void 0&&a.set("fontStyle",n.italic?"italic":"normal"),n.underline!==void 0&&a.set("underline",n.underline),i.renderAll(),e().pushState())},clearBoard:()=>{const n=e().canvas;n&&(C2.local.clear(),n.clear(),n.backgroundColor="#FFF",n.requestRenderAll())},clearToolbar:()=>{o({selectedObject:null,showTextToolbar:!1,isEditingText:!1,hasActiveShape:!1})},setToolbar:(n,i=!1)=>{const a=n.target;a?.type==="textbox"?(o({selectedObject:a,showTextToolbar:!0,isEditingText:i}),e().syncFromObject(a)):a?.customType==="shape"||n?.selected?.length>0||a?.type=="group"||a?.type=="activeselection"||a?.type=="image"?o({selectedObject:"shape"}):o({selectedObject:null})}}),B2=(o,e,t)=>({toolbarPosition:"left",isFullScreen:!1,setToolbarPosition:n=>o({toolbarPosition:n}),toggleFullscreen:()=>{const n=document.documentElement;document.fullscreenElement?(document.exitFullscreen?.(),o({isFullScreen:!1})):(n.requestFullscreen?.(),o({isFullScreen:!0}))},zoomIn:()=>{const n=e().canvas;if(!n)return;const i=new Ce(n.width/2,n.height/2),a=Math.min(n.getZoom()*1.1,5);n.zoomToPoint(i,a),n.requestRenderAll()},zoomOut:()=>{const n=e().canvas;if(!n)return;const i=new Ce(n.width/2,n.height/2),a=Math.max(n.getZoom()/1.1,.1);n.zoomToPoint(i,a),n.requestRenderAll()},zoomFit:()=>{const n=e().canvas;if(!n)return;const i=n.getObjects().filter(K=>K.visible);if(i.length===0){const K=n.viewportTransform,ae=1;K[0]=ae,K[3]=ae,K[4]=0,K[5]=0,n.setViewportTransform(K),n.requestRenderAll();return}let a=1/0,h=1/0,p=-1/0,m=-1/0;i.forEach(K=>{const ae=K.getBoundingRect(!0,!0);a=Math.min(a,ae.left),h=Math.min(h,ae.top),p=Math.max(p,ae.left+ae.width),m=Math.max(m,ae.top+ae.height)});const _={left:a,top:h,width:p-a,height:m-h},b=20,E=n.width-b*2,I=n.height-b*2;let O=Math.min(E/_.width,I/_.height);O=Math.min(Math.max(O,.1),5);const Q=_.left+_.width/2,W=_.top+_.height/2,ee=n.viewportTransform;ee[0]=O,ee[3]=O,ee[4]=n.width/2-Q*O,ee[5]=n.height/2-W*O,n.setViewportTransform(ee),n.requestRenderAll()}}),z2=(o,e,t)=>({layers:[],clipboard:null,setLayers:n=>o({layers:n}),addLayer:(n,i)=>{const a=e().layers||[],h=n.toObject().id||Date.now();o({layers:[...a,{id:h,type:i,object:n,name:i,visible:!0,locked:!1}]}),e().canvas?.requestRenderAll()},renameLayer:(n,i)=>{const a=e().layers.map(h=>(h.id===n&&(h.name=i),h));o({layers:a})},removeLayer:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObjects();if(!i||i.length===0)return;const a=e().layers.filter(h=>!i.includes(h.object));o({layers:a}),i.forEach(h=>n.remove(h)),n.discardActiveObject(),n.requestRenderAll()},toggleVisibility:n=>{const i=e().layers.map(a=>(a.id===n&&(a.visible=!a.visible,a.object&&(a.object.visible=a.visible)),a));o({layers:i}),e().canvas?.requestRenderAll()},duplicateLayer:n=>{const i=e().layers.find(a=>a.id===n);i?.object&&i.object.clone(a=>{a.set({left:i.object.left+10,top:i.object.top+10,id:Date.now()}),e().canvas.add(a),e().canvas.setActiveObject(a),e().canvas.requestRenderAll();const h=e().layers;o({layers:[...h,{id:a.id,type:i.type,name:i.name+"_copy",object:a}]})})},toggleLayerLock:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObject();if(!i)return;const a=e().layers.map(h=>{if(h.object===i){const p=!h.locked;return i.selectable=!p,i.evented=!p,{...h,locked:p}}return h});console.log(e().layers),o({layers:a})},isActiveObjectLocked:()=>e().selectedObject?._locked===!0,toggleActiveObjectLock:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObject();if(!i)return;!i._locked?(i.lockMovementX=!0,i.lockMovementY=!0,i.lockScalingX=!0,i.lockScalingY=!0,i.lockRotation=!0,i.hasControls=!1,i._locked=!0):(i.lockMovementX=!1,i.lockMovementY=!1,i.lockScalingX=!1,i.lockScalingY=!1,i.lockRotation=!1,i.hasControls=!0,i._locked=!1),n.renderAll()},bringForward:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObjects();i.length&&(i.forEach(a=>{if(a.type!=="activeselection"){const h=n.getObjects().indexOf(a);n.moveObjectTo(a,h+1)}}),n.requestRenderAll())},sendBackward:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObjects();i.length&&(i.forEach(a=>{if(a.type!=="activeselection"){const h=n.getObjects().indexOf(a);n.moveObjectTo(a,Math.max(0,h-1))}}),n.requestRenderAll())},bringToFront:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObjects();i.length&&(i.forEach(a=>{a.type!=="activeselection"&&n.moveObjectTo(a,n.getObjects().length-1)}),n.requestRenderAll())},sendToBack:()=>{const n=e().canvas;!n||![...n.getActiveObjects()].length||(n.getActiveObjects().forEach(a=>{a.type!=="activeselection"&&n.moveObjectTo(a,0)}),n.requestRenderAll())},deleteObject:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObjects();i&&(i.forEach(a=>n.remove(a)),n.discardActiveObject(),n.requestRenderAll())},groupLayers:n=>{const i=e().canvas;if(!i)return;const a=i.getActiveObjects();e().deleteObject();const h=new er(a);i.add(h),i.requestRenderAll()},ungroupSelected:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObject();i&&(n.remove(i),n.add(...i.removeAll()),n.requestRenderAll())},groupLayers1:n=>{const i=e(),a="group-"+Date.now(),h={id:a,name:"Group",visible:!0,locked:!1,parentId:null},p=i.layers.map(m=>n.includes(m.id)?{...m,parentId:a}:m);o({layers:[...p,h]})},ungroupLayers1:n=>{const a=e().layers.map(h=>n.includes(h.id)&&h.children?.length?null:n.includes(h.parentId)?{...h,parentId:null}:h).filter(Boolean);o({layers:a})},alignLayers:(n,i)=>{const a=e();if(!i.length)return;const h=a.layers.filter(_=>i.includes(_.id));let p;switch(n){case"left":p=Math.min(...h.map(_=>_.x||0));break;case"center":p=Math.round(h.reduce((_,b)=>_+(b.x||0),0)/h.length);break;case"right":p=Math.max(...h.map(_=>(_.x||0)+(_.width||0)));break;default:return}const m=a.layers.map(_=>i.includes(_.id)?{..._,x:n==="right"?p-(_.width||0):p}:_);o({layers:m})},distributeLayers:(n,i)=>{const a=e(),h=a.layers.filter(p=>i.includes(p.id));if(!(h.length<3)){if(n==="horizontal"){const p=h.sort((I,O)=>(I.x||0)-(O.x||0)),m=p[0].x||0,b=((p[p.length-1].x||0)-m)/(p.length-1),E=a.layers.map(I=>{const O=p.findIndex(Q=>Q.id===I.id);return O>=0?{...I,x:m+b*O}:I});o({layers:E})}if(n==="vertical"){const p=h.sort((I,O)=>(I.y||0)-(O.y||0)),m=p[0].y||0,b=((p[p.length-1].y||0)-m)/(p.length-1),E=a.layers.map(I=>{const O=p.findIndex(Q=>Q.id===I.id);return O>=0?{...I,y:m+b*O}:I});o({layers:E})}}},copy:()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObject();i&&i.clone().then(a=>{o({clipboard:a})})},paste:async()=>{const n=e().canvas,i=e().clipboard;if(!n||!i)return;const a=await i.clone();n.discardActiveObject(),a.set({left:a.left+10,top:a.top+10,evented:!0,customType:"shape"}),a.type==="activeSelection"?(a.canvas=n,a.forEachObject(h=>n.add(h)),a.setCoords()):n.add(a),o({clipboard:a}),n.setActiveObject(a),n.requestRenderAll()},duplicate:async()=>{const n=e().canvas;if(!n)return;const i=n.getActiveObject();if(!i)return;const a=await i.clone();n.discardActiveObject(),a.set({left:a.left+10,top:a.top+10,evented:!0}),console.log(a.type),a.type==="activeselection"?(a.canvas=n,a.forEachObject(h=>n.add(h)),a.setCoords()):n.add(a),o({clipboard:a}),n.setActiveObject(a),n.requestRenderAll()},alignObjects:n=>{const i=e().canvas;if(!i)return;const a=i.getActiveObjects();if(!a||a.length<2)return;const h=a.map(W=>({o:W,box:W.getBoundingRect(!0,!0)})),p=Math.min(...h.map(W=>W.box.left)),m=Math.max(...h.map(W=>W.box.left+W.box.width)),_=Math.min(...h.map(W=>W.box.top)),b=Math.max(...h.map(W=>W.box.top+W.box.height)),E=m-p,I=b-_,O=(W,ee)=>{const K=W-ee.box.left;ee.o.set({left:ee.o.left+K})},Q=(W,ee)=>{const K=W-ee.box.top;ee.o.set({top:ee.o.top+K})};switch(console.log("key..",n),n){case"align-left":h.forEach(W=>O(p,W));break;case"align-hcenter":{const W=p+E/2;h.forEach(ee=>{const K=W-ee.box.width/2;O(K,ee)});break}case"align-right":h.forEach(W=>{const ee=m-W.box.width;O(ee,W)});break;case"align-top":h.forEach(W=>Q(_,W));break;case"align-vcenter":{const W=_+I/2;h.forEach(ee=>{const K=W-ee.box.height/2;Q(K,ee)});break}case"align-bottom":h.forEach(W=>{const ee=b-W.box.height;Q(ee,W)});break;case"distribute-h":{const W=[...h].sort((le,ge)=>le.box.left-ge.box.left);if(W.length<3)break;const ee=W[0].box.left+W[0].box.width/2,ae=(W[W.length-1].box.left+W[W.length-1].box.width/2-ee)/(W.length-1);W.forEach((le,ge)=>{const F=ee+ae*ge-le.box.width/2;O(F,le)});break}case"distribute-v":{const W=[...h].sort((le,ge)=>le.box.top-ge.box.top);if(W.length<3)break;const ee=W[0].box.top+W[0].box.height/2,ae=(W[W.length-1].box.top+W[W.length-1].box.height/2-ee)/(W.length-1);W.forEach((le,ge)=>{const F=ee+ae*ge-le.box.height/2;Q(F,le)});break}}a.forEach(W=>W.setCoords()),i.requestRenderAll()},distributeObjects:n=>{const{canvas:i}=e();if(!i)return;const a=i.getActiveObjects();if(a.length<3)return;n==="horizontal"?a.sort((m,_)=>m.left-_.left):a.sort((m,_)=>m.top-_.top);const h=a[0],p=a[a.length-1];if(n==="horizontal"){const _=(p.left-h.left-(h.getScaledWidth()+p.getScaledWidth())/2)/(a.length-1);a.forEach((b,E)=>{E!==0&&E!==a.length-1&&(b.set({left:h.left+E*_}),b.setCoords())})}else{const _=(p.top-h.top-(h.getScaledHeight()+p.getScaledHeight())/2)/(a.length-1);a.forEach((b,E)=>{E!==0&&E!==a.length-1&&(b.set({top:h.top+E*_}),b.setCoords())})}i.requestRenderAll()},canPaste(){return!!this.clipboard},isGroupSelected(){const n=e().canvas?.getActiveObject();return n?n.type==="group"||Array.isArray(n._objects):!1}}),V2=(o,e,t)=>({pageFormat:"Freehand",orientation:"landscape",zoom:1,scale:1,setPageFormat:(n,i="portrait")=>{o({pageFormat:n,orientation:i}),e().applyPageSize(n,i)},setOrientation:n=>{o({orientation:n}),e().applyPageSize(e().pageFormat,n)},setZoom:n=>{const i=e().canvas;i&&(i.setZoom(n),o({zoom:n}),e().drawBackground(),i.renderAll())},applyPageSize:(n=e().pageFormat,i=e().orientation)=>{const a=e().canvas;if(!a)return;if(String(n||"").toLowerCase()==="freehand"){a.setWidth(window.innerWidth*2),a.setHeight(window.innerHeight*2),a.setZoom(1),a.calcOffset(),a.renderAll(),o({scale:1,pageWidth:a.getWidth(),pageHeight:a.getHeight()});return}const{w:p,h:m}=I2[n],_=i==="portrait"?p:m,b=i==="portrait"?m:p,I=800/_;a.setWidth(_*I),a.setHeight(b*I),a.setZoom(I),a.calcOffset(),a.renderAll(),o({scale:I,pageWidth:_,pageHeight:b}),e().drawBackground()}}),_h=()=>Zb,W2=({get:o})=>{const e=_h(),t=Math.max(2,o().gridSize),n=Math.max(1,o().gridMajorEvery),i=t*n,a=document.createElement("canvas");a.width=a.height=i;const h=a.getContext("2d");if(!h)return null;const p=(m,_,b,E,I,O)=>{h.beginPath(),h.moveTo(m+.5,_+.5),h.lineTo(b+.5,E+.5),h.lineWidth=I,h.strokeStyle=O,h.stroke()};for(let m=1;m<n;m++){const _=m*t;p(_,0,_,i,o().gridLineWidth,o().gridColor),p(0,_,i,_,o().gridLineWidth,o().gridColor)}return p(i-1,0,i-1,i,o().gridMajorLineWidth,o().gridMajorColor),p(0,i-1,i,i-1,o().gridMajorLineWidth,o().gridMajorColor),new e.Pattern({source:a,repeat:"repeat"})},U2=({get:o})=>{const e=_h(),t=Math.max(2,o().ruledLineHeight),n=document.createElement("canvas");n.width=2,n.height=t;const i=n.getContext("2d");return i?(i.beginPath(),i.moveTo(0,t-1+.5),i.lineTo(n.width,t-1+.5),i.lineWidth=o().ruledLineWidth,i.strokeStyle=o().ruledColor,i.stroke(),new e.Pattern({source:n,repeat:"repeat"})):null},H2=({get:o})=>{const e=_h(),t=Math.max(6,o().gridSize),n=document.createElement("canvas");n.width=n.height=t;const i=n.getContext("2d");return i?(i.beginPath(),i.arc(1,1,1,0,Math.PI*2),i.fillStyle=o().gridColor,i.fill(),new e.Pattern({source:n,repeat:"repeat"})):null},X2=({get:o})=>{const e=_h(),t=Math.max(16,o().gridSize*2),n=document.createElement("canvas");n.width=n.height=t;const i=n.getContext("2d");return i?(i.strokeStyle=o().gridColor,i.lineWidth=1,i.beginPath(),i.moveTo(0,t),i.lineTo(t/2,0),i.lineTo(t,t),i.stroke(),new e.Pattern({source:n,repeat:"repeat"})):null},G2={none:null,grid:W2,ruled:U2,dots:H2,isometric:X2},Y2=(o,e,t)=>({backgroundStyle:"none",gridSize:20,gridColor:"#e0e0e0",gridMajorEvery:5,gridMajorColor:"#bdbdbd",gridLineWidth:1,gridMajorLineWidth:1,ruledLineHeight:24,ruledColor:"#c0d6ff",ruledLineWidth:1,setBackgroundStyle:n=>{o({backgroundStyle:n}),e().drawBackground()},toggleGrid:()=>{const n=e().backgroundStyle==="grid"?"none":"grid";o({backgroundStyle:n}),e().drawBackground()},setGridOptions:n=>{o(n),e().drawBackground()},setRuledOptions:n=>{o(n),e().drawBackground()},drawBackground:()=>{const n=e().canvas;if(!n)return;const i=e().backgroundStyle,a=G2[i];if(!a){n.backgroundColor=null,n.requestRenderAll();return}const h=a({get:e});n.backgroundColor=h||null,n.requestRenderAll()}}),q2=[{id:"newfile",description:"New File",shortcut:["Meta+n","Ctrl+n"],handler:({get:o,set:e})=>{const{clearBoard:t}=o();t()}},{id:"copy",description:"Copy selected object",shortcut:["Meta+c","Ctrl+c"],handler:({get:o,set:e})=>{const{copy:t}=o();t()}},{id:"paste",description:"Paste object",shortcut:["Meta+v","Ctrl+v"],handler:({get:o,set:e})=>{const{paste:t}=o();t()}},{id:"duplicate",description:"Duplicate object",shortcut:["Meta+D","Ctrl+D"],handler:({get:o,set:e})=>{const{duplicate:t}=o();t()}},{id:"delete",description:"Delete selected object",shortcut:["Delete","Backspace"],handler:({get:o,set:e})=>{const{removeLayer:t}=o();t()}},{id:"group",description:"Group selected object",shortcut:["Meta+G","Ctrl+G"],handler:({get:o,set:e})=>{const{groupLayers:t}=o();t()}},{id:"ungroup",description:"Ungroup selected object",shortcut:["Meta+Shift+U","Ctrl+Shift+U"],handler:({get:o,set:e})=>{const{ungroupSelected:t}=o();t()}},{id:"undo",description:"Undo",shortcut:["Meta+Z","Ctrl+Z"],handler:({get:o,set:e})=>{const{undo:t}=o();t()}},{id:"redo",description:"Redo",shortcut:["Meta+Shift+Z","Ctrl+Y"],handler:({get:o,set:e})=>{const{redo:t}=o();t()}}],K2=(o,e,t)=>({commands:q2.map(i=>({...i,handler:()=>i.handler({get:e,set:o})})),runCommand:i=>{const a=e().commands.find(h=>h.id===i);a&&a.handler()}}),Z2=(o,e,t)=>({brush:"pencil",width:4,color:"#000",cursor:"crosshair",setBrush:(n={})=>{const i=e().canvas;if(!i)return;const a={pencil:()=>new Wa(i),circle:()=>new Sy(i),spray:()=>new Cy(i),pattern:()=>new ky(i),eraser:()=>new(void 0)(i)},h=n?.brush??e().brush,p=a[h]?a[h]():a.pencil(),m=n?.color??e().color,_=n?.width??e().width,b=n.cursor??"url('/pencil.svg') 0 32, crosshair";p.color=m,p.width=_,i.freeDrawingBrush=p,i.freeDrawingCursor=b,o({brush:h,color:m,width:_,cursor:b}),i.renderAll()},setBrushWidth:(n={})=>{const i=e().canvas;if(!i)return;console.log(n);const a=n?.width??e().width;i.freeDrawingBrush.width=a,o({width:a})},setBrushColor:(n={})=>{const i=e().canvas;if(!i)return;console.log(n);const a=n?.color??e().color;i.freeDrawingBrush.color=a,o({color:a})}});var qy={inherit:"inherit",current:"currentcolor",transparent:"transparent",black:"#000",white:"#fff",slate:{50:"oklch(98.4% 0.003 247.858)",100:"oklch(96.8% 0.007 247.896)",200:"oklch(92.9% 0.013 255.508)",300:"oklch(86.9% 0.022 252.894)",400:"oklch(70.4% 0.04 256.788)",500:"oklch(55.4% 0.046 257.417)",600:"oklch(44.6% 0.043 257.281)",700:"oklch(37.2% 0.044 257.287)",800:"oklch(27.9% 0.041 260.031)",900:"oklch(20.8% 0.042 265.755)",950:"oklch(12.9% 0.042 264.695)"},gray:{50:"oklch(98.5% 0.002 247.839)",100:"oklch(96.7% 0.003 264.542)",200:"oklch(92.8% 0.006 264.531)",300:"oklch(87.2% 0.01 258.338)",400:"oklch(70.7% 0.022 261.325)",500:"oklch(55.1% 0.027 264.364)",600:"oklch(44.6% 0.03 256.802)",700:"oklch(37.3% 0.034 259.733)",800:"oklch(27.8% 0.033 256.848)",900:"oklch(21% 0.034 264.665)",950:"oklch(13% 0.028 261.692)"},zinc:{50:"oklch(98.5% 0 0)",100:"oklch(96.7% 0.001 286.375)",200:"oklch(92% 0.004 286.32)",300:"oklch(87.1% 0.006 286.286)",400:"oklch(70.5% 0.015 286.067)",500:"oklch(55.2% 0.016 285.938)",600:"oklch(44.2% 0.017 285.786)",700:"oklch(37% 0.013 285.805)",800:"oklch(27.4% 0.006 286.033)",900:"oklch(21% 0.006 285.885)",950:"oklch(14.1% 0.005 285.823)"},neutral:{50:"oklch(98.5% 0 0)",100:"oklch(97% 0 0)",200:"oklch(92.2% 0 0)",300:"oklch(87% 0 0)",400:"oklch(70.8% 0 0)",500:"oklch(55.6% 0 0)",600:"oklch(43.9% 0 0)",700:"oklch(37.1% 0 0)",800:"oklch(26.9% 0 0)",900:"oklch(20.5% 0 0)",950:"oklch(14.5% 0 0)"},stone:{50:"oklch(98.5% 0.001 106.423)",100:"oklch(97% 0.001 106.424)",200:"oklch(92.3% 0.003 48.717)",300:"oklch(86.9% 0.005 56.366)",400:"oklch(70.9% 0.01 56.259)",500:"oklch(55.3% 0.013 58.071)",600:"oklch(44.4% 0.011 73.639)",700:"oklch(37.4% 0.01 67.558)",800:"oklch(26.8% 0.007 34.298)",900:"oklch(21.6% 0.006 56.043)",950:"oklch(14.7% 0.004 49.25)"},red:{50:"oklch(97.1% 0.013 17.38)",100:"oklch(93.6% 0.032 17.717)",200:"oklch(88.5% 0.062 18.334)",300:"oklch(80.8% 0.114 19.571)",400:"oklch(70.4% 0.191 22.216)",500:"oklch(63.7% 0.237 25.331)",600:"oklch(57.7% 0.245 27.325)",700:"oklch(50.5% 0.213 27.518)",800:"oklch(44.4% 0.177 26.899)",900:"oklch(39.6% 0.141 25.723)",950:"oklch(25.8% 0.092 26.042)"},orange:{50:"oklch(98% 0.016 73.684)",100:"oklch(95.4% 0.038 75.164)",200:"oklch(90.1% 0.076 70.697)",300:"oklch(83.7% 0.128 66.29)",400:"oklch(75% 0.183 55.934)",500:"oklch(70.5% 0.213 47.604)",600:"oklch(64.6% 0.222 41.116)",700:"oklch(55.3% 0.195 38.402)",800:"oklch(47% 0.157 37.304)",900:"oklch(40.8% 0.123 38.172)",950:"oklch(26.6% 0.079 36.259)"},amber:{50:"oklch(98.7% 0.022 95.277)",100:"oklch(96.2% 0.059 95.617)",200:"oklch(92.4% 0.12 95.746)",300:"oklch(87.9% 0.169 91.605)",400:"oklch(82.8% 0.189 84.429)",500:"oklch(76.9% 0.188 70.08)",600:"oklch(66.6% 0.179 58.318)",700:"oklch(55.5% 0.163 48.998)",800:"oklch(47.3% 0.137 46.201)",900:"oklch(41.4% 0.112 45.904)",950:"oklch(27.9% 0.077 45.635)"},yellow:{50:"oklch(98.7% 0.026 102.212)",100:"oklch(97.3% 0.071 103.193)",200:"oklch(94.5% 0.129 101.54)",300:"oklch(90.5% 0.182 98.111)",400:"oklch(85.2% 0.199 91.936)",500:"oklch(79.5% 0.184 86.047)",600:"oklch(68.1% 0.162 75.834)",700:"oklch(55.4% 0.135 66.442)",800:"oklch(47.6% 0.114 61.907)",900:"oklch(42.1% 0.095 57.708)",950:"oklch(28.6% 0.066 53.813)"},lime:{50:"oklch(98.6% 0.031 120.757)",100:"oklch(96.7% 0.067 122.328)",200:"oklch(93.8% 0.127 124.321)",300:"oklch(89.7% 0.196 126.665)",400:"oklch(84.1% 0.238 128.85)",500:"oklch(76.8% 0.233 130.85)",600:"oklch(64.8% 0.2 131.684)",700:"oklch(53.2% 0.157 131.589)",800:"oklch(45.3% 0.124 130.933)",900:"oklch(40.5% 0.101 131.063)",950:"oklch(27.4% 0.072 132.109)"},green:{50:"oklch(98.2% 0.018 155.826)",100:"oklch(96.2% 0.044 156.743)",200:"oklch(92.5% 0.084 155.995)",300:"oklch(87.1% 0.15 154.449)",400:"oklch(79.2% 0.209 151.711)",500:"oklch(72.3% 0.219 149.579)",600:"oklch(62.7% 0.194 149.214)",700:"oklch(52.7% 0.154 150.069)",800:"oklch(44.8% 0.119 151.328)",900:"oklch(39.3% 0.095 152.535)",950:"oklch(26.6% 0.065 152.934)"},emerald:{50:"oklch(97.9% 0.021 166.113)",100:"oklch(95% 0.052 163.051)",200:"oklch(90.5% 0.093 164.15)",300:"oklch(84.5% 0.143 164.978)",400:"oklch(76.5% 0.177 163.223)",500:"oklch(69.6% 0.17 162.48)",600:"oklch(59.6% 0.145 163.225)",700:"oklch(50.8% 0.118 165.612)",800:"oklch(43.2% 0.095 166.913)",900:"oklch(37.8% 0.077 168.94)",950:"oklch(26.2% 0.051 172.552)"},teal:{50:"oklch(98.4% 0.014 180.72)",100:"oklch(95.3% 0.051 180.801)",200:"oklch(91% 0.096 180.426)",300:"oklch(85.5% 0.138 181.071)",400:"oklch(77.7% 0.152 181.912)",500:"oklch(70.4% 0.14 182.503)",600:"oklch(60% 0.118 184.704)",700:"oklch(51.1% 0.096 186.391)",800:"oklch(43.7% 0.078 188.216)",900:"oklch(38.6% 0.063 188.416)",950:"oklch(27.7% 0.046 192.524)"},cyan:{50:"oklch(98.4% 0.019 200.873)",100:"oklch(95.6% 0.045 203.388)",200:"oklch(91.7% 0.08 205.041)",300:"oklch(86.5% 0.127 207.078)",400:"oklch(78.9% 0.154 211.53)",500:"oklch(71.5% 0.143 215.221)",600:"oklch(60.9% 0.126 221.723)",700:"oklch(52% 0.105 223.128)",800:"oklch(45% 0.085 224.283)",900:"oklch(39.8% 0.07 227.392)",950:"oklch(30.2% 0.056 229.695)"},sky:{50:"oklch(97.7% 0.013 236.62)",100:"oklch(95.1% 0.026 236.824)",200:"oklch(90.1% 0.058 230.902)",300:"oklch(82.8% 0.111 230.318)",400:"oklch(74.6% 0.16 232.661)",500:"oklch(68.5% 0.169 237.323)",600:"oklch(58.8% 0.158 241.966)",700:"oklch(50% 0.134 242.749)",800:"oklch(44.3% 0.11 240.79)",900:"oklch(39.1% 0.09 240.876)",950:"oklch(29.3% 0.066 243.157)"},blue:{50:"oklch(97% 0.014 254.604)",100:"oklch(93.2% 0.032 255.585)",200:"oklch(88.2% 0.059 254.128)",300:"oklch(80.9% 0.105 251.813)",400:"oklch(70.7% 0.165 254.624)",500:"oklch(62.3% 0.214 259.815)",600:"oklch(54.6% 0.245 262.881)",700:"oklch(48.8% 0.243 264.376)",800:"oklch(42.4% 0.199 265.638)",900:"oklch(37.9% 0.146 265.522)",950:"oklch(28.2% 0.091 267.935)"},indigo:{50:"oklch(96.2% 0.018 272.314)",100:"oklch(93% 0.034 272.788)",200:"oklch(87% 0.065 274.039)",300:"oklch(78.5% 0.115 274.713)",400:"oklch(67.3% 0.182 276.935)",500:"oklch(58.5% 0.233 277.117)",600:"oklch(51.1% 0.262 276.966)",700:"oklch(45.7% 0.24 277.023)",800:"oklch(39.8% 0.195 277.366)",900:"oklch(35.9% 0.144 278.697)",950:"oklch(25.7% 0.09 281.288)"},violet:{50:"oklch(96.9% 0.016 293.756)",100:"oklch(94.3% 0.029 294.588)",200:"oklch(89.4% 0.057 293.283)",300:"oklch(81.1% 0.111 293.571)",400:"oklch(70.2% 0.183 293.541)",500:"oklch(60.6% 0.25 292.717)",600:"oklch(54.1% 0.281 293.009)",700:"oklch(49.1% 0.27 292.581)",800:"oklch(43.2% 0.232 292.759)",900:"oklch(38% 0.189 293.745)",950:"oklch(28.3% 0.141 291.089)"},purple:{50:"oklch(97.7% 0.014 308.299)",100:"oklch(94.6% 0.033 307.174)",200:"oklch(90.2% 0.063 306.703)",300:"oklch(82.7% 0.119 306.383)",400:"oklch(71.4% 0.203 305.504)",500:"oklch(62.7% 0.265 303.9)",600:"oklch(55.8% 0.288 302.321)",700:"oklch(49.6% 0.265 301.924)",800:"oklch(43.8% 0.218 303.724)",900:"oklch(38.1% 0.176 304.987)",950:"oklch(29.1% 0.149 302.717)"},fuchsia:{50:"oklch(97.7% 0.017 320.058)",100:"oklch(95.2% 0.037 318.852)",200:"oklch(90.3% 0.076 319.62)",300:"oklch(83.3% 0.145 321.434)",400:"oklch(74% 0.238 322.16)",500:"oklch(66.7% 0.295 322.15)",600:"oklch(59.1% 0.293 322.896)",700:"oklch(51.8% 0.253 323.949)",800:"oklch(45.2% 0.211 324.591)",900:"oklch(40.1% 0.17 325.612)",950:"oklch(29.3% 0.136 325.661)"},pink:{50:"oklch(97.1% 0.014 343.198)",100:"oklch(94.8% 0.028 342.258)",200:"oklch(89.9% 0.061 343.231)",300:"oklch(82.3% 0.12 346.018)",400:"oklch(71.8% 0.202 349.761)",500:"oklch(65.6% 0.241 354.308)",600:"oklch(59.2% 0.249 0.584)",700:"oklch(52.5% 0.223 3.958)",800:"oklch(45.9% 0.187 3.815)",900:"oklch(40.8% 0.153 2.432)",950:"oklch(28.4% 0.109 3.907)"},rose:{50:"oklch(96.9% 0.015 12.422)",100:"oklch(94.1% 0.03 12.58)",200:"oklch(89.2% 0.058 10.001)",300:"oklch(81% 0.117 11.638)",400:"oklch(71.2% 0.194 13.428)",500:"oklch(64.5% 0.246 16.439)",600:"oklch(58.6% 0.253 17.585)",700:"oklch(51.4% 0.222 16.935)",800:"oklch(45.5% 0.188 13.697)",900:"oklch(41% 0.159 10.272)",950:"oklch(27.1% 0.105 12.094)"}};function Q2(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fc={exports:{}};const J2={},$2=Object.freeze(Object.defineProperty({__proto__:null,default:J2},Symbol.toStringTag,{value:"Module"})),Sm=X_($2);var Vl={exports:{}},eS=Vl.exports,Cm;function tS(){return Cm||(Cm=1,(function(o,e){(function(t,n){n(e)})(eS,(function(t){var n=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],i=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],a="-----------------------------------------------------------------------------------------------------------------------------------------------------",h="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",p={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},m="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",_={5:m,"5module":m+" export import",6:m+" const class extends export import super"},b=/^in(stanceof)?$/,E=new RegExp("["+h+"]"),I=new RegExp("["+h+a+"]");function O(c,x){for(var R=65536,G=0;G<x.length;G+=2){if(R+=x[G],R>c)return!1;if(R+=x[G+1],R>=c)return!0}return!1}function Q(c,x){return c<65?c===36:c<91?!0:c<97?c===95:c<123?!0:c<=65535?c>=170&&E.test(String.fromCharCode(c)):x===!1?!1:O(c,i)}function W(c,x){return c<48?c===36:c<58?!0:c<65?!1:c<91?!0:c<97?c===95:c<123?!0:c<=65535?c>=170&&I.test(String.fromCharCode(c)):x===!1?!1:O(c,i)||O(c,n)}var ee=function(x,R){R===void 0&&(R={}),this.label=x,this.keyword=R.keyword,this.beforeExpr=!!R.beforeExpr,this.startsExpr=!!R.startsExpr,this.isLoop=!!R.isLoop,this.isAssign=!!R.isAssign,this.prefix=!!R.prefix,this.postfix=!!R.postfix,this.binop=R.binop||null,this.updateContext=null};function K(c,x){return new ee(c,{beforeExpr:!0,binop:x})}var ae={beforeExpr:!0},le={startsExpr:!0},ge={};function xe(c,x){return x===void 0&&(x={}),x.keyword=c,ge[c]=new ee(c,x)}var F={num:new ee("num",le),regexp:new ee("regexp",le),string:new ee("string",le),name:new ee("name",le),privateId:new ee("privateId",le),eof:new ee("eof"),bracketL:new ee("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ee("]"),braceL:new ee("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ee("}"),parenL:new ee("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ee(")"),comma:new ee(",",ae),semi:new ee(";",ae),colon:new ee(":",ae),dot:new ee("."),question:new ee("?",ae),questionDot:new ee("?."),arrow:new ee("=>",ae),template:new ee("template"),invalidTemplate:new ee("invalidTemplate"),ellipsis:new ee("...",ae),backQuote:new ee("`",le),dollarBraceL:new ee("${",{beforeExpr:!0,startsExpr:!0}),eq:new ee("=",{beforeExpr:!0,isAssign:!0}),assign:new ee("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ee("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ee("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:K("||",1),logicalAND:K("&&",2),bitwiseOR:K("|",3),bitwiseXOR:K("^",4),bitwiseAND:K("&",5),equality:K("==/!=/===/!==",6),relational:K("</>/<=/>=",7),bitShift:K("<</>>/>>>",8),plusMin:new ee("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:K("%",10),star:K("*",10),slash:K("/",10),starstar:new ee("**",{beforeExpr:!0}),coalesce:K("??",1),_break:xe("break"),_case:xe("case",ae),_catch:xe("catch"),_continue:xe("continue"),_debugger:xe("debugger"),_default:xe("default",ae),_do:xe("do",{isLoop:!0,beforeExpr:!0}),_else:xe("else",ae),_finally:xe("finally"),_for:xe("for",{isLoop:!0}),_function:xe("function",le),_if:xe("if"),_return:xe("return",ae),_switch:xe("switch"),_throw:xe("throw",ae),_try:xe("try"),_var:xe("var"),_const:xe("const"),_while:xe("while",{isLoop:!0}),_with:xe("with"),_new:xe("new",{beforeExpr:!0,startsExpr:!0}),_this:xe("this",le),_super:xe("super",le),_class:xe("class",le),_extends:xe("extends",ae),_export:xe("export"),_import:xe("import",le),_null:xe("null",le),_true:xe("true",le),_false:xe("false",le),_in:xe("in",{beforeExpr:!0,binop:7}),_instanceof:xe("instanceof",{beforeExpr:!0,binop:7}),_typeof:xe("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:xe("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:xe("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Ne=/\r\n?|\n|\u2028|\u2029/,Ve=new RegExp(Ne.source,"g");function qe(c){return c===10||c===13||c===8232||c===8233}function ot(c,x,R){R===void 0&&(R=c.length);for(var G=x;G<R;G++){var re=c.charCodeAt(G);if(qe(re))return G<R-1&&re===13&&c.charCodeAt(G+1)===10?G+2:G+1}return-1}var je=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ze=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,dt=Object.prototype,We=dt.hasOwnProperty,Bt=dt.toString,Le=Object.hasOwn||(function(c,x){return We.call(c,x)}),wt=Array.isArray||(function(c){return Bt.call(c)==="[object Array]"}),ze=Object.create(null);function Xe(c){return ze[c]||(ze[c]=new RegExp("^(?:"+c.replace(/ /g,"|")+")$"))}function Qe(c){return c<=65535?String.fromCharCode(c):(c-=65536,String.fromCharCode((c>>10)+55296,(c&1023)+56320))}var be=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Fe=function(x,R){this.line=x,this.column=R};Fe.prototype.offset=function(x){return new Fe(this.line,this.column+x)};var yt=function(x,R,G){this.start=R,this.end=G,x.sourceFile!==null&&(this.source=x.sourceFile)};function Ct(c,x){for(var R=1,G=0;;){var re=ot(c,G,x);if(re<0)return new Fe(R,x-G);++R,G=re}}var pt={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Mt=!1;function zt(c){var x={};for(var R in pt)x[R]=c&&Le(c,R)?c[R]:pt[R];if(x.ecmaVersion==="latest"?x.ecmaVersion=1e8:x.ecmaVersion==null?(!Mt&&typeof console=="object"&&console.warn&&(Mt=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),x.ecmaVersion=11):x.ecmaVersion>=2015&&(x.ecmaVersion-=2009),x.allowReserved==null&&(x.allowReserved=x.ecmaVersion<5),(!c||c.allowHashBang==null)&&(x.allowHashBang=x.ecmaVersion>=14),wt(x.onToken)){var G=x.onToken;x.onToken=function(re){return G.push(re)}}return wt(x.onComment)&&(x.onComment=Ut(x,x.onComment)),x}function Ut(c,x){return function(R,G,re,Se,Oe,Ge){var rt={type:R?"Block":"Line",value:G,start:re,end:Se};c.locations&&(rt.loc=new yt(this,Oe,Ge)),c.ranges&&(rt.range=[re,Se]),x.push(rt)}}var _t=1,At=2,en=4,la=8,Rr=16,Os=32,Di=64,ua=128,Nr=256,Ri=512,Ni=_t|At|Nr;function qr(c,x){return At|(c?en:0)|(x?la:0)}var tn=0,pi=1,Gt=2,Ps=3,Nt=4,r=5,u=function(x,R,G){this.options=x=zt(x),this.sourceFile=x.sourceFile,this.keywords=Xe(_[x.ecmaVersion>=6?6:x.sourceType==="module"?"5module":5]);var re="";x.allowReserved!==!0&&(re=p[x.ecmaVersion>=6?6:x.ecmaVersion===5?5:3],x.sourceType==="module"&&(re+=" await")),this.reservedWords=Xe(re);var Se=(re?re+" ":"")+p.strict;this.reservedWordsStrict=Xe(Se),this.reservedWordsStrictBind=Xe(Se+" "+p.strictBind),this.input=String(R),this.containsEsc=!1,G?(this.pos=G,this.lineStart=this.input.lastIndexOf(`
`,G-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Ne).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=F.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=x.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&x.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(_t),this.regexpState=null,this.privateNameStack=[]},f={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};u.prototype.parse=function(){var x=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(x)},f.inFunction.get=function(){return(this.currentVarScope().flags&At)>0},f.inGenerator.get=function(){return(this.currentVarScope().flags&la)>0},f.inAsync.get=function(){return(this.currentVarScope().flags&en)>0},f.canAwait.get=function(){for(var c=this.scopeStack.length-1;c>=0;c--){var x=this.scopeStack[c],R=x.flags;if(R&(Nr|Ri))return!1;if(R&At)return(R&en)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},f.allowSuper.get=function(){var c=this.currentThisScope(),x=c.flags;return(x&Di)>0||this.options.allowSuperOutsideMethod},f.allowDirectSuper.get=function(){return(this.currentThisScope().flags&ua)>0},f.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},f.allowNewDotTarget.get=function(){for(var c=this.scopeStack.length-1;c>=0;c--){var x=this.scopeStack[c],R=x.flags;if(R&(Nr|Ri)||R&At&&!(R&Rr))return!0}return!1},f.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Nr)>0},u.extend=function(){for(var x=[],R=arguments.length;R--;)x[R]=arguments[R];for(var G=this,re=0;re<x.length;re++)G=x[re](G);return G},u.parse=function(x,R){return new this(R,x).parse()},u.parseExpressionAt=function(x,R,G){var re=new this(G,x,R);return re.nextToken(),re.parseExpression()},u.tokenizer=function(x,R){return new this(R,x)},Object.defineProperties(u.prototype,f);var g=u.prototype,v=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;g.strictDirective=function(c){if(this.options.ecmaVersion<5)return!1;for(;;){Ze.lastIndex=c,c+=Ze.exec(this.input)[0].length;var x=v.exec(this.input.slice(c));if(!x)return!1;if((x[1]||x[2])==="use strict"){Ze.lastIndex=c+x[0].length;var R=Ze.exec(this.input),G=R.index+R[0].length,re=this.input.charAt(G);return re===";"||re==="}"||Ne.test(R[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(re)||re==="!"&&this.input.charAt(G+1)==="=")}c+=x[0].length,Ze.lastIndex=c,c+=Ze.exec(this.input)[0].length,this.input[c]===";"&&c++}},g.eat=function(c){return this.type===c?(this.next(),!0):!1},g.isContextual=function(c){return this.type===F.name&&this.value===c&&!this.containsEsc},g.eatContextual=function(c){return this.isContextual(c)?(this.next(),!0):!1},g.expectContextual=function(c){this.eatContextual(c)||this.unexpected()},g.canInsertSemicolon=function(){return this.type===F.eof||this.type===F.braceR||Ne.test(this.input.slice(this.lastTokEnd,this.start))},g.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},g.semicolon=function(){!this.eat(F.semi)&&!this.insertSemicolon()&&this.unexpected()},g.afterTrailingComma=function(c,x){if(this.type===c)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),x||this.next(),!0},g.expect=function(c){this.eat(c)||this.unexpected()},g.unexpected=function(c){this.raise(c??this.start,"Unexpected token")};var w=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};g.checkPatternErrors=function(c,x){if(c){c.trailingComma>-1&&this.raiseRecoverable(c.trailingComma,"Comma is not permitted after the rest element");var R=x?c.parenthesizedAssign:c.parenthesizedBind;R>-1&&this.raiseRecoverable(R,x?"Assigning to rvalue":"Parenthesized pattern")}},g.checkExpressionErrors=function(c,x){if(!c)return!1;var R=c.shorthandAssign,G=c.doubleProto;if(!x)return R>=0||G>=0;R>=0&&this.raise(R,"Shorthand property assignments are valid only in destructuring patterns"),G>=0&&this.raiseRecoverable(G,"Redefinition of __proto__ property")},g.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},g.isSimpleAssignTarget=function(c){return c.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(c.expression):c.type==="Identifier"||c.type==="MemberExpression"};var S=u.prototype;S.parseTopLevel=function(c){var x=Object.create(null);for(c.body||(c.body=[]);this.type!==F.eof;){var R=this.parseStatement(null,!0,x);c.body.push(R)}if(this.inModule)for(var G=0,re=Object.keys(this.undefinedExports);G<re.length;G+=1){var Se=re[G];this.raiseRecoverable(this.undefinedExports[Se].start,"Export '"+Se+"' is not defined")}return this.adaptDirectivePrologue(c.body),this.next(),c.sourceType=this.options.sourceType,this.finishNode(c,"Program")};var C={kind:"loop"},T={kind:"switch"};S.isLet=function(c){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ze.lastIndex=this.pos;var x=Ze.exec(this.input),R=this.pos+x[0].length,G=this.input.charCodeAt(R);if(G===91||G===92)return!0;if(c)return!1;if(G===123||G>55295&&G<56320)return!0;if(Q(G,!0)){for(var re=R+1;W(G=this.input.charCodeAt(re),!0);)++re;if(G===92||G>55295&&G<56320)return!0;var Se=this.input.slice(R,re);if(!b.test(Se))return!0}return!1},S.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ze.lastIndex=this.pos;var c=Ze.exec(this.input),x=this.pos+c[0].length,R;return!Ne.test(this.input.slice(this.pos,x))&&this.input.slice(x,x+8)==="function"&&(x+8===this.input.length||!(W(R=this.input.charCodeAt(x+8))||R>55295&&R<56320))},S.isUsingKeyword=function(c,x){if(this.options.ecmaVersion<17||!this.isContextual(c?"await":"using"))return!1;Ze.lastIndex=this.pos;var R=Ze.exec(this.input),G=this.pos+R[0].length;if(Ne.test(this.input.slice(this.pos,G)))return!1;if(c){var re=G+5,Se;if(this.input.slice(G,re)!=="using"||re===this.input.length||W(Se=this.input.charCodeAt(re))||Se>55295&&Se<56320)return!1;Ze.lastIndex=re;var Oe=Ze.exec(this.input);if(Oe&&Ne.test(this.input.slice(re,re+Oe[0].length)))return!1}if(x){var Ge=G+2,rt;if(this.input.slice(G,Ge)==="of"&&(Ge===this.input.length||!W(rt=this.input.charCodeAt(Ge))&&!(rt>55295&&rt<56320)))return!1}var Ot=this.input.charCodeAt(G);return Q(Ot,!0)||Ot===92},S.isAwaitUsing=function(c){return this.isUsingKeyword(!0,c)},S.isUsing=function(c){return this.isUsingKeyword(!1,c)},S.parseStatement=function(c,x,R){var G=this.type,re=this.startNode(),Se;switch(this.isLet(c)&&(G=F._var,Se="let"),G){case F._break:case F._continue:return this.parseBreakContinueStatement(re,G.keyword);case F._debugger:return this.parseDebuggerStatement(re);case F._do:return this.parseDoStatement(re);case F._for:return this.parseForStatement(re);case F._function:return c&&(this.strict||c!=="if"&&c!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(re,!1,!c);case F._class:return c&&this.unexpected(),this.parseClass(re,!0);case F._if:return this.parseIfStatement(re);case F._return:return this.parseReturnStatement(re);case F._switch:return this.parseSwitchStatement(re);case F._throw:return this.parseThrowStatement(re);case F._try:return this.parseTryStatement(re);case F._const:case F._var:return Se=Se||this.value,c&&Se!=="var"&&this.unexpected(),this.parseVarStatement(re,Se);case F._while:return this.parseWhileStatement(re);case F._with:return this.parseWithStatement(re);case F.braceL:return this.parseBlock(!0,re);case F.semi:return this.parseEmptyStatement(re);case F._export:case F._import:if(this.options.ecmaVersion>10&&G===F._import){Ze.lastIndex=this.pos;var Oe=Ze.exec(this.input),Ge=this.pos+Oe[0].length,rt=this.input.charCodeAt(Ge);if(rt===40||rt===46)return this.parseExpressionStatement(re,this.parseExpression())}return this.options.allowImportExportEverywhere||(x||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),G===F._import?this.parseImport(re):this.parseExport(re,R);default:if(this.isAsyncFunction())return c&&this.unexpected(),this.next(),this.parseFunctionStatement(re,!0,!c);var Ot=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(Ot)return x&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),Ot==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(re,!1,Ot),this.semicolon(),this.finishNode(re,"VariableDeclaration");var jt=this.value,Kt=this.parseExpression();return G===F.name&&Kt.type==="Identifier"&&this.eat(F.colon)?this.parseLabeledStatement(re,jt,Kt,c):this.parseExpressionStatement(re,Kt)}},S.parseBreakContinueStatement=function(c,x){var R=x==="break";this.next(),this.eat(F.semi)||this.insertSemicolon()?c.label=null:this.type!==F.name?this.unexpected():(c.label=this.parseIdent(),this.semicolon());for(var G=0;G<this.labels.length;++G){var re=this.labels[G];if((c.label==null||re.name===c.label.name)&&(re.kind!=null&&(R||re.kind==="loop")||c.label&&R))break}return G===this.labels.length&&this.raise(c.start,"Unsyntactic "+x),this.finishNode(c,R?"BreakStatement":"ContinueStatement")},S.parseDebuggerStatement=function(c){return this.next(),this.semicolon(),this.finishNode(c,"DebuggerStatement")},S.parseDoStatement=function(c){return this.next(),this.labels.push(C),c.body=this.parseStatement("do"),this.labels.pop(),this.expect(F._while),c.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(F.semi):this.semicolon(),this.finishNode(c,"DoWhileStatement")},S.parseForStatement=function(c){this.next();var x=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(C),this.enterScope(0),this.expect(F.parenL),this.type===F.semi)return x>-1&&this.unexpected(x),this.parseFor(c,null);var R=this.isLet();if(this.type===F._var||this.type===F._const||R){var G=this.startNode(),re=R?"let":this.value;return this.next(),this.parseVar(G,!0,re),this.finishNode(G,"VariableDeclaration"),this.parseForAfterInit(c,G,x)}var Se=this.isContextual("let"),Oe=!1,Ge=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(Ge){var rt=this.startNode();return this.next(),Ge==="await using"&&this.next(),this.parseVar(rt,!0,Ge),this.finishNode(rt,"VariableDeclaration"),this.parseForAfterInit(c,rt,x)}var Ot=this.containsEsc,jt=new w,Kt=this.start,cn=x>-1?this.parseExprSubscripts(jt,"await"):this.parseExpression(!0,jt);return this.type===F._in||(Oe=this.options.ecmaVersion>=6&&this.isContextual("of"))?(x>-1?(this.type===F._in&&this.unexpected(x),c.await=!0):Oe&&this.options.ecmaVersion>=8&&(cn.start===Kt&&!Ot&&cn.type==="Identifier"&&cn.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(c.await=!1)),Se&&Oe&&this.raise(cn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(cn,!1,jt),this.checkLValPattern(cn),this.parseForIn(c,cn)):(this.checkExpressionErrors(jt,!0),x>-1&&this.unexpected(x),this.parseFor(c,cn))},S.parseForAfterInit=function(c,x,R){return(this.type===F._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&x.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===F._in?R>-1&&this.unexpected(R):c.await=R>-1),this.parseForIn(c,x)):(R>-1&&this.unexpected(R),this.parseFor(c,x))},S.parseFunctionStatement=function(c,x,R){return this.next(),this.parseFunction(c,N|(R?0:B),!1,x)},S.parseIfStatement=function(c){return this.next(),c.test=this.parseParenExpression(),c.consequent=this.parseStatement("if"),c.alternate=this.eat(F._else)?this.parseStatement("if"):null,this.finishNode(c,"IfStatement")},S.parseReturnStatement=function(c){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(F.semi)||this.insertSemicolon()?c.argument=null:(c.argument=this.parseExpression(),this.semicolon()),this.finishNode(c,"ReturnStatement")},S.parseSwitchStatement=function(c){this.next(),c.discriminant=this.parseParenExpression(),c.cases=[],this.expect(F.braceL),this.labels.push(T),this.enterScope(0);for(var x,R=!1;this.type!==F.braceR;)if(this.type===F._case||this.type===F._default){var G=this.type===F._case;x&&this.finishNode(x,"SwitchCase"),c.cases.push(x=this.startNode()),x.consequent=[],this.next(),G?x.test=this.parseExpression():(R&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),R=!0,x.test=null),this.expect(F.colon)}else x||this.unexpected(),x.consequent.push(this.parseStatement(null));return this.exitScope(),x&&this.finishNode(x,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(c,"SwitchStatement")},S.parseThrowStatement=function(c){return this.next(),Ne.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),c.argument=this.parseExpression(),this.semicolon(),this.finishNode(c,"ThrowStatement")};var P=[];S.parseCatchClauseParam=function(){var c=this.parseBindingAtom(),x=c.type==="Identifier";return this.enterScope(x?Os:0),this.checkLValPattern(c,x?Nt:Gt),this.expect(F.parenR),c},S.parseTryStatement=function(c){if(this.next(),c.block=this.parseBlock(),c.handler=null,this.type===F._catch){var x=this.startNode();this.next(),this.eat(F.parenL)?x.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),x.param=null,this.enterScope(0)),x.body=this.parseBlock(!1),this.exitScope(),c.handler=this.finishNode(x,"CatchClause")}return c.finalizer=this.eat(F._finally)?this.parseBlock():null,!c.handler&&!c.finalizer&&this.raise(c.start,"Missing catch or finally clause"),this.finishNode(c,"TryStatement")},S.parseVarStatement=function(c,x,R){return this.next(),this.parseVar(c,!1,x,R),this.semicolon(),this.finishNode(c,"VariableDeclaration")},S.parseWhileStatement=function(c){return this.next(),c.test=this.parseParenExpression(),this.labels.push(C),c.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(c,"WhileStatement")},S.parseWithStatement=function(c){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),c.object=this.parseParenExpression(),c.body=this.parseStatement("with"),this.finishNode(c,"WithStatement")},S.parseEmptyStatement=function(c){return this.next(),this.finishNode(c,"EmptyStatement")},S.parseLabeledStatement=function(c,x,R,G){for(var re=0,Se=this.labels;re<Se.length;re+=1){var Oe=Se[re];Oe.name===x&&this.raise(R.start,"Label '"+x+"' is already declared")}for(var Ge=this.type.isLoop?"loop":this.type===F._switch?"switch":null,rt=this.labels.length-1;rt>=0;rt--){var Ot=this.labels[rt];if(Ot.statementStart===c.start)Ot.statementStart=this.start,Ot.kind=Ge;else break}return this.labels.push({name:x,kind:Ge,statementStart:this.start}),c.body=this.parseStatement(G?G.indexOf("label")===-1?G+"label":G:"label"),this.labels.pop(),c.label=R,this.finishNode(c,"LabeledStatement")},S.parseExpressionStatement=function(c,x){return c.expression=x,this.semicolon(),this.finishNode(c,"ExpressionStatement")},S.parseBlock=function(c,x,R){for(c===void 0&&(c=!0),x===void 0&&(x=this.startNode()),x.body=[],this.expect(F.braceL),c&&this.enterScope(0);this.type!==F.braceR;){var G=this.parseStatement(null);x.body.push(G)}return R&&(this.strict=!1),this.next(),c&&this.exitScope(),this.finishNode(x,"BlockStatement")},S.parseFor=function(c,x){return c.init=x,this.expect(F.semi),c.test=this.type===F.semi?null:this.parseExpression(),this.expect(F.semi),c.update=this.type===F.parenR?null:this.parseExpression(),this.expect(F.parenR),c.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(c,"ForStatement")},S.parseForIn=function(c,x){var R=this.type===F._in;return this.next(),x.type==="VariableDeclaration"&&x.declarations[0].init!=null&&(!R||this.options.ecmaVersion<8||this.strict||x.kind!=="var"||x.declarations[0].id.type!=="Identifier")&&this.raise(x.start,(R?"for-in":"for-of")+" loop variable declaration may not have an initializer"),c.left=x,c.right=R?this.parseExpression():this.parseMaybeAssign(),this.expect(F.parenR),c.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(c,R?"ForInStatement":"ForOfStatement")},S.parseVar=function(c,x,R,G){for(c.declarations=[],c.kind=R;;){var re=this.startNode();if(this.parseVarId(re,R),this.eat(F.eq)?re.init=this.parseMaybeAssign(x):!G&&R==="const"&&!(this.type===F._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!G&&(R==="using"||R==="await using")&&this.options.ecmaVersion>=17&&this.type!==F._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+R+" declaration"):!G&&re.id.type!=="Identifier"&&!(x&&(this.type===F._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):re.init=null,c.declarations.push(this.finishNode(re,"VariableDeclarator")),!this.eat(F.comma))break}return c},S.parseVarId=function(c,x){c.id=x==="using"||x==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(c.id,x==="var"?pi:Gt,!1)};var N=1,B=2,L=4;S.parseFunction=function(c,x,R,G,re){this.initFunction(c),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!G)&&(this.type===F.star&&x&B&&this.unexpected(),c.generator=this.eat(F.star)),this.options.ecmaVersion>=8&&(c.async=!!G),x&N&&(c.id=x&L&&this.type!==F.name?null:this.parseIdent(),c.id&&!(x&B)&&this.checkLValSimple(c.id,this.strict||c.generator||c.async?this.treatFunctionsAsVar?pi:Gt:Ps));var Se=this.yieldPos,Oe=this.awaitPos,Ge=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(qr(c.async,c.generator)),x&N||(c.id=this.type===F.name?this.parseIdent():null),this.parseFunctionParams(c),this.parseFunctionBody(c,R,!1,re),this.yieldPos=Se,this.awaitPos=Oe,this.awaitIdentPos=Ge,this.finishNode(c,x&N?"FunctionDeclaration":"FunctionExpression")},S.parseFunctionParams=function(c){this.expect(F.parenL),c.params=this.parseBindingList(F.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},S.parseClass=function(c,x){this.next();var R=this.strict;this.strict=!0,this.parseClassId(c,x),this.parseClassSuper(c);var G=this.enterClassBody(),re=this.startNode(),Se=!1;for(re.body=[],this.expect(F.braceL);this.type!==F.braceR;){var Oe=this.parseClassElement(c.superClass!==null);Oe&&(re.body.push(Oe),Oe.type==="MethodDefinition"&&Oe.kind==="constructor"?(Se&&this.raiseRecoverable(Oe.start,"Duplicate constructor in the same class"),Se=!0):Oe.key&&Oe.key.type==="PrivateIdentifier"&&j(G,Oe)&&this.raiseRecoverable(Oe.key.start,"Identifier '#"+Oe.key.name+"' has already been declared"))}return this.strict=R,this.next(),c.body=this.finishNode(re,"ClassBody"),this.exitClassBody(),this.finishNode(c,x?"ClassDeclaration":"ClassExpression")},S.parseClassElement=function(c){if(this.eat(F.semi))return null;var x=this.options.ecmaVersion,R=this.startNode(),G="",re=!1,Se=!1,Oe="method",Ge=!1;if(this.eatContextual("static")){if(x>=13&&this.eat(F.braceL))return this.parseClassStaticBlock(R),R;this.isClassElementNameStart()||this.type===F.star?Ge=!0:G="static"}if(R.static=Ge,!G&&x>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===F.star)&&!this.canInsertSemicolon()?Se=!0:G="async"),!G&&(x>=9||!Se)&&this.eat(F.star)&&(re=!0),!G&&!Se&&!re){var rt=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Oe=rt:G=rt)}if(G?(R.computed=!1,R.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),R.key.name=G,this.finishNode(R.key,"Identifier")):this.parseClassElementName(R),x<13||this.type===F.parenL||Oe!=="method"||re||Se){var Ot=!R.static&&Y(R,"constructor"),jt=Ot&&c;Ot&&Oe!=="method"&&this.raise(R.key.start,"Constructor can't have get/set modifier"),R.kind=Ot?"constructor":Oe,this.parseClassMethod(R,re,Se,jt)}else this.parseClassField(R);return R},S.isClassElementNameStart=function(){return this.type===F.name||this.type===F.privateId||this.type===F.num||this.type===F.string||this.type===F.bracketL||this.type.keyword},S.parseClassElementName=function(c){this.type===F.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),c.computed=!1,c.key=this.parsePrivateIdent()):this.parsePropertyName(c)},S.parseClassMethod=function(c,x,R,G){var re=c.key;c.kind==="constructor"?(x&&this.raise(re.start,"Constructor can't be a generator"),R&&this.raise(re.start,"Constructor can't be an async method")):c.static&&Y(c,"prototype")&&this.raise(re.start,"Classes may not have a static property named prototype");var Se=c.value=this.parseMethod(x,R,G);return c.kind==="get"&&Se.params.length!==0&&this.raiseRecoverable(Se.start,"getter should have no params"),c.kind==="set"&&Se.params.length!==1&&this.raiseRecoverable(Se.start,"setter should have exactly one param"),c.kind==="set"&&Se.params[0].type==="RestElement"&&this.raiseRecoverable(Se.params[0].start,"Setter cannot use rest params"),this.finishNode(c,"MethodDefinition")},S.parseClassField=function(c){return Y(c,"constructor")?this.raise(c.key.start,"Classes can't have a field named 'constructor'"):c.static&&Y(c,"prototype")&&this.raise(c.key.start,"Classes can't have a static field named 'prototype'"),this.eat(F.eq)?(this.enterScope(Ri|Di),c.value=this.parseMaybeAssign(),this.exitScope()):c.value=null,this.semicolon(),this.finishNode(c,"PropertyDefinition")},S.parseClassStaticBlock=function(c){c.body=[];var x=this.labels;for(this.labels=[],this.enterScope(Nr|Di);this.type!==F.braceR;){var R=this.parseStatement(null);c.body.push(R)}return this.next(),this.exitScope(),this.labels=x,this.finishNode(c,"StaticBlock")},S.parseClassId=function(c,x){this.type===F.name?(c.id=this.parseIdent(),x&&this.checkLValSimple(c.id,Gt,!1)):(x===!0&&this.unexpected(),c.id=null)},S.parseClassSuper=function(c){c.superClass=this.eat(F._extends)?this.parseExprSubscripts(null,!1):null},S.enterClassBody=function(){var c={declared:Object.create(null),used:[]};return this.privateNameStack.push(c),c.declared},S.exitClassBody=function(){var c=this.privateNameStack.pop(),x=c.declared,R=c.used;if(this.options.checkPrivateFields)for(var G=this.privateNameStack.length,re=G===0?null:this.privateNameStack[G-1],Se=0;Se<R.length;++Se){var Oe=R[Se];Le(x,Oe.name)||(re?re.used.push(Oe):this.raiseRecoverable(Oe.start,"Private field '#"+Oe.name+"' must be declared in an enclosing class"))}};function j(c,x){var R=x.key.name,G=c[R],re="true";return x.type==="MethodDefinition"&&(x.kind==="get"||x.kind==="set")&&(re=(x.static?"s":"i")+x.kind),G==="iget"&&re==="iset"||G==="iset"&&re==="iget"||G==="sget"&&re==="sset"||G==="sset"&&re==="sget"?(c[R]="true",!1):G?!0:(c[R]=re,!1)}function Y(c,x){var R=c.computed,G=c.key;return!R&&(G.type==="Identifier"&&G.name===x||G.type==="Literal"&&G.value===x)}S.parseExportAllDeclaration=function(c,x){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(c.exported=this.parseModuleExportName(),this.checkExport(x,c.exported,this.lastTokStart)):c.exported=null),this.expectContextual("from"),this.type!==F.string&&this.unexpected(),c.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(c.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(c,"ExportAllDeclaration")},S.parseExport=function(c,x){if(this.next(),this.eat(F.star))return this.parseExportAllDeclaration(c,x);if(this.eat(F._default))return this.checkExport(x,"default",this.lastTokStart),c.declaration=this.parseExportDefaultDeclaration(),this.finishNode(c,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())c.declaration=this.parseExportDeclaration(c),c.declaration.type==="VariableDeclaration"?this.checkVariableExport(x,c.declaration.declarations):this.checkExport(x,c.declaration.id,c.declaration.id.start),c.specifiers=[],c.source=null,this.options.ecmaVersion>=16&&(c.attributes=[]);else{if(c.declaration=null,c.specifiers=this.parseExportSpecifiers(x),this.eatContextual("from"))this.type!==F.string&&this.unexpected(),c.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(c.attributes=this.parseWithClause());else{for(var R=0,G=c.specifiers;R<G.length;R+=1){var re=G[R];this.checkUnreserved(re.local),this.checkLocalExport(re.local),re.local.type==="Literal"&&this.raise(re.local.start,"A string literal cannot be used as an exported binding without `from`.")}c.source=null,this.options.ecmaVersion>=16&&(c.attributes=[])}this.semicolon()}return this.finishNode(c,"ExportNamedDeclaration")},S.parseExportDeclaration=function(c){return this.parseStatement(null)},S.parseExportDefaultDeclaration=function(){var c;if(this.type===F._function||(c=this.isAsyncFunction())){var x=this.startNode();return this.next(),c&&this.next(),this.parseFunction(x,N|L,!1,c)}else if(this.type===F._class){var R=this.startNode();return this.parseClass(R,"nullableID")}else{var G=this.parseMaybeAssign();return this.semicolon(),G}},S.checkExport=function(c,x,R){c&&(typeof x!="string"&&(x=x.type==="Identifier"?x.name:x.value),Le(c,x)&&this.raiseRecoverable(R,"Duplicate export '"+x+"'"),c[x]=!0)},S.checkPatternExport=function(c,x){var R=x.type;if(R==="Identifier")this.checkExport(c,x,x.start);else if(R==="ObjectPattern")for(var G=0,re=x.properties;G<re.length;G+=1){var Se=re[G];this.checkPatternExport(c,Se)}else if(R==="ArrayPattern")for(var Oe=0,Ge=x.elements;Oe<Ge.length;Oe+=1){var rt=Ge[Oe];rt&&this.checkPatternExport(c,rt)}else R==="Property"?this.checkPatternExport(c,x.value):R==="AssignmentPattern"?this.checkPatternExport(c,x.left):R==="RestElement"&&this.checkPatternExport(c,x.argument)},S.checkVariableExport=function(c,x){if(c)for(var R=0,G=x;R<G.length;R+=1){var re=G[R];this.checkPatternExport(c,re.id)}},S.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},S.parseExportSpecifier=function(c){var x=this.startNode();return x.local=this.parseModuleExportName(),x.exported=this.eatContextual("as")?this.parseModuleExportName():x.local,this.checkExport(c,x.exported,x.exported.start),this.finishNode(x,"ExportSpecifier")},S.parseExportSpecifiers=function(c){var x=[],R=!0;for(this.expect(F.braceL);!this.eat(F.braceR);){if(R)R=!1;else if(this.expect(F.comma),this.afterTrailingComma(F.braceR))break;x.push(this.parseExportSpecifier(c))}return x},S.parseImport=function(c){return this.next(),this.type===F.string?(c.specifiers=P,c.source=this.parseExprAtom()):(c.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),c.source=this.type===F.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(c.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(c,"ImportDeclaration")},S.parseImportSpecifier=function(){var c=this.startNode();return c.imported=this.parseModuleExportName(),this.eatContextual("as")?c.local=this.parseIdent():(this.checkUnreserved(c.imported),c.local=c.imported),this.checkLValSimple(c.local,Gt),this.finishNode(c,"ImportSpecifier")},S.parseImportDefaultSpecifier=function(){var c=this.startNode();return c.local=this.parseIdent(),this.checkLValSimple(c.local,Gt),this.finishNode(c,"ImportDefaultSpecifier")},S.parseImportNamespaceSpecifier=function(){var c=this.startNode();return this.next(),this.expectContextual("as"),c.local=this.parseIdent(),this.checkLValSimple(c.local,Gt),this.finishNode(c,"ImportNamespaceSpecifier")},S.parseImportSpecifiers=function(){var c=[],x=!0;if(this.type===F.name&&(c.push(this.parseImportDefaultSpecifier()),!this.eat(F.comma)))return c;if(this.type===F.star)return c.push(this.parseImportNamespaceSpecifier()),c;for(this.expect(F.braceL);!this.eat(F.braceR);){if(x)x=!1;else if(this.expect(F.comma),this.afterTrailingComma(F.braceR))break;c.push(this.parseImportSpecifier())}return c},S.parseWithClause=function(){var c=[];if(!this.eat(F._with))return c;this.expect(F.braceL);for(var x={},R=!0;!this.eat(F.braceR);){if(R)R=!1;else if(this.expect(F.comma),this.afterTrailingComma(F.braceR))break;var G=this.parseImportAttribute(),re=G.key.type==="Identifier"?G.key.name:G.key.value;Le(x,re)&&this.raiseRecoverable(G.key.start,"Duplicate attribute key '"+re+"'"),x[re]=!0,c.push(G)}return c},S.parseImportAttribute=function(){var c=this.startNode();return c.key=this.type===F.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(F.colon),this.type!==F.string&&this.unexpected(),c.value=this.parseExprAtom(),this.finishNode(c,"ImportAttribute")},S.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===F.string){var c=this.parseLiteral(this.value);return be.test(c.value)&&this.raise(c.start,"An export name cannot include a lone surrogate."),c}return this.parseIdent(!0)},S.adaptDirectivePrologue=function(c){for(var x=0;x<c.length&&this.isDirectiveCandidate(c[x]);++x)c[x].directive=c[x].expression.raw.slice(1,-1)},S.isDirectiveCandidate=function(c){return this.options.ecmaVersion>=5&&c.type==="ExpressionStatement"&&c.expression.type==="Literal"&&typeof c.expression.value=="string"&&(this.input[c.start]==='"'||this.input[c.start]==="'")};var z=u.prototype;z.toAssignable=function(c,x,R){if(this.options.ecmaVersion>=6&&c)switch(c.type){case"Identifier":this.inAsync&&c.name==="await"&&this.raise(c.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":c.type="ObjectPattern",R&&this.checkPatternErrors(R,!0);for(var G=0,re=c.properties;G<re.length;G+=1){var Se=re[G];this.toAssignable(Se,x),Se.type==="RestElement"&&(Se.argument.type==="ArrayPattern"||Se.argument.type==="ObjectPattern")&&this.raise(Se.argument.start,"Unexpected token")}break;case"Property":c.kind!=="init"&&this.raise(c.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(c.value,x);break;case"ArrayExpression":c.type="ArrayPattern",R&&this.checkPatternErrors(R,!0),this.toAssignableList(c.elements,x);break;case"SpreadElement":c.type="RestElement",this.toAssignable(c.argument,x),c.argument.type==="AssignmentPattern"&&this.raise(c.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":c.operator!=="="&&this.raise(c.left.end,"Only '=' operator can be used for specifying default value."),c.type="AssignmentPattern",delete c.operator,this.toAssignable(c.left,x);break;case"ParenthesizedExpression":this.toAssignable(c.expression,x,R);break;case"ChainExpression":this.raiseRecoverable(c.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!x)break;default:this.raise(c.start,"Assigning to rvalue")}else R&&this.checkPatternErrors(R,!0);return c},z.toAssignableList=function(c,x){for(var R=c.length,G=0;G<R;G++){var re=c[G];re&&this.toAssignable(re,x)}if(R){var Se=c[R-1];this.options.ecmaVersion===6&&x&&Se&&Se.type==="RestElement"&&Se.argument.type!=="Identifier"&&this.unexpected(Se.argument.start)}return c},z.parseSpread=function(c){var x=this.startNode();return this.next(),x.argument=this.parseMaybeAssign(!1,c),this.finishNode(x,"SpreadElement")},z.parseRestBinding=function(){var c=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==F.name&&this.unexpected(),c.argument=this.parseBindingAtom(),this.finishNode(c,"RestElement")},z.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case F.bracketL:var c=this.startNode();return this.next(),c.elements=this.parseBindingList(F.bracketR,!0,!0),this.finishNode(c,"ArrayPattern");case F.braceL:return this.parseObj(!0)}return this.parseIdent()},z.parseBindingList=function(c,x,R,G){for(var re=[],Se=!0;!this.eat(c);)if(Se?Se=!1:this.expect(F.comma),x&&this.type===F.comma)re.push(null);else{if(R&&this.afterTrailingComma(c))break;if(this.type===F.ellipsis){var Oe=this.parseRestBinding();this.parseBindingListItem(Oe),re.push(Oe),this.type===F.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(c);break}else re.push(this.parseAssignableListItem(G))}return re},z.parseAssignableListItem=function(c){var x=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(x),x},z.parseBindingListItem=function(c){return c},z.parseMaybeDefault=function(c,x,R){if(R=R||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(F.eq))return R;var G=this.startNodeAt(c,x);return G.left=R,G.right=this.parseMaybeAssign(),this.finishNode(G,"AssignmentPattern")},z.checkLValSimple=function(c,x,R){x===void 0&&(x=tn);var G=x!==tn;switch(c.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(c.name)&&this.raiseRecoverable(c.start,(G?"Binding ":"Assigning to ")+c.name+" in strict mode"),G&&(x===Gt&&c.name==="let"&&this.raiseRecoverable(c.start,"let is disallowed as a lexically bound name"),R&&(Le(R,c.name)&&this.raiseRecoverable(c.start,"Argument name clash"),R[c.name]=!0),x!==r&&this.declareName(c.name,x,c.start));break;case"ChainExpression":this.raiseRecoverable(c.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":G&&this.raiseRecoverable(c.start,"Binding member expression");break;case"ParenthesizedExpression":return G&&this.raiseRecoverable(c.start,"Binding parenthesized expression"),this.checkLValSimple(c.expression,x,R);default:this.raise(c.start,(G?"Binding":"Assigning to")+" rvalue")}},z.checkLValPattern=function(c,x,R){switch(x===void 0&&(x=tn),c.type){case"ObjectPattern":for(var G=0,re=c.properties;G<re.length;G+=1){var Se=re[G];this.checkLValInnerPattern(Se,x,R)}break;case"ArrayPattern":for(var Oe=0,Ge=c.elements;Oe<Ge.length;Oe+=1){var rt=Ge[Oe];rt&&this.checkLValInnerPattern(rt,x,R)}break;default:this.checkLValSimple(c,x,R)}},z.checkLValInnerPattern=function(c,x,R){switch(x===void 0&&(x=tn),c.type){case"Property":this.checkLValInnerPattern(c.value,x,R);break;case"AssignmentPattern":this.checkLValPattern(c.left,x,R);break;case"RestElement":this.checkLValPattern(c.argument,x,R);break;default:this.checkLValPattern(c,x,R)}};var H=function(x,R,G,re,Se){this.token=x,this.isExpr=!!R,this.preserveSpace=!!G,this.override=re,this.generator=!!Se},D={b_stat:new H("{",!1),b_expr:new H("{",!0),b_tmpl:new H("${",!1),p_stat:new H("(",!1),p_expr:new H("(",!0),q_tmpl:new H("`",!0,!0,function(c){return c.tryReadTemplateToken()}),f_stat:new H("function",!1),f_expr:new H("function",!0),f_expr_gen:new H("function",!0,!1,null,!0),f_gen:new H("function",!1,!1,null,!0)},U=u.prototype;U.initialContext=function(){return[D.b_stat]},U.curContext=function(){return this.context[this.context.length-1]},U.braceIsBlock=function(c){var x=this.curContext();return x===D.f_expr||x===D.f_stat?!0:c===F.colon&&(x===D.b_stat||x===D.b_expr)?!x.isExpr:c===F._return||c===F.name&&this.exprAllowed?Ne.test(this.input.slice(this.lastTokEnd,this.start)):c===F._else||c===F.semi||c===F.eof||c===F.parenR||c===F.arrow?!0:c===F.braceL?x===D.b_stat:c===F._var||c===F._const||c===F.name?!1:!this.exprAllowed},U.inGeneratorContext=function(){for(var c=this.context.length-1;c>=1;c--){var x=this.context[c];if(x.token==="function")return x.generator}return!1},U.updateContext=function(c){var x,R=this.type;R.keyword&&c===F.dot?this.exprAllowed=!1:(x=R.updateContext)?x.call(this,c):this.exprAllowed=R.beforeExpr},U.overrideContext=function(c){this.curContext()!==c&&(this.context[this.context.length-1]=c)},F.parenR.updateContext=F.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var c=this.context.pop();c===D.b_stat&&this.curContext().token==="function"&&(c=this.context.pop()),this.exprAllowed=!c.isExpr},F.braceL.updateContext=function(c){this.context.push(this.braceIsBlock(c)?D.b_stat:D.b_expr),this.exprAllowed=!0},F.dollarBraceL.updateContext=function(){this.context.push(D.b_tmpl),this.exprAllowed=!0},F.parenL.updateContext=function(c){var x=c===F._if||c===F._for||c===F._with||c===F._while;this.context.push(x?D.p_stat:D.p_expr),this.exprAllowed=!0},F.incDec.updateContext=function(){},F._function.updateContext=F._class.updateContext=function(c){c.beforeExpr&&c!==F._else&&!(c===F.semi&&this.curContext()!==D.p_stat)&&!(c===F._return&&Ne.test(this.input.slice(this.lastTokEnd,this.start)))&&!((c===F.colon||c===F.braceL)&&this.curContext()===D.b_stat)?this.context.push(D.f_expr):this.context.push(D.f_stat),this.exprAllowed=!1},F.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},F.backQuote.updateContext=function(){this.curContext()===D.q_tmpl?this.context.pop():this.context.push(D.q_tmpl),this.exprAllowed=!1},F.star.updateContext=function(c){if(c===F._function){var x=this.context.length-1;this.context[x]===D.f_expr?this.context[x]=D.f_expr_gen:this.context[x]=D.f_gen}this.exprAllowed=!0},F.name.updateContext=function(c){var x=!1;this.options.ecmaVersion>=6&&c!==F.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(x=!0),this.exprAllowed=x};var A=u.prototype;A.checkPropClash=function(c,x,R){if(!(this.options.ecmaVersion>=9&&c.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(c.computed||c.method||c.shorthand))){var G=c.key,re;switch(G.type){case"Identifier":re=G.name;break;case"Literal":re=String(G.value);break;default:return}var Se=c.kind;if(this.options.ecmaVersion>=6){re==="__proto__"&&Se==="init"&&(x.proto&&(R?R.doubleProto<0&&(R.doubleProto=G.start):this.raiseRecoverable(G.start,"Redefinition of __proto__ property")),x.proto=!0);return}re="$"+re;var Oe=x[re];if(Oe){var Ge;Se==="init"?Ge=this.strict&&Oe.init||Oe.get||Oe.set:Ge=Oe.init||Oe[Se],Ge&&this.raiseRecoverable(G.start,"Redefinition of property")}else Oe=x[re]={init:!1,get:!1,set:!1};Oe[Se]=!0}},A.parseExpression=function(c,x){var R=this.start,G=this.startLoc,re=this.parseMaybeAssign(c,x);if(this.type===F.comma){var Se=this.startNodeAt(R,G);for(Se.expressions=[re];this.eat(F.comma);)Se.expressions.push(this.parseMaybeAssign(c,x));return this.finishNode(Se,"SequenceExpression")}return re},A.parseMaybeAssign=function(c,x,R){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(c);this.exprAllowed=!1}var G=!1,re=-1,Se=-1,Oe=-1;x?(re=x.parenthesizedAssign,Se=x.trailingComma,Oe=x.doubleProto,x.parenthesizedAssign=x.trailingComma=-1):(x=new w,G=!0);var Ge=this.start,rt=this.startLoc;(this.type===F.parenL||this.type===F.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=c==="await");var Ot=this.parseMaybeConditional(c,x);if(R&&(Ot=R.call(this,Ot,Ge,rt)),this.type.isAssign){var jt=this.startNodeAt(Ge,rt);return jt.operator=this.value,this.type===F.eq&&(Ot=this.toAssignable(Ot,!1,x)),G||(x.parenthesizedAssign=x.trailingComma=x.doubleProto=-1),x.shorthandAssign>=Ot.start&&(x.shorthandAssign=-1),this.type===F.eq?this.checkLValPattern(Ot):this.checkLValSimple(Ot),jt.left=Ot,this.next(),jt.right=this.parseMaybeAssign(c),Oe>-1&&(x.doubleProto=Oe),this.finishNode(jt,"AssignmentExpression")}else G&&this.checkExpressionErrors(x,!0);return re>-1&&(x.parenthesizedAssign=re),Se>-1&&(x.trailingComma=Se),Ot},A.parseMaybeConditional=function(c,x){var R=this.start,G=this.startLoc,re=this.parseExprOps(c,x);if(this.checkExpressionErrors(x))return re;if(this.eat(F.question)){var Se=this.startNodeAt(R,G);return Se.test=re,Se.consequent=this.parseMaybeAssign(),this.expect(F.colon),Se.alternate=this.parseMaybeAssign(c),this.finishNode(Se,"ConditionalExpression")}return re},A.parseExprOps=function(c,x){var R=this.start,G=this.startLoc,re=this.parseMaybeUnary(x,!1,!1,c);return this.checkExpressionErrors(x)||re.start===R&&re.type==="ArrowFunctionExpression"?re:this.parseExprOp(re,R,G,-1,c)},A.parseExprOp=function(c,x,R,G,re){var Se=this.type.binop;if(Se!=null&&(!re||this.type!==F._in)&&Se>G){var Oe=this.type===F.logicalOR||this.type===F.logicalAND,Ge=this.type===F.coalesce;Ge&&(Se=F.logicalAND.binop);var rt=this.value;this.next();var Ot=this.start,jt=this.startLoc,Kt=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,re),Ot,jt,Se,re),cn=this.buildBinary(x,R,c,Kt,rt,Oe||Ge);return(Oe&&this.type===F.coalesce||Ge&&(this.type===F.logicalOR||this.type===F.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(cn,x,R,G,re)}return c},A.buildBinary=function(c,x,R,G,re,Se){G.type==="PrivateIdentifier"&&this.raise(G.start,"Private identifier can only be left side of binary expression");var Oe=this.startNodeAt(c,x);return Oe.left=R,Oe.operator=re,Oe.right=G,this.finishNode(Oe,Se?"LogicalExpression":"BinaryExpression")},A.parseMaybeUnary=function(c,x,R,G){var re=this.start,Se=this.startLoc,Oe;if(this.isContextual("await")&&this.canAwait)Oe=this.parseAwait(G),x=!0;else if(this.type.prefix){var Ge=this.startNode(),rt=this.type===F.incDec;Ge.operator=this.value,Ge.prefix=!0,this.next(),Ge.argument=this.parseMaybeUnary(null,!0,rt,G),this.checkExpressionErrors(c,!0),rt?this.checkLValSimple(Ge.argument):this.strict&&Ge.operator==="delete"&&V(Ge.argument)?this.raiseRecoverable(Ge.start,"Deleting local variable in strict mode"):Ge.operator==="delete"&&q(Ge.argument)?this.raiseRecoverable(Ge.start,"Private fields can not be deleted"):x=!0,Oe=this.finishNode(Ge,rt?"UpdateExpression":"UnaryExpression")}else if(!x&&this.type===F.privateId)(G||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Oe=this.parsePrivateIdent(),this.type!==F._in&&this.unexpected();else{if(Oe=this.parseExprSubscripts(c,G),this.checkExpressionErrors(c))return Oe;for(;this.type.postfix&&!this.canInsertSemicolon();){var Ot=this.startNodeAt(re,Se);Ot.operator=this.value,Ot.prefix=!1,Ot.argument=Oe,this.checkLValSimple(Oe),this.next(),Oe=this.finishNode(Ot,"UpdateExpression")}}if(!R&&this.eat(F.starstar))if(x)this.unexpected(this.lastTokStart);else return this.buildBinary(re,Se,Oe,this.parseMaybeUnary(null,!1,!1,G),"**",!1);else return Oe};function V(c){return c.type==="Identifier"||c.type==="ParenthesizedExpression"&&V(c.expression)}function q(c){return c.type==="MemberExpression"&&c.property.type==="PrivateIdentifier"||c.type==="ChainExpression"&&q(c.expression)||c.type==="ParenthesizedExpression"&&q(c.expression)}A.parseExprSubscripts=function(c,x){var R=this.start,G=this.startLoc,re=this.parseExprAtom(c,x);if(re.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return re;var Se=this.parseSubscripts(re,R,G,!1,x);return c&&Se.type==="MemberExpression"&&(c.parenthesizedAssign>=Se.start&&(c.parenthesizedAssign=-1),c.parenthesizedBind>=Se.start&&(c.parenthesizedBind=-1),c.trailingComma>=Se.start&&(c.trailingComma=-1)),Se},A.parseSubscripts=function(c,x,R,G,re){for(var Se=this.options.ecmaVersion>=8&&c.type==="Identifier"&&c.name==="async"&&this.lastTokEnd===c.end&&!this.canInsertSemicolon()&&c.end-c.start===5&&this.potentialArrowAt===c.start,Oe=!1;;){var Ge=this.parseSubscript(c,x,R,G,Se,Oe,re);if(Ge.optional&&(Oe=!0),Ge===c||Ge.type==="ArrowFunctionExpression"){if(Oe){var rt=this.startNodeAt(x,R);rt.expression=Ge,Ge=this.finishNode(rt,"ChainExpression")}return Ge}c=Ge}},A.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(F.arrow)},A.parseSubscriptAsyncArrow=function(c,x,R,G){return this.parseArrowExpression(this.startNodeAt(c,x),R,!0,G)},A.parseSubscript=function(c,x,R,G,re,Se,Oe){var Ge=this.options.ecmaVersion>=11,rt=Ge&&this.eat(F.questionDot);G&&rt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Ot=this.eat(F.bracketL);if(Ot||rt&&this.type!==F.parenL&&this.type!==F.backQuote||this.eat(F.dot)){var jt=this.startNodeAt(x,R);jt.object=c,Ot?(jt.property=this.parseExpression(),this.expect(F.bracketR)):this.type===F.privateId&&c.type!=="Super"?jt.property=this.parsePrivateIdent():jt.property=this.parseIdent(this.options.allowReserved!=="never"),jt.computed=!!Ot,Ge&&(jt.optional=rt),c=this.finishNode(jt,"MemberExpression")}else if(!G&&this.eat(F.parenL)){var Kt=new w,cn=this.yieldPos,Kr=this.awaitPos,mi=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var Zr=this.parseExprList(F.parenR,this.options.ecmaVersion>=8,!1,Kt);if(re&&!rt&&this.shouldParseAsyncArrow())return this.checkPatternErrors(Kt,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=cn,this.awaitPos=Kr,this.awaitIdentPos=mi,this.parseSubscriptAsyncArrow(x,R,Zr,Oe);this.checkExpressionErrors(Kt,!0),this.yieldPos=cn||this.yieldPos,this.awaitPos=Kr||this.awaitPos,this.awaitIdentPos=mi||this.awaitIdentPos;var Qr=this.startNodeAt(x,R);Qr.callee=c,Qr.arguments=Zr,Ge&&(Qr.optional=rt),c=this.finishNode(Qr,"CallExpression")}else if(this.type===F.backQuote){(rt||Se)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var zr=this.startNodeAt(x,R);zr.tag=c,zr.quasi=this.parseTemplate({isTagged:!0}),c=this.finishNode(zr,"TaggedTemplateExpression")}return c},A.parseExprAtom=function(c,x,R){this.type===F.slash&&this.readRegexp();var G,re=this.potentialArrowAt===this.start;switch(this.type){case F._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),G=this.startNode(),this.next(),this.type===F.parenL&&!this.allowDirectSuper&&this.raise(G.start,"super() call outside constructor of a subclass"),this.type!==F.dot&&this.type!==F.bracketL&&this.type!==F.parenL&&this.unexpected(),this.finishNode(G,"Super");case F._this:return G=this.startNode(),this.next(),this.finishNode(G,"ThisExpression");case F.name:var Se=this.start,Oe=this.startLoc,Ge=this.containsEsc,rt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Ge&&rt.name==="async"&&!this.canInsertSemicolon()&&this.eat(F._function))return this.overrideContext(D.f_expr),this.parseFunction(this.startNodeAt(Se,Oe),0,!1,!0,x);if(re&&!this.canInsertSemicolon()){if(this.eat(F.arrow))return this.parseArrowExpression(this.startNodeAt(Se,Oe),[rt],!1,x);if(this.options.ecmaVersion>=8&&rt.name==="async"&&this.type===F.name&&!Ge&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return rt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(F.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Se,Oe),[rt],!0,x)}return rt;case F.regexp:var Ot=this.value;return G=this.parseLiteral(Ot.value),G.regex={pattern:Ot.pattern,flags:Ot.flags},G;case F.num:case F.string:return this.parseLiteral(this.value);case F._null:case F._true:case F._false:return G=this.startNode(),G.value=this.type===F._null?null:this.type===F._true,G.raw=this.type.keyword,this.next(),this.finishNode(G,"Literal");case F.parenL:var jt=this.start,Kt=this.parseParenAndDistinguishExpression(re,x);return c&&(c.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Kt)&&(c.parenthesizedAssign=jt),c.parenthesizedBind<0&&(c.parenthesizedBind=jt)),Kt;case F.bracketL:return G=this.startNode(),this.next(),G.elements=this.parseExprList(F.bracketR,!0,!0,c),this.finishNode(G,"ArrayExpression");case F.braceL:return this.overrideContext(D.b_expr),this.parseObj(!1,c);case F._function:return G=this.startNode(),this.next(),this.parseFunction(G,0);case F._class:return this.parseClass(this.startNode(),!1);case F._new:return this.parseNew();case F.backQuote:return this.parseTemplate();case F._import:return this.options.ecmaVersion>=11?this.parseExprImport(R):this.unexpected();default:return this.parseExprAtomDefault()}},A.parseExprAtomDefault=function(){this.unexpected()},A.parseExprImport=function(c){var x=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===F.parenL&&!c)return this.parseDynamicImport(x);if(this.type===F.dot){var R=this.startNodeAt(x.start,x.loc&&x.loc.start);return R.name="import",x.meta=this.finishNode(R,"Identifier"),this.parseImportMeta(x)}else this.unexpected()},A.parseDynamicImport=function(c){if(this.next(),c.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(F.parenR)?c.options=null:(this.expect(F.comma),this.afterTrailingComma(F.parenR)?c.options=null:(c.options=this.parseMaybeAssign(),this.eat(F.parenR)||(this.expect(F.comma),this.afterTrailingComma(F.parenR)||this.unexpected())));else if(!this.eat(F.parenR)){var x=this.start;this.eat(F.comma)&&this.eat(F.parenR)?this.raiseRecoverable(x,"Trailing comma is not allowed in import()"):this.unexpected(x)}return this.finishNode(c,"ImportExpression")},A.parseImportMeta=function(c){this.next();var x=this.containsEsc;return c.property=this.parseIdent(!0),c.property.name!=="meta"&&this.raiseRecoverable(c.property.start,"The only valid meta property for import is 'import.meta'"),x&&this.raiseRecoverable(c.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(c.start,"Cannot use 'import.meta' outside a module"),this.finishNode(c,"MetaProperty")},A.parseLiteral=function(c){var x=this.startNode();return x.value=c,x.raw=this.input.slice(this.start,this.end),x.raw.charCodeAt(x.raw.length-1)===110&&(x.bigint=x.value!=null?x.value.toString():x.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(x,"Literal")},A.parseParenExpression=function(){this.expect(F.parenL);var c=this.parseExpression();return this.expect(F.parenR),c},A.shouldParseArrow=function(c){return!this.canInsertSemicolon()},A.parseParenAndDistinguishExpression=function(c,x){var R=this.start,G=this.startLoc,re,Se=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Oe=this.start,Ge=this.startLoc,rt=[],Ot=!0,jt=!1,Kt=new w,cn=this.yieldPos,Kr=this.awaitPos,mi;for(this.yieldPos=0,this.awaitPos=0;this.type!==F.parenR;)if(Ot?Ot=!1:this.expect(F.comma),Se&&this.afterTrailingComma(F.parenR,!0)){jt=!0;break}else if(this.type===F.ellipsis){mi=this.start,rt.push(this.parseParenItem(this.parseRestBinding())),this.type===F.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else rt.push(this.parseMaybeAssign(!1,Kt,this.parseParenItem));var Zr=this.lastTokEnd,Qr=this.lastTokEndLoc;if(this.expect(F.parenR),c&&this.shouldParseArrow(rt)&&this.eat(F.arrow))return this.checkPatternErrors(Kt,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=cn,this.awaitPos=Kr,this.parseParenArrowList(R,G,rt,x);(!rt.length||jt)&&this.unexpected(this.lastTokStart),mi&&this.unexpected(mi),this.checkExpressionErrors(Kt,!0),this.yieldPos=cn||this.yieldPos,this.awaitPos=Kr||this.awaitPos,rt.length>1?(re=this.startNodeAt(Oe,Ge),re.expressions=rt,this.finishNodeAt(re,"SequenceExpression",Zr,Qr)):re=rt[0]}else re=this.parseParenExpression();if(this.options.preserveParens){var zr=this.startNodeAt(R,G);return zr.expression=re,this.finishNode(zr,"ParenthesizedExpression")}else return re},A.parseParenItem=function(c){return c},A.parseParenArrowList=function(c,x,R,G){return this.parseArrowExpression(this.startNodeAt(c,x),R,!1,G)};var J=[];A.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var c=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===F.dot){var x=this.startNodeAt(c.start,c.loc&&c.loc.start);x.name="new",c.meta=this.finishNode(x,"Identifier"),this.next();var R=this.containsEsc;return c.property=this.parseIdent(!0),c.property.name!=="target"&&this.raiseRecoverable(c.property.start,"The only valid meta property for new is 'new.target'"),R&&this.raiseRecoverable(c.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(c.start,"'new.target' can only be used in functions and class static block"),this.finishNode(c,"MetaProperty")}var G=this.start,re=this.startLoc;return c.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),G,re,!0,!1),this.eat(F.parenL)?c.arguments=this.parseExprList(F.parenR,this.options.ecmaVersion>=8,!1):c.arguments=J,this.finishNode(c,"NewExpression")},A.parseTemplateElement=function(c){var x=c.isTagged,R=this.startNode();return this.type===F.invalidTemplate?(x||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),R.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):R.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),R.tail=this.type===F.backQuote,this.finishNode(R,"TemplateElement")},A.parseTemplate=function(c){c===void 0&&(c={});var x=c.isTagged;x===void 0&&(x=!1);var R=this.startNode();this.next(),R.expressions=[];var G=this.parseTemplateElement({isTagged:x});for(R.quasis=[G];!G.tail;)this.type===F.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(F.dollarBraceL),R.expressions.push(this.parseExpression()),this.expect(F.braceR),R.quasis.push(G=this.parseTemplateElement({isTagged:x}));return this.next(),this.finishNode(R,"TemplateLiteral")},A.isAsyncProp=function(c){return!c.computed&&c.key.type==="Identifier"&&c.key.name==="async"&&(this.type===F.name||this.type===F.num||this.type===F.string||this.type===F.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===F.star)&&!Ne.test(this.input.slice(this.lastTokEnd,this.start))},A.parseObj=function(c,x){var R=this.startNode(),G=!0,re={};for(R.properties=[],this.next();!this.eat(F.braceR);){if(G)G=!1;else if(this.expect(F.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(F.braceR))break;var Se=this.parseProperty(c,x);c||this.checkPropClash(Se,re,x),R.properties.push(Se)}return this.finishNode(R,c?"ObjectPattern":"ObjectExpression")},A.parseProperty=function(c,x){var R=this.startNode(),G,re,Se,Oe;if(this.options.ecmaVersion>=9&&this.eat(F.ellipsis))return c?(R.argument=this.parseIdent(!1),this.type===F.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(R,"RestElement")):(R.argument=this.parseMaybeAssign(!1,x),this.type===F.comma&&x&&x.trailingComma<0&&(x.trailingComma=this.start),this.finishNode(R,"SpreadElement"));this.options.ecmaVersion>=6&&(R.method=!1,R.shorthand=!1,(c||x)&&(Se=this.start,Oe=this.startLoc),c||(G=this.eat(F.star)));var Ge=this.containsEsc;return this.parsePropertyName(R),!c&&!Ge&&this.options.ecmaVersion>=8&&!G&&this.isAsyncProp(R)?(re=!0,G=this.options.ecmaVersion>=9&&this.eat(F.star),this.parsePropertyName(R)):re=!1,this.parsePropertyValue(R,c,G,re,Se,Oe,x,Ge),this.finishNode(R,"Property")},A.parseGetterSetter=function(c){var x=c.key.name;this.parsePropertyName(c),c.value=this.parseMethod(!1),c.kind=x;var R=c.kind==="get"?0:1;if(c.value.params.length!==R){var G=c.value.start;c.kind==="get"?this.raiseRecoverable(G,"getter should have no params"):this.raiseRecoverable(G,"setter should have exactly one param")}else c.kind==="set"&&c.value.params[0].type==="RestElement"&&this.raiseRecoverable(c.value.params[0].start,"Setter cannot use rest params")},A.parsePropertyValue=function(c,x,R,G,re,Se,Oe,Ge){(R||G)&&this.type===F.colon&&this.unexpected(),this.eat(F.colon)?(c.value=x?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Oe),c.kind="init"):this.options.ecmaVersion>=6&&this.type===F.parenL?(x&&this.unexpected(),c.method=!0,c.value=this.parseMethod(R,G),c.kind="init"):!x&&!Ge&&this.options.ecmaVersion>=5&&!c.computed&&c.key.type==="Identifier"&&(c.key.name==="get"||c.key.name==="set")&&this.type!==F.comma&&this.type!==F.braceR&&this.type!==F.eq?((R||G)&&this.unexpected(),this.parseGetterSetter(c)):this.options.ecmaVersion>=6&&!c.computed&&c.key.type==="Identifier"?((R||G)&&this.unexpected(),this.checkUnreserved(c.key),c.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=re),x?c.value=this.parseMaybeDefault(re,Se,this.copyNode(c.key)):this.type===F.eq&&Oe?(Oe.shorthandAssign<0&&(Oe.shorthandAssign=this.start),c.value=this.parseMaybeDefault(re,Se,this.copyNode(c.key))):c.value=this.copyNode(c.key),c.kind="init",c.shorthand=!0):this.unexpected()},A.parsePropertyName=function(c){if(this.options.ecmaVersion>=6){if(this.eat(F.bracketL))return c.computed=!0,c.key=this.parseMaybeAssign(),this.expect(F.bracketR),c.key;c.computed=!1}return c.key=this.type===F.num||this.type===F.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},A.initFunction=function(c){c.id=null,this.options.ecmaVersion>=6&&(c.generator=c.expression=!1),this.options.ecmaVersion>=8&&(c.async=!1)},A.parseMethod=function(c,x,R){var G=this.startNode(),re=this.yieldPos,Se=this.awaitPos,Oe=this.awaitIdentPos;return this.initFunction(G),this.options.ecmaVersion>=6&&(G.generator=c),this.options.ecmaVersion>=8&&(G.async=!!x),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(qr(x,G.generator)|Di|(R?ua:0)),this.expect(F.parenL),G.params=this.parseBindingList(F.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(G,!1,!0,!1),this.yieldPos=re,this.awaitPos=Se,this.awaitIdentPos=Oe,this.finishNode(G,"FunctionExpression")},A.parseArrowExpression=function(c,x,R,G){var re=this.yieldPos,Se=this.awaitPos,Oe=this.awaitIdentPos;return this.enterScope(qr(R,!1)|Rr),this.initFunction(c),this.options.ecmaVersion>=8&&(c.async=!!R),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,c.params=this.toAssignableList(x,!0),this.parseFunctionBody(c,!0,!1,G),this.yieldPos=re,this.awaitPos=Se,this.awaitIdentPos=Oe,this.finishNode(c,"ArrowFunctionExpression")},A.parseFunctionBody=function(c,x,R,G){var re=x&&this.type!==F.braceL,Se=this.strict,Oe=!1;if(re)c.body=this.parseMaybeAssign(G),c.expression=!0,this.checkParams(c,!1);else{var Ge=this.options.ecmaVersion>=7&&!this.isSimpleParamList(c.params);(!Se||Ge)&&(Oe=this.strictDirective(this.end),Oe&&Ge&&this.raiseRecoverable(c.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var rt=this.labels;this.labels=[],Oe&&(this.strict=!0),this.checkParams(c,!Se&&!Oe&&!x&&!R&&this.isSimpleParamList(c.params)),this.strict&&c.id&&this.checkLValSimple(c.id,r),c.body=this.parseBlock(!1,void 0,Oe&&!Se),c.expression=!1,this.adaptDirectivePrologue(c.body.body),this.labels=rt}this.exitScope()},A.isSimpleParamList=function(c){for(var x=0,R=c;x<R.length;x+=1){var G=R[x];if(G.type!=="Identifier")return!1}return!0},A.checkParams=function(c,x){for(var R=Object.create(null),G=0,re=c.params;G<re.length;G+=1){var Se=re[G];this.checkLValInnerPattern(Se,pi,x?null:R)}},A.parseExprList=function(c,x,R,G){for(var re=[],Se=!0;!this.eat(c);){if(Se)Se=!1;else if(this.expect(F.comma),x&&this.afterTrailingComma(c))break;var Oe=void 0;R&&this.type===F.comma?Oe=null:this.type===F.ellipsis?(Oe=this.parseSpread(G),G&&this.type===F.comma&&G.trailingComma<0&&(G.trailingComma=this.start)):Oe=this.parseMaybeAssign(!1,G),re.push(Oe)}return re},A.checkUnreserved=function(c){var x=c.start,R=c.end,G=c.name;if(this.inGenerator&&G==="yield"&&this.raiseRecoverable(x,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&G==="await"&&this.raiseRecoverable(x,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&Ni)&&G==="arguments"&&this.raiseRecoverable(x,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(G==="arguments"||G==="await")&&this.raise(x,"Cannot use "+G+" in class static initialization block"),this.keywords.test(G)&&this.raise(x,"Unexpected keyword '"+G+"'"),!(this.options.ecmaVersion<6&&this.input.slice(x,R).indexOf("\\")!==-1)){var re=this.strict?this.reservedWordsStrict:this.reservedWords;re.test(G)&&(!this.inAsync&&G==="await"&&this.raiseRecoverable(x,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(x,"The keyword '"+G+"' is reserved"))}},A.parseIdent=function(c){var x=this.parseIdentNode();return this.next(!!c),this.finishNode(x,"Identifier"),c||(this.checkUnreserved(x),x.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=x.start)),x},A.parseIdentNode=function(){var c=this.startNode();return this.type===F.name?c.name=this.value:this.type.keyword?(c.name=this.type.keyword,(c.name==="class"||c.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=F.name):this.unexpected(),c},A.parsePrivateIdent=function(){var c=this.startNode();return this.type===F.privateId?c.name=this.value:this.unexpected(),this.next(),this.finishNode(c,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(c.start,"Private field '#"+c.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(c)),c},A.parseYield=function(c){this.yieldPos||(this.yieldPos=this.start);var x=this.startNode();return this.next(),this.type===F.semi||this.canInsertSemicolon()||this.type!==F.star&&!this.type.startsExpr?(x.delegate=!1,x.argument=null):(x.delegate=this.eat(F.star),x.argument=this.parseMaybeAssign(c)),this.finishNode(x,"YieldExpression")},A.parseAwait=function(c){this.awaitPos||(this.awaitPos=this.start);var x=this.startNode();return this.next(),x.argument=this.parseMaybeUnary(null,!0,!1,c),this.finishNode(x,"AwaitExpression")};var X=u.prototype;X.raise=function(c,x){var R=Ct(this.input,c);x+=" ("+R.line+":"+R.column+")",this.sourceFile&&(x+=" in "+this.sourceFile);var G=new SyntaxError(x);throw G.pos=c,G.loc=R,G.raisedAt=this.pos,G},X.raiseRecoverable=X.raise,X.curPosition=function(){if(this.options.locations)return new Fe(this.curLine,this.pos-this.lineStart)};var te=u.prototype,ie=function(x){this.flags=x,this.var=[],this.lexical=[],this.functions=[]};te.enterScope=function(c){this.scopeStack.push(new ie(c))},te.exitScope=function(){this.scopeStack.pop()},te.treatFunctionsAsVarInScope=function(c){return c.flags&At||!this.inModule&&c.flags&_t},te.declareName=function(c,x,R){var G=!1;if(x===Gt){var re=this.currentScope();G=re.lexical.indexOf(c)>-1||re.functions.indexOf(c)>-1||re.var.indexOf(c)>-1,re.lexical.push(c),this.inModule&&re.flags&_t&&delete this.undefinedExports[c]}else if(x===Nt){var Se=this.currentScope();Se.lexical.push(c)}else if(x===Ps){var Oe=this.currentScope();this.treatFunctionsAsVar?G=Oe.lexical.indexOf(c)>-1:G=Oe.lexical.indexOf(c)>-1||Oe.var.indexOf(c)>-1,Oe.functions.push(c)}else for(var Ge=this.scopeStack.length-1;Ge>=0;--Ge){var rt=this.scopeStack[Ge];if(rt.lexical.indexOf(c)>-1&&!(rt.flags&Os&&rt.lexical[0]===c)||!this.treatFunctionsAsVarInScope(rt)&&rt.functions.indexOf(c)>-1){G=!0;break}if(rt.var.push(c),this.inModule&&rt.flags&_t&&delete this.undefinedExports[c],rt.flags&Ni)break}G&&this.raiseRecoverable(R,"Identifier '"+c+"' has already been declared")},te.checkLocalExport=function(c){this.scopeStack[0].lexical.indexOf(c.name)===-1&&this.scopeStack[0].var.indexOf(c.name)===-1&&(this.undefinedExports[c.name]=c)},te.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},te.currentVarScope=function(){for(var c=this.scopeStack.length-1;;c--){var x=this.scopeStack[c];if(x.flags&(Ni|Ri|Nr))return x}},te.currentThisScope=function(){for(var c=this.scopeStack.length-1;;c--){var x=this.scopeStack[c];if(x.flags&(Ni|Ri|Nr)&&!(x.flags&Rr))return x}};var se=function(x,R,G){this.type="",this.start=R,this.end=0,x.options.locations&&(this.loc=new yt(x,G)),x.options.directSourceFile&&(this.sourceFile=x.options.directSourceFile),x.options.ranges&&(this.range=[R,0])},he=u.prototype;he.startNode=function(){return new se(this,this.start,this.startLoc)},he.startNodeAt=function(c,x){return new se(this,c,x)};function ne(c,x,R,G){return c.type=x,c.end=R,this.options.locations&&(c.loc.end=G),this.options.ranges&&(c.range[1]=R),c}he.finishNode=function(c,x){return ne.call(this,c,x,this.lastTokEnd,this.lastTokEndLoc)},he.finishNodeAt=function(c,x,R,G){return ne.call(this,c,x,R,G)},he.copyNode=function(c){var x=new se(this,c.start,this.startLoc);for(var R in c)x[R]=c[R];return x};var ce="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",fe="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ye=fe+" Extended_Pictographic",we=ye,Ee=we+" EBase EComp EMod EPres ExtPict",Be=Ee,Ue=Be,et={9:fe,10:ye,11:we,12:Ee,13:Be,14:Ue},it="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",Ie={9:"",10:"",11:"",12:"",13:"",14:it},De="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",tt="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",at=tt+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",st=at+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",xt=st+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",vt=xt+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",lt=vt+" "+ce,Lt={9:tt,10:at,11:st,12:xt,13:vt,14:lt},bt={};function pn(c){var x=bt[c]={binary:Xe(et[c]+" "+De),binaryOfStrings:Xe(Ie[c]),nonBinary:{General_Category:Xe(De),Script:Xe(Lt[c])}};x.nonBinary.Script_Extensions=x.nonBinary.Script,x.nonBinary.gc=x.nonBinary.General_Category,x.nonBinary.sc=x.nonBinary.Script,x.nonBinary.scx=x.nonBinary.Script_Extensions}for(var sn=0,Sn=[9,10,11,12,13,14];sn<Sn.length;sn+=1){var ln=Sn[sn];pn(ln)}var Ke=u.prototype,Ht=function(x,R){this.parent=x,this.base=R||this};Ht.prototype.separatedFrom=function(x){for(var R=this;R;R=R.parent)for(var G=x;G;G=G.parent)if(R.base===G.base&&R!==G)return!0;return!1},Ht.prototype.sibling=function(){return new Ht(this.parent,this.base)};var an=function(x){this.parser=x,this.validFlags="gim"+(x.options.ecmaVersion>=6?"uy":"")+(x.options.ecmaVersion>=9?"s":"")+(x.options.ecmaVersion>=13?"d":"")+(x.options.ecmaVersion>=15?"v":""),this.unicodeProperties=bt[x.options.ecmaVersion>=14?14:x.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};an.prototype.reset=function(x,R,G){var re=G.indexOf("v")!==-1,Se=G.indexOf("u")!==-1;this.start=x|0,this.source=R+"",this.flags=G,re&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Se&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Se&&this.parser.options.ecmaVersion>=9)},an.prototype.raise=function(x){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+x)},an.prototype.at=function(x,R){R===void 0&&(R=!1);var G=this.source,re=G.length;if(x>=re)return-1;var Se=G.charCodeAt(x);if(!(R||this.switchU)||Se<=55295||Se>=57344||x+1>=re)return Se;var Oe=G.charCodeAt(x+1);return Oe>=56320&&Oe<=57343?(Se<<10)+Oe-56613888:Se},an.prototype.nextIndex=function(x,R){R===void 0&&(R=!1);var G=this.source,re=G.length;if(x>=re)return re;var Se=G.charCodeAt(x),Oe;return!(R||this.switchU)||Se<=55295||Se>=57344||x+1>=re||(Oe=G.charCodeAt(x+1))<56320||Oe>57343?x+1:x+2},an.prototype.current=function(x){return x===void 0&&(x=!1),this.at(this.pos,x)},an.prototype.lookahead=function(x){return x===void 0&&(x=!1),this.at(this.nextIndex(this.pos,x),x)},an.prototype.advance=function(x){x===void 0&&(x=!1),this.pos=this.nextIndex(this.pos,x)},an.prototype.eat=function(x,R){return R===void 0&&(R=!1),this.current(R)===x?(this.advance(R),!0):!1},an.prototype.eatChars=function(x,R){R===void 0&&(R=!1);for(var G=this.pos,re=0,Se=x;re<Se.length;re+=1){var Oe=Se[re],Ge=this.at(G,R);if(Ge===-1||Ge!==Oe)return!1;G=this.nextIndex(G,R)}return this.pos=G,!0},Ke.validateRegExpFlags=function(c){for(var x=c.validFlags,R=c.flags,G=!1,re=!1,Se=0;Se<R.length;Se++){var Oe=R.charAt(Se);x.indexOf(Oe)===-1&&this.raise(c.start,"Invalid regular expression flag"),R.indexOf(Oe,Se+1)>-1&&this.raise(c.start,"Duplicate regular expression flag"),Oe==="u"&&(G=!0),Oe==="v"&&(re=!0)}this.options.ecmaVersion>=15&&G&&re&&this.raise(c.start,"Invalid regular expression flag")};function qt(c){for(var x in c)return!0;return!1}Ke.validateRegExpPattern=function(c){this.regexp_pattern(c),!c.switchN&&this.options.ecmaVersion>=9&&qt(c.groupNames)&&(c.switchN=!0,this.regexp_pattern(c))},Ke.regexp_pattern=function(c){c.pos=0,c.lastIntValue=0,c.lastStringValue="",c.lastAssertionIsQuantifiable=!1,c.numCapturingParens=0,c.maxBackReference=0,c.groupNames=Object.create(null),c.backReferenceNames.length=0,c.branchID=null,this.regexp_disjunction(c),c.pos!==c.source.length&&(c.eat(41)&&c.raise("Unmatched ')'"),(c.eat(93)||c.eat(125))&&c.raise("Lone quantifier brackets")),c.maxBackReference>c.numCapturingParens&&c.raise("Invalid escape");for(var x=0,R=c.backReferenceNames;x<R.length;x+=1){var G=R[x];c.groupNames[G]||c.raise("Invalid named capture referenced")}},Ke.regexp_disjunction=function(c){var x=this.options.ecmaVersion>=16;for(x&&(c.branchID=new Ht(c.branchID,null)),this.regexp_alternative(c);c.eat(124);)x&&(c.branchID=c.branchID.sibling()),this.regexp_alternative(c);x&&(c.branchID=c.branchID.parent),this.regexp_eatQuantifier(c,!0)&&c.raise("Nothing to repeat"),c.eat(123)&&c.raise("Lone quantifier brackets")},Ke.regexp_alternative=function(c){for(;c.pos<c.source.length&&this.regexp_eatTerm(c););},Ke.regexp_eatTerm=function(c){return this.regexp_eatAssertion(c)?(c.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(c)&&c.switchU&&c.raise("Invalid quantifier"),!0):(c.switchU?this.regexp_eatAtom(c):this.regexp_eatExtendedAtom(c))?(this.regexp_eatQuantifier(c),!0):!1},Ke.regexp_eatAssertion=function(c){var x=c.pos;if(c.lastAssertionIsQuantifiable=!1,c.eat(94)||c.eat(36))return!0;if(c.eat(92)){if(c.eat(66)||c.eat(98))return!0;c.pos=x}if(c.eat(40)&&c.eat(63)){var R=!1;if(this.options.ecmaVersion>=9&&(R=c.eat(60)),c.eat(61)||c.eat(33))return this.regexp_disjunction(c),c.eat(41)||c.raise("Unterminated group"),c.lastAssertionIsQuantifiable=!R,!0}return c.pos=x,!1},Ke.regexp_eatQuantifier=function(c,x){return x===void 0&&(x=!1),this.regexp_eatQuantifierPrefix(c,x)?(c.eat(63),!0):!1},Ke.regexp_eatQuantifierPrefix=function(c,x){return c.eat(42)||c.eat(43)||c.eat(63)||this.regexp_eatBracedQuantifier(c,x)},Ke.regexp_eatBracedQuantifier=function(c,x){var R=c.pos;if(c.eat(123)){var G=0,re=-1;if(this.regexp_eatDecimalDigits(c)&&(G=c.lastIntValue,c.eat(44)&&this.regexp_eatDecimalDigits(c)&&(re=c.lastIntValue),c.eat(125)))return re!==-1&&re<G&&!x&&c.raise("numbers out of order in {} quantifier"),!0;c.switchU&&!x&&c.raise("Incomplete quantifier"),c.pos=R}return!1},Ke.regexp_eatAtom=function(c){return this.regexp_eatPatternCharacters(c)||c.eat(46)||this.regexp_eatReverseSolidusAtomEscape(c)||this.regexp_eatCharacterClass(c)||this.regexp_eatUncapturingGroup(c)||this.regexp_eatCapturingGroup(c)},Ke.regexp_eatReverseSolidusAtomEscape=function(c){var x=c.pos;if(c.eat(92)){if(this.regexp_eatAtomEscape(c))return!0;c.pos=x}return!1},Ke.regexp_eatUncapturingGroup=function(c){var x=c.pos;if(c.eat(40)){if(c.eat(63)){if(this.options.ecmaVersion>=16){var R=this.regexp_eatModifiers(c),G=c.eat(45);if(R||G){for(var re=0;re<R.length;re++){var Se=R.charAt(re);R.indexOf(Se,re+1)>-1&&c.raise("Duplicate regular expression modifiers")}if(G){var Oe=this.regexp_eatModifiers(c);!R&&!Oe&&c.current()===58&&c.raise("Invalid regular expression modifiers");for(var Ge=0;Ge<Oe.length;Ge++){var rt=Oe.charAt(Ge);(Oe.indexOf(rt,Ge+1)>-1||R.indexOf(rt)>-1)&&c.raise("Duplicate regular expression modifiers")}}}}if(c.eat(58)){if(this.regexp_disjunction(c),c.eat(41))return!0;c.raise("Unterminated group")}}c.pos=x}return!1},Ke.regexp_eatCapturingGroup=function(c){if(c.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(c):c.current()===63&&c.raise("Invalid group"),this.regexp_disjunction(c),c.eat(41))return c.numCapturingParens+=1,!0;c.raise("Unterminated group")}return!1},Ke.regexp_eatModifiers=function(c){for(var x="",R=0;(R=c.current())!==-1&&tr(R);)x+=Qe(R),c.advance();return x};function tr(c){return c===105||c===109||c===115}Ke.regexp_eatExtendedAtom=function(c){return c.eat(46)||this.regexp_eatReverseSolidusAtomEscape(c)||this.regexp_eatCharacterClass(c)||this.regexp_eatUncapturingGroup(c)||this.regexp_eatCapturingGroup(c)||this.regexp_eatInvalidBracedQuantifier(c)||this.regexp_eatExtendedPatternCharacter(c)},Ke.regexp_eatInvalidBracedQuantifier=function(c){return this.regexp_eatBracedQuantifier(c,!0)&&c.raise("Nothing to repeat"),!1},Ke.regexp_eatSyntaxCharacter=function(c){var x=c.current();return Fr(x)?(c.lastIntValue=x,c.advance(),!0):!1};function Fr(c){return c===36||c>=40&&c<=43||c===46||c===63||c>=91&&c<=94||c>=123&&c<=125}Ke.regexp_eatPatternCharacters=function(c){for(var x=c.pos,R=0;(R=c.current())!==-1&&!Fr(R);)c.advance();return c.pos!==x},Ke.regexp_eatExtendedPatternCharacter=function(c){var x=c.current();return x!==-1&&x!==36&&!(x>=40&&x<=43)&&x!==46&&x!==63&&x!==91&&x!==94&&x!==124?(c.advance(),!0):!1},Ke.regexp_groupSpecifier=function(c){if(c.eat(63)){this.regexp_eatGroupName(c)||c.raise("Invalid group");var x=this.options.ecmaVersion>=16,R=c.groupNames[c.lastStringValue];if(R)if(x)for(var G=0,re=R;G<re.length;G+=1){var Se=re[G];Se.separatedFrom(c.branchID)||c.raise("Duplicate capture group name")}else c.raise("Duplicate capture group name");x?(R||(c.groupNames[c.lastStringValue]=[])).push(c.branchID):c.groupNames[c.lastStringValue]=!0}},Ke.regexp_eatGroupName=function(c){if(c.lastStringValue="",c.eat(60)){if(this.regexp_eatRegExpIdentifierName(c)&&c.eat(62))return!0;c.raise("Invalid capture group name")}return!1},Ke.regexp_eatRegExpIdentifierName=function(c){if(c.lastStringValue="",this.regexp_eatRegExpIdentifierStart(c)){for(c.lastStringValue+=Qe(c.lastIntValue);this.regexp_eatRegExpIdentifierPart(c);)c.lastStringValue+=Qe(c.lastIntValue);return!0}return!1},Ke.regexp_eatRegExpIdentifierStart=function(c){var x=c.pos,R=this.options.ecmaVersion>=11,G=c.current(R);return c.advance(R),G===92&&this.regexp_eatRegExpUnicodeEscapeSequence(c,R)&&(G=c.lastIntValue),fr(G)?(c.lastIntValue=G,!0):(c.pos=x,!1)};function fr(c){return Q(c,!0)||c===36||c===95}Ke.regexp_eatRegExpIdentifierPart=function(c){var x=c.pos,R=this.options.ecmaVersion>=11,G=c.current(R);return c.advance(R),G===92&&this.regexp_eatRegExpUnicodeEscapeSequence(c,R)&&(G=c.lastIntValue),Wn(G)?(c.lastIntValue=G,!0):(c.pos=x,!1)};function Wn(c){return W(c,!0)||c===36||c===95||c===8204||c===8205}Ke.regexp_eatAtomEscape=function(c){return this.regexp_eatBackReference(c)||this.regexp_eatCharacterClassEscape(c)||this.regexp_eatCharacterEscape(c)||c.switchN&&this.regexp_eatKGroupName(c)?!0:(c.switchU&&(c.current()===99&&c.raise("Invalid unicode escape"),c.raise("Invalid escape")),!1)},Ke.regexp_eatBackReference=function(c){var x=c.pos;if(this.regexp_eatDecimalEscape(c)){var R=c.lastIntValue;if(c.switchU)return R>c.maxBackReference&&(c.maxBackReference=R),!0;if(R<=c.numCapturingParens)return!0;c.pos=x}return!1},Ke.regexp_eatKGroupName=function(c){if(c.eat(107)){if(this.regexp_eatGroupName(c))return c.backReferenceNames.push(c.lastStringValue),!0;c.raise("Invalid named reference")}return!1},Ke.regexp_eatCharacterEscape=function(c){return this.regexp_eatControlEscape(c)||this.regexp_eatCControlLetter(c)||this.regexp_eatZero(c)||this.regexp_eatHexEscapeSequence(c)||this.regexp_eatRegExpUnicodeEscapeSequence(c,!1)||!c.switchU&&this.regexp_eatLegacyOctalEscapeSequence(c)||this.regexp_eatIdentityEscape(c)},Ke.regexp_eatCControlLetter=function(c){var x=c.pos;if(c.eat(99)){if(this.regexp_eatControlLetter(c))return!0;c.pos=x}return!1},Ke.regexp_eatZero=function(c){return c.current()===48&&!Vt(c.lookahead())?(c.lastIntValue=0,c.advance(),!0):!1},Ke.regexp_eatControlEscape=function(c){var x=c.current();return x===116?(c.lastIntValue=9,c.advance(),!0):x===110?(c.lastIntValue=10,c.advance(),!0):x===118?(c.lastIntValue=11,c.advance(),!0):x===102?(c.lastIntValue=12,c.advance(),!0):x===114?(c.lastIntValue=13,c.advance(),!0):!1},Ke.regexp_eatControlLetter=function(c){var x=c.current();return Cn(x)?(c.lastIntValue=x%32,c.advance(),!0):!1};function Cn(c){return c>=65&&c<=90||c>=97&&c<=122}Ke.regexp_eatRegExpUnicodeEscapeSequence=function(c,x){x===void 0&&(x=!1);var R=c.pos,G=x||c.switchU;if(c.eat(117)){if(this.regexp_eatFixedHexDigits(c,4)){var re=c.lastIntValue;if(G&&re>=55296&&re<=56319){var Se=c.pos;if(c.eat(92)&&c.eat(117)&&this.regexp_eatFixedHexDigits(c,4)){var Oe=c.lastIntValue;if(Oe>=56320&&Oe<=57343)return c.lastIntValue=(re-55296)*1024+(Oe-56320)+65536,!0}c.pos=Se,c.lastIntValue=re}return!0}if(G&&c.eat(123)&&this.regexp_eatHexDigits(c)&&c.eat(125)&&On(c.lastIntValue))return!0;G&&c.raise("Invalid unicode escape"),c.pos=R}return!1};function On(c){return c>=0&&c<=1114111}Ke.regexp_eatIdentityEscape=function(c){if(c.switchU)return this.regexp_eatSyntaxCharacter(c)?!0:c.eat(47)?(c.lastIntValue=47,!0):!1;var x=c.current();return x!==99&&(!c.switchN||x!==107)?(c.lastIntValue=x,c.advance(),!0):!1},Ke.regexp_eatDecimalEscape=function(c){c.lastIntValue=0;var x=c.current();if(x>=49&&x<=57){do c.lastIntValue=10*c.lastIntValue+(x-48),c.advance();while((x=c.current())>=48&&x<=57);return!0}return!1};var nr=0,vn=1,Fn=2;Ke.regexp_eatCharacterClassEscape=function(c){var x=c.current();if(As(x))return c.lastIntValue=-1,c.advance(),vn;var R=!1;if(c.switchU&&this.options.ecmaVersion>=9&&((R=x===80)||x===112)){c.lastIntValue=-1,c.advance();var G;if(c.eat(123)&&(G=this.regexp_eatUnicodePropertyValueExpression(c))&&c.eat(125))return R&&G===Fn&&c.raise("Invalid property name"),G;c.raise("Invalid property name")}return nr};function As(c){return c===100||c===68||c===115||c===83||c===119||c===87}Ke.regexp_eatUnicodePropertyValueExpression=function(c){var x=c.pos;if(this.regexp_eatUnicodePropertyName(c)&&c.eat(61)){var R=c.lastStringValue;if(this.regexp_eatUnicodePropertyValue(c)){var G=c.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(c,R,G),vn}}if(c.pos=x,this.regexp_eatLoneUnicodePropertyNameOrValue(c)){var re=c.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(c,re)}return nr},Ke.regexp_validateUnicodePropertyNameAndValue=function(c,x,R){Le(c.unicodeProperties.nonBinary,x)||c.raise("Invalid property name"),c.unicodeProperties.nonBinary[x].test(R)||c.raise("Invalid property value")},Ke.regexp_validateUnicodePropertyNameOrValue=function(c,x){if(c.unicodeProperties.binary.test(x))return vn;if(c.switchV&&c.unicodeProperties.binaryOfStrings.test(x))return Fn;c.raise("Invalid property name")},Ke.regexp_eatUnicodePropertyName=function(c){var x=0;for(c.lastStringValue="";Ms(x=c.current());)c.lastStringValue+=Qe(x),c.advance();return c.lastStringValue!==""};function Ms(c){return Cn(c)||c===95}Ke.regexp_eatUnicodePropertyValue=function(c){var x=0;for(c.lastStringValue="";js(x=c.current());)c.lastStringValue+=Qe(x),c.advance();return c.lastStringValue!==""};function js(c){return Ms(c)||Vt(c)}Ke.regexp_eatLoneUnicodePropertyNameOrValue=function(c){return this.regexp_eatUnicodePropertyValue(c)},Ke.regexp_eatCharacterClass=function(c){if(c.eat(91)){var x=c.eat(94),R=this.regexp_classContents(c);return c.eat(93)||c.raise("Unterminated character class"),x&&R===Fn&&c.raise("Negated character class may contain strings"),!0}return!1},Ke.regexp_classContents=function(c){return c.current()===93?vn:c.switchV?this.regexp_classSetExpression(c):(this.regexp_nonEmptyClassRanges(c),vn)},Ke.regexp_nonEmptyClassRanges=function(c){for(;this.regexp_eatClassAtom(c);){var x=c.lastIntValue;if(c.eat(45)&&this.regexp_eatClassAtom(c)){var R=c.lastIntValue;c.switchU&&(x===-1||R===-1)&&c.raise("Invalid character class"),x!==-1&&R!==-1&&x>R&&c.raise("Range out of order in character class")}}},Ke.regexp_eatClassAtom=function(c){var x=c.pos;if(c.eat(92)){if(this.regexp_eatClassEscape(c))return!0;if(c.switchU){var R=c.current();(R===99||Br(R))&&c.raise("Invalid class escape"),c.raise("Invalid escape")}c.pos=x}var G=c.current();return G!==93?(c.lastIntValue=G,c.advance(),!0):!1},Ke.regexp_eatClassEscape=function(c){var x=c.pos;if(c.eat(98))return c.lastIntValue=8,!0;if(c.switchU&&c.eat(45))return c.lastIntValue=45,!0;if(!c.switchU&&c.eat(99)){if(this.regexp_eatClassControlLetter(c))return!0;c.pos=x}return this.regexp_eatCharacterClassEscape(c)||this.regexp_eatCharacterEscape(c)},Ke.regexp_classSetExpression=function(c){var x=vn,R;if(!this.regexp_eatClassSetRange(c))if(R=this.regexp_eatClassSetOperand(c)){R===Fn&&(x=Fn);for(var G=c.pos;c.eatChars([38,38]);){if(c.current()!==38&&(R=this.regexp_eatClassSetOperand(c))){R!==Fn&&(x=vn);continue}c.raise("Invalid character in character class")}if(G!==c.pos)return x;for(;c.eatChars([45,45]);)this.regexp_eatClassSetOperand(c)||c.raise("Invalid character in character class");if(G!==c.pos)return x}else c.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(c)){if(R=this.regexp_eatClassSetOperand(c),!R)return x;R===Fn&&(x=Fn)}},Ke.regexp_eatClassSetRange=function(c){var x=c.pos;if(this.regexp_eatClassSetCharacter(c)){var R=c.lastIntValue;if(c.eat(45)&&this.regexp_eatClassSetCharacter(c)){var G=c.lastIntValue;return R!==-1&&G!==-1&&R>G&&c.raise("Range out of order in character class"),!0}c.pos=x}return!1},Ke.regexp_eatClassSetOperand=function(c){return this.regexp_eatClassSetCharacter(c)?vn:this.regexp_eatClassStringDisjunction(c)||this.regexp_eatNestedClass(c)},Ke.regexp_eatNestedClass=function(c){var x=c.pos;if(c.eat(91)){var R=c.eat(94),G=this.regexp_classContents(c);if(c.eat(93))return R&&G===Fn&&c.raise("Negated character class may contain strings"),G;c.pos=x}if(c.eat(92)){var re=this.regexp_eatCharacterClassEscape(c);if(re)return re;c.pos=x}return null},Ke.regexp_eatClassStringDisjunction=function(c){var x=c.pos;if(c.eatChars([92,113])){if(c.eat(123)){var R=this.regexp_classStringDisjunctionContents(c);if(c.eat(125))return R}else c.raise("Invalid escape");c.pos=x}return null},Ke.regexp_classStringDisjunctionContents=function(c){for(var x=this.regexp_classString(c);c.eat(124);)this.regexp_classString(c)===Fn&&(x=Fn);return x},Ke.regexp_classString=function(c){for(var x=0;this.regexp_eatClassSetCharacter(c);)x++;return x===1?vn:Fn},Ke.regexp_eatClassSetCharacter=function(c){var x=c.pos;if(c.eat(92))return this.regexp_eatCharacterEscape(c)||this.regexp_eatClassSetReservedPunctuator(c)?!0:c.eat(98)?(c.lastIntValue=8,!0):(c.pos=x,!1);var R=c.current();return R<0||R===c.lookahead()&&Fi(R)||Za(R)?!1:(c.advance(),c.lastIntValue=R,!0)};function Fi(c){return c===33||c>=35&&c<=38||c>=42&&c<=44||c===46||c>=58&&c<=64||c===94||c===96||c===126}function Za(c){return c===40||c===41||c===45||c===47||c>=91&&c<=93||c>=123&&c<=125}Ke.regexp_eatClassSetReservedPunctuator=function(c){var x=c.current();return Bi(x)?(c.lastIntValue=x,c.advance(),!0):!1};function Bi(c){return c===33||c===35||c===37||c===38||c===44||c===45||c>=58&&c<=62||c===64||c===96||c===126}Ke.regexp_eatClassControlLetter=function(c){var x=c.current();return Vt(x)||x===95?(c.lastIntValue=x%32,c.advance(),!0):!1},Ke.regexp_eatHexEscapeSequence=function(c){var x=c.pos;if(c.eat(120)){if(this.regexp_eatFixedHexDigits(c,2))return!0;c.switchU&&c.raise("Invalid escape"),c.pos=x}return!1},Ke.regexp_eatDecimalDigits=function(c){var x=c.pos,R=0;for(c.lastIntValue=0;Vt(R=c.current());)c.lastIntValue=10*c.lastIntValue+(R-48),c.advance();return c.pos!==x};function Vt(c){return c>=48&&c<=57}Ke.regexp_eatHexDigits=function(c){var x=c.pos,R=0;for(c.lastIntValue=0;zi(R=c.current());)c.lastIntValue=16*c.lastIntValue+Vi(R),c.advance();return c.pos!==x};function zi(c){return c>=48&&c<=57||c>=65&&c<=70||c>=97&&c<=102}function Vi(c){return c>=65&&c<=70?10+(c-65):c>=97&&c<=102?10+(c-97):c-48}Ke.regexp_eatLegacyOctalEscapeSequence=function(c){if(this.regexp_eatOctalDigit(c)){var x=c.lastIntValue;if(this.regexp_eatOctalDigit(c)){var R=c.lastIntValue;x<=3&&this.regexp_eatOctalDigit(c)?c.lastIntValue=x*64+R*8+c.lastIntValue:c.lastIntValue=x*8+R}else c.lastIntValue=x;return!0}return!1},Ke.regexp_eatOctalDigit=function(c){var x=c.current();return Br(x)?(c.lastIntValue=x-48,c.advance(),!0):(c.lastIntValue=0,!1)};function Br(c){return c>=48&&c<=55}Ke.regexp_eatFixedHexDigits=function(c,x){var R=c.pos;c.lastIntValue=0;for(var G=0;G<x;++G){var re=c.current();if(!zi(re))return c.pos=R,!1;c.lastIntValue=16*c.lastIntValue+Vi(re),c.advance()}return!0};var dr=function(x){this.type=x.type,this.value=x.value,this.start=x.start,this.end=x.end,x.options.locations&&(this.loc=new yt(x,x.startLoc,x.endLoc)),x.options.ranges&&(this.range=[x.start,x.end])},Pt=u.prototype;Pt.next=function(c){!c&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new dr(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Pt.getToken=function(){return this.next(),new dr(this)},typeof Symbol<"u"&&(Pt[Symbol.iterator]=function(){var c=this;return{next:function(){var x=c.getToken();return{done:x.type===F.eof,value:x}}}}),Pt.nextToken=function(){var c=this.curContext();if((!c||!c.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(F.eof);if(c.override)return c.override(this);this.readToken(this.fullCharCodeAtPos())},Pt.readToken=function(c){return Q(c,this.options.ecmaVersion>=6)||c===92?this.readWord():this.getTokenFromCode(c)},Pt.fullCharCodeAtPos=function(){var c=this.input.charCodeAt(this.pos);if(c<=55295||c>=56320)return c;var x=this.input.charCodeAt(this.pos+1);return x<=56319||x>=57344?c:(c<<10)+x-56613888},Pt.skipBlockComment=function(){var c=this.options.onComment&&this.curPosition(),x=this.pos,R=this.input.indexOf("*/",this.pos+=2);if(R===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=R+2,this.options.locations)for(var G=void 0,re=x;(G=ot(this.input,re,this.pos))>-1;)++this.curLine,re=this.lineStart=G;this.options.onComment&&this.options.onComment(!0,this.input.slice(x+2,R),x,this.pos,c,this.curPosition())},Pt.skipLineComment=function(c){for(var x=this.pos,R=this.options.onComment&&this.curPosition(),G=this.input.charCodeAt(this.pos+=c);this.pos<this.input.length&&!qe(G);)G=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(x+c,this.pos),x,this.pos,R,this.curPosition())},Pt.skipSpace=function(){e:for(;this.pos<this.input.length;){var c=this.input.charCodeAt(this.pos);switch(c){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(c>8&&c<14||c>=5760&&je.test(String.fromCharCode(c)))++this.pos;else break e}}},Pt.finishToken=function(c,x){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var R=this.type;this.type=c,this.value=x,this.updateContext(R)},Pt.readToken_dot=function(){var c=this.input.charCodeAt(this.pos+1);if(c>=48&&c<=57)return this.readNumber(!0);var x=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&c===46&&x===46?(this.pos+=3,this.finishToken(F.ellipsis)):(++this.pos,this.finishToken(F.dot))},Pt.readToken_slash=function(){var c=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):c===61?this.finishOp(F.assign,2):this.finishOp(F.slash,1)},Pt.readToken_mult_modulo_exp=function(c){var x=this.input.charCodeAt(this.pos+1),R=1,G=c===42?F.star:F.modulo;return this.options.ecmaVersion>=7&&c===42&&x===42&&(++R,G=F.starstar,x=this.input.charCodeAt(this.pos+2)),x===61?this.finishOp(F.assign,R+1):this.finishOp(G,R)},Pt.readToken_pipe_amp=function(c){var x=this.input.charCodeAt(this.pos+1);if(x===c){if(this.options.ecmaVersion>=12){var R=this.input.charCodeAt(this.pos+2);if(R===61)return this.finishOp(F.assign,3)}return this.finishOp(c===124?F.logicalOR:F.logicalAND,2)}return x===61?this.finishOp(F.assign,2):this.finishOp(c===124?F.bitwiseOR:F.bitwiseAND,1)},Pt.readToken_caret=function(){var c=this.input.charCodeAt(this.pos+1);return c===61?this.finishOp(F.assign,2):this.finishOp(F.bitwiseXOR,1)},Pt.readToken_plus_min=function(c){var x=this.input.charCodeAt(this.pos+1);return x===c?x===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Ne.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(F.incDec,2):x===61?this.finishOp(F.assign,2):this.finishOp(F.plusMin,1)},Pt.readToken_lt_gt=function(c){var x=this.input.charCodeAt(this.pos+1),R=1;return x===c?(R=c===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+R)===61?this.finishOp(F.assign,R+1):this.finishOp(F.bitShift,R)):x===33&&c===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(x===61&&(R=2),this.finishOp(F.relational,R))},Pt.readToken_eq_excl=function(c){var x=this.input.charCodeAt(this.pos+1);return x===61?this.finishOp(F.equality,this.input.charCodeAt(this.pos+2)===61?3:2):c===61&&x===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(F.arrow)):this.finishOp(c===61?F.eq:F.prefix,1)},Pt.readToken_question=function(){var c=this.options.ecmaVersion;if(c>=11){var x=this.input.charCodeAt(this.pos+1);if(x===46){var R=this.input.charCodeAt(this.pos+2);if(R<48||R>57)return this.finishOp(F.questionDot,2)}if(x===63){if(c>=12){var G=this.input.charCodeAt(this.pos+2);if(G===61)return this.finishOp(F.assign,3)}return this.finishOp(F.coalesce,2)}}return this.finishOp(F.question,1)},Pt.readToken_numberSign=function(){var c=this.options.ecmaVersion,x=35;if(c>=13&&(++this.pos,x=this.fullCharCodeAtPos(),Q(x,!0)||x===92))return this.finishToken(F.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+Qe(x)+"'")},Pt.getTokenFromCode=function(c){switch(c){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(F.parenL);case 41:return++this.pos,this.finishToken(F.parenR);case 59:return++this.pos,this.finishToken(F.semi);case 44:return++this.pos,this.finishToken(F.comma);case 91:return++this.pos,this.finishToken(F.bracketL);case 93:return++this.pos,this.finishToken(F.bracketR);case 123:return++this.pos,this.finishToken(F.braceL);case 125:return++this.pos,this.finishToken(F.braceR);case 58:return++this.pos,this.finishToken(F.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(F.backQuote);case 48:var x=this.input.charCodeAt(this.pos+1);if(x===120||x===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(x===111||x===79)return this.readRadixNumber(8);if(x===98||x===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(c);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(c);case 124:case 38:return this.readToken_pipe_amp(c);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(c);case 60:case 62:return this.readToken_lt_gt(c);case 61:case 33:return this.readToken_eq_excl(c);case 63:return this.readToken_question();case 126:return this.finishOp(F.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+Qe(c)+"'")},Pt.finishOp=function(c,x){var R=this.input.slice(this.pos,this.pos+x);return this.pos+=x,this.finishToken(c,R)},Pt.readRegexp=function(){for(var c,x,R=this.pos;;){this.pos>=this.input.length&&this.raise(R,"Unterminated regular expression");var G=this.input.charAt(this.pos);if(Ne.test(G)&&this.raise(R,"Unterminated regular expression"),c)c=!1;else{if(G==="[")x=!0;else if(G==="]"&&x)x=!1;else if(G==="/"&&!x)break;c=G==="\\"}++this.pos}var re=this.input.slice(R,this.pos);++this.pos;var Se=this.pos,Oe=this.readWord1();this.containsEsc&&this.unexpected(Se);var Ge=this.regexpState||(this.regexpState=new an(this));Ge.reset(R,re,Oe),this.validateRegExpFlags(Ge),this.validateRegExpPattern(Ge);var rt=null;try{rt=new RegExp(re,Oe)}catch{}return this.finishToken(F.regexp,{pattern:re,flags:Oe,value:rt})},Pt.readInt=function(c,x,R){for(var G=this.options.ecmaVersion>=12&&x===void 0,re=R&&this.input.charCodeAt(this.pos)===48,Se=this.pos,Oe=0,Ge=0,rt=0,Ot=x??1/0;rt<Ot;++rt,++this.pos){var jt=this.input.charCodeAt(this.pos),Kt=void 0;if(G&&jt===95){re&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Ge===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),rt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Ge=jt;continue}if(jt>=97?Kt=jt-97+10:jt>=65?Kt=jt-65+10:jt>=48&&jt<=57?Kt=jt-48:Kt=1/0,Kt>=c)break;Ge=jt,Oe=Oe*c+Kt}return G&&Ge===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Se||x!=null&&this.pos-Se!==x?null:Oe};function rr(c,x){return x?parseInt(c,8):parseFloat(c.replace(/_/g,""))}function ir(c){return typeof BigInt!="function"?null:BigInt(c.replace(/_/g,""))}Pt.readRadixNumber=function(c){var x=this.pos;this.pos+=2;var R=this.readInt(c);return R==null&&this.raise(this.start+2,"Expected number in radix "+c),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(R=ir(this.input.slice(x,this.pos)),++this.pos):Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(F.num,R)},Pt.readNumber=function(c){var x=this.pos;!c&&this.readInt(10,void 0,!0)===null&&this.raise(x,"Invalid number");var R=this.pos-x>=2&&this.input.charCodeAt(x)===48;R&&this.strict&&this.raise(x,"Invalid number");var G=this.input.charCodeAt(this.pos);if(!R&&!c&&this.options.ecmaVersion>=11&&G===110){var re=ir(this.input.slice(x,this.pos));return++this.pos,Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(F.num,re)}R&&/[89]/.test(this.input.slice(x,this.pos))&&(R=!1),G===46&&!R&&(++this.pos,this.readInt(10),G=this.input.charCodeAt(this.pos)),(G===69||G===101)&&!R&&(G=this.input.charCodeAt(++this.pos),(G===43||G===45)&&++this.pos,this.readInt(10)===null&&this.raise(x,"Invalid number")),Q(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Se=rr(this.input.slice(x,this.pos),R);return this.finishToken(F.num,Se)},Pt.readCodePoint=function(){var c=this.input.charCodeAt(this.pos),x;if(c===123){this.options.ecmaVersion<6&&this.unexpected();var R=++this.pos;x=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,x>1114111&&this.invalidStringToken(R,"Code point out of bounds")}else x=this.readHexChar(4);return x},Pt.readString=function(c){for(var x="",R=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var G=this.input.charCodeAt(this.pos);if(G===c)break;G===92?(x+=this.input.slice(R,this.pos),x+=this.readEscapedChar(!1),R=this.pos):G===8232||G===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(qe(G)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return x+=this.input.slice(R,this.pos++),this.finishToken(F.string,x)};var Un={};Pt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(c){if(c===Un)this.readInvalidTemplateToken();else throw c}this.inTemplateElement=!1},Pt.invalidStringToken=function(c,x){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Un;this.raise(c,x)},Pt.readTmplToken=function(){for(var c="",x=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var R=this.input.charCodeAt(this.pos);if(R===96||R===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===F.template||this.type===F.invalidTemplate)?R===36?(this.pos+=2,this.finishToken(F.dollarBraceL)):(++this.pos,this.finishToken(F.backQuote)):(c+=this.input.slice(x,this.pos),this.finishToken(F.template,c));if(R===92)c+=this.input.slice(x,this.pos),c+=this.readEscapedChar(!0),x=this.pos;else if(qe(R)){switch(c+=this.input.slice(x,this.pos),++this.pos,R){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:c+=`
`;break;default:c+=String.fromCharCode(R);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),x=this.pos}else++this.pos}},Pt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(F.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},Pt.readEscapedChar=function(c){var x=this.input.charCodeAt(++this.pos);switch(++this.pos,x){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Qe(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),c){var R=this.pos-1;this.invalidStringToken(R,"Invalid escape sequence in template string")}default:if(x>=48&&x<=55){var G=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],re=parseInt(G,8);return re>255&&(G=G.slice(0,-1),re=parseInt(G,8)),this.pos+=G.length-1,x=this.input.charCodeAt(this.pos),(G!=="0"||x===56||x===57)&&(this.strict||c)&&this.invalidStringToken(this.pos-1-G.length,c?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(re)}return qe(x)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(x)}},Pt.readHexChar=function(c){var x=this.pos,R=this.readInt(16,c);return R===null&&this.invalidStringToken(x,"Bad character escape sequence"),R},Pt.readWord1=function(){this.containsEsc=!1;for(var c="",x=!0,R=this.pos,G=this.options.ecmaVersion>=6;this.pos<this.input.length;){var re=this.fullCharCodeAtPos();if(W(re,G))this.pos+=re<=65535?1:2;else if(re===92){this.containsEsc=!0,c+=this.input.slice(R,this.pos);var Se=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Oe=this.readCodePoint();(x?Q:W)(Oe,G)||this.invalidStringToken(Se,"Invalid Unicode escape"),c+=Qe(Oe),R=this.pos}else break;x=!1}return c+this.input.slice(R,this.pos)},Pt.readWord=function(){var c=this.readWord1(),x=F.name;return this.keywords.test(c)&&(x=ge[c]),this.finishToken(x,c)};var Hn="8.15.0";u.acorn={Parser:u,version:Hn,defaultOptions:pt,Position:Fe,SourceLocation:yt,getLineInfo:Ct,Node:se,TokenType:ee,tokTypes:F,keywordTypes:ge,TokContext:H,tokContexts:D,isIdentifierChar:W,isIdentifierStart:Q,Token:dr,isNewLine:qe,lineBreak:Ne,lineBreakG:Ve,nonASCIIwhitespace:je};function Sr(c,x){return u.parse(c,x)}function Cr(c,x,R){return u.parseExpressionAt(c,x,R)}function gi(c,x){return u.tokenizer(c,x)}t.Node=se,t.Parser=u,t.Position=Fe,t.SourceLocation=yt,t.TokContext=H,t.Token=dr,t.TokenType=ee,t.defaultOptions=pt,t.getLineInfo=Ct,t.isIdentifierChar=W,t.isIdentifierStart=Q,t.isNewLine=qe,t.keywordTypes=ge,t.lineBreak=Ne,t.lineBreakG=Ve,t.nonASCIIwhitespace=je,t.parse=Sr,t.parseExpressionAt=Cr,t.tokContexts=D,t.tokTypes=F,t.tokenizer=gi,t.version=Hn}))})(Vl,Vl.exports)),Vl.exports}/*!
 * Paper.js v0.12.18 - The Swiss Army Knife of Vector Graphics Scripting.
 * http://paperjs.org/
 *
 * Copyright (c) 2011 - 2020, Jrg Lehni & Jonathan Puckey
 * http://juerglehni.com/ & https://puckey.studio/
 *
 * Distributed under the MIT license. See LICENSE file for details.
 *
 * All rights reserved.
 *
 * Date: Wed Jul 17 14:57:24 2024 +0200
 *
 ***
 *
 * Straps.js - Class inheritance library with support for bean-style accessors
 *
 * Copyright (c) 2006 - 2020 Jrg Lehni
 * http://juerglehni.com/
 *
 * Distributed under the MIT license.
 *
 ***
 *
 * Acorn.js
 * https://marijnhaverbeke.nl/acorn/
 *
 * Acorn is a tiny, fast JavaScript parser written in JavaScript,
 * created by Marijn Haverbeke and released under an MIT license.
 *
 */var nS=Fc.exports,km;function rS(){return km||(km=1,(function(o){(function(e,t){e=e||Sm;var n=e.window,i=e.document,a=new function(){var r=/^(statics|enumerable|beans|preserve)$/,u=[],f=u.slice,g=Object.create,v=Object.getOwnPropertyDescriptor,w=Object.defineProperty,S=u.forEach||function(L,j){for(var Y=0,z=this.length;Y<z;Y++)L.call(j,this[Y],Y,this)},C=function(L,j){for(var Y in this)this.hasOwnProperty(Y)&&L.call(j,this[Y],Y,this)},T=Object.assign||function(L){for(var j=1,Y=arguments.length;j<Y;j++){var z=arguments[j];for(var H in z)z.hasOwnProperty(H)&&(L[H]=z[H])}return L},P=function(L,j,Y){if(L){var z=v(L,"length");(z&&typeof z.value=="number"?S:C).call(L,j,Y=Y||L)}return Y};function N(L,j,Y,z,H){var D={};function U(X,te){te=te||(te=v(j,X))&&(te.get?te:te.value),typeof te=="string"&&te[0]==="#"&&(te=L[te.substring(1)]||te);var ie=typeof te=="function",se=te,he=H||ie&&!te.base?te&&te.get?X in L:L[X]:null,ne;(!H||!he)&&(ie&&he&&(te.base=he),ie&&z!==!1&&(ne=X.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(D[ne[3].toLowerCase()+ne[4]]=ne[2]),(!se||ie||!se.get||typeof se.get!="function"||!B.isPlainObject(se))&&(se={value:se,writable:!0}),(v(L,X)||{configurable:!0}).configurable&&(se.configurable=!0,se.enumerable=Y??!ne),w(L,X,se))}if(j){for(var A in j)j.hasOwnProperty(A)&&!r.test(A)&&U(A);for(var A in D){var V=D[A],q=L["set"+V],J=L["get"+V]||q&&L["is"+V];J&&(z===!0||J.length===0)&&U(A,{get:J,set:q})}}return L}function B(){for(var L=0,j=arguments.length;L<j;L++){var Y=arguments[L];Y&&T(this,Y)}return this}return N(B,{inject:function(L){if(L){var j=L.statics===!0?L:L.statics,Y=L.beans,z=L.preserve;j!==L&&N(this.prototype,L,L.enumerable,Y,z),N(this,j,null,Y,z)}for(var H=1,D=arguments.length;H<D;H++)this.inject(arguments[H]);return this},extend:function(){for(var L=this,j,Y,z=0,H,D=arguments.length;z<D&&!(j&&Y);z++)H=arguments[z],j=j||H.initialize,Y=Y||H.prototype;return j=j||function(){L.apply(this,arguments)},Y=j.prototype=Y||g(this.prototype),w(Y,"constructor",{value:j,writable:!0,configurable:!0}),N(j,this),arguments.length&&this.inject.apply(j,arguments),j.base=L,j}}).inject({enumerable:!1,initialize:B,set:B,inject:function(){for(var L=0,j=arguments.length;L<j;L++){var Y=arguments[L];Y&&N(this,Y,Y.enumerable,Y.beans,Y.preserve)}return this},extend:function(){var L=g(this);return L.inject.apply(L,arguments)},each:function(L,j){return P(this,L,j)},clone:function(){return new this.constructor(this)},statics:{set:T,each:P,create:g,define:w,describe:v,clone:function(L){return T(new L.constructor,L)},isPlainObject:function(L){var j=L!=null&&L.constructor;return j&&(j===Object||j===B||j.name==="Object")},pick:function(L,j){return L!==t?L:j},slice:function(L,j,Y){return f.call(L,j,Y)}}})};o.exports=a,a.inject({enumerable:!1,toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+a.each(this,function(r,u){if(!/^_/.test(u)){var f=typeof r;this.push(u+": "+(f==="number"?b.instance.number(r):f==="string"?"'"+r+"'":r))}},[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(r){return a.importJSON(r,this)},exportJSON:function(r){return a.exportJSON(this,r)},toJSON:function(){return a.serialize(this)},set:function(r,u){return r&&a.filter(this,r,u,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function r(){var u=r.base.apply(this,arguments),f=u.prototype._class;return f&&!a.exports[f]&&(a.exports[f]=u),u},equals:function(r,u){if(r===u)return!0;if(r&&r.equals)return r.equals(u);if(u&&u.equals)return u.equals(r);if(r&&u&&typeof r=="object"&&typeof u=="object"){if(Array.isArray(r)&&Array.isArray(u)){var f=r.length;if(f!==u.length)return!1;for(;f--;)if(!a.equals(r[f],u[f]))return!1}else{var g=Object.keys(r),f=g.length;if(f!==Object.keys(u).length)return!1;for(;f--;){var v=g[f];if(!(u.hasOwnProperty(v)&&a.equals(r[v],u[v])))return!1}}return!0}return!1},read:function(r,u,f,g){if(this===a){var v=this.peek(r,u);return r.__index++,v}var w=this.prototype,S=w._readIndex,C=u||S&&r.__index||0,T=r.length,P=r[C];if(g=g||T-C,P instanceof this||f&&f.readNull&&P==null&&g<=1)return S&&(r.__index=C+1),P&&f&&f.clone?P.clone():P;if(P=a.create(w),S&&(P.__read=!0),P=P.initialize.apply(P,C>0||C+g<T?a.slice(r,C,C+g):r)||P,S){r.__index=C+P.__read;var N=P.__filtered;N&&(r.__filtered=N,P.__filtered=t),P.__read=t}return P},peek:function(r,u){return r[r.__index=u||r.__index||0]},remain:function(r){return r.length-(r.__index||0)},readList:function(r,u,f,g){for(var v=[],w,S=u||0,C=g?S+g:r.length,T=S;T<C;T++)v.push(Array.isArray(w=r[T])?this.read(w,0,f):this.read(r,T,f,1));return v},readNamed:function(r,u,f,g,v){var w=this.getNamed(r,u),S=w!==t;if(S){var C=r.__filtered;if(!C){var T=this.getSource(r);C=r.__filtered=a.create(T),C.__unfiltered=T}C[u]=t}return this.read(S?[w]:r,f,g,v)},readSupported:function(r,u){var f=this.getSource(r),g=this,v=!1;return f&&Object.keys(f).forEach(function(w){if(w in u){var S=g.readNamed(r,w);S!==t&&(u[w]=S),v=!0}}),v},getSource:function(r){var u=r.__source;if(u===t){var f=r.length===1&&r[0];u=r.__source=f&&a.isPlainObject(f)?f:null}return u},getNamed:function(r,u){var f=this.getSource(r);if(f)return u?f[u]:r.__filtered||f},hasNamed:function(r,u){return!!this.getNamed(r,u)},filter:function(r,u,f,g){var v;function w(N){if(!(f&&N in f)&&!(v&&N in v)){var B=u[N];B!==t&&(r[N]=B)}}if(g){for(var S={},C=0,T,P=g.length;C<P;C++)(T=g[C])in u&&(w(T),S[T]=!0);v=S}return Object.keys(u.__unfiltered||u).forEach(w),r},isPlainValue:function(r,u){return a.isPlainObject(r)||Array.isArray(r)||u&&typeof r=="string"},serialize:function(r,u,f,g){u=u||{};var v=!g,w;if(v&&(u.formatter=new b(u.precision),g={length:0,definitions:{},references:{},add:function(B,L){var j="#"+B._id,Y=this.references[j];if(!Y){this.length++;var z=L.call(B),H=B._class;H&&z[0]!==H&&z.unshift(H),this.definitions[j]=z,Y=this.references[j]=[j]}return Y}}),r&&r._serialize){w=r._serialize(u,g);var S=r._class;S&&!r._compactSerialize&&(v||!f)&&w[0]!==S&&w.unshift(S)}else if(Array.isArray(r)){w=[];for(var C=0,T=r.length;C<T;C++)w[C]=a.serialize(r[C],u,f,g)}else if(a.isPlainObject(r)){w={};for(var P=Object.keys(r),C=0,T=P.length;C<T;C++){var N=P[C];w[N]=a.serialize(r[N],u,f,g)}}else typeof r=="number"?w=u.formatter.number(r,u.precision):w=r;return v&&g.length>0?[["dictionary",g.definitions],w]:w},deserialize:function(r,u,f,g,v){var w=r,S=!f,C=S&&r&&r.length&&r[0][0]==="dictionary";if(f=f||{},Array.isArray(r)){var T=r[0],P=T==="dictionary";if(r.length==1&&/^#/.test(T))return f.dictionary[T];T=a.exports[T],w=[];for(var N=T?1:0,B=r.length;N<B;N++)w.push(a.deserialize(r[N],u,f,P,C));if(T){var L=w;u?w=u(T,L,S||v):w=new T(L)}}else if(a.isPlainObject(r)){w={},g&&(f.dictionary=w);for(var j in r)w[j]=a.deserialize(r[j],u,f)}return C?w[1]:w},exportJSON:function(r,u){var f=a.serialize(r,u);return u&&u.asString==!1?f:JSON.stringify(f)},importJSON:function(r,u){return a.deserialize(typeof r=="string"?JSON.parse(r):r,function(f,g,v){var w=v&&u&&u.constructor===f,S=w?u:a.create(f.prototype);if(g.length===1&&S instanceof F&&(w||!(S instanceof Ve))){var C=g[0];a.isPlainObject(C)&&(C.insert=!1,w&&(g=g.concat([F.INSERT])))}return(w?S.set:f).apply(S,g),w&&(u=null),S})},push:function(r,u){var f=u.length;if(f<4096)r.push.apply(r,u);else{var g=r.length;r.length+=f;for(var v=0;v<f;v++)r[g+v]=u[v]}return r},splice:function(r,u,f,g){var v=u&&u.length,w=f===t;f=w?r.length:f,f>r.length&&(f=r.length);for(var S=0;S<v;S++)u[S]._index=f+S;if(w)return a.push(r,u),[];var C=[f,g];u&&a.push(C,u);for(var T=r.splice.apply(r,C),S=0,P=T.length;S<P;S++)T[S]._index=t;for(var S=f+v,P=r.length;S<P;S++)r[S]._index=S;return T},capitalize:function(r){return r.replace(/\b[a-z]/g,function(u){return u.toUpperCase()})},camelize:function(r){return r.replace(/-(.)/g,function(u,f){return f.toUpperCase()})},hyphenate:function(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var h={on:function(r,u){if(typeof r!="string")a.each(r,function(w,S){this.on(S,w)},this);else{var f=this._eventTypes,g=f&&f[r],v=this._callbacks=this._callbacks||{};v=v[r]=v[r]||[],v.indexOf(u)===-1&&(v.push(u),g&&g.install&&v.length===1&&g.install.call(this,r))}return this},off:function(r,u){if(typeof r!="string"){a.each(r,function(S,C){this.off(C,S)},this);return}var f=this._eventTypes,g=f&&f[r],v=this._callbacks&&this._callbacks[r],w;return v&&(!u||(w=v.indexOf(u))!==-1&&v.length===1?(g&&g.uninstall&&g.uninstall.call(this,r),delete this._callbacks[r]):w!==-1&&v.splice(w,1)),this},once:function(r,u){return this.on(r,function f(){u.apply(this,arguments),this.off(r,f)})},emit:function(r,u){var f=this._callbacks&&this._callbacks[r];if(!f)return!1;var g=a.slice(arguments,1),v=u&&u.target&&!u.currentTarget;f=f.slice(),v&&(u.currentTarget=this);for(var w=0,S=f.length;w<S;w++)if(f[w].apply(this,g)==!1){u&&u.stop&&u.stop();break}return v&&delete u.currentTarget,!0},responds:function(r){return!!(this._callbacks&&this._callbacks[r])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(r){var u=this._eventTypes,f=this._callbacks,g=r?"install":"uninstall";if(u){for(var v in f)if(f[v].length>0){var w=u[v],S=w&&w[g];S&&S.call(this,v)}}},statics:{inject:function r(u){var f=u._events;if(f){var g={};a.each(f,function(v,w){var S=typeof v=="string",C=S?v:w,T=a.capitalize(C),P=C.substring(2).toLowerCase();g[P]=S?{}:v,C="_"+C,u["get"+T]=function(){return this[C]},u["set"+T]=function(N){var B=this[C];B&&this.off(P,B),N&&this.on(P,N),this[C]=N}}),u._eventTypes=g}return r.base.apply(this,arguments)}}},p=a.extend({_class:"PaperScope",initialize:function r(){Nt=this,this.settings=new a({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=r._id++,r._scopes[this._id]=this;var u=r.prototype;if(!this.support){var f=tn.getContext(1,1)||{};u.support={nativeDash:"setLineDash"in f||"mozDash"in f,nativeBlendModes:pi.nativeModes},tn.release(f)}if(!this.agent){var g=e.navigator.userAgent.toLowerCase(),v=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(g)||[])[0],w=v==="darwin"?"mac":v,S=u.agent=u.browser={platform:w};w&&(S[w]=!0),g.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,function(C,T,P,N,B){if(!S.chrome){var L=T==="opera"?N:/^(node|trident)$/.test(T)?B:P;S.version=L,S.versionNumber=parseFloat(L),T={trident:"msie",jsdom:"node"}[T]||T,S.name=T,S[T]=!0}}),S.chrome&&delete S.webkit,S.atom&&delete S.chrome}},version:"0.12.18",getView:function(){var r=this.project;return r&&r._view},getPaper:function(){return this},execute:function(r,u){var f=Nt.PaperScript.execute(r,this,u);return en.updateFocus(),f},install:function(r){var u=this;a.each(["project","view","tool"],function(g){a.define(r,g,{configurable:!0,get:function(){return u[g]}})});for(var f in this)!/^_/.test(f)&&this[f]&&(r[f]=this[f])},setup:function(r){return Nt=this,this.project=new xe(r),this},createCanvas:function(r,u){return tn.getCanvas(r,u)},activate:function(){Nt=this},clear:function(){for(var r=this.projects,u=this.tools,f=r.length-1;f>=0;f--)r[f].remove();for(var f=u.length-1;f>=0;f--)u[f].remove()},remove:function(){this.clear(),delete p._scopes[this._id]},statics:new function(){function r(u){return u+="Attribute",function(f,g){return f[u](g)||f[u]("data-paper-"+g)}}return{_scopes:{},_id:0,get:function(u){return this._scopes[u]||null},getAttribute:r("get"),hasAttribute:r("has")}}}),m=a.extend(h,{initialize:function(r){this._scope=Nt,this._index=this._scope[this._list].push(this)-1,(r||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var r=this._scope[this._reference];return r&&r!==this&&r.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",r),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(a.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),_={findItemBoundsCollisions:function(r,u,f){function g(S){for(var C=new Array(S.length),T=0;T<S.length;T++){var P=S[T].getBounds();C[T]=[P.left,P.top,P.right,P.bottom]}return C}var v=g(r),w=!u||u===r?v:g(u);return this.findBoundsCollisions(v,w,f||0)},findCurveBoundsCollisions:function(r,u,f,g){function v(L){for(var j=Math.min,Y=Math.max,z=new Array(L.length),H=0;H<L.length;H++){var D=L[H];z[H]=[j(D[0],D[2],D[4],D[6]),j(D[1],D[3],D[5],D[7]),Y(D[0],D[2],D[4],D[6]),Y(D[1],D[3],D[5],D[7])]}return z}var w=v(r),S=!u||u===r?w:v(u);if(g){for(var C=this.findBoundsCollisions(w,S,f||0,!1,!0),T=this.findBoundsCollisions(w,S,f||0,!0,!0),P=[],N=0,B=C.length;N<B;N++)P[N]={hor:C[N],ver:T[N]};return P}return this.findBoundsCollisions(w,S,f||0)},findBoundsCollisions:function(r,u,f,g,v){var w=!u||r===u,S=w?r:r.concat(u),C=r.length,T=S.length;function P(Ue,et,it){for(var Ie=0,De=Ue.length;Ie<De;){var tt=De+Ie>>>1;S[Ue[tt]][et]<it?Ie=tt+1:De=tt}return Ie-1}for(var N=g?1:0,B=N+2,L=g?0:1,j=L+2,Y=new Array(T),z=0;z<T;z++)Y[z]=z;Y.sort(function(Ue,et){return S[Ue][N]-S[et][N]});for(var H=[],D=new Array(C),z=0;z<T;z++){var U=Y[z],A=S[U],V=w?U:U-C,q=U<C,J=w||!q,X=q?[]:null;if(H.length){var te=P(H,B,A[N]-f)+1;if(H.splice(0,te),w&&v){X=X.concat(H);for(var ie=0;ie<H.length;ie++){var se=H[ie];D[se].push(V)}}else for(var he=A[j],ne=A[L],ie=0;ie<H.length;ie++){var se=H[ie],ce=S[se],fe=se<C,ye=w||se>=C;(v||(q&&ye||J&&fe)&&he>=ce[L]-f&&ne<=ce[j]+f)&&(q&&ye&&X.push(w?se:se-C),J&&fe&&D[se].push(V))}}if(q&&(r===u&&X.push(U),D[U]=X),H.length){var we=A[B],Ee=P(H,B,we);H.splice(Ee+1,0,U)}else H.push(U)}for(var z=0;z<D.length;z++){var Be=D[z];Be&&Be.sort(function(et,it){return et-it})}return D}},b=a.extend({initialize:function(r){this.precision=a.pick(r,5),this.multiplier=Math.pow(10,this.precision)},number:function(r){return this.precision<16?Math.round(r*this.multiplier)/this.multiplier:r},pair:function(r,u,f){return this.number(r)+(f||",")+this.number(u)},point:function(r,u){return this.number(r.x)+(u||",")+this.number(r.y)},size:function(r,u){return this.number(r.width)+(u||",")+this.number(r.height)},rectangle:function(r,u){return this.point(r,u)+(u||",")+this.size(r,u)}});b.instance=new b;var E=new function(){var r=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],u=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],f=Math.abs,g=Math.sqrt,v=Math.pow,w=Math.log2||function(B){return Math.log(B)*Math.LOG2E},S=1e-12,C=112e-18;function T(B,L,j){return B<L?L:B>j?j:B}function P(B,L,j){function Y(te){var ie=te*134217729,se=te-ie,he=se+ie,ne=te-he;return[he,ne]}var z=L*L-B*j,H=L*L+B*j;if(f(z)*3<H){var D=Y(B),U=Y(L),A=Y(j),V=L*L,q=U[0]*U[0]-V+2*U[0]*U[1]+U[1]*U[1],J=B*j,X=D[0]*A[0]-J+D[0]*A[1]+D[1]*A[0]+D[1]*A[1];z=V-J+(q-X)}return z}function N(){var B=Math.max.apply(Math,arguments);return B&&(B<1e-8||B>1e8)?v(2,-Math.round(w(B))):0}return{EPSILON:S,MACHINE_EPSILON:C,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(g(2)-1)/3,isZero:function(B){return B>=-S&&B<=S},isMachineZero:function(B){return B>=-C&&B<=C},clamp:T,integrate:function(B,L,j,Y){for(var z=r[Y-2],H=u[Y-2],D=(j-L)*.5,U=D+L,A=0,V=Y+1>>1,q=Y&1?H[A++]*B(U):0;A<V;){var J=D*z[A];q+=H[A++]*(B(U+J)+B(U-J))}return D*q},findRoot:function(B,L,j,Y,z,H,D){for(var U=0;U<H;U++){var A=B(j),V=A/L(j),q=j-V;if(f(V)<D){j=q;break}A>0?(z=j,j=q<=Y?(Y+z)*.5:q):(Y=j,j=q>=z?(Y+z)*.5:q)}return T(j,Y,z)},solveQuadratic:function(B,L,j,Y,z,H){var D,U=1/0;if(f(B)<S){if(f(L)<S)return f(j)<S?-1:0;D=-j/L}else{L*=-.5;var A=P(B,L,j);if(A&&f(A)<C){var V=N(f(B),f(L),f(j));V&&(B*=V,L*=V,j*=V,A=P(B,L,j))}if(A>=-C){var q=A<0?0:g(A),J=L+(L<0?-q:q);J===0?(D=j/B,U=-D):(D=J/B,U=j/J)}}var X=0,te=z==null,ie=z-S,se=H+S;return isFinite(D)&&(te||D>ie&&D<se)&&(Y[X++]=te?D:T(D,z,H)),U!==D&&isFinite(U)&&(te||U>ie&&U<se)&&(Y[X++]=te?U:T(U,z,H)),X},solveCubic:function(B,L,j,Y,z,H,D){var U=N(f(B),f(L),f(j),f(Y)),A,V,q,J,X;U&&(B*=U,L*=U,j*=U,Y*=U);function te(Ee){A=Ee;var Be=B*A;V=Be+L,q=V*A+j,J=(Be+V)*A+q,X=q*A+Y}if(f(B)<S)B=L,V=j,q=Y,A=1/0;else if(f(Y)<S)V=L,q=j,A=0;else{te(-(L/B)/3);var ie=X/B,se=v(f(ie),1/3),he=ie<0?-1:1,ne=-J/B,ce=ne>0?1.324717957244746*Math.max(se,g(ne)):se,fe=A-he*ce;if(fe!==A){do te(fe),fe=J===0?A:A-X/J/(1+C);while(he*fe>he*A);f(B)*A*A>f(Y/A)&&(q=-Y/A,V=(q-j)/A)}}var ye=E.solveQuadratic(B,V,q,z,H,D),we=H==null;return isFinite(A)&&(ye===0||ye>0&&A!==z[0]&&A!==z[1])&&(we||A>H-S&&A<D+S)&&(z[ye++]=we?A:T(A,H,D)),ye}}},I={_id:1,_pools:{},get:function(r){if(r){var u=this._pools[r];return u||(u=this._pools[r]={_id:1}),u._id++}else return this._id++}},O=a.extend({_class:"Point",_readIndex:!0,initialize:function(u,f){var g=typeof u,v=this.__read,w=0;if(g==="number"){var S=typeof f=="number";this._set(u,S?f:u),v&&(w=S?2:1)}else if(g==="undefined"||u===null)this._set(0,0),v&&(w=u===null?1:0);else{var C=g==="string"?u.split(/[\s,]+/)||[]:u;w=1,Array.isArray(C)?this._set(+C[0],+(C.length>1?C[1]:C[0])):"x"in C?this._set(C.x||0,C.y||0):"width"in C?this._set(C.width||0,C.height||0):"angle"in C?(this._set(C.length||0,0),this.setAngle(C.angle||0)):(this._set(0,0),w=0)}return v&&(this.__read=w),this},set:"#initialize",_set:function(r,u){return this.x=r,this.y=u,this},equals:function(r){return this===r||r&&(this.x===r.x&&this.y===r.y||Array.isArray(r)&&this.x===r[0]&&this.y===r[1])||!1},clone:function(){return new O(this.x,this.y)},toString:function(){var r=b.instance;return"{ x: "+r.number(this.x)+", y: "+r.number(this.y)+" }"},_serialize:function(r){var u=r.formatter;return[u.number(this.x),u.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(r){if(this.isZero()){var u=this._angle||0;this._set(Math.cos(u)*r,Math.sin(u)*r)}else{var f=r/this.getLength();E.isZero(f)&&this.getAngle(),this._set(this.x*f,this.y*f)}},getAngle:function(){return this.getAngleInRadians.apply(this,arguments)*180/Math.PI},setAngle:function(r){this.setAngleInRadians.call(this,r*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var r=O.read(arguments),u=this.getLength()*r.getLength();if(E.isZero(u))return NaN;var f=this.dot(r)/u;return Math.acos(f<-1?-1:f>1?1:f)}else return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(r){if(this._angle=r,!this.isZero()){var u=this.getLength();this._set(Math.cos(r)*u,Math.sin(r)*u)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var r=O.read(arguments);return Math.atan2(this.cross(r),this.dot(r))*180/Math.PI},getDistance:function(){var r=arguments,u=O.read(r),f=u.x-this.x,g=u.y-this.y,v=f*f+g*g,w=a.read(r);return w?v:Math.sqrt(v)},normalize:function(r){r===t&&(r=1);var u=this.getLength(),f=u!==0?r/u:0,g=new O(this.x*f,this.y*f);return f>=0&&(g._angle=this._angle),g},rotate:function(r,u){if(r===0)return this.clone();r=r*Math.PI/180;var f=u?this.subtract(u):this,g=Math.sin(r),v=Math.cos(r);return f=new O(f.x*v-f.y*g,f.x*g+f.y*v),u?f.add(u):f},transform:function(r){return r?r._transformPoint(this):this},add:function(){var r=O.read(arguments);return new O(this.x+r.x,this.y+r.y)},subtract:function(){var r=O.read(arguments);return new O(this.x-r.x,this.y-r.y)},multiply:function(){var r=O.read(arguments);return new O(this.x*r.x,this.y*r.y)},divide:function(){var r=O.read(arguments);return new O(this.x/r.x,this.y/r.y)},modulo:function(){var r=O.read(arguments);return new O(this.x%r.x,this.y%r.y)},negate:function(){return new O(-this.x,-this.y)},isInside:function(){return K.read(arguments).contains(this)},isClose:function(){var r=arguments,u=O.read(r),f=a.read(r);return this.getDistance(u)<=f},isCollinear:function(){var r=O.read(arguments);return O.isCollinear(this.x,this.y,r.x,r.y)},isColinear:"#isCollinear",isOrthogonal:function(){var r=O.read(arguments);return O.isOrthogonal(this.x,this.y,r.x,r.y)},isZero:function(){var r=E.isZero;return r(this.x)&&r(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(r){return this.x*(r>1&&r<4?-1:1)>=0&&this.y*(r>2?-1:1)>=0},dot:function(){var r=O.read(arguments);return this.x*r.x+this.y*r.y},cross:function(){var r=O.read(arguments);return this.x*r.y-this.y*r.x},project:function(){var r=O.read(arguments),u=r.isZero()?0:this.dot(r)/r.dot(r);return new O(r.x*u,r.y*u)},statics:{min:function(){var r=arguments,u=O.read(r),f=O.read(r);return new O(Math.min(u.x,f.x),Math.min(u.y,f.y))},max:function(){var r=arguments,u=O.read(r),f=O.read(r);return new O(Math.max(u.x,f.x),Math.max(u.y,f.y))},random:function(){return new O(Math.random(),Math.random())},isCollinear:function(r,u,f,g){return Math.abs(r*g-u*f)<=Math.sqrt((r*r+u*u)*(f*f+g*g))*1e-8},isOrthogonal:function(r,u,f,g){return Math.abs(r*f+u*g)<=Math.sqrt((r*r+u*u)*(f*f+g*g))*1e-8}}},a.each(["round","ceil","floor","abs"],function(r){var u=Math[r];this[r]=function(){return new O(u(this.x),u(this.y))}},{})),Q=O.extend({initialize:function(u,f,g,v){this._x=u,this._y=f,this._owner=g,this._setter=v},_set:function(r,u,f){return this._x=r,this._y=u,f||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(r){this._x=r,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(r){this._y=r,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(r){this._owner._changeSelection(this._getSelection(),r)},_getSelection:function(){return this._setter==="setPosition"?4:0}}),W=a.extend({_class:"Size",_readIndex:!0,initialize:function(u,f){var g=typeof u,v=this.__read,w=0;if(g==="number"){var S=typeof f=="number";this._set(u,S?f:u),v&&(w=S?2:1)}else if(g==="undefined"||u===null)this._set(0,0),v&&(w=u===null?1:0);else{var C=g==="string"?u.split(/[\s,]+/)||[]:u;w=1,Array.isArray(C)?this._set(+C[0],+(C.length>1?C[1]:C[0])):"width"in C?this._set(C.width||0,C.height||0):"x"in C?this._set(C.x||0,C.y||0):(this._set(0,0),w=0)}return v&&(this.__read=w),this},set:"#initialize",_set:function(r,u){return this.width=r,this.height=u,this},equals:function(r){return r===this||r&&(this.width===r.width&&this.height===r.height||Array.isArray(r)&&this.width===r[0]&&this.height===r[1])||!1},clone:function(){return new W(this.width,this.height)},toString:function(){var r=b.instance;return"{ width: "+r.number(this.width)+", height: "+r.number(this.height)+" }"},_serialize:function(r){var u=r.formatter;return[u.number(this.width),u.number(this.height)]},add:function(){var r=W.read(arguments);return new W(this.width+r.width,this.height+r.height)},subtract:function(){var r=W.read(arguments);return new W(this.width-r.width,this.height-r.height)},multiply:function(){var r=W.read(arguments);return new W(this.width*r.width,this.height*r.height)},divide:function(){var r=W.read(arguments);return new W(this.width/r.width,this.height/r.height)},modulo:function(){var r=W.read(arguments);return new W(this.width%r.width,this.height%r.height)},negate:function(){return new W(-this.width,-this.height)},isZero:function(){var r=E.isZero;return r(this.width)&&r(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(r,u){return new W(Math.min(r.width,u.width),Math.min(r.height,u.height))},max:function(r,u){return new W(Math.max(r.width,u.width),Math.max(r.height,u.height))},random:function(){return new W(Math.random(),Math.random())}}},a.each(["round","ceil","floor","abs"],function(r){var u=Math[r];this[r]=function(){return new W(u(this.width),u(this.height))}},{})),ee=W.extend({initialize:function(u,f,g,v){this._width=u,this._height=f,this._owner=g,this._setter=v},_set:function(r,u,f){return this._width=r,this._height=u,f||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(r){this._width=r,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(r){this._height=r,this._owner[this._setter](this)}}),K=a.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(u,f,g,v){var w=arguments,S=typeof u,C;if(S==="number"?(this._set(u,f,g,v),C=4):S==="undefined"||u===null?(this._set(0,0,0,0),C=u===null?1:0):w.length===1&&(Array.isArray(u)?(this._set.apply(this,u),C=1):u.x!==t||u.width!==t?(this._set(u.x||0,u.y||0,u.width||0,u.height||0),C=1):u.from===t&&u.to===t&&(this._set(0,0,0,0),a.readSupported(w,this)&&(C=1))),C===t){var T=O.readNamed(w,"from"),P=a.peek(w),N=T.x,B=T.y,L,j;if(P&&P.x!==t||a.hasNamed(w,"to")){var Y=O.readNamed(w,"to");L=Y.x-N,j=Y.y-B,L<0&&(N=Y.x,L=-L),j<0&&(B=Y.y,j=-j)}else{var z=W.read(w);L=z.width,j=z.height}this._set(N,B,L,j),C=w.__index}var H=w.__filtered;return H&&(this.__filtered=H),this.__read&&(this.__read=C),this},set:"#initialize",_set:function(r,u,f,g){return this.x=r,this.y=u,this.width=f,this.height=g,this},clone:function(){return new K(this.x,this.y,this.width,this.height)},equals:function(r){var u=a.isPlainValue(r)?K.read(arguments):r;return u===this||u&&this.x===u.x&&this.y===u.y&&this.width===u.width&&this.height===u.height||!1},toString:function(){var r=b.instance;return"{ x: "+r.number(this.x)+", y: "+r.number(this.y)+", width: "+r.number(this.width)+", height: "+r.number(this.height)+" }"},_serialize:function(r){var u=r.formatter;return[u.number(this.x),u.number(this.y),u.number(this.width),u.number(this.height)]},getPoint:function(r){var u=r?O:Q;return new u(this.x,this.y,this,"setPoint")},setPoint:function(){var r=O.read(arguments);this.x=r.x,this.y=r.y},getSize:function(r){var u=r?W:ee;return new u(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var r=W.read(arguments),u=this._sx,f=this._sy,g=r.width,v=r.height;u&&(this.x+=(this.width-g)*u),f&&(this.y+=(this.height-v)*f),this.width=g,this.height=v,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(r){if(!this._fw){var u=r-this.x;this.width-=this._sx===.5?u*2:u}this.x=r,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(r){if(!this._fh){var u=r-this.y;this.height-=this._sy===.5?u*2:u}this.y=r,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(r){if(!this._fw){var u=r-this.x;this.width=this._sx===.5?u*2:u}this.x=r-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(r){if(!this._fh){var u=r-this.y;this.height=this._sy===.5?u*2:u}this.y=r-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(r){this._fw||this._sx===.5?this.x=r-this.width/2:(this._sx&&(this.x+=(r-this.x)*2*this._sx),this.width=(r-this.x)*2),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(r){this._fh||this._sy===.5?this.y=r-this.height/2:(this._sy&&(this.y+=(r-this.y)*2*this._sy),this.height=(r-this.y)*2),this._sy=.5,this._fh=0},getCenter:function(r){var u=r?O:Q;return new u(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var r=O.read(arguments);return this.setCenterX(r.x),this.setCenterY(r.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return this.width===0||this.height===0},contains:function(r){return r&&r.width!==t||(Array.isArray(r)?r:arguments).length===4?this._containsRectangle(K.read(arguments)):this._containsPoint(O.read(arguments))},_containsPoint:function(r){var u=r.x,f=r.y;return u>=this.x&&f>=this.y&&u<=this.x+this.width&&f<=this.y+this.height},_containsRectangle:function(r){var u=r.x,f=r.y;return u>=this.x&&f>=this.y&&u+r.width<=this.x+this.width&&f+r.height<=this.y+this.height},intersects:function(){var r=K.read(arguments),u=a.read(arguments)||0;return r.x+r.width>this.x-u&&r.y+r.height>this.y-u&&r.x<this.x+this.width+u&&r.y<this.y+this.height+u},intersect:function(){var r=K.read(arguments),u=Math.max(this.x,r.x),f=Math.max(this.y,r.y),g=Math.min(this.x+this.width,r.x+r.width),v=Math.min(this.y+this.height,r.y+r.height);return new K(u,f,g-u,v-f)},unite:function(){var r=K.read(arguments),u=Math.min(this.x,r.x),f=Math.min(this.y,r.y),g=Math.max(this.x+this.width,r.x+r.width),v=Math.max(this.y+this.height,r.y+r.height);return new K(u,f,g-u,v-f)},include:function(){var r=O.read(arguments),u=Math.min(this.x,r.x),f=Math.min(this.y,r.y),g=Math.max(this.x+this.width,r.x),v=Math.max(this.y+this.height,r.y);return new K(u,f,g-u,v-f)},expand:function(){var r=W.read(arguments),u=r.width,f=r.height;return new K(this.x-u/2,this.y-f/2,this.width+u,this.height+f)},scale:function(r,u){return this.expand(this.width*r-this.width,this.height*(u===t?r:u)-this.height)}},a.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(r,u){var f=r.join(""),g=/^[RL]/.test(f);u>=4&&(r[1]+=g?"Y":"X");var v=r[g?0:1],w=r[g?1:0],S="get"+v,C="get"+w,T="set"+v,P="set"+w,N="get"+f,B="set"+f;this[N]=function(L){var j=L?O:Q;return new j(this[S](),this[C](),this,B)},this[B]=function(){var L=O.read(arguments);this[T](L.x),this[P](L.y)}},{beans:!0})),ae=K.extend({initialize:function(u,f,g,v,w,S){this._set(u,f,g,v,!0),this._owner=w,this._setter=S},_set:function(r,u,f,g,v){return this._x=r,this._y=u,this._width=f,this._height=g,v||this._owner[this._setter](this),this}},new function(){var r=K.prototype;return a.each(["x","y","width","height"],function(u){var f=a.capitalize(u),g="_"+u;this["get"+f]=function(){return this[g]},this["set"+f]=function(v){this[g]=v,this._dontNotify||this._owner[this._setter](this)}},a.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(u){var f="set"+u;this[f]=function(){this._dontNotify=!0,r[f].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}},{isSelected:function(){return!!(this._owner._selection&2)},setSelected:function(u){var f=this._owner;f._changeSelection&&f._changeSelection(2,u)}}))}),le=a.extend({_class:"Matrix",initialize:function r(u,f){var g=arguments,v=g.length,w=!0;if(v>=6?this._set.apply(this,g):v===1||v===2?u instanceof r?this._set(u._a,u._b,u._c,u._d,u._tx,u._ty,f):Array.isArray(u)?this._set.apply(this,f?u.concat([f]):u):w=!1:v?w=!1:this.reset(),!w)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(r,u,f,g,v,w,S){return this._a=r,this._b=u,this._c=f,this._d=g,this._tx=v,this._ty=w,S||this._changed(),this},_serialize:function(r,u){return a.serialize(this.getValues(),r,!0,u)},_changed:function(){var r=this._owner;r&&(r._applyMatrix?r.transform(null,!0):r._changed(25))},clone:function(){return new le(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(r){return r===this||r&&this._a===r._a&&this._b===r._b&&this._c===r._c&&this._d===r._d&&this._tx===r._tx&&this._ty===r._ty},toString:function(){var r=b.instance;return"[["+[r.number(this._a),r.number(this._c),r.number(this._tx)].join(", ")+"], ["+[r.number(this._b),r.number(this._d),r.number(this._ty)].join(", ")+"]]"},reset:function(r){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,r||this._changed(),this},apply:function(r,u){var f=this._owner;return f?(f.transform(null,a.pick(r,!0),u),this.isIdentity()):!1},translate:function(){var r=O.read(arguments),u=r.x,f=r.y;return this._tx+=u*this._a+f*this._c,this._ty+=u*this._b+f*this._d,this._changed(),this},scale:function(){var r=arguments,u=O.read(r),f=O.read(r,0,{readNull:!0});return f&&this.translate(f),this._a*=u.x,this._b*=u.x,this._c*=u.y,this._d*=u.y,f&&this.translate(f.negate()),this._changed(),this},rotate:function(r){r*=Math.PI/180;var u=O.read(arguments,1),f=u.x,g=u.y,v=Math.cos(r),w=Math.sin(r),S=f-f*v+g*w,C=g-f*w-g*v,T=this._a,P=this._b,N=this._c,B=this._d;return this._a=v*T+w*N,this._b=v*P+w*B,this._c=-w*T+v*N,this._d=-w*P+v*B,this._tx+=S*T+C*N,this._ty+=S*P+C*B,this._changed(),this},shear:function(){var r=arguments,u=O.read(r),f=O.read(r,0,{readNull:!0});f&&this.translate(f);var g=this._a,v=this._b;return this._a+=u.y*this._c,this._b+=u.y*this._d,this._c+=u.x*g,this._d+=u.x*v,f&&this.translate(f.negate()),this._changed(),this},skew:function(){var r=arguments,u=O.read(r),f=O.read(r,0,{readNull:!0}),g=Math.PI/180,v=new O(Math.tan(u.x*g),Math.tan(u.y*g));return this.shear(v,f)},append:function(r,u){if(r){var f=this._a,g=this._b,v=this._c,w=this._d,S=r._a,C=r._c,T=r._b,P=r._d,N=r._tx,B=r._ty;this._a=S*f+T*v,this._c=C*f+P*v,this._b=S*g+T*w,this._d=C*g+P*w,this._tx+=N*f+B*v,this._ty+=N*g+B*w,u||this._changed()}return this},prepend:function(r,u){if(r){var f=this._a,g=this._b,v=this._c,w=this._d,S=this._tx,C=this._ty,T=r._a,P=r._c,N=r._b,B=r._d,L=r._tx,j=r._ty;this._a=T*f+P*g,this._c=T*v+P*w,this._b=N*f+B*g,this._d=N*v+B*w,this._tx=T*S+P*C+L,this._ty=N*S+B*C+j,u||this._changed()}return this},appended:function(r){return this.clone().append(r)},prepended:function(r){return this.clone().prepend(r)},invert:function(){var r=this._a,u=this._b,f=this._c,g=this._d,v=this._tx,w=this._ty,S=r*g-u*f,C=null;return S&&!isNaN(S)&&isFinite(v)&&isFinite(w)&&(this._a=g/S,this._b=-u/S,this._c=-f/S,this._d=r/S,this._tx=(f*w-g*v)/S,this._ty=(u*v-r*w)/S,C=this),C},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new le(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return this._a===1&&this._b===0&&this._c===0&&this._d===1&&this._tx===0&&this._ty===0},isInvertible:function(){var r=this._a*this._d-this._c*this._b;return r&&!isNaN(r)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(r,u,f){return arguments.length<3?this._transformPoint(O.read(arguments)):this._transformCoordinates(r,u,f)},_transformPoint:function(r,u,f){var g=r.x,v=r.y;return u||(u=new O),u._set(g*this._a+v*this._c+this._tx,g*this._b+v*this._d+this._ty,f)},_transformCoordinates:function(r,u,f){for(var g=0,v=2*f;g<v;g+=2){var w=r[g],S=r[g+1];u[g]=w*this._a+S*this._c+this._tx,u[g+1]=w*this._b+S*this._d+this._ty}return u},_transformCorners:function(r){var u=r.x,f=r.y,g=u+r.width,v=f+r.height,w=[u,f,g,f,g,v,u,v];return this._transformCoordinates(w,w,4)},_transformBounds:function(r,u,f){for(var g=this._transformCorners(r),v=g.slice(0,2),w=v.slice(),S=2;S<8;S++){var C=g[S],T=S&1;C<v[T]?v[T]=C:C>w[T]&&(w[T]=C)}return u||(u=new K),u._set(v[0],v[1],w[0]-v[0],w[1]-v[1],f)},inverseTransform:function(){return this._inverseTransform(O.read(arguments))},_inverseTransform:function(r,u,f){var g=this._a,v=this._b,w=this._c,S=this._d,C=this._tx,T=this._ty,P=g*S-v*w,N=null;if(P&&!isNaN(P)&&isFinite(C)&&isFinite(T)){var B=r.x-this._tx,L=r.y-this._ty;u||(u=new O),N=u._set((B*S-L*w)/P,(L*g-B*v)/P,f)}return N},decompose:function(){var r=this._a,u=this._b,f=this._c,g=this._d,v=r*g-u*f,w=Math.sqrt,S=Math.atan2,C=180/Math.PI,T,P,N;if(r!==0||u!==0){var B=w(r*r+u*u);T=Math.acos(r/B)*(u>0?1:-1),P=[B,v/B],N=[S(r*f+u*g,B*B),0]}else if(f!==0||g!==0){var L=w(f*f+g*g);T=Math.asin(f/L)*(g>0?1:-1),P=[v/L,L],N=[0,S(r*f+u*g,L*L)]}else T=0,N=P=[0,0];return{translation:this.getTranslation(),rotation:T*C,scaling:new O(P),skewing:new O(N[0]*C,N[1]*C)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new O(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(r){this.isIdentity()||r.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},a.each(["a","b","c","d","tx","ty"],function(r){var u=a.capitalize(r),f="_"+r;this["get"+u]=function(){return this[f]},this["set"+u]=function(g){this[f]=g,this._changed()}},{})),ge=a.extend({_class:"Line",initialize:function(u,f,g,v,w){var S=!1;arguments.length>=4?(this._px=u,this._py=f,this._vx=g,this._vy=v,S=w):(this._px=u.x,this._py=u.y,this._vx=f.x,this._vy=f.y,S=g),S||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new O(this._px,this._py)},getVector:function(){return new O(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(r,u){return ge.intersect(this._px,this._py,this._vx,this._vy,r._px,r._py,r._vx,r._vy,!0,u)},getSide:function(r,u){return ge.getSide(this._px,this._py,this._vx,this._vy,r.x,r.y,!0,u)},getDistance:function(r){return Math.abs(this.getSignedDistance(r))},getSignedDistance:function(r){return ge.getSignedDistance(this._px,this._py,this._vx,this._vy,r.x,r.y,!0)},isCollinear:function(r){return O.isCollinear(this._vx,this._vy,r._vx,r._vy)},isOrthogonal:function(r){return O.isOrthogonal(this._vx,this._vy,r._vx,r._vy)},statics:{intersect:function(r,u,f,g,v,w,S,C,T,P){T||(f-=r,g-=u,S-=v,C-=w);var N=f*C-g*S;if(!E.isMachineZero(N)){var B=r-v,L=u-w,j=(S*L-C*B)/N,Y=(f*L-g*B)/N,z=1e-12,H=-z,D=1+z;if(P||H<j&&j<D&&H<Y&&Y<D)return P||(j=j<=0?0:j>=1?1:j),new O(r+j*f,u+j*g)}},getSide:function(r,u,f,g,v,w,S,C){S||(f-=r,g-=u);var T=v-r,P=w-u,N=T*g-P*f;return!C&&E.isMachineZero(N)&&(N=(T*f+T*f)/(f*f+g*g),N>=0&&N<=1&&(N=0)),N<0?-1:N>0?1:0},getSignedDistance:function(r,u,f,g,v,w,S){return S||(f-=r,g-=u),f===0?g>0?v-r:r-v:g===0?f<0?w-u:u-w:((v-r)*g-(w-u)*f)/(g>f?g*Math.sqrt(1+f*f/(g*g)):f*Math.sqrt(1+g*g/(f*f)))},getDistance:function(r,u,f,g,v,w,S){return Math.abs(ge.getSignedDistance(r,u,f,g,v,w,S))}}}),xe=m.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(u){m.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new Ut(null,null,this),this._view=en.create(this,u||tn.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(r,u){return a.serialize(this._children,r,!0,u)},_changed:function(r,u){if(r&1){var f=this._view;f&&(f._needsUpdate=!0,!f._requested&&f._autoUpdate&&f.requestUpdate())}var g=this._changes;if(g&&u){var v=this._changesById,w=u._id,S=v[w];S?S.flags|=r:g.push(v[w]={item:u,flags:r})}},clear:function(){for(var r=this._children,u=r.length-1;u>=0;u--)r[u].remove()},isEmpty:function(){return!this._children.length},remove:function r(){return r.base.call(this)?(this._view&&this._view.remove(),!0):!1},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(r){this._currentStyle.set(r)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new Ve({project:this,insert:!0})},getSymbolDefinitions:function(){var r=[],u={};return this.getItems({class:je,match:function(f){var g=f._definition,v=g._id;return u[v]||(u[v]=!0,r.push(g)),!1}}),r},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var r=this._selectionItems,u=[];for(var f in r){var g=r[f],v=g._selection;v&1&&g.isInserted()?u.push(g):v||this._updateSelection(g)}return u},_updateSelection:function(r){var u=r._id,f=this._selectionItems;r._selection?f[u]!==r&&(this._selectionCount++,f[u]=r):f[u]===r&&(this._selectionCount--,delete f[u])},selectAll:function(){for(var r=this._children,u=0,f=r.length;u<f;u++)r[u].setFullySelected(!0)},deselectAll:function(){var r=this._selectionItems;for(var u in r)r[u].setFullySelected(!1)},addLayer:function(r){return this.insertLayer(t,r)},insertLayer:function(r,u){if(u instanceof Ve){u._remove(!1,!0),a.splice(this._children,[u],r,0),u._setProject(this,!0);var f=u._name;f&&u.setName(f),this._changes&&u._changed(5),this._activeLayer||(this._activeLayer=u)}else u=null;return u},_insertItem:function(r,u,f){return u=this.insertLayer(r,u)||(this._activeLayer||this._insertItem(t,new Ve(F.NO_INSERT),!0)).insertChild(r,u),f&&u.activate&&u.activate(),u},getItems:function(r){return F._getItems(this,r)},getItem:function(r){return F._getItems(this,r,null,null,!0)[0]||null},importJSON:function(r){this.activate();var u=this._activeLayer;return a.importJSON(r,u&&u.isEmpty()&&u)},removeOn:function(r){var u=this._removeSets;if(u){r==="mouseup"&&(u.mousedrag=null);var f=u[r];if(f){for(var g in f){var v=f[g];for(var w in u){var S=u[w];S&&S!=f&&delete S[v._id]}v.remove()}u[r]=null}}},draw:function(r,u,f){this._updateVersion++,r.save(),u.applyToContext(r);for(var g=this._children,v=new a({offset:new O(0,0),pixelRatio:f,viewMatrix:u.isIdentity()?null:u,matrices:[new le],updateMatrix:!0}),w=0,S=g.length;w<S;w++)g[w].draw(r,v);if(r.restore(),this._selectionCount>0){r.save(),r.strokeWidth=1;var C=this._selectionItems,T=this._scope.settings.handleSize,P=this._updateVersion;for(var N in C)C[N]._drawSelection(r,u,T,C,P);r.restore()}}}),F=a.extend(h,{statics:{extend:function r(u){return u._serializeFields&&(u._serializeFields=a.set({},this.prototype._serializeFields,u._serializeFields)),r.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new le,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var r=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return a.each(r,function(u){this._events[u]={install:function(f){this.getView()._countItemEvent(f,1)},uninstall:function(f){this.getView()._countItemEvent(f,-1)}}},{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:r}})},{initialize:function(){},_initialize:function(r,u){var f=r&&a.isPlainObject(r),g=f&&r.internal===!0,v=this._matrix=new le,w=f&&r.project||Nt.project,S=Nt.settings;return this._id=g?null:I.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&S.applyMatrix,u&&v.translate(u),v._owner=this,this._style=new Ut(w._currentStyle,this,w),g||f&&r.insert==!1||!S.insertItems&&!(f&&r.insert==!0)?this._setProject(w):(f&&r.parent||w)._insertItem(t,this,!0),f&&r!==F.NO_INSERT&&r!==F.INSERT&&this.set(r,{internal:!0,insert:!0,project:!0,parent:!0}),f},_serialize:function(r,u){var f={},g=this;function v(w){for(var S in w){var C=g[S];a.equals(C,S==="leading"?w.fontSize*1.2:w[S])||(f[S]=a.serialize(C,r,S!=="data",u))}}return v(this._serializeFields),this instanceof Ne||v(this._style._defaults),[this._class,f]},_changed:function(r){var u=this._symbol,f=this._parent||u,g=this._project;r&8&&(this._bounds=this._position=this._decomposed=t),r&16&&(this._globalMatrix=t),f&&r&72&&F._clearBoundsCache(f),r&2&&F._clearBoundsCache(this),g&&g._changed(r,this),u&&u._changed(r)},getId:function(){return this._id},getName:function(){return this._name},setName:function(r){if(this._name&&this._removeNamed(),r===+r+"")throw new Error("Names consisting only of numbers are not supported.");var u=this._getOwner();if(r&&u){var f=u._children,g=u._namedChildren;(g[r]=g[r]||[]).push(this),r in f||(f[r]=this)}this._name=r||t,this._changed(256)},getStyle:function(){return this._style},setStyle:function(r){this.getStyle().set(r)}},a.each(["locked","visible","blendMode","opacity","guide"],function(r){var u=a.capitalize(r),f="_"+r,g={locked:256,visible:265};this["get"+u]=function(){return this[f]},this["set"+u]=function(v){v!=this[f]&&(this[f]=v,this._changed(g[r]||257))}},{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(r){if(r!==this._selection){this._selection=r;var u=this._project;u&&(u._updateSelection(this),this._changed(257))}},_changeSelection:function(r,u){var f=this._selection;this.setSelection(u?f|r:f&~r)},isSelected:function(){if(this._selectChildren){for(var r=this._children,u=0,f=r.length;u<f;u++)if(r[u].isSelected())return!0}return!!(this._selection&1)},setSelected:function(r){if(this._selectChildren)for(var u=this._children,f=0,g=u.length;f<g;f++)u[f].setSelected(r);this._changeSelection(1,r)},isFullySelected:function(){var r=this._children,u=!!(this._selection&1);if(r&&u){for(var f=0,g=r.length;f<g;f++)if(!r[f].isFullySelected())return!1;return!0}return u},setFullySelected:function(r){var u=this._children;if(u)for(var f=0,g=u.length;f<g;f++)u[f].setFullySelected(r);this._changeSelection(1,r)},isClipMask:function(){return this._clipMask},setClipMask:function(r){this._clipMask!=(r=!!r)&&(this._clipMask=r,r&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(r){this._data=r},getPosition:function(r){var u=r?O:Q,f=this._position||(this._position=this._getPositionFromBounds());return new u(f.x,f.y,this,"setPosition")},setPosition:function(){this.translate(O.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(r){return this._pivot?this._matrix._transformPoint(this._pivot):(r||this.getBounds()).getCenter(!0)},getPivot:function(){var r=this._pivot;return r?new Q(r.x,r.y,this,"setPivot"):null},setPivot:function(){this._pivot=O.read(arguments,0,{clone:!0,readNull:!0}),this._position=t}},a.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},function(r,u){this[u]=function(f){return this.getBounds(f,r)}},{beans:!0,getBounds:function(r,u){var f=u||r instanceof le,g=a.set({},f?u:r,this._boundsOptions);(!g.stroke||this.getStrokeScaling())&&(g.cacheItem=this);var v=this._getCachedBounds(f&&r,g).rect;return arguments.length?v:new ae(v.x,v.y,v.width,v.height,this,"setBounds")},setBounds:function(){var r=K.read(arguments),u=this.getBounds(),f=this._matrix,g=new le,v=r.getCenter();g.translate(v),(r.width!=u.width||r.height!=u.height)&&(f.isInvertible()||(f.set(f._backup||new le().translate(f.getTranslation())),u=this.getBounds()),g.scale(u.width!==0?r.width/u.width:0,u.height!==0?r.height/u.height:0)),v=u.getCenter(),g.translate(-v.x,-v.y),this.transform(g)},_getBounds:function(r,u){var f=this._children;return!f||!f.length?new K:(F._updateBoundsCache(this,u.cacheItem),F._getBounds(f,r,u))},_getBoundsCacheKey:function(r,u){return[r.stroke?1:0,r.handle?1:0,u?1:0].join("")},_getCachedBounds:function(r,u,f){r=r&&r._orNullIfIdentity();var g=u.internal&&!f,v=u.cacheItem,w=g?null:this._matrix._orNullIfIdentity(),S=v&&(!r||r.equals(w))&&this._getBoundsCacheKey(u,g),C=this._bounds;if(F._updateBoundsCache(this._parent||this._symbol,v),S&&C&&S in C){var T=C[S];return{rect:T.rect.clone(),nonscaling:T.nonscaling}}var P=this._getBounds(r||w,u),N=P.rect||P,B=this._style,L=P.nonscaling||B.hasStroke()&&!B.getStrokeScaling();if(S){C||(this._bounds=C={});var T=C[S]={rect:N.clone(),nonscaling:L,internal:g}}return{rect:N,nonscaling:L}},_getStrokeMatrix:function(r,u){var f=this.getStrokeScaling()?null:u&&u.internal?this:this._parent||this._symbol&&this._symbol._item,g=f?f.getViewMatrix().invert():r;return g&&g._shiftless()},statics:{_updateBoundsCache:function(r,u){if(r&&u){var f=u._id,g=r._boundsCache=r._boundsCache||{ids:{},list:[]};g.ids[f]||(g.list.push(u),g.ids[f]=u)}},_clearBoundsCache:function(r){var u=r._boundsCache;if(u){r._bounds=r._position=r._boundsCache=t;for(var f=0,g=u.list,v=g.length;f<v;f++){var w=g[f];w!==r&&(w._bounds=w._position=t,w._boundsCache&&F._clearBoundsCache(w))}}},_getBounds:function(r,u,f){var g=1/0,v=-g,w=g,S=v,C=!1;f=f||{};for(var T=0,P=r.length;T<P;T++){var N=r[T];if(N._visible&&!N.isEmpty(!0)){var B=N._getCachedBounds(u&&u.appended(N._matrix),f,!0),L=B.rect;g=Math.min(L.x,g),w=Math.min(L.y,w),v=Math.max(L.x+L.width,v),S=Math.max(L.y+L.height,S),B.nonscaling&&(C=!0)}}return{rect:isFinite(g)?new K(g,w,v-g,S-w):new K,nonscaling:C}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var r=this._decompose();return r?r.rotation:0},setRotation:function(r){var u=this.getRotation();if(u!=null&&r!=null){var f=this._decomposed;this.rotate(r-u),f&&(f.rotation=r,this._decomposed=f)}},getScaling:function(){var r=this._decompose(),u=r&&r.scaling;return new Q(u?u.x:1,u?u.y:1,this,"setScaling")},setScaling:function(){var r=this.getScaling(),u=O.read(arguments,0,{clone:!0,readNull:!0});if(r&&u&&!r.equals(u)){var f=this.getRotation(),g=this._decomposed,v=new le,w=E.isZero;if(w(r.x)||w(r.y))v.translate(g.translation),f&&v.rotate(f),v.scale(u.x,u.y),this._matrix.set(v);else{var S=this.getPosition(!0);v.translate(S),f&&v.rotate(f),v.scale(u.x/r.x,u.y/r.y),f&&v.rotate(-f),v.translate(S.negate()),this.transform(v)}g&&(g.scaling=u,this._decomposed=g)}},getMatrix:function(){return this._matrix},setMatrix:function(){var r=this._matrix;r.set.apply(r,arguments)},getGlobalMatrix:function(r){var u=this._globalMatrix;if(u)for(var f=this._parent,g=[];f;){if(!f._globalMatrix){u=null;for(var v=0,w=g.length;v<w;v++)g[v]._globalMatrix=null;break}g.push(f),f=f._parent}if(!u){u=this._globalMatrix=this._matrix.clone();var f=this._parent;f&&u.prepend(f.getGlobalMatrix(!0))}return r?u:u.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(r){(this._applyMatrix=this._canApplyMatrix&&!!r)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(r,u){if(this._project!==r){this._project&&this._installEvents(!1),this._project=r;for(var f=this._children,g=0,v=f&&f.length;g<v;g++)f[g]._setProject(r);u=!0}u&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function r(u){r.base.call(this,u);for(var f=this._children,g=0,v=f&&f.length;g<v;g++)f[g]._installEvents(u)},getLayer:function(){for(var r=this;r=r._parent;)if(r instanceof Ve)return r;return null},getParent:function(){return this._parent},setParent:function(r){return r.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(r){this.removeChildren(),this.addChildren(r)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var r=this._getOwner();return r&&r._children[this._index+1]||null},getPreviousSibling:function(){var r=this._getOwner();return r&&r._children[this._index-1]||null},getIndex:function(){return this._index},setIndex:function(r){var u=this._parent,f=u&&u._children;f&&u.insertChildren(r in f?r:t,[this])},equals:function(r){return r===this||r&&this._class===r._class&&this._style.equals(r._style)&&this._matrix.equals(r._matrix)&&this._locked===r._locked&&this._visible===r._visible&&this._blendMode===r._blendMode&&this._opacity===r._opacity&&this._clipMask===r._clipMask&&this._guide===r._guide&&this._equals(r)||!1},_equals:function(r){return a.equals(this._children,r._children)},clone:function(r){var u=new this.constructor(F.NO_INSERT),f=this._children,g=a.pick(r?r.insert:t,r===t||r===!0),v=a.pick(r?r.deep:t,!0);f&&u.copyAttributes(this),(!f||v)&&u.copyContent(this),f||u.copyAttributes(this),g&&u.insertAbove(this);var w=this._name,S=this._parent;if(w&&S){for(var f=S._children,C=w,T=1;f[w];)w=C+" "+T++;w!==C&&u.setName(w)}return u},copyContent:function(r){for(var u=r._children,f=0,g=u&&u.length;f<g;f++)this.addChild(u[f].clone(!1),!0)},copyAttributes:function(r,u){this.setStyle(r._style);for(var f=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],g=0,v=f.length;g<v;g++){var w=f[g];r.hasOwnProperty(w)&&(this[w]=r[w])}u||this._matrix.set(r._matrix,!0),this.setApplyMatrix(r._applyMatrix),this.setPivot(r._pivot),this.setSelection(r._selection);var S=r._data,C=r._name;this._data=S?a.clone(S):null,C&&this.setName(C)},rasterize:function(r,u){var f,g,v;a.isPlainObject(r)?(f=r.resolution,g=r.insert,v=r.raster):(f=r,g=u),v||(v=new ot(F.NO_INSERT));var w=this.getStrokeBounds(),S=(f||this.getView().getResolution())/72,C=w.getTopLeft().floor(),T=w.getBottomRight().ceil(),P=new W(T.subtract(C)),N=P.multiply(S);if(v.setSize(N,!0),!N.isZero()){var B=v.getContext(!0),L=new le().scale(S).translate(C.negate());B.save(),L.applyToContext(B),this.draw(B,new a({matrices:[L]})),B.restore()}return v._matrix.set(new le().translate(C.add(P.divide(2))).scale(1/S)),(g===t||g)&&v.insertAbove(this),v},contains:function(){var r=this._matrix;return r.isInvertible()&&!!this._contains(r._inverseTransform(O.read(arguments)))},_contains:function(r){var u=this._children;if(u){for(var f=u.length-1;f>=0;f--)if(u[f].contains(r))return!0;return!1}return r.isInside(this.getInternalBounds())},isInside:function(){return K.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new Xe.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(r,u){return r instanceof F?this._asPathItem().getIntersections(r._asPathItem(),null,u,!0).length>0:!1}},new function(){function r(){var g=arguments;return this._hitTest(O.read(g),dt.getOptions(g))}function u(){var g=arguments,v=O.read(g),w=dt.getOptions(g),S=[];return this._hitTest(v,new a({all:S},w)),S}function f(g,v,w,S){var C=this._children;if(C)for(var T=C.length-1;T>=0;T--){var P=C[T],N=P!==S&&P._hitTest(g,v,w);if(N&&!v.all)return N}return null}return xe.inject({hitTest:r,hitTestAll:u,_hitTest:f}),{hitTest:r,hitTestAll:u,_hitTestChildren:f}},{_hitTest:function(r,u,f){if(this._locked||!this._visible||this._guide&&!u.guides||this.isEmpty())return null;var g=this._matrix,v=f?f.appended(g):this.getGlobalMatrix().prepend(this.getView()._matrix),w=Math.max(u.tolerance,1e-12),S=u._tolerancePadding=new W(Xe._getStrokePadding(w,g._shiftless().invert()));if(r=g._inverseTransform(r),!r||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(S.multiply(2))._containsPoint(r))return null;var C=!(u.guides&&!this._guide||u.selected&&!this.isSelected()||u.type&&u.type!==a.hyphenate(this._class)||u.class&&!(this instanceof u.class)),T=u.match,P=this,N,B;function L(A){return A&&T&&!T(A)&&(A=null),A&&u.all&&u.all.push(A),A}function j(A,V){var q=V?N["get"+V]():P.getPosition();if(r.subtract(q).divide(S).length<=1)return new dt(A,P,{name:V?a.hyphenate(V):A,point:q})}var Y=u.position,z=u.center,H=u.bounds;if(C&&this._parent&&(Y||z||H)){if((z||H)&&(N=this.getInternalBounds()),B=Y&&j("position")||z&&j("center","Center"),!B&&H)for(var D=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],U=0;U<8&&!B;U++)B=j("bounds",D[U]);B=L(B)}return B||(B=this._hitTestChildren(r,u,v)||C&&L(this._hitTestSelf(r,u,v,this.getStrokeScaling()?null:v._shiftless().invert()))||null),B&&B.point&&(B.point=g.transform(B.point)),B},_hitTestSelf:function(r,u){if(u.fill&&this.hasFill()&&this._contains(r))return new dt("fill",this)},matches:function(r,u){function f(S,C){for(var T in S)if(S.hasOwnProperty(T)){var P=S[T],N=C[T];if(a.isPlainObject(P)&&a.isPlainObject(N)){if(!f(P,N))return!1}else if(!a.equals(P,N))return!1}return!0}var g=typeof r;if(g==="object"){for(var v in r)if(r.hasOwnProperty(v)&&!this.matches(v,r[v]))return!1;return!0}else{if(g==="function")return r(this);if(r==="match")return u(this);var w=/^(empty|editable)$/.test(r)?this["is"+a.capitalize(r)]():r==="type"?a.hyphenate(this._class):this[r];if(r==="class"){if(typeof u=="function")return this instanceof u;w=this._class}if(typeof u=="function")return!!u(w);if(u){if(u.test)return u.test(w);if(a.isPlainObject(u))return f(u,w)}return a.equals(w,u)}},getItems:function(r){return F._getItems(this,r,this._matrix)},getItem:function(r){return F._getItems(this,r,this._matrix,null,!0)[0]||null},statics:{_getItems:function r(u,f,g,v,w){if(!v){var S=typeof f=="object"&&f,C=S&&S.overlapping,T=S&&S.inside,P=C||T,L=P&&K.read([P]);v={items:[],recursive:S&&S.recursive!==!1,inside:!!T,overlapping:!!C,rect:L,path:C&&new Xe.Rectangle({rectangle:L,insert:!1})},S&&(f=a.filter({},f,{recursive:!0,inside:!0,overlapping:!0}))}var N=u._children,B=v.items,L=v.rect;g=L&&(g||new le);for(var j=0,Y=N&&N.length;j<Y;j++){var z=N[j],H=g&&g.appended(z._matrix),D=!0;if(L){var P=z.getBounds(H);if(!L.intersects(P))continue;L.contains(P)||v.overlapping&&(P.contains(L)||v.path.intersects(z,H))||(D=!1)}if(D&&z.matches(f)&&(B.push(z),w)||(v.recursive!==!1&&r(z,f,H,v,w),w&&B.length>0))break}return B}}},{importJSON:function(r){var u=a.importJSON(r,this);return u!==this?this.addChild(u):u},addChild:function(r){return this.insertChild(t,r)},insertChild:function(r,u){var f=u?this.insertChildren(r,[u]):null;return f&&f[0]},addChildren:function(r){return this.insertChildren(this._children.length,r)},insertChildren:function(r,u){var f=this._children;if(f&&u&&u.length>0){u=a.slice(u);for(var g={},v=u.length-1;v>=0;v--){var w=u[v],S=w&&w._id;!w||g[S]?u.splice(v,1):(w._remove(!1,!0),g[S]=!0)}a.splice(f,u,r,0);for(var C=this._project,T=C._changes,v=0,P=u.length;v<P;v++){var w=u[v],N=w._name;w._parent=this,w._setProject(C,!0),N&&w.setName(N),T&&w._changed(5)}this._changed(11)}else u=null;return u},_insertItem:"#insertChild",_insertAt:function(r,u){var f=r&&r._getOwner(),g=r!==this&&f?this:null;return g&&(g._remove(!1,!0),f._insertItem(r._index+u,g)),g},insertAbove:function(r){return this._insertAt(r,1)},insertBelow:function(r){return this._insertAt(r,0)},sendToBack:function(){var r=this._getOwner();return r?r._insertItem(0,this):null},bringToFront:function(){var r=this._getOwner();return r?r._insertItem(t,this):null},appendTop:"#addChild",appendBottom:function(r){return this.insertChild(0,r)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(r){return r._insertItem(t,this)},copyTo:function(r){return this.clone(!1).addTo(r)},reduce:function(r){var u=this._children;if(u&&u.length===1){var f=u[0].reduce(r);return this._parent?(f.insertAbove(this),this.remove()):f.remove(),f}return this},_removeNamed:function(){var r=this._getOwner();if(r){var u=r._children,f=r._namedChildren,g=this._name,v=f[g],w=v?v.indexOf(this):-1;w!==-1&&(u[g]==this&&delete u[g],v.splice(w,1),v.length?u[g]=v[0]:delete f[g])}},_remove:function(r,u){var f=this._getOwner(),g=this._project,v=this._index;return this._style&&this._style._dispose(),f?(this._name&&this._removeNamed(),v!=null&&(g._activeLayer===this&&(g._activeLayer=this.getNextSibling()||this.getPreviousSibling()),a.splice(f._children,null,v,1)),this._installEvents(!1),r&&g._changes&&this._changed(5),u&&f._changed(11,this),this._parent=null,!0):!1},remove:function(){return this._remove(!0,!0)},replaceWith:function(r){var u=r&&r.insertBelow(this);return u&&this.remove(),u},removeChildren:function(r,u){if(!this._children)return null;r=r||0,u=a.pick(u,this._children.length);for(var f=a.splice(this._children,null,r,u-r),g=f.length-1;g>=0;g--)f[g]._remove(!0,!1);return f.length>0&&this._changed(11),f},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var r=0,u=this._children.length;r<u;r++)this._children[r]._index=r;this._changed(11)}},isEmpty:function(r){var u=this._children,f=u?u.length:0;if(r){for(var g=0;g<f;g++)if(!u[g].isEmpty(r))return!1;return!0}return!f},isEditable:function(){for(var r=this;r;){if(!r._visible||r._locked)return!1;r=r._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(r){function u(S){var C=[];do C.unshift(S);while(S=S._parent);return C}for(var f=u(this),g=u(r),v=0,w=Math.min(f.length,g.length);v<w;v++)if(f[v]!=g[v])return f[v]._index<g[v]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return this._parent?this._parent.isInserted():!1},isAbove:function(r){return this._getOrder(r)===-1},isBelow:function(r){return this._getOrder(r)===1},isParent:function(r){return this._parent===r},isChild:function(r){return r&&r._parent===this},isDescendant:function(r){for(var u=this;u=u._parent;)if(u===r)return!0;return!1},isAncestor:function(r){return r?r.isDescendant(this):!1},isSibling:function(r){return this._parent===r._parent},isGroupedWith:function(r){for(var u=this._parent;u;){if(u._parent&&/^(Group|Layer|CompoundPath)$/.test(u._class)&&r.isDescendant(u))return!0;u=u._parent}return!1}},a.each(["rotate","scale","shear","skew"],function(r){var u=r==="rotate";this[r]=function(){var f=arguments,g=(u?a:O).read(f),v=O.read(f,0,{readNull:!0});return this.transform(new le()[r](g,v||this.getPosition(!0)))}},{translate:function(){var r=new le;return this.transform(r.translate.apply(r,arguments))},transform:function(r,u,f){var g=this._matrix,v=r&&!r.isIdentity(),w=f&&this._canApplyMatrix||this._applyMatrix&&(v||!g.isIdentity()||u&&this._children);if(!v&&!w)return this;if(v){!r.isInvertible()&&g.isInvertible()&&(g._backup=g.getValues()),g.prepend(r,!0);var S=this._style,C=S.getFillColor(!0),T=S.getStrokeColor(!0);C&&C.transform(r),T&&T.transform(r)}if(w&&(w=this._transformContent(g,u,f))){var P=this._pivot;P&&g._transformPoint(P,P,!0),g.reset(!0),f&&this._canApplyMatrix&&(this._applyMatrix=!0)}var N=this._bounds,B=this._position;(v||w)&&this._changed(25);var L=v&&N&&r.decompose();if(L&&L.skewing.isZero()&&L.rotation%90===0){for(var j in N){var Y=N[j];if(Y.nonscaling)delete N[j];else if(w||!Y.internal){var z=Y.rect;r._transformBounds(z,z)}}this._bounds=N;var H=N[this._getBoundsCacheKey(this._boundsOptions||{})];H&&(this._position=this._getPositionFromBounds(H.rect))}else v&&B&&this._pivot&&(this._position=r._transformPoint(B,B));return this},_transformContent:function(r,u,f){var g=this._children;if(g){for(var v=0,w=g.length;v<w;v++)g[v].transform(r,u,f);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(O.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(O.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(O.read(arguments))},localToParent:function(){return this._matrix._transformPoint(O.read(arguments))},fitBounds:function(r,u){r=K.read(arguments);var f=this.getBounds(),g=f.height/f.width,v=r.height/r.width,w=(u?g>v:g<v)?r.width/f.width:r.height/f.height,S=new K(new O,new W(f.width*w,f.height*w));S.setCenter(r.getCenter()),this.setBounds(S)}}),{_setStyles:function(r,u,f){var g=this._style,v=this._matrix;if(g.hasFill()&&(r.fillStyle=g.getFillColor().toCanvasStyle(r,v)),g.hasStroke()){r.strokeStyle=g.getStrokeColor().toCanvasStyle(r,v),r.lineWidth=g.getStrokeWidth();var w=g.getStrokeJoin(),S=g.getStrokeCap(),C=g.getMiterLimit();if(w&&(r.lineJoin=w),S&&(r.lineCap=S),C&&(r.miterLimit=C),Nt.support.nativeDash){var T=g.getDashArray(),P=g.getDashOffset();T&&T.length&&("setLineDash"in r?(r.setLineDash(T),r.lineDashOffset=P):(r.mozDash=T,r.mozDashOffset=P))}}if(g.hasShadow()){var N=u.pixelRatio||1,B=f._shiftless().prepend(new le().scale(N,N)),L=B.transform(new O(g.getShadowBlur(),0)),j=B.transform(this.getShadowOffset());r.shadowColor=g.getShadowColor().toCanvasStyle(r),r.shadowBlur=L.getLength(),r.shadowOffsetX=j.x,r.shadowOffsetY=j.y}},draw:function(r,u,f){if(this._updateVersion=this._project._updateVersion,!(!this._visible||this._opacity===0)){var g=u.matrices,v=u.viewMatrix,w=this._matrix,S=g[g.length-1].appended(w);if(S.isInvertible()){v=v?v.appended(S):S,g.push(S),u.updateMatrix&&(this._globalMatrix=S);var C=this._blendMode,T=E.clamp(this._opacity,0,1),P=C==="normal",N=pi.nativeModes[C],B=P&&T===1||u.dontStart||u.clip||(N||P&&T<1)&&this._canComposite(),L=u.pixelRatio||1,j,Y,z;if(!B){var H=this.getStrokeBounds(v);if(!H.width||!H.height){g.pop();return}z=u.offset,Y=u.offset=H.getTopLeft().floor(),j=r,r=tn.getContext(H.getSize().ceil().add(1).multiply(L)),L!==1&&r.scale(L,L)}r.save();var D=f?f.appended(w):this._canScaleStroke&&!this.getStrokeScaling(!0)&&v,U=!B&&u.clipItem,A=!D||U;if(B?(r.globalAlpha=T,N&&(r.globalCompositeOperation=C)):A&&r.translate(-Y.x,-Y.y),A&&(B?w:v).applyToContext(r),U&&u.clipItem.draw(r,u.extend({clip:!0})),D){r.setTransform(L,0,0,L,0,0);var V=u.offset;V&&r.translate(-V.x,-V.y)}this._draw(r,u,v,D),r.restore(),g.pop(),u.clip&&!u.dontFinish&&r.clip(this.getFillRule()),B||(pi.process(C,r,j,T,Y.subtract(z).multiply(L)),tn.release(r),u.offset=z)}}},_isUpdated:function(r){var u=this._parent;if(u instanceof Qe)return u._isUpdated(r);var f=this._updateVersion===r;return!f&&u&&u._visible&&u._isUpdated(r)&&(this._updateVersion=r,f=!0),f},_drawSelection:function(r,u,f,g,v){var w=this._selection,S=w&1,C=w&2||S&&this._selectBounds,T=w&4;if(this._drawSelected||(S=!1),(S||C||T)&&this._isUpdated(v)){var P,N=this.getSelectedColor(!0)||(P=this.getLayer())&&P.getSelectedColor(!0),B=u.appended(this.getGlobalMatrix(!0)),L=f/2;if(r.strokeStyle=r.fillStyle=N?N.toCanvasStyle(r):"#009dec",S&&this._drawSelected(r,B,g),T){var j=this.getPosition(!0),Y=this._parent,z=Y?Y.localToGlobal(j):j,H=z.x,D=z.y;r.beginPath(),r.arc(H,D,L,0,Math.PI*2,!0),r.stroke();for(var U=[[0,-1],[1,0],[0,1],[-1,0]],A=L,V=f+1,q=0;q<4;q++){var J=U[q],X=J[0],te=J[1];r.moveTo(H+X*A,D+te*A),r.lineTo(H+X*V,D+te*V),r.stroke()}}if(C){var ie=B._transformCorners(this.getInternalBounds());r.beginPath();for(var q=0;q<8;q++)r[q?"lineTo":"moveTo"](ie[q],ie[++q]);r.closePath(),r.stroke();for(var q=0;q<8;q++)r.fillRect(ie[q]-L,ie[++q]-L,f,f)}}},_canComposite:function(){return!1}},a.each(["down","drag","up","move"],function(r){this["removeOn"+a.capitalize(r)]=function(){var u={};return u[r]=!0,this.removeOn(u)}},{removeOn:function(r){for(var u in r)if(r[u]){var f="mouse"+u,g=this._project,v=g._removeSets=g._removeSets||{};v[f]=v[f]||{},v[f][this._id]=this}return this}}),{tween:function(r,u,f){f||(f=u,u=r,r=null,f||(f=u,u=null));var g=f&&f.easing,v=f&&f.start,w=f!=null&&(typeof f=="number"?f:f.duration),S=new Ni(this,r,u,w,g,v);function C(T){S._handleFrame(T.time*1e3),S.running||this.off("frame",C)}return w&&this.on("frame",C),S},tweenTo:function(r,u){return this.tween(null,r,u)},tweenFrom:function(r,u){return this.tween(r,null,u)}}),Ne=F.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(u){this._children=[],this._namedChildren={},this._initialize(u)||this.addChildren(Array.isArray(u)?u:arguments)},_changed:function r(u){r.base.call(this,u),u&2050&&(this._clipItem=t)},_getClipItem:function(){var r=this._clipItem;if(r===t){r=null;for(var u=this._children,f=0,g=u.length;f<g;f++)if(u[f]._clipMask){r=u[f];break}this._clipItem=r}return r},isClipped:function(){return!!this._getClipItem()},setClipped:function(r){var u=this.getFirstChild();u&&u.setClipMask(r)},_getBounds:function r(u,f){var g=this._getClipItem();return g?g._getCachedBounds(g._matrix.prepended(u),a.set({},f,{stroke:!1})):r.base.call(this,u,f)},_hitTestChildren:function r(u,f,g){var v=this._getClipItem();return(!v||v.contains(u))&&r.base.call(this,u,f,g,v)},_draw:function(r,u){var f=u.clip,g=!f&&this._getClipItem();u=u.extend({clipItem:g,clip:!1}),f?(r.beginPath(),u.dontStart=u.dontFinish=!0):g&&g.draw(r,u.extend({clip:!0}));for(var v=this._children,w=0,S=v.length;w<S;w++){var C=v[w];C!==g&&C.draw(r,u)}}}),Ve=Ne.extend({_class:"Layer",initialize:function(){Ne.apply(this,arguments)},_getOwner:function(){return this._parent||this._index!=null&&this._project},isInserted:function r(){return this._parent?r.base.call(this):this._index!=null},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),qe=F.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(u,f){this._initialize(u,f)},_equals:function(r){return this._type===r._type&&this._size.equals(r._size)&&a.equals(this._radius,r._radius)},copyContent:function(r){this.setType(r._type),this.setSize(r._size),this.setRadius(r._radius)},getType:function(){return this._type},setType:function(r){this._type=r},getShape:"#getType",setShape:"#setType",getSize:function(){var r=this._size;return new ee(r.width,r.height,this,"setSize")},setSize:function(){var r=W.read(arguments);if(!this._size)this._size=r.clone();else if(!this._size.equals(r)){var u=this._type,f=r.width,g=r.height;u==="rectangle"?this._radius.set(W.min(this._radius,r.divide(2).abs())):u==="circle"?(f=g=(f+g)/2,this._radius=f/2):u==="ellipse"&&this._radius._set(f/2,g/2),this._size._set(f,g),this._changed(9)}},getRadius:function(){var r=this._radius;return this._type==="circle"?r:new ee(r.width,r.height,this,"setRadius")},setRadius:function(r){var u=this._type;if(u==="circle"){if(r===this._radius)return;var f=r*2;this._radius=r,this._size._set(f,f)}else if(r=W.read(arguments),!this._radius)this._radius=r.clone();else{if(this._radius.equals(r))return;if(this._radius.set(r),u==="rectangle"){var f=W.max(this._size,r.multiply(2));this._size.set(f)}else u==="ellipse"&&this._size._set(r.width*2,r.height*2)}this._changed(9)},isEmpty:function(){return!1},toPath:function(r){var u=new Xe[a.capitalize(this._type)]({center:new O,size:this._size,radius:this._radius,insert:!1});return u.copyAttributes(this),Nt.settings.applyMatrix&&u.setApplyMatrix(!0),(r===t||r)&&u.insertAbove(this),u},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(r,u,f,g){var v=this._style,w=v.hasFill(),S=v.hasStroke(),C=u.dontFinish||u.clip,T=!g;if(w||S||C){var P=this._type,N=this._radius,B=P==="circle";if(u.dontStart||r.beginPath(),T&&B)r.arc(0,0,N,0,Math.PI*2,!0);else{var L=B?N:N.width,j=B?N:N.height,Y=this._size,z=Y.width,H=Y.height;if(T&&P==="rectangle"&&L===0&&j===0)r.rect(-z/2,-H/2,z,H);else{var D=z/2,U=H/2,A=1-.5522847498307936,V=L*A,q=j*A,J=[-D,-U+j,-D,-U+q,-D+V,-U,-D+L,-U,D-L,-U,D-V,-U,D,-U+q,D,-U+j,D,U-j,D,U-q,D-V,U,D-L,U,-D+L,U,-D+V,U,-D,U-q,-D,U-j];g&&g.transform(J,J,32),r.moveTo(J[0],J[1]),r.bezierCurveTo(J[2],J[3],J[4],J[5],J[6],J[7]),D!==L&&r.lineTo(J[8],J[9]),r.bezierCurveTo(J[10],J[11],J[12],J[13],J[14],J[15]),U!==j&&r.lineTo(J[16],J[17]),r.bezierCurveTo(J[18],J[19],J[20],J[21],J[22],J[23]),D!==L&&r.lineTo(J[24],J[25]),r.bezierCurveTo(J[26],J[27],J[28],J[29],J[30],J[31])}}r.closePath()}!C&&(w||S)&&(this._setStyles(r,u,f),w&&(r.fill(v.getFillRule()),r.shadowColor="rgba(0,0,0,0)"),S&&r.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(r,u){var f=new K(this._size).setCenter(0,0),g=this._style,v=u.stroke&&g.hasStroke()&&g.getStrokeWidth();return r&&(f=r._transformBounds(f)),v?f.expand(Xe._getStrokePadding(v,this._getStrokeMatrix(r,u))):f}},new function(){function r(f,g,v){var w=f._radius;if(!w.isZero())for(var S=f._size.divide(2),C=1;C<=4;C++){var T=new O(C>1&&C<4?-1:1,C>2?-1:1),P=T.multiply(S),N=P.subtract(T.multiply(w)),B=new K(v?P.add(T.multiply(v)):P,N);if(B.contains(g))return{point:N,quadrant:C}}}function u(f,g,v,w){var S=f.divide(g);return(!w||S.isInQuadrant(w))&&S.subtract(S.normalize()).multiply(g).divide(v).length<=1}return{_contains:function f(g){if(this._type==="rectangle"){var v=r(this,g);return v?g.subtract(v.point).divide(this._radius).getLength()<=1:f.base.call(this,g)}else return g.divide(this.size).getLength()<=.5},_hitTestSelf:function f(g,v,w,S){var C=!1,T=this._style,P=v.stroke&&T.hasStroke(),N=v.fill&&T.hasFill();if(P||N){var B=this._type,L=this._radius,j=P?T.getStrokeWidth()/2:0,Y=v._tolerancePadding.add(Xe._getStrokePadding(j,!T.getStrokeScaling()&&S));if(B==="rectangle"){var z=Y.multiply(2),H=r(this,g,z);if(H)C=u(g.subtract(H.point),L,Y,H.quadrant);else{var D=new K(this._size).setCenter(0,0),U=D.expand(z),A=D.expand(z.negate());C=U._containsPoint(g)&&!A._containsPoint(g)}}else C=u(g,L,Y)}return C?new dt(P?"stroke":"fill",this):f.base.apply(this,arguments)}}},{statics:new function(){function r(u,f,g,v,w){var S=a.create(qe.prototype);return S._type=u,S._size=g,S._radius=v,S._initialize(a.getNamed(w),f),S}return{Circle:function(){var u=arguments,f=O.readNamed(u,"center"),g=a.readNamed(u,"radius");return r("circle",f,new W(g*2),g,u)},Rectangle:function(){var u=arguments,f=K.readNamed(u,"rectangle"),g=W.min(W.readNamed(u,"radius"),f.getSize(!0).divide(2));return r("rectangle",f.getCenter(!0),f.getSize(!0),g,u)},Ellipse:function(){var u=arguments,f=qe._readEllipse(u),g=f.radius;return r("ellipse",f.center,g.multiply(2),g,u)},_readEllipse:function(u){var f,g;if(a.hasNamed(u,"radius"))f=O.readNamed(u,"center"),g=W.readNamed(u,"radius");else{var v=K.readNamed(u,"rectangle");f=v.getCenter(!0),g=v.getSize(!0).divide(2)}return{center:f,radius:g}}}}}),ot=F.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(u,f){if(!this._initialize(u,f!==t&&O.read(arguments))){var g,v=typeof u,w=v==="string"?i.getElementById(u):v==="object"?u:null;if(w&&w!==F.NO_INSERT){if(w.getContext||w.naturalHeight!=null)g=w;else if(w){var S=W.read(arguments);S.isZero()||(g=tn.getCanvas(S))}}g?this.setImage(g):this.setSource(u)}this._size||(this._size=new W,this._loaded=!1)},_equals:function(r){return this.getSource()===r.getSource()},copyContent:function(r){var u=r._image,f=r._canvas;if(u)this._setImage(u);else if(f){var g=tn.getCanvas(r._size);g.getContext("2d").drawImage(f,0,0),this._setImage(g)}this._crossOrigin=r._crossOrigin},getSize:function(){var r=this._size;return new ee(r?r.width:0,r?r.height:0,this,"setSize")},setSize:function(r,u){var f=W.read(arguments);if(f.equals(this._size))u&&this.clear();else if(f.width>0&&f.height>0){var g=!u&&this.getElement();this._setImage(tn.getCanvas(f)),g&&this.getContext(!0).drawImage(g,0,0,f.width,f.height)}else this._canvas&&tn.release(this._canvas),this._size=f.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(r){this.setSize(r,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(r){this.setSize(this.getWidth(),r)},getLoaded:function(){return this._loaded},isEmpty:function(){var r=this._size;return!r||r.width===0&&r.height===0},getResolution:function(){var r=this._matrix,u=new O(0,0).transform(r),f=new O(1,0).transform(r).subtract(u),g=new O(0,1).transform(r).subtract(u);return new W(72/f.getLength(),72/g.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(r){var u=this;function f(g){var v=u.getView(),w=g&&g.type||"load";v&&u.responds(w)&&(Nt=v._scope,u.emit(w,new Rr(g)))}this._setImage(r),this._loaded?setTimeout(f,0):r&&At.add(r,{load:function(g){u._setImage(r),f(g)},error:f})},_setImage:function(r){this._canvas&&tn.release(this._canvas),r&&r.getContext?(this._image=null,this._canvas=r,this._loaded=!0):(this._image=r,this._canvas=null,this._loaded=!!(r&&r.src&&r.complete)),this._size=new W(r?r.naturalWidth||r.width:0,r?r.naturalHeight||r.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var r=tn.getContext(this._size);try{this._image&&r.drawImage(this._image,0,0),this._canvas=r.canvas}catch{tn.release(r)}}return this._canvas},setCanvas:"#setImage",getContext:function(r){return this._context||(this._context=this.getCanvas().getContext("2d")),r&&(this._image=null,this._changed(1025)),this._context},setContext:function(r){this._context=r},getSource:function(){var r=this._image;return r&&r.src||this.toDataURL()},setSource:function(r){var u=new e.Image,f=this._crossOrigin;f&&(u.crossOrigin=f),r&&(u.src=r),this.setImage(u)},getCrossOrigin:function(){var r=this._image;return r&&r.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(r){this._crossOrigin=r;var u=this._image;u&&(u.crossOrigin=r)},getSmoothing:function(){return this._smoothing},setSmoothing:function(r){this._smoothing=typeof r=="string"?r:r?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var r=K.read(arguments),u=tn.getContext(r.getSize());return u.drawImage(this.getCanvas(),r.x,r.y,r.width,r.height,0,0,r.width,r.height),u.canvas},getSubRaster:function(){var r=K.read(arguments),u=new ot(F.NO_INSERT);return u._setImage(this.getSubCanvas(r)),u.translate(r.getCenter().subtract(this.getSize().divide(2))),u._matrix.prepend(this._matrix),u.insertAbove(this),u},toDataURL:function(){var r=this._image,u=r&&r.src;if(/^data:/.test(u))return u;var f=this.getCanvas();return f?f.toDataURL.apply(f,arguments):null},drawImage:function(r){var u=O.read(arguments,1);this.getContext(!0).drawImage(r,u.x,u.y)},getAverageColor:function(r){var u,f;if(r?r instanceof ze?(f=r,u=r.getBounds()):typeof r=="object"&&("width"in r?u=new K(r):"x"in r&&(u=new K(r.x-.5,r.y-.5,1,1))):u=this.getBounds(),!u)return null;var g=32,v=Math.min(u.width,g),w=Math.min(u.height,g),S=ot._sampleContext;S?S.clearRect(0,0,g+1,g+1):S=ot._sampleContext=tn.getContext(new W(g)),S.save();var C=new le().scale(v/u.width,w/u.height).translate(-u.x,-u.y);C.applyToContext(S),f&&f.draw(S,new a({clip:!0,matrices:[C]})),this._matrix.applyToContext(S);var T=this.getElement(),P=this._size;T&&S.drawImage(T,-P.width/2,-P.height/2),S.restore();for(var N=S.getImageData(.5,.5,Math.ceil(v),Math.ceil(w)).data,B=[0,0,0],L=0,j=0,Y=N.length;j<Y;j+=4){var z=N[j+3];L+=z,z/=255,B[0]+=N[j]*z,B[1]+=N[j+1]*z,B[2]+=N[j+2]*z}for(var j=0;j<3;j++)B[j]/=L;return L?pt.read(B):null},getPixel:function(){var r=O.read(arguments),u=this.getContext().getImageData(r.x,r.y,1,1).data;return new pt("rgb",[u[0]/255,u[1]/255,u[2]/255],u[3]/255)},setPixel:function(){var r=arguments,u=O.read(r),f=pt.read(r),g=f._convert("rgb"),v=f._alpha,w=this.getContext(!0),S=w.createImageData(1,1),C=S.data;C[0]=g[0]*255,C[1]=g[1]*255,C[2]=g[2]*255,C[3]=v!=null?v*255:255,w.putImageData(S,u.x,u.y)},clear:function(){var r=this._size;this.getContext(!0).clearRect(0,0,r.width+1,r.height+1)},createImageData:function(){var r=W.read(arguments);return this.getContext().createImageData(r.width,r.height)},getImageData:function(){var r=K.read(arguments);return r.isEmpty()&&(r=new K(this._size)),this.getContext().getImageData(r.x,r.y,r.width,r.height)},putImageData:function(r){var u=O.read(arguments,1);this.getContext(!0).putImageData(r,u.x,u.y)},setImageData:function(r){this.setSize(r),this.getContext(!0).putImageData(r,0,0)},_getBounds:function(r,u){var f=new K(this._size).setCenter(0,0);return r?r._transformBounds(f):f},_hitTestSelf:function(r){if(this._contains(r)){var u=this;return new dt("pixel",u,{offset:r.add(u._size.divide(2)).round(),color:{get:function(){return u.getPixel(this.offset)}}})}},_draw:function(r,u,f){var g=this.getElement();if(g&&g.width>0&&g.height>0){r.globalAlpha=E.clamp(this._opacity,0,1),this._setStyles(r,u,f);var v=this._smoothing,w=v==="off";_t.setPrefixed(r,w?"imageSmoothingEnabled":"imageSmoothingQuality",w?!1:v),r.drawImage(g,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),je=F.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(u,f){this._initialize(u,f!==t&&O.read(arguments,1))||this.setDefinition(u instanceof Ze?u:new Ze(u))},_equals:function(r){return this._definition===r._definition},copyContent:function(r){this.setDefinition(r._definition)},getDefinition:function(){return this._definition},setDefinition:function(r){this._definition=r,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(r,u){var f=this._definition._item;return f._getCachedBounds(f._matrix.prepended(r),u)},_hitTestSelf:function(r,u,f){var g=u.extend({all:!1}),v=this._definition._item._hitTest(r,g,f);return v&&(v.item=this),v},_draw:function(r,u){this._definition._item.draw(r,u)}}),Ze=a.extend({_class:"SymbolDefinition",initialize:function(u,f){this._id=I.get(),this.project=Nt.project,u&&this.setItem(u,f)},_serialize:function(r,u){return u.add(this,function(){return a.serialize([this._class,this._item],r,!1,u)})},_changed:function(r){r&8&&F._clearBoundsCache(this),r&1&&this.project._changed(r)},getItem:function(){return this._item},setItem:function(r,u){r._symbol&&(r=r.clone()),this._item&&(this._item._symbol=null),this._item=r,r.remove(),r.setSelected(!1),u||r.setPosition(new O),r._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(r){return new je(this,r)},clone:function(){return new Ze(this._item.clone(!1))},equals:function(r){return r===this||r&&this._item.equals(r._item)||!1}}),dt=a.extend({_class:"HitResult",initialize:function(u,f,g){this.type=u,this.item=f,g&&this.inject(g)},statics:{getOptions:function(r){var u=r&&a.read(r);return new a({type:null,tolerance:Nt.settings.hitTolerance,fill:!u,stroke:!u,segments:!u,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},u)}}}),We=a.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(u,f,g,v,w,S){var C=arguments.length,T,P,N,B;C>0&&(u==null||typeof u=="object"?C===1&&u&&"point"in u?(T=u.point,P=u.handleIn,N=u.handleOut,B=u.selection):(T=u,P=f,N=g,B=v):(T=[u,f],P=g!==t?[g,v]:null,N=w!==t?[w,S]:null)),new Bt(T,this,"_point"),new Bt(P,this,"_handleIn"),new Bt(N,this,"_handleOut"),B&&this.setSelection(B)},_serialize:function(r,u){var f=this._point,g=this._selection,v=g||this.hasHandles()?[f,this._handleIn,this._handleOut]:f;return g&&v.push(g),a.serialize(v,r,!0,u)},_changed:function(r){var u=this._path;if(u){var f=u._curves,g=this._index,v;f&&((!r||r===this._point||r===this._handleIn)&&(v=g>0?f[g-1]:u._closed?f[f.length-1]:null)&&v._changed(),(!r||r===this._point||r===this._handleOut)&&(v=f[g])&&v._changed()),u._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(O.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(O.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(O.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var r=this._handleIn,u=this._handleOut;return!r.isZero()&&!u.isZero()&&r.isCollinear(u)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(r){var u=this._selection,f=this._path;this._selection=r=r||0,f&&r!==u&&(f._updateSelection(this,u,r),f._changed(257))},_changeSelection:function(r,u){var f=this._selection;this.setSelection(u?f|r:f&~r)},isSelected:function(){return!!(this._selection&7)},setSelected:function(r){this._changeSelection(7,r)},getIndex:function(){return this._index!==t?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var r=this._path,u=this._index;return r?(u>0&&!r._closed&&u===r._segments.length-1&&u--,r.getCurves()[u]||null):null},getLocation:function(){var r=this.getCurve();return r?new wt(r,this===r._segment1?0:1):null},getNext:function(){var r=this._path&&this._path._segments;return r&&(r[this._index+1]||this._path._closed&&r[0])||null},smooth:function(r,u,f){var g=r||{},v=g.type,w=g.factor,S=this.getPrevious(),C=this.getNext(),T=(S||this)._point,P=this._point,N=(C||this)._point,B=T.getDistance(P),L=P.getDistance(N);if(!v||v==="catmull-rom"){var j=w===t?.5:w,Y=Math.pow(B,j),z=Y*Y,H=Math.pow(L,j),D=H*H;if(!u&&S){var U=2*D+3*H*Y+z,A=3*H*(H+Y);this.setHandleIn(A!==0?new O((D*T._x+U*P._x-z*N._x)/A-P._x,(D*T._y+U*P._y-z*N._y)/A-P._y):new O)}if(!f&&C){var U=2*z+3*Y*H+D,A=3*Y*(Y+H);this.setHandleOut(A!==0?new O((z*N._x+U*P._x-D*T._x)/A-P._x,(z*N._y+U*P._y-D*T._y)/A-P._y):new O)}}else if(v==="geometric"){if(S&&C){var V=T.subtract(N),q=w===t?.4:w,J=q*B/(B+L);u||this.setHandleIn(V.multiply(J)),f||this.setHandleOut(V.multiply(J-q))}}else throw new Error("Smoothing method '"+v+"' not supported.")},getPrevious:function(){var r=this._path&&this._path._segments;return r&&(r[this._index-1]||this._path._closed&&r[r.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var r=this._path;return r&&this._index===r._segments.length-1||!1},reverse:function(){var r=this._handleIn,u=this._handleOut,f=r.clone();r.set(u),u.set(f)},reversed:function(){return new We(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new We(this._point,this._handleIn,this._handleOut)},equals:function(r){return r===this||r&&this._class===r._class&&this._point.equals(r._point)&&this._handleIn.equals(r._handleIn)&&this._handleOut.equals(r._handleOut)||!1},toString:function(){var r=["point: "+this._point];return this._handleIn.isZero()||r.push("handleIn: "+this._handleIn),this._handleOut.isZero()||r.push("handleOut: "+this._handleOut),"{ "+r.join(", ")+" }"},transform:function(r){this._transformCoordinates(r,new Array(6),!0),this._changed()},interpolate:function(r,u,f){var g=1-f,v=f,w=r._point,S=u._point,C=r._handleIn,T=u._handleIn,P=u._handleOut,N=r._handleOut;this._point._set(g*w._x+v*S._x,g*w._y+v*S._y,!0),this._handleIn._set(g*C._x+v*T._x,g*C._y+v*T._y,!0),this._handleOut._set(g*N._x+v*P._x,g*N._y+v*P._y,!0),this._changed()},_transformCoordinates:function(r,u,f){var g=this._point,v=!f||!this._handleIn.isZero()?this._handleIn:null,w=!f||!this._handleOut.isZero()?this._handleOut:null,S=g._x,C=g._y,T=2;return u[0]=S,u[1]=C,v&&(u[T++]=v._x+S,u[T++]=v._y+C),w&&(u[T++]=w._x+S,u[T++]=w._y+C),r&&(r._transformCoordinates(u,u,T/2),S=u[0],C=u[1],f?(g._x=S,g._y=C,T=2,v&&(v._x=u[T++]-S,v._y=u[T++]-C),w&&(w._x=u[T++]-S,w._y=u[T++]-C)):(v||(u[T++]=S,u[T++]=C),w||(u[T++]=S,u[T++]=C))),u}}),Bt=O.extend({initialize:function(u,f,g){var v,w,S;if(!u)v=w=0;else if((v=u[0])!==t)w=u[1];else{var C=u;(v=C.x)===t&&(C=O.read(arguments),v=C.x),w=C.y,S=C.selected}this._x=v,this._y=w,this._owner=f,f[g]=this,S&&this.setSelected(!0)},_set:function(r,u){return this._x=r,this._y=u,this._owner._changed(this),this},getX:function(){return this._x},setX:function(r){this._x=r,this._owner._changed(this)},getY:function(){return this._y},setY:function(r){this._y=r,this._owner._changed(this)},isZero:function(){var r=E.isZero;return r(this._x)&&r(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(r){this._owner._changeSelection(this._getSelection(),r)},_getSelection:function(){var r=this._owner;return this===r._point?1:this===r._handleIn?2:this===r._handleOut?4:0}}),Le=a.extend({_class:"Curve",beans:!0,initialize:function(u,f,g,v,w,S,C,T){var P=arguments.length,N,B,L,j,Y,z;P===3?(this._path=u,N=f,B=g):P?P===1?"segment1"in u?(N=new We(u.segment1),B=new We(u.segment2)):"point1"in u?(L=u.point1,Y=u.handle1,z=u.handle2,j=u.point2):Array.isArray(u)&&(L=[u[0],u[1]],j=[u[6],u[7]],Y=[u[2]-u[0],u[3]-u[1]],z=[u[4]-u[6],u[5]-u[7]]):P===2?(N=new We(u),B=new We(f)):P===4?(L=u,Y=f,z=g,j=v):P===8&&(L=[u,f],j=[C,T],Y=[g-u,v-f],z=[w-C,S-T]):(N=new We,B=new We),this._segment1=N||new We(L,null,Y),this._segment2=B||new We(j,z,null)},_serialize:function(r,u){return a.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],r,!0,u)},_changed:function(){this._length=this._bounds=t},clone:function(){return new Le(this._segment1,this._segment2)},toString:function(){var r=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||r.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||r.push("handle2: "+this._segment2._handleIn),r.push("point2: "+this._segment2._point),"{ "+r.join(", ")+" }"},classify:function(){return Le.classify(this.getValues())},remove:function(){var r=!1;if(this._path){var u=this._segment2,f=u._handleOut;r=u.remove(),r&&this._segment1._handleOut.set(f)}return r},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(O.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(O.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(O.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(O.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var r=this._path&&this._path._curves;return r&&(r[this._segment1._index+1]||this._path._closed&&r[0])||null},getPrevious:function(){var r=this._path&&this._path._curves;return r&&(r[this._segment1._index-1]||this._path._closed&&r[r.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var r=this._path;return r&&this._segment1._index===r._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(r){this.getPoint1().setSelected(r),this.getHandle1().setSelected(r),this.getHandle2().setSelected(r),this.getPoint2().setSelected(r)},getValues:function(r){return Le.getValues(this._segment1,this._segment2,r)},getPoints:function(){for(var r=this.getValues(),u=[],f=0;f<8;f+=2)u.push(new O(r[f],r[f+1]));return u}},{getLength:function(){return this._length==null&&(this._length=Le.getLength(this.getValues(),0,1)),this._length},getArea:function(){return Le.getArea(this.getValues())},getLine:function(){return new ge(this._segment1._point,this._segment2._point)},getPart:function(r,u){return new Le(Le.getPart(this.getValues(),r,u))},getPartLength:function(r,u){return Le.getLength(this.getValues(),r,u)},divideAt:function(r){return this.divideAtTime(r&&r.curve===this?r.time:this.getTimeAt(r))},divideAtTime:function(r,u){var f=1e-8,g=1-f,v=null;if(r>=f&&r<=g){var w=Le.subdivide(this.getValues(),r),S=w[0],C=w[1],T=u||this.hasHandles(),P=this._segment1,N=this._segment2,B=this._path;T&&(P._handleOut._set(S[2]-S[0],S[3]-S[1]),N._handleIn._set(C[4]-C[6],C[5]-C[7]));var L=S[6],j=S[7],Y=new We(new O(L,j),T&&new O(S[4]-L,S[5]-j),T&&new O(C[2]-L,C[3]-j));B?(B.insert(P._index+1,Y),v=this.getNext()):(this._segment2=Y,this._changed(),v=new Le(Y,N))}return v},splitAt:function(r){var u=this._path;return u?u.splitAt(r):null},splitAtTime:function(r){return this.splitAt(this.getLocationAtTime(r))},divide:function(r,u){return this.divideAtTime(r===t?.5:u?r:this.getTimeAt(r))},split:function(r,u){return this.splitAtTime(r===t?.5:u?r:this.getTimeAt(r))},reversed:function(){return new Le(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(r,u,f,g){var v=r._point,w=r._handleOut,S=u._handleIn,C=u._point,T=v.x,P=v.y,N=C.x,B=C.y,L=g?[T,P,T,P,N,B,N,B]:[T,P,T+w._x,P+w._y,N+S._x,B+S._y,N,B];return f&&f._transformCoordinates(L,L,4),L},subdivide:function(r,u){var f=r[0],g=r[1],v=r[2],w=r[3],S=r[4],C=r[5],T=r[6],P=r[7];u===t&&(u=.5);var N=1-u,B=N*f+u*v,L=N*g+u*w,j=N*v+u*S,Y=N*w+u*C,z=N*S+u*T,H=N*C+u*P,D=N*B+u*j,U=N*L+u*Y,A=N*j+u*z,V=N*Y+u*H,q=N*D+u*A,J=N*U+u*V;return[[f,g,B,L,D,U,q,J],[q,J,A,V,z,H,T,P]]},getMonoCurves:function(r,u){var f=[],g=u?0:1,v=r[g+0],w=r[g+2],S=r[g+4],C=r[g+6];if(v>=w==w>=S&&w>=S==S>=C||Le.isStraight(r))f.push(r);else{var T=3*(w-S)-v+C,P=2*(v+S)-4*w,N=w-v,B=1e-8,L=1-B,j=[],Y=E.solveQuadratic(T,P,N,j,B,L);if(!Y)f.push(r);else{j.sort();var z=j[0],H=Le.subdivide(r,z);f.push(H[0]),Y>1&&(z=(j[1]-z)/(1-z),H=Le.subdivide(H[1],z),f.push(H[0])),f.push(H[1])}}return f},solveCubic:function(r,u,f,g,v,w){var S=r[u],C=r[u+2],T=r[u+4],P=r[u+6],N=0;if(!(S<f&&P<f&&C<f&&T<f||S>f&&P>f&&C>f&&T>f)){var B=3*(C-S),L=3*(T-C)-B,j=P-S-B-L;N=E.solveCubic(j,L,B,S-f,g,v,w)}return N},getTimeOf:function(r,u){var f=new O(r[0],r[1]),g=new O(r[6],r[7]),v=1e-12,w=1e-7,S=u.isClose(f,v)?0:u.isClose(g,v)?1:null;if(S===null)for(var C=[u.x,u.y],T=[],P=0;P<2;P++)for(var N=Le.solveCubic(r,P,C[P],T,0,1),B=0;B<N;B++){var L=T[B];if(u.isClose(Le.getPoint(r,L),w))return L}return u.isClose(f,w)?0:u.isClose(g,w)?1:null},getNearestTime:function(r,u){if(Le.isStraight(r)){var f=r[0],g=r[1],v=r[6],w=r[7],S=v-f,C=w-g,T=S*S+C*C;if(T===0)return 0;var P=((u.x-f)*S+(u.y-g)*C)/T;return P<1e-12?0:P>.999999999999?1:Le.getTimeOf(r,new O(f+P*S,g+P*C))}var N=100,B=1/0,L=0;function j(H){if(H>=0&&H<=1){var D=u.getDistance(Le.getPoint(r,H),!0);if(D<B)return B=D,L=H,!0}}for(var Y=0;Y<=N;Y++)j(Y/N);for(var z=1/(N*2);z>1e-8;)!j(L-z)&&!j(L+z)&&(z/=2);return L},getPart:function(r,u,f){var g=u>f;if(g){var v=u;u=f,f=v}return u>0&&(r=Le.subdivide(r,u)[1]),f<1&&(r=Le.subdivide(r,(f-u)/(1-u))[0]),g?[r[6],r[7],r[4],r[5],r[2],r[3],r[0],r[1]]:r},isFlatEnough:function(r,u){var f=r[0],g=r[1],v=r[2],w=r[3],S=r[4],C=r[5],T=r[6],P=r[7],N=3*v-2*f-T,B=3*w-2*g-P,L=3*S-2*T-f,j=3*C-2*P-g;return Math.max(N*N,L*L)+Math.max(B*B,j*j)<=16*u*u},getArea:function(r){var u=r[0],f=r[1],g=r[2],v=r[3],w=r[4],S=r[5],C=r[6],T=r[7];return 3*((T-f)*(g+w)-(C-u)*(v+S)+v*(u-w)-g*(f-S)+T*(w+u/3)-C*(S+f/3))/20},getBounds:function(r){for(var u=r.slice(0,2),f=u.slice(),g=[0,0],v=0;v<2;v++)Le._addBounds(r[v],r[v+2],r[v+4],r[v+6],v,0,u,f,g);return new K(u[0],u[1],f[0]-u[0],f[1]-u[1])},_addBounds:function(r,u,f,g,v,w,S,C,T){function P(q,J){var X=q-J,te=q+J;X<S[v]&&(S[v]=X),te>C[v]&&(C[v]=te)}w/=2;var N=S[v]+w,B=C[v]-w;if(r<N||u<N||f<N||g<N||r>B||u>B||f>B||g>B)if(u<r!=u<g&&f<r!=f<g)P(r,0),P(g,0);else{var L=3*(u-f)-r+g,j=2*(r+f)-4*u,Y=u-r,z=E.solveQuadratic(L,j,Y,T),H=1e-8,D=1-H;P(g,0);for(var U=0;U<z;U++){var A=T[U],V=1-A;H<=A&&A<=D&&P(V*V*V*r+3*V*V*A*u+3*V*A*A*f+A*A*A*g,w)}}}}},a.each(["getBounds","getStrokeBounds","getHandleBounds"],function(r){this[r]=function(){this._bounds||(this._bounds={});var u=this._bounds[r];return u||(u=this._bounds[r]=Xe[r]([this._segment1,this._segment2],!1,this._path)),u.clone()}},{}),a.each({isStraight:function(r,u,f,g){if(u.isZero()&&f.isZero())return!0;var v=g.subtract(r);if(v.isZero())return!1;if(v.isCollinear(u)&&v.isCollinear(f)){var w=new ge(r,g),S=1e-7;if(w.getDistance(r.add(u))<S&&w.getDistance(g.add(f))<S){var C=v.dot(v),T=v.dot(u)/C,P=v.dot(f)/C;return T>=0&&T<=1&&P<=0&&P>=-1}}return!1},isLinear:function(r,u,f,g){var v=g.subtract(r).divide(3);return u.equals(v)&&f.negate().equals(v)}},function(r,u){this[u]=function(f){var g=this._segment1,v=this._segment2;return r(g._point,g._handleOut,v._handleIn,v._point,f)},this.statics[u]=function(f,g){var v=f[0],w=f[1],S=f[6],C=f[7];return r(new O(v,w),new O(f[2]-v,f[3]-w),new O(f[4]-S,f[5]-C),new O(S,C),g)}},{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(r){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(r||0)},isCollinear:function(r){return r&&this.isStraight()&&r.isStraight()&&this.getLine().isCollinear(r.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(r,u){return this.getLocationAtTime(u?r:this.getTimeAt(r))},getLocationAtTime:function(r){return r!=null&&r>=0&&r<=1?new wt(this,r):null},getTimeAt:function(r,u){return Le.getTimeAt(this.getValues(),r,u)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var r=O.read(arguments);return r.isZero()?[]:Le.getTimesWithTangent(this.getValues(),r)},getOffsetAtTime:function(r){return this.getPartLength(0,r)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(O.read(arguments)))},getOffsetOf:function(){var r=this.getLocationOf.apply(this,arguments);return r?r.getOffset():null},getTimeOf:function(){return Le.getTimeOf(this.getValues(),O.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var r=O.read(arguments),u=this.getValues(),f=Le.getNearestTime(u,r),g=Le.getPoint(u,f);return new wt(this,f,g,null,r.getDistance(g))},getNearestPoint:function(){var r=this.getNearestLocation.apply(this,arguments);return r&&r.getPoint()}},new function(){var r=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return a.each(r,function(u){this[u+"At"]=function(f,g){var v=this.getValues();return Le[u](v,g?f:Le.getTimeAt(v,f))},this[u+"AtTime"]=function(f){return Le[u](this.getValues(),f)}},{statics:{_evaluateMethods:r}})},new function(){function r(g){var v=g[0],w=g[1],S=g[2],C=g[3],T=g[4],P=g[5],N=g[6],B=g[7],L=9*(S-T)+3*(N-v),j=6*(v+T)-12*S,Y=3*(S-v),z=9*(C-P)+3*(B-w),H=6*(w+P)-12*C,D=3*(C-w);return function(U){var A=(L*U+j)*U+Y,V=(z*U+H)*U+D;return Math.sqrt(A*A+V*V)}}function u(g,v){return Math.max(2,Math.min(16,Math.ceil(Math.abs(v-g)*32)))}function f(g,v,w,S){if(v==null||v<0||v>1)return null;var C=g[0],T=g[1],P=g[2],N=g[3],B=g[4],L=g[5],j=g[6],Y=g[7],z=E.isZero;z(P-C)&&z(N-T)&&(P=C,N=T),z(B-j)&&z(L-Y)&&(B=j,L=Y);var H=3*(P-C),D=3*(B-P)-H,U=j-C-H-D,A=3*(N-T),V=3*(L-N)-A,q=Y-T-A-V,J,X;if(w===0)J=v===0?C:v===1?j:((U*v+D)*v+H)*v+C,X=v===0?T:v===1?Y:((q*v+V)*v+A)*v+T;else{var te=1e-8,ie=1-te;if(v<te?(J=H,X=A):v>ie?(J=3*(j-B),X=3*(Y-L)):(J=(3*U*v+2*D)*v+H,X=(3*q*v+2*V)*v+A),S){J===0&&X===0&&(v<te||v>ie)&&(J=B-P,X=L-N);var se=Math.sqrt(J*J+X*X);se&&(J/=se,X/=se)}if(w===3){var B=6*U*v+2*D,L=6*q*v+2*V,he=Math.pow(J*J+X*X,3/2);J=he!==0?(J*L-X*B)/he:0,X=0}}return w===2?new O(X,-J):new O(J,X)}return{statics:{classify:function(g){var v=g[0],w=g[1],S=g[2],C=g[3],T=g[4],P=g[5],N=g[6],B=g[7],L=v*(B-P)+w*(T-N)+N*P-B*T,j=S*(w-B)+C*(N-v)+v*B-w*N,Y=T*(C-w)+P*(v-S)+S*w-C*v,z=3*Y,H=z-j,D=H-j+L,U=Math.sqrt(D*D+H*H+z*z),A=U!==0?1/U:0,V=E.isZero,q="serpentine";D*=A,H*=A,z*=A;function J(se,he,ne){var ce=he!==t,fe=ce&&he>0&&he<1,ye=ce&&ne>0&&ne<1;return ce&&(!(fe||ye)||se==="loop"&&!(fe&&ye))&&(se="arch",fe=ye=!1),{type:se,roots:fe||ye?fe&&ye?he<ne?[he,ne]:[ne,he]:[fe?he:ne]:null}}if(V(D))return V(H)?J(V(z)?"line":"quadratic"):J(q,z/(3*H));var X=3*H*H-4*D*z;if(V(X))return J("cusp",H/(2*D));var te=X>0?Math.sqrt(X/3):Math.sqrt(-X),ie=2*D;return J(X>0?q:"loop",(H+te)/ie,(H-te)/ie)},getLength:function(g,v,w,S){if(v===t&&(v=0),w===t&&(w=1),Le.isStraight(g)){var C=g;w<1&&(C=Le.subdivide(C,w)[0],v/=w),v>0&&(C=Le.subdivide(C,v)[1]);var T=C[6]-C[0],P=C[7]-C[1];return Math.sqrt(T*T+P*P)}return E.integrate(S||r(g),v,w,u(v,w))},getTimeAt:function(g,v,w){if(w===t&&(w=v<0?1:0),v===0)return w;var S=Math.abs,C=1e-12,T=v>0,P=T?w:0,N=T?1:w,B=r(g),L=Le.getLength(g,P,N,B),j=S(v)-L;if(S(j)<C)return T?N:P;if(j>C)return null;var Y=v/L,z=0;function H(D){return z+=E.integrate(B,w,D,u(w,D)),w=D,z-v}return E.findRoot(H,B,w+Y,P,N,32,1e-12)},getPoint:function(g,v){return f(g,v,0,!1)},getTangent:function(g,v){return f(g,v,1,!0)},getWeightedTangent:function(g,v){return f(g,v,1,!1)},getNormal:function(g,v){return f(g,v,2,!0)},getWeightedNormal:function(g,v){return f(g,v,2,!1)},getCurvature:function(g,v){return f(g,v,3,!1).x},getPeaks:function(g){var v=g[0],w=g[1],S=g[2],C=g[3],T=g[4],P=g[5],N=g[6],B=g[7],L=-v+3*S-3*T+N,j=3*v-6*S+3*T,Y=-3*v+3*S,z=-w+3*C-3*P+B,H=3*w-6*C+3*P,D=-3*w+3*C,U=1e-8,A=1-U,V=[];return E.solveCubic(9*(L*L+z*z),9*(L*j+H*z),2*(j*j+H*H)+3*(Y*L+D*z),Y*j+H*D,V,U,A),V.sort()}}}},new function(){function r(j,Y,z,H,D,U,A){var V=!A&&z.getPrevious()===D,q=!A&&z!==D&&z.getNext()===D,J=1e-8,X=1-J;if(H!==null&&H>=(V?J:0)&&H<=(q?X:1)&&U!==null&&U>=(q?J:0)&&U<=(V?X:1)){var te=new wt(z,H,null,A),ie=new wt(D,U,null,A);te._intersection=ie,ie._intersection=te,(!Y||Y(te))&&wt.insert(j,te,!0)}}function u(j,Y,z,H,D,U,A,V,q,J,X,te,ie){if(++q>=4096||++V>=40)return q;var se=1e-9,he=Y[0],ne=Y[1],ce=Y[6],fe=Y[7],ye=ge.getSignedDistance,we=ye(he,ne,ce,fe,Y[2],Y[3]),Ee=ye(he,ne,ce,fe,Y[4],Y[5]),Be=we*Ee>0?3/4:4/9,Ue=Be*Math.min(0,we,Ee),et=Be*Math.max(0,we,Ee),it=ye(he,ne,ce,fe,j[0],j[1]),Ie=ye(he,ne,ce,fe,j[2],j[3]),De=ye(he,ne,ce,fe,j[4],j[5]),tt=ye(he,ne,ce,fe,j[6],j[7]),at=f(it,Ie,De,tt),st=at[0],xt=at[1],vt,lt;if(we===0&&Ee===0&&it===0&&Ie===0&&De===0&&tt===0||(vt=g(st,xt,Ue,et))==null||(lt=g(st.reverse(),xt.reverse(),Ue,et))==null)return q;var Lt=J+(X-J)*vt,bt=J+(X-J)*lt;if(Math.max(ie-te,bt-Lt)<se){var pn=(Lt+bt)/2,sn=(te+ie)/2;r(D,U,A?H:z,A?sn:pn,A?z:H,A?pn:sn)}else{j=Le.getPart(j,vt,lt);var Sn=ie-te;if(lt-vt>.8)if(bt-Lt>Sn){var ln=Le.subdivide(j,.5),pn=(Lt+bt)/2;q=u(Y,ln[0],H,z,D,U,!A,V,q,te,ie,Lt,pn),q=u(Y,ln[1],H,z,D,U,!A,V,q,te,ie,pn,bt)}else{var ln=Le.subdivide(Y,.5),sn=(te+ie)/2;q=u(ln[0],j,H,z,D,U,!A,V,q,te,sn,Lt,bt),q=u(ln[1],j,H,z,D,U,!A,V,q,sn,ie,Lt,bt)}else Sn===0||Sn>=se?q=u(Y,j,H,z,D,U,!A,V,q,te,ie,Lt,bt):q=u(j,Y,z,H,D,U,A,V,q,Lt,bt,te,ie)}return q}function f(j,Y,z,H){var D=[0,j],U=[1/3,Y],A=[2/3,z],V=[1,H],q=Y-(2*j+H)/3,J=z-(j+2*H)/3,X;if(q*J<0)X=[[D,U,V],[D,A,V]];else{var te=q/J;X=[te>=2?[D,U,V]:te<=.5?[D,A,V]:[D,U,A,V],[D,V]]}return(q||J)<0?X.reverse():X}function g(j,Y,z,H){return j[0][1]<z?v(j,!0,z):Y[0][1]>H?v(Y,!1,H):j[0][0]}function v(j,Y,z){for(var H=j[0][0],D=j[0][1],U=1,A=j.length;U<A;U++){var V=j[U][0],q=j[U][1];if(Y?q>=z:q<=z)return q===z?V:H+(z-D)*(V-H)/(q-D);H=V,D=q}return null}function w(j,Y,z,H,D){var U=E.isZero;if(U(H)&&U(D)){var A=Le.getTimeOf(j,new O(Y,z));return A===null?[]:[A]}for(var V=Math.atan2(-D,H),q=Math.sin(V),J=Math.cos(V),X=[],te=[],ie=0;ie<8;ie+=2){var se=j[ie]-Y,he=j[ie+1]-z;X.push(se*J-he*q,se*q+he*J)}return Le.solveCubic(X,1,0,te,0,1),te}function S(j,Y,z,H,D,U,A){for(var V=Y[0],q=Y[1],J=Y[6],X=Y[7],te=w(j,V,q,J-V,X-q),ie=0,se=te.length;ie<se;ie++){var he=te[ie],ne=Le.getPoint(j,he),ce=Le.getTimeOf(Y,ne);ce!==null&&r(D,U,A?H:z,A?ce:he,A?z:H,A?he:ce)}}function C(j,Y,z,H,D,U){var A=ge.intersect(j[0],j[1],j[6],j[7],Y[0],Y[1],Y[6],Y[7]);A&&r(D,U,z,Le.getTimeOf(j,A),H,Le.getTimeOf(Y,A))}function T(j,Y,z,H,D,U){var A=1e-12,V=Math.min,q=Math.max;if(q(j[0],j[2],j[4],j[6])+A>V(Y[0],Y[2],Y[4],Y[6])&&V(j[0],j[2],j[4],j[6])-A<q(Y[0],Y[2],Y[4],Y[6])&&q(j[1],j[3],j[5],j[7])+A>V(Y[1],Y[3],Y[5],Y[7])&&V(j[1],j[3],j[5],j[7])-A<q(Y[1],Y[3],Y[5],Y[7])){var J=B(j,Y);if(J)for(var X=0;X<2;X++){var te=J[X];r(D,U,z,te[0],H,te[1],!0)}else{var ie=Le.isStraight(j),se=Le.isStraight(Y),he=ie&&se,ne=ie&&!se,ce=D.length;if((he?C:ie||se?S:u)(ne?Y:j,ne?j:Y,ne?H:z,ne?z:H,D,U,ne,0,0,0,1,0,1),!he||D.length===ce)for(var X=0;X<4;X++){var fe=X>>1,ye=X&1,we=fe*6,Ee=ye*6,Be=new O(j[we],j[we+1]),Ue=new O(Y[Ee],Y[Ee+1]);Be.isClose(Ue,A)&&r(D,U,z,fe,H,ye)}}}return D}function P(j,Y,z,H){var D=Le.classify(j);if(D.type==="loop"){var U=D.roots;r(z,H,Y,U[0],Y,U[1])}return z}function N(j,Y,z,H,D,U){var A=1e-7,V=!Y;V&&(Y=j);for(var q=j.length,J=Y.length,X=new Array(q),te=V?X:new Array(J),ie=[],se=0;se<q;se++)X[se]=j[se].getValues(H);if(!V)for(var se=0;se<J;se++)te[se]=Y[se].getValues(D);for(var he=_.findCurveBoundsCollisions(X,te,A),ne=0;ne<q;ne++){var ce=j[ne],fe=X[ne];V&&P(fe,ce,ie,z);var ye=he[ne];if(ye)for(var we=0;we<ye.length;we++){if(U&&ie.length)return ie;var Ee=ye[we];if(!V||Ee>ne){var Be=Y[Ee],Ue=te[Ee];T(fe,Ue,ce,Be,ie,z)}}}return ie}function B(j,Y){function z(tt){var at=tt[6]-tt[0],st=tt[7]-tt[1];return at*at+st*st}var H=Math.abs,D=ge.getDistance,U=1e-8,A=1e-7,V=Le.isStraight(j),q=Le.isStraight(Y),J=V&&q,X=z(j)<z(Y),te=X?Y:j,ie=X?j:Y,se=te[0],he=te[1],ne=te[6]-se,ce=te[7]-he;if(D(se,he,ne,ce,ie[0],ie[1],!0)<A&&D(se,he,ne,ce,ie[6],ie[7],!0)<A)!J&&D(se,he,ne,ce,te[2],te[3],!0)<A&&D(se,he,ne,ce,te[4],te[5],!0)<A&&D(se,he,ne,ce,ie[2],ie[3],!0)<A&&D(se,he,ne,ce,ie[4],ie[5],!0)<A&&(V=q=J=!0);else if(J)return null;if(V^q)return null;for(var fe=[j,Y],ye=[],we=0;we<4&&ye.length<2;we++){var Ee=we&1,Be=Ee^1,Ue=we>>1,et=Le.getTimeOf(fe[Ee],new O(fe[Be][Ue?6:0],fe[Be][Ue?7:1]));if(et!=null){var it=Ee?[Ue,et]:[et,Ue];(!ye.length||H(it[0]-ye[0][0])>U&&H(it[1]-ye[0][1])>U)&&ye.push(it)}if(we>2&&!ye.length)break}if(ye.length!==2)ye=null;else if(!J){var Ie=Le.getPart(j,ye[0][0],ye[1][0]),De=Le.getPart(Y,ye[0][1],ye[1][1]);(H(De[2]-Ie[2])>A||H(De[3]-Ie[3])>A||H(De[4]-Ie[4])>A||H(De[5]-Ie[5])>A)&&(ye=null)}return ye}function L(j,Y){var z=j[0],H=j[1],D=j[2],U=j[3],A=j[4],V=j[5],q=j[6],J=j[7],X=Y.normalize(),te=X.x,ie=X.y,se=3*q-9*A+9*D-3*z,he=3*J-9*V+9*U-3*H,ne=6*A-12*D+6*z,ce=6*V-12*U+6*H,fe=3*D-3*z,ye=3*U-3*H,we=2*se*ie-2*he*te,Ee=[];if(Math.abs(we)<E.CURVETIME_EPSILON){var Be=se*ye-he*fe,we=se*ce-he*ne;if(we!=0){var Ue=-Be/we;Ue>=0&&Ue<=1&&Ee.push(Ue)}}else{var et=(ne*ne-4*se*fe)*ie*ie+(-2*ne*ce+4*he*fe+4*se*ye)*te*ie+(ce*ce-4*he*ye)*te*te,it=ne*ie-ce*te;if(et>=0&&we!=0){var Ie=Math.sqrt(et),De=-(it+Ie)/we,tt=(-it+Ie)/we;De>=0&&De<=1&&Ee.push(De),tt>=0&&tt<=1&&Ee.push(tt)}}return Ee}return{getIntersections:function(j){var Y=this.getValues(),z=j&&j!==this&&j.getValues();return z?T(Y,z,this,j,[]):P(Y,this,[])},statics:{getOverlaps:B,getIntersections:N,getCurveLineIntersections:w,getTimesWithTangent:L}}}),wt=a.extend({_class:"CurveLocation",initialize:function(u,f,g,v,w){if(f>=.99999999){var S=u.getNext();S&&(f=0,u=S)}this._setCurve(u),this._time=f,this._point=g||u.getPointAtTime(f),this._overlap=v,this._distance=w,this._intersection=this._next=this._previous=null},_setPath:function(r){this._path=r,this._version=r?r._version:0},_setCurve:function(r){this._setPath(r._path),this._curve=r,this._segment=null,this._segment1=r._segment1,this._segment2=r._segment2},_setSegment:function(r){var u=r.getCurve();u?this._setCurve(u):(this._setPath(r._path),this._segment1=r,this._segment2=null),this._segment=r,this._time=r===this._segment1?0:1,this._point=r._point.clone()},getSegment:function(){var r=this._segment;if(!r){var u=this.getCurve(),f=this.getTime();f===0?r=u._segment1:f===1?r=u._segment2:f!=null&&(r=u.getPartLength(0,f)<u.getPartLength(f,1)?u._segment1:u._segment2),this._segment=r}return r},getCurve:function(){var r=this._path,u=this;r&&r._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null);function f(g){var v=g&&g.getCurve();if(v&&(u._time=v.getTimeOf(u._point))!=null)return u._setCurve(v),v}return this._curve||f(this._segment)||f(this._segment1)||f(this._segment2.getPrevious())},getPath:function(){var r=this.getCurve();return r&&r._path},getIndex:function(){var r=this.getCurve();return r&&r.getIndex()},getTime:function(){var r=this.getCurve(),u=this._time;return r&&u==null?this._time=r.getTimeOf(this._point):u},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var r=this._offset;if(r==null){r=0;var u=this.getPath(),f=this.getIndex();if(u&&f!=null)for(var g=u.getCurves(),v=0;v<f;v++)r+=g[v].getLength();this._offset=r+=this.getCurveOffset()}return r},getCurveOffset:function(){var r=this._curveOffset;if(r==null){var u=this.getCurve(),f=this.getTime();this._curveOffset=r=f!=null&&u&&u.getPartLength(0,f)}return r},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var r=this.getCurve(),u=r&&r.divideAtTime(this.getTime());return u&&this._setSegment(u._segment1),u},split:function(){var r=this.getCurve(),u=r._path,f=r&&r.splitAtTime(this.getTime());return f&&this._setSegment(u.getLastSegment()),f},equals:function(r,u){var f=this===r;if(!f&&r instanceof wt){var g=this.getCurve(),v=r.getCurve(),w=g._path,S=v._path;if(w===S){var C=Math.abs,T=1e-7,P=C(this.getOffset()-r.getOffset()),N=!u&&this._intersection,B=!u&&r._intersection;f=(P<T||w&&C(w.getLength()-P)<T)&&(!N&&!B||N&&B&&N.equals(B,!0))}}return f},toString:function(){var r=[],u=this.getPoint(),f=b.instance;u&&r.push("point: "+u);var g=this.getIndex();g!=null&&r.push("index: "+g);var v=this.getTime();return v!=null&&r.push("time: "+f.number(v)),this._distance!=null&&r.push("distance: "+f.number(this._distance)),"{ "+r.join(", ")+" }"},isTouching:function(){var r=this._intersection;if(r&&this.getTangent().isCollinear(r.getTangent())){var u=this.getCurve(),f=r.getCurve();return!(u.isStraight()&&f.isStraight()&&u.getLine().intersect(f.getLine()))}return!1},isCrossing:function(){var r=this._intersection;if(!r)return!1;var u=this.getTime(),f=r.getTime(),g=1e-8,v=1-g,w=u>=g&&u<=v,S=f>=g&&f<=v;if(w&&S)return!this.isTouching();var C=this.getCurve(),T=C&&u<g?C.getPrevious():C,P=r.getCurve(),N=P&&f<g?P.getPrevious():P;if(u>v&&(C=C.getNext()),f>v&&(P=P.getNext()),!T||!C||!N||!P)return!1;var B=[];function L(te,ie){var se=te.getValues(),he=Le.classify(se).roots||Le.getPeaks(se),ne=he.length,ce=Le.getLength(se,ie&&ne?he[ne-1]:0,!ie&&ne?he[0]:1);B.push(ne?ce:ce/32)}function j(te,ie,se){return ie<se?te>ie&&te<se:te>ie||te<se}w||(L(T,!0),L(C,!1)),S||(L(N,!0),L(P,!1));var Y=this.getPoint(),z=Math.min.apply(Math,B),H=w?C.getTangentAtTime(u):C.getPointAt(z).subtract(Y),D=w?H.negate():T.getPointAt(-z).subtract(Y),U=S?P.getTangentAtTime(f):P.getPointAt(z).subtract(Y),A=S?U.negate():N.getPointAt(-z).subtract(Y),V=D.getAngle(),q=H.getAngle(),J=A.getAngle(),X=U.getAngle();return!!(w?j(V,J,X)^j(q,J,X)&&j(V,X,J)^j(q,X,J):j(J,V,q)^j(X,V,q)&&j(J,q,V)^j(X,q,V))},hasOverlap:function(){return!!this._overlap}},a.each(Le._evaluateMethods,function(r){var u=r+"At";this[r]=function(){var f=this.getCurve(),g=this.getTime();return g!=null&&f&&f[u](g,!0)}},{preserve:!0}),new function(){function r(u,f,g){var v=u.length,w=0,S=v-1;function C(Y,z){for(var H=Y+z;H>=-1&&H<=v;H+=z){var D=u[(H%v+v)%v];if(!f.getPoint().isClose(D.getPoint(),1e-7))break;if(f.equals(D))return D}return null}for(;w<=S;){var T=w+S>>>1,P=u[T],N;if(g&&(N=f.equals(P)?P:C(T,-1)||C(T,1)))return f._overlap&&(N._overlap=N._intersection._overlap=!0),N;var B=f.getPath(),L=P.getPath(),j=B!==L?B._id-L._id:f.getIndex()+f.getTime()-(P.getIndex()+P.getTime());j<0?S=T-1:w=T+1}return u.splice(w,0,f),f}return{statics:{insert:r,expand:function(u){for(var f=u.slice(),g=u.length-1;g>=0;g--)r(f,u[g]._intersection,!1);return f}}}}),ze=F.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(r){var u,f,g;if(a.isPlainObject(r)?(f=r.segments,u=r.pathData):Array.isArray(r)?f=r:typeof r=="string"&&(u=r),f){var v=f[0];g=v&&Array.isArray(v[0])}else u&&(g=(u.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(u));var w=g?Qe:Xe;return new w(r)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(r){this.isClockwise()!=(r=!!r)&&this.reverse()},setPathData:function(r){var u=r&&r.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig),f,g=!1,v,w,S=new O,C=new O;function T(A,V){var q=+f[A];return g&&(q+=S[V]),q}function P(A){return new O(T(A,"x"),T(A+1,"y"))}this.clear();for(var N=0,B=u&&u.length;N<B;N++){var L=u[N],j=L[0],Y=j.toLowerCase();f=L.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);var z=f&&f.length;switch(g=j===Y,v==="z"&&!/[mz]/.test(Y)&&this.moveTo(S),Y){case"m":case"l":for(var H=Y==="m",D=0;D<z;D+=2)this[H?"moveTo":"lineTo"](S=P(D)),H&&(C=S,H=!1);w=S;break;case"h":case"v":var U=Y==="h"?"x":"y";S=S.clone();for(var D=0;D<z;D++)S[U]=T(D,U),this.lineTo(S);w=S;break;case"c":for(var D=0;D<z;D+=6)this.cubicCurveTo(P(D),w=P(D+2),S=P(D+4));break;case"s":for(var D=0;D<z;D+=4)this.cubicCurveTo(/[cs]/.test(v)?S.multiply(2).subtract(w):S,w=P(D),S=P(D+2)),v=Y;break;case"q":for(var D=0;D<z;D+=4)this.quadraticCurveTo(w=P(D),S=P(D+2));break;case"t":for(var D=0;D<z;D+=2)this.quadraticCurveTo(w=/[qt]/.test(v)?S.multiply(2).subtract(w):S,S=P(D)),v=Y;break;case"a":for(var D=0;D<z;D+=7)this.arcTo(S=P(D+5),new W(+f[D],+f[D+1]),+f[D+2],+f[D+4],+f[D+3]);break;case"z":this.closePath(1e-12),S=C;break}v=Y}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(r){var u=r.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(r):{};return u.onPath||!!(this.getFillRule()==="evenodd"?u.windingL&1||u.windingR&1:u.winding)},getIntersections:function(r,u,f,g){var v=this===r||!r,w=this._matrix._orNullIfIdentity(),S=v?w:(f||r._matrix)._orNullIfIdentity();return v||this.getBounds(w).intersects(r.getBounds(S),1e-12)?Le.getIntersections(this.getCurves(),!v&&r.getCurves(),u,w,S,g):[]},getCrossings:function(r){return this.getIntersections(r,function(u){return u.isCrossing()})},getNearestLocation:function(){for(var r=O.read(arguments),u=this.getCurves(),f=1/0,g=null,v=0,w=u.length;v<w;v++){var S=u[v].getNearestLocation(r);S._distance<f&&(f=S._distance,g=S)}return g},getNearestPoint:function(){var r=this.getNearestLocation.apply(this,arguments);return r&&r.getPoint()},interpolate:function(r,u,f){var g=!this._children,v=g?"_segments":"_children",w=r[v],S=u[v],C=this[v];if(!w||!S||w.length!==S.length)throw new Error("Invalid operands in interpolate() call: "+r+", "+u);var T=C.length,P=S.length;if(T<P)for(var N=g?We:Xe,B=T;B<P;B++)this.add(new N);else T>P&&this[g?"removeSegments":"removeChildren"](P,T);for(var B=0;B<P;B++)C[B].interpolate(w[B],S[B],f);g&&(this.setClosed(r._closed),this._changed(9))},compare:function(r){var u=!1;if(r){var f=this._children||[this],g=r._children?r._children.slice():[r],v=f.length,w=g.length,S=[],C=0;u=!0;for(var T=_.findItemBoundsCollisions(f,g,E.GEOMETRIC_EPSILON),P=v-1;P>=0&&u;P--){var N=f[P];u=!1;var B=T[P];if(B)for(var L=B.length-1;L>=0&&!u;L--)N.compare(g[B[L]])&&(S[B[L]]||(S[B[L]]=!0,C++),u=!0)}u=u&&C===w}return u}}),Xe=ze.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(u){this._closed=!1,this._segments=[],this._version=0;var f=arguments,g=Array.isArray(u)?typeof u[0]=="object"?u:f:u&&u.size===t&&(u.x!==t||u.point!==t)?f:null;g&&g.length>0?this.setSegments(g):(this._curves=t,this._segmentSelection=0,!g&&typeof u=="string"&&(this.setPathData(u),u=null)),this._initialize(!g&&u)},_equals:function(r){return this._closed===r._closed&&a.equals(this._segments,r._segments)},copyContent:function(r){this.setSegments(r._segments),this._closed=r._closed},_changed:function r(u){if(r.base.call(this,u),u&8){if(this._length=this._area=t,u&32)this._version++;else if(this._curves)for(var f=0,g=this._curves.length;f<g;f++)this._curves[f]._changed()}else u&64&&(this._bounds=t)},getStyle:function(){var r=this._parent;return(r instanceof Qe?r:this)._style},getSegments:function(){return this._segments},setSegments:function(r){var u=this.isFullySelected(),f=r&&r.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=t,f){var g=r[f-1];typeof g=="boolean"&&(this.setClosed(g),f--),this._add(We.readList(r,0,{},f))}u&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var r=this._curves,u=this._segments;if(!r){var f=this._countCurves();r=this._curves=new Array(f);for(var g=0;g<f;g++)r[g]=new Le(this,u[g],u[g+1]||u[0])}return r},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var r=this.getCurves();return r[r.length-1]},isClosed:function(){return this._closed},setClosed:function(r){if(this._closed!=(r=!!r)){if(this._closed=r,this._curves){var u=this._curves.length=this._countCurves();r&&(this._curves[u-1]=new Le(this,this._segments[u-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(r,u){var f=this._segments,g=f.length,v=new b(u),w=new Array(6),S=!0,C,T,P,N,B,L,j,Y,z=[];function H(U,A){if(U._transformCoordinates(r,w),C=w[0],T=w[1],S)z.push("M"+v.pair(C,T)),S=!1;else if(B=w[2],L=w[3],B===C&&L===T&&j===P&&Y===N){if(!A){var V=C-P,q=T-N;z.push(V===0?"v"+v.number(q):q===0?"h"+v.number(V):"l"+v.pair(V,q))}}else z.push("c"+v.pair(j-P,Y-N)+" "+v.pair(B-P,L-N)+" "+v.pair(C-P,T-N));P=C,N=T,j=w[4],Y=w[5]}if(!g)return"";for(var D=0;D<g;D++)H(f[D]);return this._closed&&g>0&&(H(f[0],!0),z.push("z")),z.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(r){for(var u=this._segments,f=new Array(6),g=0,v=u.length;g<v;g++)u[g]._transformCoordinates(r,f,!0);return!0},_add:function(r,S){for(var f=this._segments,g=this._curves,v=r.length,w=S==null,S=w?f.length:S,C=0;C<v;C++){var T=r[C];T._path&&(T=r[C]=T.clone()),T._path=this,T._index=S+C,T._selection&&this._updateSelection(T,0,T._selection)}if(w)a.push(f,r);else{f.splice.apply(f,[S,0].concat(r));for(var C=S+v,P=f.length;C<P;C++)f[C]._index=C}if(g){var N=this._countCurves(),B=S>0&&S+v-1===N?S-1:S,L=B,j=Math.min(B+v,N);r._curves&&(g.splice.apply(g,[B,0].concat(r._curves)),L+=r._curves.length);for(var C=L;C<j;C++)g.splice(C,0,new Le(this,null,null));this._adjustCurves(B,j)}return this._changed(41),r},_adjustCurves:function(r,u){for(var f=this._segments,g=this._curves,v,w=r;w<u;w++)v=g[w],v._path=this,v._segment1=f[w],v._segment2=f[w+1]||f[0],v._changed();(v=g[this._closed&&!r?f.length-1:r-1])&&(v._segment2=f[r]||f[0],v._changed()),(v=g[u])&&(v._segment1=f[u],v._changed())},_countCurves:function(){var r=this._segments.length;return!this._closed&&r>0?r-1:r},add:function(r){var u=arguments;return u.length>1&&typeof r!="number"?this._add(We.readList(u)):this._add([We.read(u)])[0]},insert:function(r,u){var f=arguments;return f.length>2&&typeof u!="number"?this._add(We.readList(f,1),r):this._add([We.read(f,1)],r)[0]},addSegment:function(){return this._add([We.read(arguments)])[0]},insertSegment:function(r){return this._add([We.read(arguments,1)],r)[0]},addSegments:function(r){return this._add(We.readList(r))},insertSegments:function(r,u){return this._add(We.readList(u),r)},removeSegment:function(r){return this.removeSegments(r,r+1)[0]||null},removeSegments:function(r,u,f){r=r||0,u=a.pick(u,this._segments.length);var g=this._segments,v=this._curves,w=g.length,S=g.splice(r,u-r),C=S.length;if(!C)return S;for(var T=0;T<C;T++){var P=S[T];P._selection&&this._updateSelection(P,P._selection,0),P._index=P._path=null}for(var T=r,N=g.length;T<N;T++)g[T]._index=T;if(v){for(var B=r>0&&u===w+(this._closed?1:0)?r-1:r,v=v.splice(B,C),T=v.length-1;T>=0;T--)v[T]._path=null;f&&(S._curves=v.slice(1)),this._adjustCurves(B,B)}return this._changed(41),S},clear:"#removeSegments",hasHandles:function(){for(var r=this._segments,u=0,f=r.length;u<f;u++)if(r[u].hasHandles())return!0;return!1},clearHandles:function(){for(var r=this._segments,u=0,f=r.length;u<f;u++)r[u].clearHandles()},getLength:function(){if(this._length==null){for(var r=this.getCurves(),u=0,f=0,g=r.length;f<g;f++)u+=r[f].getLength();this._length=u}return this._length},getArea:function(){var r=this._area;if(r==null){var u=this._segments,f=this._closed;r=0;for(var g=0,v=u.length;g<v;g++){var w=g+1===v;r+=Le.getArea(Le.getValues(u[g],u[w?0:g+1],null,w&&!f))}this._area=r}return r},isFullySelected:function(){var r=this._segments.length;return this.isSelected()&&r>0&&this._segmentSelection===r*7},setFullySelected:function(r){r&&this._selectSegments(!0),this.setSelected(r)},setSelection:function r(u){u&1||this._selectSegments(!1),r.base.call(this,u)},_selectSegments:function(r){var u=this._segments,f=u.length,g=r?7:0;this._segmentSelection=g*f;for(var v=0;v<f;v++)u[v]._selection=g},_updateSelection:function(r,u,f){r._selection=f;var g=this._segmentSelection+=f-u;g>0&&this.setSelected(!0)},divideAt:function(r){var u=this.getLocationAt(r),f;return u&&(f=u.getCurve().divideAt(u.getCurveOffset()))?f._segment1:null},splitAt:function(r){var u=this.getLocationAt(r),f=u&&u.index,g=u&&u.time,v=1e-8,w=1-v;g>w&&(f++,g=0);var S=this.getCurves();if(f>=0&&f<S.length){g>=v&&S[f++].divideAtTime(g);var C=this.removeSegments(f,this._segments.length,!0),T;return this._closed?(this.setClosed(!1),T=this):(T=new Xe(F.NO_INSERT),T.insertAbove(this),T.copyAttributes(this)),T._add(C,0),this.addSegment(C[0]),T}return null},split:function(r,u){var f,g=u===t?r:(f=this.getCurves()[r])&&f.getLocationAtTime(u);return g!=null?this.splitAt(g):null},join:function(r,u){var f=u||0;if(r&&r!==this){var g=r._segments,v=this.getLastSegment(),w=r.getLastSegment();if(!w)return this;v&&v._point.isClose(w._point,f)&&r.reverse();var S=r.getFirstSegment();if(v&&v._point.isClose(S._point,f))v.setHandleOut(S._handleOut),this._add(g.slice(1));else{var C=this.getFirstSegment();C&&C._point.isClose(S._point,f)&&r.reverse(),w=r.getLastSegment(),C&&C._point.isClose(w._point,f)?(C.setHandleIn(w._handleIn),this._add(g.slice(0,g.length-1),0)):this._add(g.slice())}r._closed&&this._add([g[0]]),r.remove()}var T=this.getFirstSegment(),P=this.getLastSegment();return T!==P&&T._point.isClose(P._point,f)&&(T.setHandleIn(P._handleIn),P.remove(),this.setClosed(!0)),this},reduce:function(r){for(var u=this.getCurves(),f=r&&r.simplify,g=f?1e-7:0,v=u.length-1;v>=0;v--){var w=u[v];!w.hasHandles()&&(!w.hasLength(g)||f&&w.isCollinear(w.getNext()))&&w.remove()}return this},reverse:function(){this._segments.reverse();for(var r=0,u=this._segments.length;r<u;r++){var f=this._segments[r],g=f._handleIn;f._handleIn=f._handleOut,f._handleOut=g,f._index=r}this._curves=null,this._changed(9)},flatten:function(r){for(var u=new be(this,r||.25,256,!0),f=u.parts,g=f.length,v=[],w=0;w<g;w++)v.push(new We(f[w].curve.slice(0,2)));!this._closed&&g>0&&v.push(new We(f[g-1].curve.slice(6))),this.setSegments(v)},simplify:function(r){var u=new Fe(this).fit(r||2.5);return u&&this.setSegments(u),!!u},smooth:function(r){var u=this,f=r||{},g=f.type||"asymmetric",v=this._segments,w=v.length,S=this._closed;function C(st,xt){var vt=st&&st.index;if(vt!=null){var lt=st.path;if(lt&&lt!==u)throw new Error(st._class+" "+vt+" of "+lt+" is not part of "+u);xt&&st instanceof Le&&vt++}else vt=typeof st=="number"?st:xt;return Math.min(vt<0&&S?vt%w:vt<0?vt+w:vt,w-1)}var T=S&&f.from===t&&f.to===t,P=C(f.from,0),N=C(f.to,w-1);if(P>N)if(S)P-=w;else{var B=P;P=N,N=B}if(/^(?:asymmetric|continuous)$/.test(g)){var L=g==="asymmetric",j=Math.min,Y=N-P+1,z=Y-1,H=T?j(Y,4):1,D=H,U=H,A=[];if(S||(D=j(1,P),U=j(1,w-N-1)),z+=D+U,z<=1)return;for(var V=0,q=P-D;V<=z;V++,q++)A[V]=v[(q<0?q+w:q)%w]._point;for(var J=A[0]._x+2*A[1]._x,X=A[0]._y+2*A[1]._y,te=2,ie=z-1,se=[J],he=[X],ne=[te],ce=[],fe=[],V=1;V<z;V++){var ye=V<ie,we=ye||L?1:2,Ee=ye?4:L?2:7,Be=ye?4:L?3:8,Ue=ye?2:L?0:1,et=we/te;te=ne[V]=Ee-et,J=se[V]=Be*A[V]._x+Ue*A[V+1]._x-et*J,X=he[V]=Be*A[V]._y+Ue*A[V+1]._y-et*X}ce[ie]=se[ie]/ne[ie],fe[ie]=he[ie]/ne[ie];for(var V=z-2;V>=0;V--)ce[V]=(se[V]-ce[V+1])/ne[V],fe[V]=(he[V]-fe[V+1])/ne[V];ce[z]=(3*A[z]._x-ce[ie])/2,fe[z]=(3*A[z]._y-fe[ie])/2;for(var V=D,it=z-U,q=P;V<=it;V++,q++){var Ie=v[q<0?q+w:q],De=Ie._point,tt=ce[V]-De._x,at=fe[V]-De._y;(T||V<it)&&Ie.setHandleOut(tt,at),(T||V>D)&&Ie.setHandleIn(-tt,-at)}}else for(var V=P;V<=N;V++)v[V<0?V+w:V].smooth(f,!T&&V===P,!T&&V===N)},toShape:function(r){if(!this._closed)return null;var u=this._segments,f,g,v,w;function S(L,j){var Y=u[L],z=Y.getNext(),H=u[j],D=H.getNext();return Y._handleOut.isZero()&&z._handleIn.isZero()&&H._handleOut.isZero()&&D._handleIn.isZero()&&z._point.subtract(Y._point).isCollinear(D._point.subtract(H._point))}function C(L){var j=u[L],Y=j.getPrevious(),z=j.getNext();return Y._handleOut.isZero()&&j._handleIn.isZero()&&j._handleOut.isZero()&&z._handleIn.isZero()&&j._point.subtract(Y._point).isOrthogonal(z._point.subtract(j._point))}function T(L){var j=u[L],Y=j.getNext(),z=j._handleOut,H=Y._handleIn,D=.5522847498307936;if(z.isOrthogonal(H)){var U=j._point,A=Y._point,V=new ge(U,z,!0).intersect(new ge(A,H,!0),!0);return V&&E.isZero(z.getLength()/V.subtract(U).getLength()-D)&&E.isZero(H.getLength()/V.subtract(A).getLength()-D)}return!1}function P(L,j){return u[L]._point.getDistance(u[j]._point)}if(!this.hasHandles()&&u.length===4&&S(0,2)&&S(1,3)&&C(1)?(f=qe.Rectangle,g=new W(P(0,3),P(0,1)),w=u[1]._point.add(u[2]._point).divide(2)):u.length===8&&T(0)&&T(2)&&T(4)&&T(6)&&S(1,5)&&S(3,7)?(f=qe.Rectangle,g=new W(P(1,6),P(0,3)),v=g.subtract(new W(P(0,7),P(1,2))).divide(2),w=u[3]._point.add(u[4]._point).divide(2)):u.length===4&&T(0)&&T(1)&&T(2)&&T(3)&&(E.isZero(P(0,2)-P(1,3))?(f=qe.Circle,v=P(0,2)/2):(f=qe.Ellipse,v=new W(P(2,0)/2,P(3,1)/2)),w=u[1]._point),f){var N=this.getPosition(!0),B=new f({center:N,size:g,radius:v,insert:!1});return B.copyAttributes(this,!0),B._matrix.prepend(this._matrix),B.rotate(w.subtract(N).getAngle()+90),(r===t||r)&&B.insertAbove(this),B}return null},toPath:"#clone",compare:function r(u){if(!u||u instanceof Qe)return r.base.call(this,u);var f=this.getCurves(),g=u.getCurves(),v=f.length,w=g.length;if(!v||!w)return v==w;for(var S=f[0].getValues(),C=[],T=0,P,N=0,B,L=0;L<w;L++){var H=g[L].getValues();C.push(H);var j=Le.getOverlaps(S,H);if(j){P=!L&&j[0][0]>0?w-1:L,B=j[0][1];break}}for(var Y=Math.abs,z=1e-8,H=C[P],D;S&&H;){var j=Le.getOverlaps(S,H);if(j){var U=j[0][0];if(Y(U-N)<z){N=j[1][0],N===1&&(S=++T<v?f[T].getValues():null,N=0);var A=j[0][1];if(Y(A-B)<z){if(D||(D=[P,A]),B=j[1][1],B===1&&(++P>=w&&(P=0),H=C[P]||g[P].getValues(),B=0),!S)return D[0]===P&&D[1]===B;continue}}}break}return!1},_hitTestSelf:function(r,u,f,g){var v=this,w=this.getStyle(),S=this._segments,C=S.length,T=this._closed,P=u._tolerancePadding,N=P,B,L,j,Y,z,H,D=u.stroke&&w.hasStroke(),U=u.fill&&w.hasFill(),A=u.curves,V=D?w.getStrokeWidth()/2:U&&u.tolerance>0||A?0:null;V!==null&&(V>0?(B=w.getStrokeJoin(),L=w.getStrokeCap(),j=w.getMiterLimit(),N=N.add(Xe._getStrokePadding(V,g))):B=L="round");function q(ce,fe){return r.subtract(ce).divide(fe).length<=1}function J(ce,fe,ye){if(!u.selected||fe.isSelected()){var we=ce._point;if(fe!==we&&(fe=fe.add(we)),q(fe,N))return new dt(ye,v,{segment:ce,point:fe})}}function X(ce,fe){return(fe||u.segments)&&J(ce,ce._point,"segment")||!fe&&u.handles&&(J(ce,ce._handleIn,"handle-in")||J(ce,ce._handleOut,"handle-out"))}function te(ce){Y.add(ce)}function ie(ce){var fe=T||ce._index>0&&ce._index<C-1;if((fe?B:L)==="round")return q(ce._point,N);if(Y=new Xe({internal:!0,closed:!0}),fe?ce.isSmooth()||Xe._addBevelJoin(ce,B,V,j,null,g,te,!0):L==="square"&&Xe._addSquareCap(ce,L,V,null,g,te,!0),!Y.isEmpty()){var ye;return Y.contains(r)||(ye=Y.getNearestLocation(r))&&q(ye.getPoint(),P)}}if(u.ends&&!u.segments&&!T){if(H=X(S[0],!0)||X(S[C-1],!0))return H}else if(u.segments||u.handles){for(var se=0;se<C;se++)if(H=X(S[se]))return H}if(V!==null){if(z=this.getNearestLocation(r),z){var he=z.getTime();he===0||he===1&&C>1?ie(z.getSegment())||(z=null):q(z.getPoint(),N)||(z=null)}if(!z&&B==="miter"&&C>1)for(var se=0;se<C;se++){var ne=S[se];if(r.getDistance(ne._point)<=j*V&&ie(ne)){z=ne.getLocation();break}}}return!z&&U&&this._contains(r)||z&&!D&&!A?new dt("fill",this):z?new dt(D?"stroke":"curve",this,{location:z,point:z.getPoint()}):null}},a.each(Le._evaluateMethods,function(r){this[r+"At"]=function(u){var f=this.getLocationAt(u);return f&&f[r]()}},{beans:!1,getLocationOf:function(){for(var r=O.read(arguments),u=this.getCurves(),f=0,g=u.length;f<g;f++){var v=u[f].getLocationOf(r);if(v)return v}return null},getOffsetOf:function(){var r=this.getLocationOf.apply(this,arguments);return r?r.getOffset():null},getLocationAt:function(r){if(typeof r=="number"){for(var u=this.getCurves(),f=0,g=0,v=u.length;g<v;g++){var w=f,S=u[g];if(f+=S.getLength(),f>r)return S.getLocationAt(r-w)}if(u.length>0&&r<=this.getLength())return new wt(u[u.length-1],1)}else if(r&&r.getPath&&r.getPath()===this)return r;return null},getOffsetsWithTangent:function(){var r=O.read(arguments);if(r.isZero())return[];for(var u=[],f=0,g=this.getCurves(),v=0,w=g.length;v<w;v++){for(var S=g[v],C=S.getTimesWithTangent(r),T=0,P=C.length;T<P;T++){var N=f+S.getOffsetAtTime(C[T]);u.indexOf(N)<0&&u.push(N)}f+=S.length}return u}}),new function(){function r(f,g,v,w){if(w<=0)return;var S=w/2,C=w-2,T=S-1,P=new Array(6),N,B;function L(U){var A=P[U],V=P[U+1];(N!=A||B!=V)&&(f.beginPath(),f.moveTo(N,B),f.lineTo(A,V),f.stroke(),f.beginPath(),f.arc(A,V,S,0,Math.PI*2,!0),f.fill())}for(var j=0,Y=g.length;j<Y;j++){var z=g[j],H=z._selection;if(z._transformCoordinates(v,P),N=P[0],B=P[1],H&2&&L(2),H&4&&L(4),f.fillRect(N-S,B-S,w,w),C>0&&!(H&1)){var D=f.fillStyle;f.fillStyle="#ffffff",f.fillRect(N-T,B-T,C,C),f.fillStyle=D}}}function u(f,g,v){var w=g._segments,S=w.length,C=new Array(6),T=!0,P,N,B,L,j,Y,z,H;function D(A){if(v)A._transformCoordinates(v,C),P=C[0],N=C[1];else{var V=A._point;P=V._x,N=V._y}if(T)f.moveTo(P,N),T=!1;else{if(v)j=C[2],Y=C[3];else{var q=A._handleIn;j=P+q._x,Y=N+q._y}j===P&&Y===N&&z===B&&H===L?f.lineTo(P,N):f.bezierCurveTo(z,H,j,Y,P,N)}if(B=P,L=N,v)z=C[4],H=C[5];else{var q=A._handleOut;z=B+q._x,H=L+q._y}}for(var U=0;U<S;U++)D(w[U]);g._closed&&S>0&&D(w[0])}return{_draw:function(f,g,v,w){var S=g.dontStart,C=g.dontFinish||g.clip,T=this.getStyle(),P=T.hasFill(),N=T.hasStroke(),B=T.getDashArray(),L=!Nt.support.nativeDash&&N&&B&&B.length;S||f.beginPath(),(P||N&&!L||C)&&(u(f,this,w),this._closed&&f.closePath());function j(A){return B[(A%L+L)%L]}if(!C&&(P||N)&&(this._setStyles(f,g,v),P&&(f.fill(T.getFillRule()),f.shadowColor="rgba(0,0,0,0)"),N)){if(L){S||f.beginPath();for(var Y=new be(this,.25,32,!1,w),z=Y.length,H=-T.getDashOffset(),D,U=0;H>0;)H-=j(U--)+j(U--);for(;H<z;)D=H+j(U++),(H>0||D>0)&&Y.drawPart(f,Math.max(H,0),Math.max(D,0)),H=D+j(U++)}f.stroke()}},_drawSelected:function(f,g){f.beginPath(),u(f,this,g),f.stroke(),r(f,this._segments,g,Nt.settings.handleSize)}}},new function(){function r(u){var f=u._segments;if(!f.length)throw new Error("Use a moveTo() command first");return f[f.length-1]}return{moveTo:function(){var u=this._segments;u.length===1&&this.removeSegment(0),u.length||this._add([new We(O.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new We(O.read(arguments))])},cubicCurveTo:function(){var u=arguments,f=O.read(u),g=O.read(u),v=O.read(u),w=r(this);w.setHandleOut(f.subtract(w._point)),this._add([new We(v,g.subtract(v))])},quadraticCurveTo:function(){var u=arguments,f=O.read(u),g=O.read(u),v=r(this)._point;this.cubicCurveTo(f.add(v.subtract(f).multiply(1/3)),f.add(g.subtract(f).multiply(1/3)),g)},curveTo:function(){var u=arguments,f=O.read(u),g=O.read(u),v=a.pick(a.read(u),.5),w=1-v,S=r(this)._point,C=f.subtract(S.multiply(w*w)).subtract(g.multiply(v*v)).divide(2*v*w);if(C.isNaN())throw new Error("Cannot put a curve through points with parameter = "+v);this.quadraticCurveTo(C,g)},arcTo:function(){var u=arguments,f=Math.abs,g=Math.sqrt,v=r(this),w=v._point,S=O.read(u),C,T=a.peek(u),P=a.pick(T,!0),N,B,L,j;if(typeof P=="boolean")var Y=w.add(S).divide(2),C=Y.add(Y.subtract(w).rotate(P?-90:90));else if(a.remain(u)<=2)C=S,S=O.read(u);else if(!w.equals(S)){var z=W.read(u),H=E.isZero;if(H(z.width)||H(z.height))return this.lineTo(S);var D=a.read(u),P=!!a.read(u),U=!!a.read(u),Y=w.add(S).divide(2),A=w.subtract(Y).rotate(-D),V=A.x,q=A.y,J=f(z.width),X=f(z.height),te=J*J,ie=X*X,se=V*V,he=q*q,ne=g(se/te+he/ie);if(ne>1&&(J*=ne,X*=ne,te=J*J,ie=X*X),ne=(te*ie-te*he-ie*se)/(te*he+ie*se),f(ne)<1e-12&&(ne=0),ne<0)throw new Error("Cannot create an arc with the given arguments");N=new O(J*q/X,-X*V/J).multiply((U===P?-1:1)*g(ne)).rotate(D).add(Y),j=new le().translate(N).rotate(D).scale(J,X),L=j._inverseTransform(w),B=L.getDirectedAngle(j._inverseTransform(S)),!P&&B>0?B-=360:P&&B<0&&(B+=360)}if(C){var ce=new ge(w.add(C).divide(2),C.subtract(w).rotate(90),!0),fe=new ge(C.add(S).divide(2),S.subtract(C).rotate(90),!0),ye=new ge(w,S),we=ye.getSide(C);if(N=ce.intersect(fe,!0),!N){if(!we)return this.lineTo(S);throw new Error("Cannot create an arc with the given arguments")}L=w.subtract(N),B=L.getDirectedAngle(S.subtract(N));var Ee=ye.getSide(N,!0);Ee===0?B=we*f(B):we===Ee&&(B+=B<0?360:-360)}if(B){for(var Be=1e-5,Ue=f(B),et=Ue>=360?4:Math.ceil((Ue-Be)/90),it=B/et,Ie=it*Math.PI/360,De=4/3*Math.sin(Ie)/(1+Math.cos(Ie)),tt=[],at=0;at<=et;at++){var A=S,st=null;if(at<et&&(st=L.rotate(90).multiply(De),j?(A=j._transformPoint(L),st=j._transformPoint(L.add(st)).subtract(A)):A=N.add(L)),!at)v.setHandleOut(st);else{var xt=L.rotate(-90).multiply(De);j&&(xt=j._transformPoint(L.add(xt)).subtract(A)),tt.push(new We(A,xt,st))}L=L.rotate(it)}this._add(tt)}},lineBy:function(){var u=O.read(arguments),f=r(this)._point;this.lineTo(f.add(u))},curveBy:function(){var u=arguments,f=O.read(u),g=O.read(u),v=a.read(u),w=r(this)._point;this.curveTo(w.add(f),w.add(g),v)},cubicCurveBy:function(){var u=arguments,f=O.read(u),g=O.read(u),v=O.read(u),w=r(this)._point;this.cubicCurveTo(w.add(f),w.add(g),w.add(v))},quadraticCurveBy:function(){var u=arguments,f=O.read(u),g=O.read(u),v=r(this)._point;this.quadraticCurveTo(v.add(f),v.add(g))},arcBy:function(){var u=arguments,f=r(this)._point,g=f.add(O.read(u)),v=a.pick(a.peek(u),!0);typeof v=="boolean"?this.arcTo(g,v):this.arcTo(g,f.add(O.read(u)))},closePath:function(u){this.setClosed(!0),this.join(this,u)}}},{_getBounds:function(r,u){var f=u.handle?"getHandleBounds":u.stroke?"getStrokeBounds":"getBounds";return Xe[f](this._segments,this._closed,this,r,u)},statics:{getBounds:function(r,u,f,g,v,w){var S=r[0];if(!S)return new K;var C=new Array(6),T=S._transformCoordinates(g,new Array(6)),P=T.slice(0,2),N=P.slice(),B=new Array(2);function L(z){z._transformCoordinates(g,C);for(var H=0;H<2;H++)Le._addBounds(T[H],T[H+4],C[H+2],C[H],H,w?w[H]:0,P,N,B);var D=T;T=C,C=D}for(var j=1,Y=r.length;j<Y;j++)L(r[j]);return u&&L(S),new K(P[0],P[1],N[0]-P[0],N[1]-P[1])},getStrokeBounds:function(r,u,f,g,v){var w=f.getStyle(),S=w.hasStroke(),C=w.getStrokeWidth(),T=S&&f._getStrokeMatrix(g,v),P=S&&Xe._getStrokePadding(C,T),N=Xe.getBounds(r,u,f,g,v,P);if(!S)return N;var B=C/2,L=w.getStrokeJoin(),j=w.getStrokeCap(),Y=w.getMiterLimit(),z=new K(new W(P));function H(J){N=N.include(J)}function D(J){N=N.unite(z.setCenter(J._point.transform(g)))}function U(J,X){X==="round"||J.isSmooth()?D(J):Xe._addBevelJoin(J,X,B,Y,g,T,H)}function A(J,X){X==="round"?D(J):Xe._addSquareCap(J,X,B,g,T,H)}var V=r.length-(u?0:1);if(V>0){for(var q=1;q<V;q++)U(r[q],L);u?U(r[0],L):(A(r[0],j),A(r[r.length-1],j))}return N},_getStrokePadding:function(r,u){if(!u)return[r,r];var f=new O(r,0).transform(u),g=new O(0,r).transform(u),v=f.getAngleInRadians(),w=f.getLength(),S=g.getLength(),C=Math.sin(v),T=Math.cos(v),P=Math.tan(v),N=Math.atan2(S*P,w),B=Math.atan2(S,P*w);return[Math.abs(w*Math.cos(N)*T+S*Math.sin(N)*C),Math.abs(S*Math.sin(B)*T+w*Math.cos(B)*C)]},_addBevelJoin:function(r,u,f,g,v,w,S,C){var T=r.getCurve(),P=T.getPrevious(),N=T.getPoint1().transform(v),B=P.getNormalAtTime(1).multiply(f).transform(w),L=T.getNormalAtTime(0).multiply(f).transform(w),j=B.getDirectedAngle(L);if((j<0||j>=180)&&(B=B.negate(),L=L.negate()),C&&S(N),S(N.add(B)),u==="miter"){var Y=new ge(N.add(B),new O(-B.y,B.x),!0).intersect(new ge(N.add(L),new O(-L.y,L.x),!0),!0);Y&&N.getDistance(Y)<=g*f&&S(Y)}S(N.add(L))},_addSquareCap:function(r,u,f,g,v,w,S){var C=r._point.transform(g),T=r.getLocation(),P=T.getNormal().multiply(T.getTime()===0?f:-f).transform(v);u==="square"&&(S&&(w(C.subtract(P)),w(C.add(P))),C=C.add(P.rotate(-90))),w(C.add(P)),w(C.subtract(P))},getHandleBounds:function(r,u,f,g,v){var w=f.getStyle(),S=v.stroke&&w.hasStroke(),C,T;if(S){var P=f._getStrokeMatrix(g,v),N=w.getStrokeWidth()/2,B=N;w.getStrokeJoin()==="miter"&&(B=N*w.getMiterLimit()),w.getStrokeCap()==="square"&&(B=Math.max(B,N*Math.SQRT2)),C=Xe._getStrokePadding(N,P),T=Xe._getStrokePadding(B,P)}for(var L=new Array(6),j=1/0,Y=-j,z=j,H=Y,D=0,U=r.length;D<U;D++){var A=r[D];A._transformCoordinates(g,L);for(var V=0;V<6;V+=2){var q=V?C:T,J=q?q[0]:0,X=q?q[1]:0,te=L[V],ie=L[V+1],se=te-J,he=te+J,ne=ie-X,ce=ie+X;se<j&&(j=se),he>Y&&(Y=he),ne<z&&(z=ne),ce>H&&(H=ce)}}return new K(j,z,Y-j,H-z)}}});Xe.inject({statics:new function(){var r=.5522847498307936,u=[new We([-1,0],[0,r],[0,-r]),new We([0,-1],[-r,0],[r,0]),new We([1,0],[0,-r],[0,r]),new We([0,1],[r,0],[-r,0])];function f(v,w,S){var C=a.getNamed(S),T=new Xe(C&&(C.insert==!0?F.INSERT:C.insert==!1?F.NO_INSERT:null));return T._add(v),T._closed=w,T.set(C,F.INSERT)}function g(v,w,S){for(var C=new Array(4),T=0;T<4;T++){var P=u[T];C[T]=new We(P._point.multiply(w).add(v),P._handleIn.multiply(w),P._handleOut.multiply(w))}return f(C,!0,S)}return{Line:function(){var v=arguments;return f([new We(O.readNamed(v,"from")),new We(O.readNamed(v,"to"))],!1,v)},Circle:function(){var v=arguments,w=O.readNamed(v,"center"),S=a.readNamed(v,"radius");return g(w,new W(S),v)},Rectangle:function(){var v=arguments,w=K.readNamed(v,"rectangle"),S=W.readNamed(v,"radius",0,{readNull:!0}),C=w.getBottomLeft(!0),T=w.getTopLeft(!0),P=w.getTopRight(!0),N=w.getBottomRight(!0),B;if(!S||S.isZero())B=[new We(C),new We(T),new We(P),new We(N)];else{S=W.min(S,w.getSize(!0).divide(2));var L=S.width,j=S.height,Y=L*r,z=j*r;B=[new We(C.add(L,0),null,[-Y,0]),new We(C.subtract(0,j),[0,z]),new We(T.add(0,j),null,[0,-z]),new We(T.add(L,0),[-Y,0],null),new We(P.subtract(L,0),null,[Y,0]),new We(P.add(0,j),[0,-z],null),new We(N.subtract(0,j),null,[0,z]),new We(N.subtract(L,0),[Y,0])]}return f(B,!0,v)},RoundRectangle:"#Rectangle",Ellipse:function(){var v=arguments,w=qe._readEllipse(v);return g(w.center,w.radius,v)},Oval:"#Ellipse",Arc:function(){var v=arguments,w=O.readNamed(v,"from"),S=O.readNamed(v,"through"),C=O.readNamed(v,"to"),T=a.getNamed(v),P=new Xe(T&&T.insert==!1&&F.NO_INSERT);return P.moveTo(w),P.arcTo(S,C),P.set(T)},RegularPolygon:function(){for(var v=arguments,w=O.readNamed(v,"center"),S=a.readNamed(v,"sides"),C=a.readNamed(v,"radius"),T=360/S,P=S%3===0,N=new O(0,P?-C:C),B=P?-1:.5,L=new Array(S),j=0;j<S;j++)L[j]=new We(w.add(N.rotate((j+B)*T)));return f(L,!0,v)},Star:function(){for(var v=arguments,w=O.readNamed(v,"center"),S=a.readNamed(v,"points")*2,C=a.readNamed(v,"radius1"),T=a.readNamed(v,"radius2"),P=360/S,N=new O(0,-1),B=new Array(S),L=0;L<S;L++)B[L]=new We(w.add(N.rotate(P*L).multiply(L%2?T:C)));return f(B,!0,v)}}}});var Qe=ze.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(u){this._children=[],this._namedChildren={},this._initialize(u)||(typeof u=="string"?this.setPathData(u):this.addChildren(Array.isArray(u)?u:arguments))},insertChildren:function r(u,f){var g=f,v=g[0];v&&typeof v[0]=="number"&&(g=[g]);for(var w=f.length-1;w>=0;w--){var S=g[w];g===f&&!(S instanceof Xe)&&(g=a.slice(g)),Array.isArray(S)?g[w]=new Xe({segments:S,insert:!1}):S instanceof Qe&&(g.splice.apply(g,[w,1].concat(S.removeChildren())),S.remove())}return r.base.call(this,u,g)},reduce:function r(u){for(var f=this._children,g=f.length-1;g>=0;g--){var v=f[g].reduce(u);v.isEmpty()&&v.remove()}if(!f.length){var v=new Xe(F.NO_INSERT);return v.copyAttributes(this),v.insertAbove(this),this.remove(),v}return r.base.call(this)},isClosed:function(){for(var r=this._children,u=0,f=r.length;u<f;u++)if(!r[u]._closed)return!1;return!0},setClosed:function(r){for(var u=this._children,f=0,g=u.length;f<g;f++)u[f].setClosed(r)},getFirstSegment:function(){var r=this.getFirstChild();return r&&r.getFirstSegment()},getLastSegment:function(){var r=this.getLastChild();return r&&r.getLastSegment()},getCurves:function(){for(var r=this._children,u=[],f=0,g=r.length;f<g;f++)a.push(u,r[f].getCurves());return u},getFirstCurve:function(){var r=this.getFirstChild();return r&&r.getFirstCurve()},getLastCurve:function(){var r=this.getLastChild();return r&&r.getLastCurve()},getArea:function(){for(var r=this._children,u=0,f=0,g=r.length;f<g;f++)u+=r[f].getArea();return u},getLength:function(){for(var r=this._children,u=0,f=0,g=r.length;f<g;f++)u+=r[f].getLength();return u},getPathData:function(r,u){for(var f=this._children,g=[],v=0,w=f.length;v<w;v++){var S=f[v],C=S._matrix;g.push(S.getPathData(r&&!C.isIdentity()?r.appended(C):r,u))}return g.join("")},_hitTestChildren:function r(u,f,g){return r.base.call(this,u,f.class===Xe||f.type==="path"?f:a.set({},f,{fill:!1}),g)},_draw:function(r,u,f,g){var v=this._children;if(v.length){u=u.extend({dontStart:!0,dontFinish:!0}),r.beginPath();for(var w=0,S=v.length;w<S;w++)v[w].draw(r,u,g);if(!u.clip){this._setStyles(r,u,f);var C=this._style;C.hasFill()&&(r.fill(C.getFillRule()),r.shadowColor="rgba(0,0,0,0)"),C.hasStroke()&&r.stroke()}}},_drawSelected:function(r,u,f){for(var g=this._children,v=0,w=g.length;v<w;v++){var S=g[v],C=S._matrix;f[S._id]||S._drawSelected(r,C.isIdentity()?u:u.appended(C))}}},new function(){function r(u,f){var g=u._children;if(f&&!g.length)throw new Error("Use a moveTo() command first");return g[g.length-1]}return a.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],function(u){this[u]=function(){var f=r(this,!0);f[u].apply(f,arguments)}},{moveTo:function(){var u=r(this),f=u&&u.isEmpty()?u:new Xe(F.NO_INSERT);f!==u&&this.addChild(f),f.moveTo.apply(f,arguments)},moveBy:function(){var u=r(this,!0),f=u&&u.getLastSegment(),g=O.read(arguments);this.moveTo(f?g.add(f._point):g)},closePath:function(u){r(this,!0).closePath(u)}})},a.each(["reverse","flatten","simplify","smooth"],function(r){this[r]=function(u){for(var f=this._children,g,v=0,w=f.length;v<w;v++)g=f[v][r](u)||g;return g}},{}));ze.inject(new function(){var r=Math.min,u=Math.max,f=Math.abs,g={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function v(D){return D._children||[D]}function w(D,U){var A=D.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(U){for(var V=v(A),q=0,J=V.length;q<J;q++){var D=V[q];!D._closed&&!D.isEmpty()&&(D.closePath(1e-12),D.getFirstSegment().setHandleIn(0,0),D.getLastSegment().setHandleOut(0,0))}A=A.resolveCrossings().reorient(A.getFillRule()==="nonzero",!0)}return A}function S(D,U,A,V,q){var J=new Qe(F.NO_INSERT);return J.addChildren(D,!0),J=J.reduce({simplify:U}),q&&q.insert==!1||J.insertAbove(V&&A.isSibling(V)&&A.getIndex()<V.getIndex()?V:A),J.copyAttributes(A,!0),J}function C(D){return D.hasOverlap()||D.isCrossing()}function T(D,U,A,V){if(V&&(V.trace==!1||V.stroke)&&/^(subtract|intersect)$/.test(A))return P(D,U,A);var q=w(D,!0),J=U&&D!==U&&w(U,!0),X=g[A];X[A]=!0,J&&(X.subtract||X.exclude)^(J.isClockwise()^q.isClockwise())&&J.reverse();var te=j(wt.expand(q.getIntersections(J,C))),ie=v(q),se=J&&v(J),he=[],ne=[],ce;function fe(st){for(var xt=0,vt=st.length;xt<vt;xt++){var lt=st[xt];a.push(he,lt._segments),a.push(ne,lt.getCurves()),lt._overlapsOnly=!0}}function ye(st){for(var xt=[],vt=0,lt=st&&st.length;vt<lt;vt++)xt.push(ne[st[vt]]);return xt}if(te.length){fe(ie),se&&fe(se);for(var we=new Array(ne.length),Ee=0,Be=ne.length;Ee<Be;Ee++)we[Ee]=ne[Ee].getValues();for(var Ue=_.findCurveBoundsCollisions(we,we,0,!0),et={},Ee=0;Ee<ne.length;Ee++){var it=ne[Ee],Ie=it._path._id,De=et[Ie]=et[Ie]||{};De[it.getIndex()]={hor:ye(Ue[Ee].hor),ver:ye(Ue[Ee].ver)}}for(var Ee=0,Be=te.length;Ee<Be;Ee++)z(te[Ee]._segment,q,J,et,X);for(var Ee=0,Be=he.length;Ee<Be;Ee++){var tt=he[Ee],at=tt._intersection;tt._winding||z(tt,q,J,et,X),at&&at._overlap||(tt._path._overlapsOnly=!1)}ce=H(he,X)}else ce=L(se?ie.concat(se):ie.slice(),function(st){return!!X[st]});return S(ce,!0,D,U,V)}function P(D,U,A){var V=w(D),q=w(U),J=V.getIntersections(q,C),X=A==="subtract",te=A==="divide",ie={},se=[];function he(fe){if(!ie[fe._id]&&(te||q.contains(fe.getPointAt(fe.getLength()/2))^X))return se.unshift(fe),ie[fe._id]=!0}for(var ne=J.length-1;ne>=0;ne--){var ce=J[ne].split();ce&&(he(ce)&&ce.getFirstSegment().setHandleIn(0,0),V.getLastSegment().setHandleOut(0,0))}return he(V),S(se,!1,D,U)}function N(D,U){for(var A=D;A;){if(A===U)return;A=A._previous}for(;D._next&&D._next!==U;)D=D._next;if(!D._next){for(;U._previous;)U=U._previous;D._next=U,U._previous=D}}function B(D){for(var U=D.length-1;U>=0;U--)D[U].clearHandles()}function L(D,U,A){var V=D&&D.length;if(V){var q=a.each(D,function(Ue,et){this[Ue._id]={container:null,winding:Ue.isClockwise()?1:-1,index:et}},{}),J=D.slice().sort(function(Ue,et){return f(et.getArea())-f(Ue.getArea())}),X=J[0],te=_.findItemBoundsCollisions(J,null,E.GEOMETRIC_EPSILON);A==null&&(A=X.isClockwise());for(var ie=0;ie<V;ie++){var se=J[ie],he=q[se._id],ne=0,ce=te[ie];if(ce){for(var fe=null,ye=ce.length-1;ye>=0;ye--)if(ce[ye]<ie){fe=fe||se.getInteriorPoint();var we=J[ce[ye]];if(we.contains(fe)){var Ee=q[we._id];ne=Ee.winding,he.winding+=ne,he.container=Ee.exclude?Ee.container:we;break}}}if(U(he.winding)===U(ne))he.exclude=!0,D[he.index]=null;else{var Be=he.container;se.setClockwise(Be?!Be.isClockwise():A)}}}return D}function j(D,U,A){var V=U&&[],q=1e-8,J=1-q,X=!1,te=A||[],ie=A&&{},se,he,ne;function ce(xt){return xt._path._id+"."+xt._segment1._index}for(var fe=(A&&A.length)-1;fe>=0;fe--){var ye=A[fe];ye._path&&(ie[ce(ye)]=!0)}for(var fe=D.length-1;fe>=0;fe--){var we=D[fe],Ee=we._time,Be=Ee,Ue=U&&!U(we),ye=we._curve,et;if(ye&&(ye!==he?(X=!ye.hasHandles()||ie&&ie[ce(ye)],se=[],ne=null,he=ye):ne>=q&&(Ee/=ne)),Ue){se&&se.push(we);continue}else U&&V.unshift(we);if(ne=Be,Ee<q)et=ye._segment1;else if(Ee>J)et=ye._segment2;else{var it=ye.divideAtTime(Ee,!0);X&&te.push(ye,it),et=it._segment1;for(var Ie=se.length-1;Ie>=0;Ie--){var De=se[Ie];De._time=(De._time-Ee)/(1-Ee)}}we._setSegment(et);var tt=et._intersection,at=we._intersection;if(tt){N(tt,at);for(var st=tt;st;)N(st._intersection,tt),st=st._next}else et._intersection=at}return A||B(te),V||D}function Y(D,U,A,V,q){var J=Array.isArray(U)?U:U[A?"hor":"ver"],X=A?1:0,te=X^1,ie=[D.x,D.y],se=ie[X],he=ie[te],ne=1e-9,ce=1e-6,fe=se-ne,ye=se+ne,we=0,Ee=0,Be=0,Ue=0,et=!1,it=!1,Ie=1,De=[],tt,at;function st(Ke){var Ht=Ke[te+0],an=Ke[te+6];if(!(he<r(Ht,an)||he>u(Ht,an))){var qt=Ke[X+0],tr=Ke[X+2],Fr=Ke[X+4],fr=Ke[X+6];if(Ht===an){(qt<ye&&fr>fe||fr<ye&&qt>fe)&&(et=!0);return}var Wn=he===Ht?0:he===an||fe>u(qt,tr,Fr,fr)||ye<r(qt,tr,Fr,fr)?1:Le.solveCubic(Ke,te,he,De,0,1)>0?De[0]:1,Cn=Wn===0?qt:Wn===1?fr:Le.getPoint(Ke,Wn)[A?"y":"x"],On=Ht>an?1:-1,nr=tt[te]>tt[te+6]?1:-1,vn=tt[X+6];return he!==Ht?(Cn<fe?Be+=On:Cn>ye?Ue+=On:et=!0,Cn>se-ce&&Cn<se+ce&&(Ie/=2)):(On!==nr?qt<fe?Be+=On:qt>ye&&(Ue+=On):qt!=vn&&(vn<ye&&Cn>ye?(Ue+=On,et=!0):vn>fe&&Cn<fe&&(Be+=On,et=!0)),Ie/=4),tt=Ke,!q&&Cn>fe&&Cn<ye&&Le.getTangent(Ke,Wn)[A?"x":"y"]===0&&Y(D,U,!A,V,!0)}}function xt(Ke){var Ht=Ke[te+0],an=Ke[te+2],qt=Ke[te+4],tr=Ke[te+6];if(he<=u(Ht,an,qt,tr)&&he>=r(Ht,an,qt,tr)){for(var Fr=Ke[X+0],fr=Ke[X+2],Wn=Ke[X+4],Cn=Ke[X+6],On=fe>u(Fr,fr,Wn,Cn)||ye<r(Fr,fr,Wn,Cn)?[Ke]:Le.getMonoCurves(Ke,A),nr,vn=0,Fn=On.length;vn<Fn;vn++)if(nr=st(On[vn]))return nr}}for(var vt=0,lt=J.length;vt<lt;vt++){var Lt=J[vt],bt=Lt._path,pn=Lt.getValues(),sn;if((!vt||J[vt-1]._path!==bt)&&(tt=null,bt._closed||(at=Le.getValues(bt.getLastCurve().getSegment2(),Lt.getSegment1(),null,!V),at[te]!==at[te+6]&&(tt=at)),!tt)){tt=pn;for(var Sn=bt.getLastCurve();Sn&&Sn!==Lt;){var ln=Sn.getValues();if(ln[te]!==ln[te+6]){tt=ln;break}Sn=Sn.getPrevious()}}if(sn=xt(pn))return sn;if(vt+1===lt||J[vt+1]._path!==bt){if(at&&(sn=xt(at)))return sn;et&&!Be&&!Ue&&(Be=Ue=bt.isClockwise(V)^A?1:-1),we+=Be,Ee+=Ue,Be=Ue=0,et&&(it=!0,et=!1),at=null}}return we=f(we),Ee=f(Ee),{winding:u(we,Ee),windingL:we,windingR:Ee,quality:Ie,onPath:it}}function z(D,U,A,V,q){var J=[],X=D,te=0,ne;do{var ie=D.getCurve();if(ie){var se=ie.getLength();J.push({segment:D,curve:ie,length:se}),te+=se}D=D.getNext()}while(D&&!D._intersection&&D!==X);for(var he=[.5,.25,.75],ne={winding:0,quality:-1},ce=.001,fe=1-ce,ye=0;ye<he.length&&ne.quality<.5;ye++)for(var se=te*he[ye],we=0,Ee=J.length;we<Ee;we++){var Be=J[we],Ue=Be.length;if(se<=Ue){var ie=Be.curve,et=ie._path,it=et._parent,Ie=it instanceof Qe?it:et,De=E.clamp(ie.getTimeAt(se),ce,fe),tt=ie.getPointAtTime(De),at=f(ie.getTangentAtTime(De).y)<Math.SQRT1_2,st=null;if(q.subtract&&A){var xt=Ie===U?A:U,vt=xt._getWinding(tt,at,!0);if(Ie===U&&vt.winding||Ie===A&&!vt.winding){if(vt.quality<1)continue;st={winding:0,quality:1}}}st=st||Y(tt,V[et._id][ie.getIndex()],at,!0),st.quality>ne.quality&&(ne=st);break}se-=Ue}for(var we=J.length-1;we>=0;we--)J[we].segment._winding=ne}function H(D,U){var A=[],V;function q(lt){var Lt;return!!(lt&&!lt._visited&&(!U||U[(Lt=lt._winding||{}).winding]&&!(U.unite&&Lt.winding===2&&Lt.windingL&&Lt.windingR)))}function J(lt){if(lt){for(var Lt=0,bt=V.length;Lt<bt;Lt++)if(lt===V[Lt])return!0}return!1}function X(lt){for(var Lt=lt._segments,bt=0,pn=Lt.length;bt<pn;bt++)Lt[bt]._visited=!0}function te(lt,Lt){var bt=lt._intersection,pn=bt,sn=[];Lt&&(V=[lt]);function Sn(ln,Ke){for(;ln&&ln!==Ke;){var Ht=ln._segment,an=Ht&&Ht._path;if(an){var qt=Ht.getNext()||an.getFirstSegment(),tr=qt._intersection;Ht!==lt&&(J(Ht)||J(qt)||qt&&q(Ht)&&(q(qt)||tr&&q(tr._segment)))&&sn.push(Ht),Lt&&V.push(Ht)}ln=ln._next}}if(bt){for(Sn(bt);bt&&bt._previous;)bt=bt._previous;Sn(bt,pn)}return sn}D.sort(function(lt,Lt){var bt=lt._intersection,pn=Lt._intersection,sn=!!(bt&&bt._overlap),Sn=!!(pn&&pn._overlap),ln=lt._path,Ke=Lt._path;return sn^Sn?sn?1:-1:!bt^!pn?bt?1:-1:ln!==Ke?ln._id-Ke._id:lt._index-Lt._index});for(var ie=0,se=D.length;ie<se;ie++){var he=D[ie],ne=q(he),ce=null,fe=!1,ye=!0,we=[],Ee,Be,Ue;if(ne&&he._path._overlapsOnly){var et=he._path,it=he._intersection._segment._path;et.compare(it)&&(et.getArea()&&A.push(et.clone(!1)),X(et),X(it),ne=!1)}for(;ne;){var Ie=!ce,De=te(he,Ie),tt=De.shift(),fe=!Ie&&(J(he)||J(tt)),at=!fe&&tt;if(Ie&&(ce=new Xe(F.NO_INSERT),Ee=null),fe){(he.isFirst()||he.isLast())&&(ye=he._path._closed),he._visited=!0;break}if(at&&Ee&&(we.push(Ee),Ee=null),Ee||(at&&De.push(he),Ee={start:ce._segments.length,crossings:De,visited:Be=[],handleIn:Ue}),at&&(he=tt),!q(he)){ce.removeSegments(Ee.start);for(var st=0,xt=Be.length;st<xt;st++)Be[st]._visited=!1;Be.length=0;do he=Ee&&Ee.crossings.shift(),(!he||!he._path)&&(he=null,Ee=we.pop(),Ee&&(Be=Ee.visited,Ue=Ee.handleIn));while(Ee&&!q(he));if(!he)break}var vt=he.getNext();ce.add(new We(he._point,Ue,vt&&he._handleOut)),he._visited=!0,Be.push(he),he=vt||he._path.getFirstSegment(),Ue=vt&&vt._handleIn}fe&&(ye&&(ce.getFirstSegment().setHandleIn(Ue),ce.setClosed(ye)),ce.getArea()!==0&&A.push(ce))}return A}return{_getWinding:function(D,U,A){return Y(D,this.getCurves(),U,A)},unite:function(D,U){return T(this,D,"unite",U)},intersect:function(D,U){return T(this,D,"intersect",U)},subtract:function(D,U){return T(this,D,"subtract",U)},exclude:function(D,U){return T(this,D,"exclude",U)},divide:function(D,U){return U&&(U.trace==!1||U.stroke)?P(this,D,"divide"):S([this.subtract(D,U),this.intersect(D,U)],!0,this,D,U)},resolveCrossings:function(){var D=this._children,U=D||[this];function A(Ee,Be){var Ue=Ee&&Ee._intersection;return Ue&&Ue._overlap&&Ue._path===Be}var V=!1,q=!1,J=this.getIntersections(null,function(Ee){return Ee.hasOverlap()&&(V=!0)||Ee.isCrossing()&&(q=!0)}),X=V&&q&&[];if(J=wt.expand(J),V)for(var te=j(J,function(Ee){return Ee.hasOverlap()},X),ie=te.length-1;ie>=0;ie--){var se=te[ie],he=se._path,ne=se._segment,ce=ne.getPrevious(),fe=ne.getNext();A(ce,he)&&A(fe,he)&&(ne.remove(),ce._handleOut._set(0,0),fe._handleIn._set(0,0),ce!==ne&&!ce.getCurve().hasLength()&&(fe._handleIn.set(ce._handleIn),ce.remove()))}q&&(j(J,V&&function(Ee){var Be=Ee.getCurve(),Ue=Ee.getSegment(),et=Ee._intersection,it=et._curve,Ie=et._segment;if(Be&&it&&Be._path&&it._path)return!0;Ue&&(Ue._intersection=null),Ie&&(Ie._intersection=null)},X),X&&B(X),U=H(a.each(U,function(Ee){a.push(this,Ee._segments)},[])));var ye=U.length,we;return ye>1&&D?(U!==D&&this.setChildren(U),we=this):ye===1&&!D&&(U[0]!==this&&this.setSegments(U[0].removeSegments()),we=this),we||(we=new Qe(F.NO_INSERT),we.addChildren(U),we=we.reduce(),we.copyAttributes(this),this.replaceWith(we)),we},reorient:function(D,U){var A=this._children;return A&&A.length?this.setChildren(L(this.removeChildren(),function(V){return!!(D?V:V&1)},U)):U!==t&&this.setClockwise(U),this},getInteriorPoint:function(){var D=this.getBounds(),U=D.getCenter(!0);if(!this.contains(U)){for(var A=this.getCurves(),V=U.y,q=[],J=[],X=0,te=A.length;X<te;X++){var ie=A[X].getValues(),se=ie[1],he=ie[3],ne=ie[5],ce=ie[7];if(V>=r(se,he,ne,ce)&&V<=u(se,he,ne,ce))for(var fe=Le.getMonoCurves(ie),ye=0,we=fe.length;ye<we;ye++){var Ee=fe[ye],Be=Ee[1],Ue=Ee[7];if(Be!==Ue&&(V>=Be&&V<=Ue||V>=Ue&&V<=Be)){var et=V===Be?Ee[0]:V===Ue?Ee[6]:Le.solveCubic(Ee,1,V,J,0,1)===1?Le.getPoint(Ee,J[0]).x:(Ee[0]+Ee[6])/2;q.push(et)}}}q.length>1&&(q.sort(function(it,Ie){return it-Ie}),U.x=(q[0]+q[1])/2)}return U}}});var be=a.extend({_class:"PathFlattener",initialize:function(r,u,f,g,v){var w=[],S=[],C=0,T=1/(f||32),P=r._segments,N=P[0],B;function L(H,D){var U=Le.getValues(H,D,v);w.push(U),j(U,H._index,0,1)}function j(H,D,U,A){if(A-U>T&&!(g&&Le.isStraight(H))&&!Le.isFlatEnough(H,u||.25)){var V=Le.subdivide(H,.5),q=(U+A)/2;j(V[0],D,U,q),j(V[1],D,q,A)}else{var J=H[6]-H[0],X=H[7]-H[1],te=Math.sqrt(J*J+X*X);te>0&&(C+=te,S.push({offset:C,curve:H,index:D,time:A}))}}for(var Y=1,z=P.length;Y<z;Y++)B=P[Y],L(N,B),N=B;r._closed&&L(B||N,P[0]),this.curves=w,this.parts=S,this.length=C,this.index=0},_get:function(r){for(var u=this.parts,f=u.length,g,v=this.index;g=v,!(!v||u[--v].offset<r););for(;g<f;g++){var w=u[g];if(w.offset>=r){this.index=g;var S=u[g-1],C=S&&S.index===w.index?S.time:0,T=S?S.offset:0;return{index:w.index,time:C+(w.time-C)*(r-T)/(w.offset-T)}}}return{index:u[f-1].index,time:1}},drawPart:function(r,u,f){for(var g=this._get(u),v=this._get(f),w=g.index,S=v.index;w<=S;w++){var C=Le.getPart(this.curves[w],w===g.index?g.time:0,w===v.index?v.time:1);w===g.index&&r.moveTo(C[0],C[1]),r.bezierCurveTo.apply(r,C.slice(2))}}},a.each(Le._evaluateMethods,function(r){this[r+"At"]=function(u){var f=this._get(u);return Le[r](this.curves[f.index],f.time)}},{})),Fe=a.extend({initialize:function(r){for(var u=this.points=[],f=r._segments,g=r._closed,v=0,w,S=f.length;v<S;v++){var C=f[v].point;(!w||!w.equals(C))&&u.push(w=C.clone())}g&&(u.unshift(u[u.length-1]),u.push(u[1])),this.closed=g},fit:function(r){var u=this.points,f=u.length,g=null;return f>0&&(g=[new We(u[0])],f>1&&(this.fitCubic(g,r,0,f-1,u[1].subtract(u[0]),u[f-2].subtract(u[f-1])),this.closed&&(g.shift(),g.pop()))),g},fitCubic:function(r,u,f,g,v,w){var S=this.points;if(g-f===1){var C=S[f],T=S[g],P=C.getDistance(T)/3;this.addCurve(r,[C,C.add(v.normalize(P)),T.add(w.normalize(P)),T]);return}for(var N=this.chordLengthParameterize(f,g),B=Math.max(u,u*u),L,j=!0,Y=0;Y<=4;Y++){var z=this.generateBezier(f,g,N,v,w),H=this.findMaxError(f,g,z,N);if(H.error<u&&j){this.addCurve(r,z);return}if(L=H.index,H.error>=B)break;j=this.reparameterize(f,g,N,z),B=H.error}var D=S[L-1].subtract(S[L+1]);this.fitCubic(r,u,f,L,v,D),this.fitCubic(r,u,L,g,D.negate(),w)},addCurve:function(r,u){var f=r[r.length-1];f.setHandleOut(u[1].subtract(u[0])),r.push(new We(u[3],u[2].subtract(u[3])))},generateBezier:function(r,u,f,g,v){for(var w=1e-12,S=Math.abs,C=this.points,T=C[r],P=C[u],N=[[0,0],[0,0]],B=[0,0],L=0,j=u-r+1;L<j;L++){var Y=f[L],z=1-Y,H=3*Y*z,D=z*z*z,U=H*z,A=H*Y,V=Y*Y*Y,q=g.normalize(U),J=v.normalize(A),X=C[r+L].subtract(T.multiply(D+U)).subtract(P.multiply(A+V));N[0][0]+=q.dot(q),N[0][1]+=q.dot(J),N[1][0]=N[0][1],N[1][1]+=J.dot(J),B[0]+=q.dot(X),B[1]+=J.dot(X)}var te=N[0][0]*N[1][1]-N[1][0]*N[0][1],ie,se;if(S(te)>w){var he=N[0][0]*B[1]-N[1][0]*B[0],ne=B[0]*N[1][1]-B[1]*N[0][1];ie=ne/te,se=he/te}else{var ce=N[0][0]+N[0][1],fe=N[1][0]+N[1][1];ie=se=S(ce)>w?B[0]/ce:S(fe)>w?B[1]/fe:0}var ye=P.getDistance(T),we=w*ye,Ee,Be;if(ie<we||se<we)ie=se=ye/3;else{var Ue=P.subtract(T);Ee=g.normalize(ie),Be=v.normalize(se),Ee.dot(Ue)-Be.dot(Ue)>ye*ye&&(ie=se=ye/3,Ee=Be=null)}return[T,T.add(Ee||g.normalize(ie)),P.add(Be||v.normalize(se)),P]},reparameterize:function(r,u,f,g){for(var v=r;v<=u;v++)f[v-r]=this.findRoot(g,this.points[v],f[v-r]);for(var v=1,w=f.length;v<w;v++)if(f[v]<=f[v-1])return!1;return!0},findRoot:function(r,u,f){for(var g=[],v=[],w=0;w<=2;w++)g[w]=r[w+1].subtract(r[w]).multiply(3);for(var w=0;w<=1;w++)v[w]=g[w+1].subtract(g[w]).multiply(2);var S=this.evaluate(3,r,f),C=this.evaluate(2,g,f),T=this.evaluate(1,v,f),P=S.subtract(u),N=C.dot(C)+P.dot(T);return E.isMachineZero(N)?f:f-P.dot(C)/N},evaluate:function(r,u,f){for(var g=u.slice(),v=1;v<=r;v++)for(var w=0;w<=r-v;w++)g[w]=g[w].multiply(1-f).add(g[w+1].multiply(f));return g[0]},chordLengthParameterize:function(r,u){for(var f=[0],g=r+1;g<=u;g++)f[g-r]=f[g-r-1]+this.points[g].getDistance(this.points[g-1]);for(var g=1,v=u-r;g<=v;g++)f[g]/=f[v];return f},findMaxError:function(r,u,f,g){for(var v=Math.floor((u-r+1)/2),w=0,S=r+1;S<u;S++){var C=this.evaluate(3,f,g[S-r]),T=C.subtract(this.points[S]),P=T.x*T.x+T.y*T.y;P>=w&&(w=P,v=S)}return{error:w,index:v}}}),yt=F.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(u){this._content="",this._lines=[];var f=u&&a.isPlainObject(u)&&u.x===t&&u.y===t;this._initialize(f&&u,!f&&O.read(arguments))},_equals:function(r){return this._content===r._content},copyContent:function(r){this.setContent(r._content)},getContent:function(){return this._content},setContent:function(r){this._content=""+r,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),Ct=yt.extend({_class:"PointText",initialize:function(){yt.apply(this,arguments)},getPoint:function(){var r=this._matrix.getTranslation();return new Q(r.x,r.y,this,"setPoint")},setPoint:function(){var r=O.read(arguments);this.translate(r.subtract(this._matrix.getTranslation()))},_draw:function(r,u,f){if(this._content){this._setStyles(r,u,f);var g=this._lines,v=this._style,w=v.hasFill(),S=v.hasStroke(),C=v.getLeading(),T=r.shadowColor;r.font=v.getFontStyle(),r.textAlign=v.getJustification();for(var P=0,N=g.length;P<N;P++){r.shadowColor=T;var B=g[P];w&&(r.fillText(B,0,0),r.shadowColor="rgba(0,0,0,0)"),S&&r.strokeText(B,0,0),r.translate(0,C)}}},_getBounds:function(r,u){var f=this._style,g=this._lines,v=g.length,w=f.getJustification(),S=f.getLeading(),C=this.getView().getTextWidth(f.getFontStyle(),g),T=0;w!=="left"&&(T-=C/(w==="center"?2:1));var P=new K(T,v?-.75*S:0,C,v*S);return r?r._transformBounds(P,P):P}}),pt=a.extend(new function(){var r={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},u={},f={transparent:[0,0,0,0]},g;function v(C){var T=C.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||C.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),P="rgb",N;if(T){var B=T[4]?4:3;N=new Array(B);for(var L=0;L<B;L++){var j=T[L+1];N[L]=parseInt(j.length==1?j+j:j,16)/255}}else if(T=C.match(/^(rgb|hsl)a?\((.*)\)$/)){P=T[1],N=T[2].trim().split(/[,\s]+/g);for(var Y=P==="hsl",L=0,z=Math.min(N.length,4);L<z;L++){var H=N[L],j=parseFloat(H);if(Y)if(L===0){var D=H.match(/([a-z]*)$/)[1];j*={turn:360,rad:180/Math.PI,grad:.9}[D]||1}else L<3&&(j/=100);else L<3&&(j/=/%$/.test(H)?100:255);N[L]=j}}else{var U=f[C];if(!U)if(n){g||(g=tn.getContext(1,1,{willReadFrequently:!0}),g.globalCompositeOperation="copy"),g.fillStyle="rgba(0,0,0,0)",g.fillStyle=C,g.fillRect(0,0,1,1);var A=g.getImageData(0,0,1,1).data;U=f[C]=[A[0]/255,A[1]/255,A[2]/255]}else U=[0,0,0];N=U.slice()}return[P,N]}var w=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],S={"rgb-hsb":function(C,T,P){var N=Math.max(C,T,P),B=Math.min(C,T,P),L=N-B,j=L===0?0:(N==C?(T-P)/L+(T<P?6:0):N==T?(P-C)/L+2:(C-T)/L+4)*60;return[j,N===0?0:L/N,N]},"hsb-rgb":function(C,T,P){C=(C/60%6+6)%6;var B=Math.floor(C),N=C-B,B=w[B],L=[P,P*(1-T),P*(1-T*N),P*(1-T*(1-N))];return[L[B[0]],L[B[1]],L[B[2]]]},"rgb-hsl":function(C,T,P){var N=Math.max(C,T,P),B=Math.min(C,T,P),L=N-B,j=L===0,Y=j?0:(N==C?(T-P)/L+(T<P?6:0):N==T?(P-C)/L+2:(C-T)/L+4)*60,z=(N+B)/2,H=j?0:z<.5?L/(N+B):L/(2-N-B);return[Y,H,z]},"hsl-rgb":function(C,T,P){if(C=(C/360%1+1)%1,T===0)return[P,P,P];for(var N=[C+1/3,C,C-1/3],B=P<.5?P*(1+T):P+T-P*T,L=2*P-B,j=[],Y=0;Y<3;Y++){var z=N[Y];z<0&&(z+=1),z>1&&(z-=1),j[Y]=6*z<1?L+(B-L)*6*z:2*z<1?B:3*z<2?L+(B-L)*(2/3-z)*6:L}return j},"rgb-gray":function(C,T,P){return[C*.2989+T*.587+P*.114]},"gray-rgb":function(C){return[C,C,C]},"gray-hsb":function(C){return[0,0,C]},"gray-hsl":function(C){return[0,0,C]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return a.each(r,function(C,T){u[T]=[],a.each(C,function(P,N){var B=a.capitalize(P),L=/^(hue|saturation)$/.test(P),j=u[T][N]=T==="gradient"?P==="gradient"?function(Y){var z=this._components[0];return Y=Mt.read(Array.isArray(Y)?Y:arguments,0,{readNull:!0}),z!==Y&&(z&&z._removeOwner(this),Y&&Y._addOwner(this)),Y}:function(){return O.read(arguments,0,{readNull:P==="highlight",clone:!0})}:function(Y){return Y==null||isNaN(Y)?0:+Y};this["get"+B]=function(){return this._type===T||L&&/^hs[bl]$/.test(this._type)?this._components[N]:this._convert(T)[N]},this["set"+B]=function(Y){this._type!==T&&!(L&&/^hs[bl]$/.test(this._type))&&(this._components=this._convert(T),this._properties=r[T],this._type=T),this._components[N]=j.call(this,Y),this._changed()}},this)},{_class:"Color",_readIndex:!0,initialize:function C(T){var P=arguments,N=this.__read,B=0,L,j,Y,z;Array.isArray(T)&&(P=T,T=P[0]);var H=T!=null&&typeof T;if(H==="string"&&T in r&&(L=T,T=P[1],Array.isArray(T)?(j=T,Y=P[2]):(N&&(B=1),P=a.slice(P,1),H=typeof T)),!j){if(z=H==="number"?P:H==="object"&&T.length!=null?T:null,z){L||(L=z.length>=3?"rgb":"gray");var D=r[L].length;Y=z[D],N&&(B+=z===arguments?D+(Y!=null?1:0):1),z.length>D&&(z=a.slice(z,0,D))}else if(H==="string"){var U=v(T);L=U[0],j=U[1],j.length===4&&(Y=j[3],j.length--)}else if(H==="object")if(T.constructor===C){if(L=T._type,j=T._components.slice(),Y=T._alpha,L==="gradient")for(var A=1,V=j.length;A<V;A++){var q=j[A];q&&(j[A]=q.clone())}}else if(T.constructor===Mt)L="gradient",z=P;else{L="hue"in T?"lightness"in T?"hsl":"hsb":"gradient"in T||"stops"in T||"radial"in T?"gradient":"gray"in T?"gray":"rgb";var J=r[L],X=u[L];this._components=j=[];for(var A=0,V=J.length;A<V;A++){var te=T[J[A]];te==null&&!A&&L==="gradient"&&"stops"in T&&(te={stops:T.stops,radial:T.radial}),te=X[A].call(this,te),te!=null&&(j[A]=te)}Y=T.alpha}N&&L&&(B=1)}if(this._type=L||"rgb",!j){this._components=j=[];for(var X=u[this._type],A=0,V=X.length;A<V;A++){var te=X[A].call(this,z&&z[A]);te!=null&&(j[A]=te)}}return this._components=j,this._properties=r[this._type],this._alpha=Y,N&&(this.__read=B),this},set:"#initialize",_serialize:function(C,T){var P=this.getComponents();return a.serialize(/^(gray|rgb)$/.test(this._type)?P:[this._type].concat(P),C,!0,T)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(C){var T;return this._type===C?this._components.slice():(T=S[this._type+"-"+C])?T.apply(this,this._components):S["rgb-"+C].apply(this,S[this._type+"-rgb"].apply(this,this._components))},convert:function(C){return new pt(C,this._convert(C),this._alpha)},getType:function(){return this._type},setType:function(C){this._components=this._convert(C),this._properties=r[C],this._type=C},getComponents:function(){var C=this._components.slice();return this._alpha!=null&&C.push(this._alpha),C},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(C){this._alpha=C==null?null:Math.min(Math.max(C,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(C){var T=a.isPlainValue(C,!0)?pt.read(arguments):C;return T===this||T&&this._class===T._class&&this._type===T._type&&this.getAlpha()===T.getAlpha()&&a.equals(this._components,T._components)||!1},toString:function(){for(var C=this._properties,T=[],P=this._type==="gradient",N=b.instance,B=0,L=C.length;B<L;B++){var j=this._components[B];j!=null&&T.push(C[B]+": "+(P?j:N.number(j)))}return this._alpha!=null&&T.push("alpha: "+N.number(this._alpha)),"{ "+T.join(", ")+" }"},toCSS:function(C){var T=this._convert("rgb"),P=C||this._alpha==null?1:this._alpha;function N(B){return Math.round((B<0?0:B>1?1:B)*255)}return T=[N(T[0]),N(T[1]),N(T[2])],P<1&&T.push(P<0?0:P),C?"#"+((1<<24)+(T[0]<<16)+(T[1]<<8)+T[2]).toString(16).slice(1):(T.length==4?"rgba(":"rgb(")+T.join(",")+")"},toCanvasStyle:function(C,T){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var P=this._components,N=P[0],B=N._stops,L=P[1],j=P[2],Y=P[3],z=T&&T.inverted(),H;if(z&&(L=z._transformPoint(L),j=z._transformPoint(j),Y&&(Y=z._transformPoint(Y))),N._radial){var D=j.getDistance(L);if(Y){var U=Y.subtract(L);U.getLength()>D&&(Y=L.add(U.normalize(D-.1)))}var A=Y||L;H=C.createRadialGradient(A.x,A.y,0,L.x,L.y,D)}else H=C.createLinearGradient(L.x,L.y,j.x,j.y);for(var V=0,q=B.length;V<q;V++){var J=B[V],X=J._offset;H.addColorStop(X??V/(q-1),J._color.toCanvasStyle())}return this._canvasStyle=H},transform:function(C){if(this._type==="gradient"){for(var T=this._components,P=1,N=T.length;P<N;P++){var B=T[P];C._transformPoint(B,B,!0)}this._changed()}},statics:{_types:r,random:function(){var C=Math.random;return new pt(C(),C(),C())},_setOwner:function(C,T,P){return C&&(C._owner&&T&&C._owner!==T&&(C=C.clone()),!C._owner^!T&&(C._owner=T||null,C._setter=P||null)),C}}})},new function(){var r={add:function(u,f){return u+f},subtract:function(u,f){return u-f},multiply:function(u,f){return u*f},divide:function(u,f){return u/f}};return a.each(r,function(u,f){this[f]=function(g){g=pt.read(arguments);for(var v=this._type,w=this._components,S=g._convert(v),C=0,T=w.length;C<T;C++)S[C]=u(w[C],S[C]);return new pt(v,S,this._alpha!=null?u(this._alpha,g.getAlpha()):null)}},{})}),Mt=a.extend({_class:"Gradient",initialize:function(u,f){this._id=I.get(),u&&a.isPlainObject(u)&&(this.set(u),u=f=null),this._stops==null&&this.setStops(u||["white","black"]),this._radial==null&&this.setRadial(typeof f=="string"&&f==="radial"||f||!1)},_serialize:function(r,u){return u.add(this,function(){return a.serialize([this._stops,this._radial],r,!0,u)})},_changed:function(){for(var r=0,u=this._owners&&this._owners.length;r<u;r++)this._owners[r]._changed()},_addOwner:function(r){this._owners||(this._owners=[]),this._owners.push(r)},_removeOwner:function(r){var u=this._owners?this._owners.indexOf(r):-1;u!=-1&&(this._owners.splice(u,1),this._owners.length||(this._owners=t))},clone:function(){for(var r=[],u=0,f=this._stops.length;u<f;u++)r[u]=this._stops[u].clone();return new Mt(r,this._radial)},getStops:function(){return this._stops},setStops:function(r){if(r.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var u=this._stops;if(u)for(var f=0,g=u.length;f<g;f++)u[f]._owner=t;u=this._stops=zt.readList(r,0,{clone:!0});for(var f=0,g=u.length;f<g;f++)u[f]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(r){this._radial=r,this._changed()},equals:function(r){if(r===this)return!0;if(r&&this._class===r._class){var u=this._stops,f=r._stops,g=u.length;if(g===f.length){for(var v=0;v<g;v++)if(!u[v].equals(f[v]))return!1;return!0}}return!1}}),zt=a.extend({_class:"GradientStop",initialize:function(u,f){var g=u,v=f;typeof u=="object"&&f===t&&(Array.isArray(u)&&typeof u[0]!="number"?(g=u[0],v=u[1]):("color"in u||"offset"in u||"rampPoint"in u)&&(g=u.color,v=u.offset||u.rampPoint||0)),this.setColor(g),this.setOffset(v)},clone:function(){return new zt(this._color.clone(),this._offset)},_serialize:function(r,u){var f=this._color,g=this._offset;return a.serialize(g==null?[f]:[f,g],r,!0,u)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(r){this._offset=r,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){pt._setOwner(this._color,null),this._color=pt._setOwner(pt.read(arguments,0),this,"setColor"),this._changed()},equals:function(r){return r===this||r&&this._class===r._class&&this._color.equals(r._color)&&this._offset==r._offset||!1}}),Ut=a.extend(new function(){var r={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new O,selectedColor:null},u=a.set({},r,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),f=a.set({},u,{fillColor:new pt}),g={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},v={beans:!0},w={_class:"Style",beans:!0,initialize:function(C,T,P){this._values={},this._owner=T,this._project=T&&T._project||P||Nt.project,this._defaults=!T||T instanceof Ne?u:T instanceof yt?f:r,C&&this.set(C)}};return a.each(u,function(S,C){var T=/Color$/.test(C),P=C==="shadowOffset",N=a.capitalize(C),B=g[C],L="set"+N,j="get"+N;w[L]=function(Y){var z=this._owner,H=z&&z._children,D=H&&H.length>0&&!(z instanceof Qe);if(D)for(var U=0,A=H.length;U<A;U++)H[U]._style[L](Y);if((C==="selectedColor"||!D)&&C in this._defaults){var V=this._values[C];V!==Y&&(T&&(V&&(pt._setOwner(V,null),V._canvasStyle=null),Y&&Y.constructor===pt&&(Y=pt._setOwner(Y,z,D&&L))),this._values[C]=Y,z&&z._changed(B||129))}},w[j]=function(Y){var z=this._owner,H=z&&z._children,D=H&&H.length>0&&!(z instanceof Qe),U;if(D&&!Y)for(var A=0,V=H.length;A<V;A++){var q=H[A]._style[j]();if(!A)U=q;else if(!a.equals(U,q))return t}else if(C in this._defaults){var U=this._values[C];if(U===t)U=this._defaults[C],U&&U.clone&&(U=U.clone());else{var J=T?pt:P?O:null;J&&!(U&&U.constructor===J)&&(this._values[C]=U=J.read([U],0,{readNull:!0,clone:!0}))}}return U&&T&&(U=pt._setOwner(U,z,D&&L)),U},v[j]=function(Y){return this._style[j](Y)},v[L]=function(Y){this._style[L](Y)}}),a.each({Font:"FontFamily",WindingRule:"FillRule"},function(S,C){var T="get"+C,P="set"+C;w[T]=v[T]="#get"+S,w[P]=v[P]="#set"+S}),F.inject(v),w},{set:function(r){var u=r instanceof Ut,f=u?r._values:r;if(f){for(var g in f)if(g in this._defaults){var v=f[g];this[g]=v&&u&&v.clone?v.clone():v}}},equals:function(r){function u(f,g,v){var w=f._values,S=g._values,C=g._defaults;for(var T in w){var P=w[T],N=S[T];if(!(v&&T in S)&&!a.equals(P,N===t?C[T]:N))return!1}return!0}return r===this||r&&this._class===r._class&&u(this,r)&&u(r,this,!0)||!1},_dispose:function(){var r;r=this.getFillColor(),r&&(r._canvasStyle=null),r=this.getStrokeColor(),r&&(r._canvasStyle=null),r=this.getShadowColor(),r&&(r._canvasStyle=null)},hasFill:function(){var r=this.getFillColor();return!!r&&r.alpha>0},hasStroke:function(){var r=this.getStrokeColor();return!!r&&r.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var r=this.getShadowColor();return!!r&&r.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var r=this.getFontSize();return this.getFontWeight()+" "+r+(/[a-z]/i.test(r+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function r(){var u=r.base.call(this),f=this.getFontSize();return/pt|em|%|px/.test(f)&&(f=this.getView().getPixelSize(f)),u??f*1.2}}),_t=new function(){function r(u,f,g,v){for(var w=["","webkit","moz","Moz","ms","o"],S=f[0].toUpperCase()+f.substring(1),C=0;C<6;C++){var T=w[C],P=T?T+S:f;if(P in u){if(g)u[P]=v;else return u[P];break}}}return{getStyles:function(u){var f=u&&u.nodeType!==9?u.ownerDocument:u,g=f&&f.defaultView;return g&&g.getComputedStyle(u,"")},getBounds:function(u,f){var g=u.ownerDocument,v=g.body,w=g.documentElement,S;try{S=u.getBoundingClientRect()}catch{S={left:0,top:0,width:0,height:0}}var C=S.left-(w.clientLeft||v.clientLeft||0),T=S.top-(w.clientTop||v.clientTop||0);if(!f){var P=g.defaultView;C+=P.pageXOffset||w.scrollLeft||v.scrollLeft,T+=P.pageYOffset||w.scrollTop||v.scrollTop}return new K(C,T,S.width,S.height)},getViewportBounds:function(u){var f=u.ownerDocument,g=f.defaultView,v=f.documentElement;return new K(0,0,g.innerWidth||v.clientWidth,g.innerHeight||v.clientHeight)},getOffset:function(u,f){return _t.getBounds(u,f).getPoint()},getSize:function(u){return _t.getBounds(u,!0).getSize()},isInvisible:function(u){return _t.getSize(u).equals(new W(0,0))},isInView:function(u){return!_t.isInvisible(u)&&_t.getViewportBounds(u).intersects(_t.getBounds(u,!0))},isInserted:function(u){return i.body.contains(u)},getPrefixed:function(u,f){return u&&r(u,f)},setPrefixed:function(u,f,g){if(typeof f=="object")for(var v in f)r(u,v,!0,f[v]);else r(u,f,!0,g)}}},At={add:function(r,u){if(r)for(var f in u)for(var g=u[f],v=f.split(/[\s,]+/g),w=0,S=v.length;w<S;w++){var C=v[w],T=r===i&&(C==="touchstart"||C==="touchmove")?{passive:!1}:!1;r.addEventListener(C,g,T)}},remove:function(r,u){if(r)for(var f in u)for(var g=u[f],v=f.split(/[\s,]+/g),w=0,S=v.length;w<S;w++)r.removeEventListener(v[w],g,!1)},getPoint:function(r){var u=r.targetTouches?r.targetTouches.length?r.targetTouches[0]:r.changedTouches[0]:r;return new O(u.pageX||u.clientX+i.documentElement.scrollLeft,u.pageY||u.clientY+i.documentElement.scrollTop)},getTarget:function(r){return r.target||r.srcElement},getRelatedTarget:function(r){return r.relatedTarget||r.toElement},getOffset:function(r,u){return At.getPoint(r).subtract(_t.getOffset(u||At.getTarget(r)))}};At.requestAnimationFrame=new function(){var r=_t.getPrefixed(n,"requestAnimationFrame"),u=!1,f=[],g;function v(){var w=f;f=[];for(var S=0,C=w.length;S<C;S++)w[S]();u=r&&f.length,u&&r(v)}return function(w){f.push(w),r?u||(r(v),u=!0):g||(g=setInterval(v,1e3/60))}};var en=a.extend(h,{_class:"View",initialize:function r(u,f){function g(B){return f[B]||parseInt(f.getAttribute(B),10)}function v(){var B=_t.getSize(f);return B.isNaN()||B.isZero()?new W(g("width"),g("height")):B}var w;if(n&&f){this._id=f.getAttribute("id"),this._id==null&&f.setAttribute("id",this._id="paper-view-"+r._id++),At.add(f,this._viewEvents);var S="none";if(_t.setPrefixed(f.style,{userDrag:S,userSelect:S,touchCallout:S,contentZooming:S,tapHighlightColor:"rgba(0,0,0,0)"}),p.hasAttribute(f,"resize")){var C=this;At.add(n,this._windowEvents={resize:function(){C.setViewSize(v())}})}if(w=v(),p.hasAttribute(f,"stats")&&typeof Stats<"u"){this._stats=new Stats;var T=this._stats.domElement,P=T.style,N=_t.getOffset(f);P.position="absolute",P.left=N.x+"px",P.top=N.y+"px",i.body.appendChild(T)}}else w=new W(f),f=null;this._project=u,this._scope=u._scope,this._element=f,this._pixelRatio||(this._pixelRatio=n&&n.devicePixelRatio||1),this._setElementSize(w.width,w.height),this._viewSize=w,r._views.push(this),r._viewsById[this._id]=this,(this._matrix=new le)._owner=this,r._focused||(r._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!Nt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;en._focused===this&&(en._focused=null),en._views.splice(en._views.indexOf(this),1),delete en._viewsById[this._id];var r=this._project;return r._view===this&&(r._view=null),At.remove(this._element,this._viewEvents),At.remove(n,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:a.each(F._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),function(r){this[r]={}},{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(r){this._autoUpdate=r,r&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var r=this;At.requestAnimationFrame(function(){if(r._requested=!1,r._animate){r.requestUpdate();var u=r._element;(!_t.getPrefixed(i,"hidden")||p.getAttribute(u,"keepalive")==="true")&&_t.isInView(u)&&r._handleFrame()}r._autoUpdate&&r.update()}),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){Nt=this._scope;var r=Date.now()/1e3,u=this._last?r-this._last:0;this._last=r,this.emit("frame",new a({delta:u,time:this._time+=u,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(r,u){var f=this._frameItems;u?(f[r._id]={item:r,time:0,count:0},++this._frameItemCount===1&&this.on("frame",this._handleFrameItems)):(delete f[r._id],--this._frameItemCount===0&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(r){for(var u in this._frameItems){var f=this._frameItems[u];f.item.emit("frame",new a(r,{time:f.time+=r.delta,count:f.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=t},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return this._pixelRatio*72},getViewSize:function(){var r=this._viewSize;return new ee(r.width,r.height,this,"setViewSize")},setViewSize:function(){var r=W.read(arguments),u=r.subtract(this._viewSize);u.isZero()||(this._setElementSize(r.width,r.height),this._viewSize.set(r),this._changed(),this.emit("resize",{size:r,delta:u}),this._autoUpdate&&this.update())},_setElementSize:function(r,u){var f=this._element;f&&(f.width!==r&&(f.width=r),f.height!==u&&(f.height=u))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new K(new O,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return _t.isInView(this._element)},isInserted:function(){return _t.isInserted(this._element)},getPixelSize:function(r){var u=this._element,f;if(u){var g=u.parentNode,v=i.createElement("div");v.style.fontSize=r,g.appendChild(v),f=parseFloat(_t.getStyles(v).fontSize),g.removeChild(v)}else f=parseFloat(f);return f},getTextWidth:function(r,u){return 0}},a.each(["rotate","scale","shear","skew"],function(r){var u=r==="rotate";this[r]=function(){var f=arguments,g=(u?a:O).read(f),v=O.read(f,0,{readNull:!0});return this.transform(new le()[r](g,v||this.getCenter(!0)))}},{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var r=new le;return this.transform(r.translate.apply(r,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var r=O.read(arguments);this.translate(this.getCenter().subtract(r))},getZoom:function(){var r=this._decompose().scaling;return(r.x+r.y)/2},setZoom:function(r){this.transform(new le().scale(r/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(r){var u=this.getRotation();u!=null&&r!=null&&this.rotate(r-u)},getScaling:function(){var r=this._decompose().scaling;return new Q(r.x,r.y,this,"setScaling")},setScaling:function(){var r=this.getScaling(),u=O.read(arguments,0,{clone:!0,readNull:!0});r&&u&&this.scale(u.x/r.x,u.y/r.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var r=this._matrix;r.set.apply(r,arguments)},transform:function(r){this._matrix.append(r)},scrollBy:function(){this.translate(O.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(O.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(O.read(arguments))},getEventPoint:function(r){return this.viewToProject(At.getOffset(r,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(r,u){i&&typeof u=="string"&&(u=i.getElementById(u));var f=n?la:en;return new f(r,u)}}},new function(){if(!n)return;var r,u,f=!1,g=!1;function v(ne){var ce=At.getTarget(ne);return ce.getAttribute&&en._viewsById[ce.getAttribute("id")]}function w(){var ne=en._focused;if(!ne||!ne.isVisible()){for(var ce=0,fe=en._views.length;ce<fe;ce++)if((ne=en._views[ce]).isVisible()){en._focused=u=ne;break}}}function S(ne,ce,fe){ne._handleMouseEvent("mousemove",ce,fe)}var C=n.navigator,T,P,N;C.pointerEnabled||C.msPointerEnabled?(T="pointerdown MSPointerDown",P="pointermove MSPointerMove",N="pointerup pointercancel MSPointerUp MSPointerCancel"):(T="touchstart",P="touchmove",N="touchend touchcancel","ontouchstart"in n&&C.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(T+=" mousedown",P+=" mousemove",N+=" mouseup"));var B={},L={mouseout:function(ne){var ce=en._focused,fe=At.getRelatedTarget(ne);if(ce&&(!fe||fe.nodeName==="HTML")){var ye=At.getOffset(ne,ce._element),we=ye.x,Ee=Math.abs,Be=Ee(we),Ue=1<<25,et=Be-Ue;ye.x=Ee(et)<Be?et*(we<0?-1:1):we,S(ce,ne,ce.viewToProject(ye))}},scroll:w};B[T]=function(ne){var ce=en._focused=v(ne);f||(f=!0,ce._handleMouseEvent("mousedown",ne))},L[P]=function(ne){var ce=en._focused;if(!g){var fe=v(ne);fe?ce!==fe&&(ce&&S(ce,ne),r||(r=ce),ce=en._focused=u=fe):u&&u===ce&&(r&&!r.isInserted()&&(r=null),ce=en._focused=r,r=null,w())}ce&&S(ce,ne)},L[T]=function(){g=!0},L[N]=function(ne){var ce=en._focused;ce&&f&&ce._handleMouseEvent("mouseup",ne),g=f=!1},At.add(i,L),At.add(n,{load:w});var j=!1,Y=!1,z={doubleclick:"click",mousedrag:"mousemove"},H=!1,D,U,A,V,q,J,X,te;function ie(ne,ce,fe,ye,we,Ee,Be){var Ue=!1,et;function it(Ie,De){if(Ie.responds(De)){if(et||(et=new ua(De,ye,we,ce||Ie,Ee?we.subtract(Ee):null)),Ie.emit(De,et)&&(j=!0,et.prevented&&(Y=!0),et.stopped))return Ue=!0}else{var tt=z[De];if(tt)return it(Ie,tt)}}for(;ne&&ne!==Be&&!it(ne,fe);)ne=ne._parent;return Ue}function se(ne,ce,fe,ye,we,Ee){return ne._project.removeOn(fe),Y=j=!1,q&&ie(q,null,fe,ye,we,Ee)||ce&&ce!==q&&!ce.isDescendant(q)&&ie(ce,null,fe==="mousedrag"?"mousemove":fe,ye,we,Ee,q)||ie(ne,q||ce||ne,fe,ye,we,Ee)}var he={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:B,_handleMouseEvent:function(ne,ce,fe){var ye=this._itemEvents,we=ye.native[ne],Ee=ne==="mousemove",Be=this._scope.tool,Ue=this;function et(xt){return ye.virtual[xt]||Ue.responds(xt)||Be&&Be.responds(xt)}Ee&&f&&et("mousedrag")&&(ne="mousedrag"),fe||(fe=this.getEventPoint(ce));var it=this.getBounds().contains(fe),Ie=we&&it&&Ue._project.hitTest(fe,{tolerance:0,fill:!0,stroke:!0}),De=Ie&&Ie.item||null,tt=!1,at={};if(at[ne.substr(5)]=!0,we&&De!==V&&(V&&ie(V,null,"mouseleave",ce,fe),De&&ie(De,null,"mouseenter",ce,fe),V=De),H^it&&(ie(this,null,it?"mouseenter":"mouseleave",ce,fe),tt=!0),(it||at.drag)&&!fe.equals(U)&&(se(this,De,Ee?ne:"mousemove",ce,fe,U),tt=!0),H=it,at.down&&it||at.up&&D){if(se(this,De,ne,ce,fe,D),at.down){if(te=De===J&&Date.now()-X<300,A=J=De,!Y&&De){for(var st=De;st&&!st.responds("mousedrag");)st=st._parent;st&&(q=De)}D=fe}else at.up&&(!Y&&De===A&&(X=Date.now(),se(this,De,te?"doubleclick":"click",ce,fe,D),te=!1),A=q=null);H=!1,tt=!0}U=fe,tt&&Be&&(j=Be._handleMouseEvent(ne,ce,fe,at)||j),ce.cancelable!==!1&&(j&&!at.move||at.down&&et("mouseup"))&&ce.preventDefault()},_handleKeyEvent:function(ne,ce,fe,ye){var we=this._scope,Ee=we.tool,Be;function Ue(et){et.responds(ne)&&(Nt=we,et.emit(ne,Be=Be||new Os(ne,ce,fe,ye)))}this.isVisible()&&(Ue(this),Ee&&Ee.responds(ne)&&Ue(Ee))},_countItemEvent:function(ne,ce){var fe=this._itemEvents,ye=fe.native,we=fe.virtual;for(var Ee in he)ye[Ee]=(ye[Ee]||0)+(he[Ee][ne]||0)*ce;we[ne]=(we[ne]||0)+ce},statics:{updateFocus:w,_resetState:function(){f=g=j=H=!1,r=u=D=U=A=V=q=J=X=te=null}}}}),la=en.extend({_class:"CanvasView",initialize:function(u,f){if(!(f instanceof n.HTMLCanvasElement)){var g=W.read(arguments,1);if(g.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+a.slice(arguments,1));f=tn.getCanvas(g)}var v=this._context=f.getContext("2d");if(v.save(),this._pixelRatio=1,!/^off|false$/.test(p.getAttribute(f,"hidpi"))){var w=n.devicePixelRatio||1,S=_t.getPrefixed(v,"backingStorePixelRatio")||1;this._pixelRatio=w/S}en.call(this,u,f),this._needsUpdate=!0},remove:function r(){return this._context.restore(),r.base.call(this)},_setElementSize:function r(u,f){var g=this._pixelRatio;if(r.base.call(this,u*g,f*g),g!==1){var v=this._element,w=this._context;if(!p.hasAttribute(v,"resize")){var S=v.style;S.width=u+"px",S.height=f+"px"}w.restore(),w.save(),w.scale(g,g)}},getContext:function(){return this._context},getPixelSize:function r(u){var f=Nt.agent,g;if(f&&f.firefox)g=r.base.call(this,u);else{var v=this._context,w=v.font;v.font=u+" serif",g=parseFloat(v.font),v.font=w}return g},getTextWidth:function(r,u){var f=this._context,g=f.font,v=0;f.font=r;for(var w=0,S=u.length;w<S;w++)v=Math.max(v,f.measureText(u[w]).width);return f.font=g,v},update:function(){if(!this._needsUpdate)return!1;var r=this._project,u=this._context,f=this._viewSize;return u.clearRect(0,0,f.width+1,f.height+1),r&&r.draw(u,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),Rr=a.extend({_class:"Event",initialize:function(u){this.event=u,this.type=u&&u.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Di.modifiers}}),Os=Rr.extend({_class:"KeyEvent",initialize:function(u,f,g,v){this.type=u,this.event=f,this.key=g,this.character=v},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Di=new function(){var r={"	":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},u={tab:"	",space:" ",enter:"\r"},f={},g={},v,w,S=new a({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var P=Nt&&Nt.agent;return P&&P.mac?this.meta:this.control}}});function C(P){var N=P.key||P.keyIdentifier;return N=/^U\+/.test(N)?String.fromCharCode(parseInt(N.substr(2),16)):/^Arrow[A-Z]/.test(N)?N.substr(5):N==="Unidentified"||N===t?String.fromCharCode(P.keyCode):N,r[N]||(N.length>1?a.hyphenate(N):N.toLowerCase())}function T(P,N,B,L){var j=en._focused,Y;if(f[N]=P,P?g[N]=B:delete g[N],N.length>1&&(Y=a.camelize(N))in S){S[Y]=P;var z=Nt&&Nt.agent;if(Y==="meta"&&z&&z.mac)if(P)v={};else{for(var H in v)H in g&&T(!1,H,v[H],L);v=null}}else P&&v&&(v[N]=B);j&&j._handleKeyEvent(P?"keydown":"keyup",L,N,B)}return At.add(i,{keydown:function(P){var N=C(P),B=Nt&&Nt.agent;N.length>1||B&&B.chrome&&(P.altKey||B.mac&&P.metaKey||!B.mac&&P.ctrlKey)?T(!0,N,u[N]||(N.length>1?"":N),P):w=N},keypress:function(P){if(w){var N=C(P),B=P.charCode,L=B>=32?String.fromCharCode(B):N.length>1?"":N;N!==w&&(N=L.toLowerCase()),T(!0,N,L,P),w=null}},keyup:function(P){var N=C(P);N in g&&T(!1,N,g[N],P)}}),At.add(n,{blur:function(P){for(var N in g)T(!1,N,g[N],P)}}),{modifiers:S,isDown:function(P){return!!f[P]}}},ua=Rr.extend({_class:"MouseEvent",initialize:function(u,f,g,v,w){this.type=u,this.event=f,this.point=g,this.target=v,this.delta=w},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),Nr=Rr.extend({_class:"ToolEvent",_item:null,initialize:function(u,f,g){this.tool=u,this.type=f,this.event=g},_choosePoint:function(r,u){return r||(u?u.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(r){this._point=r},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(r){this._lastPoint=r},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(r){this._downPoint=r},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(r){this._middlePoint=r},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(r){this._delta=r},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(r){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=r},getItem:function(){if(!this._item){var r=this.tool._scope.project.hitTest(this.getPoint());if(r){for(var u=r.item,f=u._parent;/^(Group|CompoundPath)$/.test(f._class);)u=f,f=f._parent;this._item=u}}return this._item},setItem:function(r){this._item=r},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Ri=m.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(u){m.call(this),this._moveCount=-1,this._downCount=-1,this.set(u)},getMinDistance:function(){return this._minDistance},setMinDistance:function(r){this._minDistance=r,r!=null&&this._maxDistance!=null&&r>this._maxDistance&&(this._maxDistance=r)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(r){this._maxDistance=r,this._minDistance!=null&&r!=null&&r<this._minDistance&&(this._minDistance=r)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(r){this._minDistance=this._maxDistance=r},_handleMouseEvent:function(r,u,f,g){Nt=this._scope,g.drag&&!this.responds(r)&&(r="mousemove");var v=g.move||g.drag,w=this.responds(r),S=!1,C=this;function T(N,B){var L=f,j=v?C._point:C._downPoint||L;if(v){if(C._moveCount>=0&&L.equals(j))return!1;if(j&&(N!=null||B!=null)){var Y=L.subtract(j),z=Y.getLength();if(z<(N||0))return!1;B&&(L=j.add(Y.normalize(Math.min(z,B))))}C._moveCount++}return C._point=L,C._lastPoint=j||L,g.down&&(C._moveCount=-1,C._downPoint=L,C._downCount++),!0}function P(){w&&(S=C.emit(r,new Nr(C,r,u))||S)}if(g.down)T(),P();else if(g.up)T(null,this._maxDistance),P();else if(w)for(;T(this._minDistance,this._maxDistance);)P();return S}}),Ni=a.extend(h,{_class:"Tween",statics:{easings:new a({linear:function(r){return r},easeInQuad:function(r){return r*r},easeOutQuad:function(r){return r*(2-r)},easeInOutQuad:function(r){return r<.5?2*r*r:-1+2*(2-r)*r},easeInCubic:function(r){return r*r*r},easeOutCubic:function(r){return--r*r*r+1},easeInOutCubic:function(r){return r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1},easeInQuart:function(r){return r*r*r*r},easeOutQuart:function(r){return 1- --r*r*r*r},easeInOutQuart:function(r){return r<.5?8*r*r*r*r:1-8*--r*r*r*r},easeInQuint:function(r){return r*r*r*r*r},easeOutQuint:function(r){return 1+--r*r*r*r*r},easeInOutQuint:function(r){return r<.5?16*r*r*r*r*r:1+16*--r*r*r*r*r}})},initialize:function r(u,f,g,v,w,S){this.object=u;var C=typeof w,T=C==="function";this.type=T?C:C==="string"?w:"linear",this.easing=T?w:r.easings[this.type],this.duration=v,this.running=!1,this._then=null,this._startTime=null;var P=f||g;this._keys=P?Object.keys(P):[],this._parsedKeys=this._parseKeys(this._keys),this._from=P&&this._getState(f),this._to=P&&this._getState(g),S!==!1&&this.start()},then:function(r){return this._then=r,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(r){if(this.running){r>=1&&(r=1,this.running=!1);for(var u=this.easing(r),f=this._keys,g=function(N){return typeof N=="function"?N(u,r):N},v=0,w=f&&f.length;v<w;v++){var S=f[v],C=g(this._from[S]),T=g(this._to[S]),P=C&&T&&C.__add&&T.__add?T.__subtract(C).__multiply(u).__add(C):(T-C)*u+C;this._setProperty(this._parsedKeys[S],P)}this.responds("update")&&this.emit("update",new a({progress:r,factor:u})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(r){var u=this._startTime,f=u?(r-u)/this.duration:0;u||(this._startTime=r),this.update(f)},_getState:function(r){for(var u=this._keys,f={},g=0,v=u.length;g<v;g++){var w=u[g],S=this._parsedKeys[w],C=this._getProperty(S),T;if(r){var P=this._resolveValue(C,r[w]);this._setProperty(S,P),T=this._getProperty(S),T=T&&T.clone?T.clone():T,this._setProperty(S,C)}else T=C&&C.clone?C.clone():C;f[w]=T}return f},_resolveValue:function(r,u){if(u){if(Array.isArray(u)&&u.length===2){var f=u[0];return f&&f.match&&f.match(/^[+\-\*\/]=/)?this._calculate(r,f[0],u[1]):u}else if(typeof u=="string"){var g=u.match(/^[+\-*/]=(.*)/);if(g){var v=JSON.parse(g[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(r,u[0],v)}}}return u},_calculate:function(r,u,f){return Nt.PaperScript.calculateBinary(r,u,f)},_parseKeys:function(r){for(var u={},f=0,g=r.length;f<g;f++){var v=r[f],w=v.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");u[v]=w.split("/")}return u},_getProperty:function(r,u){for(var f=this.object,g=0,v=r.length-(u||0);g<v&&f;g++)f=f[r[g]];return f},_setProperty:function(r,u){var f=this._getProperty(r,1);f&&(f[r[r.length-1]]=u)}}),qr={request:function(r){var u=new e.XMLHttpRequest;return u.open((r.method||"get").toUpperCase(),r.url,a.pick(r.async,!0)),r.mimeType&&u.overrideMimeType(r.mimeType),u.onload=function(){var f=u.status;f===0||f===200?r.onLoad&&r.onLoad.call(u,u.responseText):u.onerror()},u.onerror=function(){var f=u.status,g='Could not load "'+r.url+'" (Status: '+f+")";if(r.onError)r.onError(g,f);else throw new Error(g)},u.send(null)}},tn=a.exports.CanvasProvider={canvases:[],getCanvas:function(r,u,f){if(!n)return null;var g,v=!0;typeof r=="object"&&(u=r.height,r=r.width),this.canvases.length?g=this.canvases.pop():(g=i.createElement("canvas"),v=!1);var w=g.getContext("2d",f||{});if(!w)throw new Error("Canvas "+g+" is unable to provide a 2D context.");return g.width===r&&g.height===u?v&&w.clearRect(0,0,r+1,u+1):(g.width=r,g.height=u),w.save(),g},getContext:function(r,u,f){var g=this.getCanvas(r,u,f);return g?g.getContext("2d",f||{}):null},release:function(r){var u=r&&r.canvas?r.canvas:r;u&&u.getContext&&(u.getContext("2d").restore(),this.canvases.push(u))}},pi=new function(){var r=Math.min,u=Math.max,f=Math.abs,g,v,w,S,C,T,P,N,B,L,j;function Y(q,J,X){return .2989*q+.587*J+.114*X}function z(q,J,X,se){var ie=se-Y(q,J,X);B=q+ie,L=J+ie,j=X+ie;var se=Y(B,L,j),he=r(B,L,j),ne=u(B,L,j);if(he<0){var ce=se-he;B=se+(B-se)*se/ce,L=se+(L-se)*se/ce,j=se+(j-se)*se/ce}if(ne>255){var fe=255-se,ye=ne-se;B=se+(B-se)*fe/ye,L=se+(L-se)*fe/ye,j=se+(j-se)*fe/ye}}function H(q,J,X){return u(q,J,X)-r(q,J,X)}function D(q,J,X,te){var ie=[q,J,X],se=u(q,J,X),he=r(q,J,X),ne;he=he===q?0:he===J?1:2,se=se===q?0:se===J?1:2,ne=r(he,se)===0?u(he,se)===1?2:1:0,ie[se]>ie[he]?(ie[ne]=(ie[ne]-ie[he])*te/(ie[se]-ie[he]),ie[se]=te):ie[ne]=ie[se]=0,ie[he]=0,B=ie[0],L=ie[1],j=ie[2]}var U={multiply:function(){B=C*g/255,L=T*v/255,j=P*w/255},screen:function(){B=C+g-C*g/255,L=T+v-T*v/255,j=P+w-P*w/255},overlay:function(){B=C<128?2*C*g/255:255-2*(255-C)*(255-g)/255,L=T<128?2*T*v/255:255-2*(255-T)*(255-v)/255,j=P<128?2*P*w/255:255-2*(255-P)*(255-w)/255},"soft-light":function(){var q=g*C/255;B=q+C*(255-(255-C)*(255-g)/255-q)/255,q=v*T/255,L=q+T*(255-(255-T)*(255-v)/255-q)/255,q=w*P/255,j=q+P*(255-(255-P)*(255-w)/255-q)/255},"hard-light":function(){B=g<128?2*g*C/255:255-2*(255-g)*(255-C)/255,L=v<128?2*v*T/255:255-2*(255-v)*(255-T)/255,j=w<128?2*w*P/255:255-2*(255-w)*(255-P)/255},"color-dodge":function(){B=C===0?0:g===255?255:r(255,255*C/(255-g)),L=T===0?0:v===255?255:r(255,255*T/(255-v)),j=P===0?0:w===255?255:r(255,255*P/(255-w))},"color-burn":function(){B=C===255?255:g===0?0:u(0,255-(255-C)*255/g),L=T===255?255:v===0?0:u(0,255-(255-T)*255/v),j=P===255?255:w===0?0:u(0,255-(255-P)*255/w)},darken:function(){B=C<g?C:g,L=T<v?T:v,j=P<w?P:w},lighten:function(){B=C>g?C:g,L=T>v?T:v,j=P>w?P:w},difference:function(){B=C-g,B<0&&(B=-B),L=T-v,L<0&&(L=-L),j=P-w,j<0&&(j=-j)},exclusion:function(){B=C+g*(255-C-C)/255,L=T+v*(255-T-T)/255,j=P+w*(255-P-P)/255},hue:function(){D(g,v,w,H(C,T,P)),z(B,L,j,Y(C,T,P))},saturation:function(){D(C,T,P,H(g,v,w)),z(B,L,j,Y(C,T,P))},luminosity:function(){z(C,T,P,Y(g,v,w))},color:function(){z(g,v,w,Y(C,T,P))},add:function(){B=r(C+g,255),L=r(T+v,255),j=r(P+w,255)},subtract:function(){B=u(C-g,0),L=u(T-v,0),j=u(P-w,0)},average:function(){B=(C+g)/2,L=(T+v)/2,j=(P+w)/2},negation:function(){B=255-f(255-g-C),L=255-f(255-v-T),j=255-f(255-w-P)}},A=this.nativeModes=a.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(q){this[q]=!0},{}),V=tn.getContext(1,1,{willReadFrequently:!0});V&&(a.each(U,function(q,J){var X=J==="darken",te=!1;V.save();try{V.fillStyle=X?"#300":"#a00",V.fillRect(0,0,1,1),V.globalCompositeOperation=J,V.globalCompositeOperation===J&&(V.fillStyle=X?"#a00":"#300",V.fillRect(0,0,1,1),te=V.getImageData(0,0,1,1).data[0]!==X?170:51)}catch{}V.restore(),A[J]=te}),tn.release(V)),this.process=function(q,J,X,te,ie){var se=J.canvas,he=q==="normal";if(he||A[q])X.save(),X.setTransform(1,0,0,1,0,0),X.globalAlpha=te,he||(X.globalCompositeOperation=q),X.drawImage(se,ie.x,ie.y),X.restore();else{var ne=U[q];if(!ne)return;for(var ce=X.getImageData(ie.x,ie.y,se.width,se.height),fe=ce.data,ye=J.getImageData(0,0,se.width,se.height).data,we=0,Ee=fe.length;we<Ee;we+=4){g=ye[we],C=fe[we],v=ye[we+1],T=fe[we+1],w=ye[we+2],P=fe[we+2],S=ye[we+3],N=fe[we+3],ne();var Be=S*te/255,Ue=1-Be;fe[we]=Be*B+Ue*C,fe[we+1]=Be*L+Ue*T,fe[we+2]=Be*j+Ue*P,fe[we+3]=S*te+Ue*N}X.putImageData(ce,ie.x,ie.y)}}},Gt=new function(){var r="http://www.w3.org/2000/svg",u="http://www.w3.org/2000/xmlns",f="http://www.w3.org/1999/xlink",g={href:f,xlink:u,xmlns:u+"/","xmlns:xlink":u+"/"};function v(C,T,P){return S(i.createElementNS(r,C),T,P)}function w(C,T){var P=g[T],N=P?C.getAttributeNS(P,T):C.getAttribute(T);return N==="null"?null:N}function S(C,T,P){for(var N in T){var B=T[N],L=g[N];typeof B=="number"&&P&&(B=P.number(B)),L?C.setAttributeNS(L,N,B):C.setAttribute(N,B)}return C}return{svg:r,xmlns:u,xlink:f,create:v,get:w,set:S}},Ps=a.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(r,u){return!u&&(r instanceof ze||r instanceof qe||r instanceof yt)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},function(r,u){var f=a.capitalize(u),g=r[2];this[u]={type:r[1],property:u,attribute:r[0],toSVG:g,fromSVG:g&&a.each(g,function(v,w){this[v]=w},{}),exportFilter:r[3],get:"get"+f,set:"set"+f}},{});new function(){var r;function u(U,A,V){var q=new a,J=U.getTranslation();if(A){var X;U.isInvertible()?(U=U._shiftless(),X=U._inverseTransform(J),J=null):X=new O,q[V?"cx":"x"]=X.x,q[V?"cy":"y"]=X.y}if(!U.isIdentity()){var te=U.decompose();if(te){var ie=[],se=te.rotation,he=te.scaling,ne=te.skewing;J&&!J.isZero()&&ie.push("translate("+r.point(J)+")"),se&&ie.push("rotate("+r.number(se)+")"),(!E.isZero(he.x-1)||!E.isZero(he.y-1))&&ie.push("scale("+r.point(he)+")"),ne.x&&ie.push("skewX("+r.number(ne.x)+")"),ne.y&&ie.push("skewY("+r.number(ne.y)+")"),q.transform=ie.join(" ")}else q.transform="matrix("+U.getValues().join(",")+")"}return q}function f(U,A){for(var V=u(U._matrix),q=U._children,J=Gt.create("g",V,r),X=0,te=q.length;X<te;X++){var ie=q[X],se=H(ie,A);if(se)if(ie.isClipMask()){var he=Gt.create("clipPath");he.appendChild(se),Y(ie,he,"clip"),Gt.set(J,{"clip-path":"url(#"+he.id+")"})}else J.appendChild(se)}return J}function g(U,A){var V=u(U._matrix,!0),q=U.getSize(),J=U.getImage();return V.x-=q.width/2,V.y-=q.height/2,V.width=q.width,V.height=q.height,V.href=A.embedImages==!1&&J&&J.src||U.toDataURL(),Gt.create("image",V,r)}function v(U,A){var V=A.matchShapes;if(V){var q=U.toShape(!1);if(q)return w(q)}var J=U._segments,X=J.length,te,ie=u(U._matrix);if(V&&X>=2&&!U.hasHandles())if(X>2){te=U._closed?"polygon":"polyline";for(var se=[],he=0;he<X;he++)se.push(r.point(J[he]._point));ie.points=se.join(" ")}else{te="line";var ne=J[0]._point,ce=J[1]._point;ie.set({x1:ne.x,y1:ne.y,x2:ce.x,y2:ce.y})}else te="path",ie.d=U.getPathData(null,A.precision);return Gt.create(te,ie,r)}function w(U){var A=U._type,V=U._radius,q=u(U._matrix,!0,A!=="rectangle");if(A==="rectangle"){A="rect";var J=U._size,X=J.width,te=J.height;q.x-=X/2,q.y-=te/2,q.width=X,q.height=te,V.isZero()&&(V=null)}return V&&(A==="circle"?q.r=V:(q.rx=V.width,q.ry=V.height)),Gt.create(A,q,r)}function S(U,A){var V=u(U._matrix),q=U.getPathData(null,A.precision);return q&&(V.d=q),Gt.create("path",V,r)}function C(U,A){var V=u(U._matrix,!0),q=U._definition,J=j(q,"symbol"),X=q._item,te=X.getStrokeBounds();return J||(J=Gt.create("symbol",{viewBox:r.rectangle(te)}),J.appendChild(H(X,A)),Y(q,J,"symbol")),V.href="#"+J.id,V.x+=te.x,V.y+=te.y,V.width=te.width,V.height=te.height,V.overflow="visible",Gt.create("use",V,r)}function T(U){var A=j(U,"color");if(!A){var V=U.getGradient(),q=V._radial,J=U.getOrigin(),X=U.getDestination(),te;if(q){te={cx:J.x,cy:J.y,r:J.getDistance(X)};var ie=U.getHighlight();ie&&(te.fx=ie.x,te.fy=ie.y)}else te={x1:J.x,y1:J.y,x2:X.x,y2:X.y};te.gradientUnits="userSpaceOnUse",A=Gt.create((q?"radial":"linear")+"Gradient",te,r);for(var se=V._stops,he=0,ne=se.length;he<ne;he++){var ce=se[he],fe=ce._color,ye=fe.getAlpha(),we=ce._offset;te={offset:we??he/(ne-1)},fe&&(te["stop-color"]=fe.toCSS(!0)),ye<1&&(te["stop-opacity"]=ye),A.appendChild(Gt.create("stop",te,r))}Y(U,A,"color")}return"url(#"+A.id+")"}function P(U){var A=Gt.create("text",u(U._matrix,!0),r);return A.textContent=U._content,A}var N={Group:f,Layer:f,Raster:g,Path:v,Shape:w,CompoundPath:S,SymbolItem:C,PointText:P};function B(U,A,V,q){var J={},X=!q&&U.getParent(),te=[];return U._name!=null&&(J.id=U._name),a.each(Ps,function(ie){var se=ie.get,he=ie.type,ne=U[se]();if(ie.exportFilter?ie.exportFilter(U,ne):V.reduceAttributes==!1||!X||!a.equals(X[se](),ne)){if(he==="color"&&ne!=null){var ce=ne.getAlpha();ce<1&&(J[ie.attribute+"-opacity"]=ce)}he==="style"?te.push(ie.attribute+": "+ne):J[ie.attribute]=ne==null?"none":he==="color"?ne.gradient?T(ne):ne.toCSS(!0):he==="array"?ne.join(","):he==="lookup"?ie.toSVG[ne]:ne}}),te.length&&(J.style=te.join(";")),J.opacity===1&&delete J.opacity,U._visible||(J.visibility="hidden"),Gt.set(A,J,r)}var L;function j(U,A){return L||(L={ids:{},svgs:{}}),U&&L.svgs[A+"-"+(U._id||U.__id||(U.__id=I.get("svg")))]}function Y(U,A,V){L||j();var q=L.ids[V]=(L.ids[V]||0)+1;A.id=V+"-"+q,L.svgs[V+"-"+(U._id||U.__id)]=A}function z(U,A){var V=U,q=null;if(L){V=U.nodeName.toLowerCase()==="svg"&&U;for(var J in L.svgs)q||(V||(V=Gt.create("svg"),V.appendChild(U)),q=V.insertBefore(Gt.create("defs"),V.firstChild)),q.appendChild(L.svgs[J]);L=null}return A.asString?new e.XMLSerializer().serializeToString(V):V}function H(U,A,V){var q=N[U._class],J=q&&q(U,A);if(J){var X=A.onExport;X&&(J=X(U,J,A)||J);var te=JSON.stringify(U._data);te&&te!=="{}"&&te!=="null"&&J.setAttribute("data-paper-data",te)}return J&&B(U,J,A,V)}function D(U){return U||(U={}),r=new b(U.precision),U}F.inject({exportSVG:function(U){return U=D(U),z(H(this,U,!0),U)}}),xe.inject({exportSVG:function(U){U=D(U);var A=this._children,V=this.getView(),q=a.pick(U.bounds,"view"),J=U.matrix||q==="view"&&V._matrix,X=J&&le.read([J]),te=q==="view"?new K([0,0],V.getViewSize()):q==="content"?F._getBounds(A,X,{stroke:!0}).rect:K.read([q],0,{readNull:!0}),ie={version:"1.1",xmlns:Gt.svg,"xmlns:xlink":Gt.xlink};te&&(ie.width=te.width,ie.height=te.height,(te.x||te.x===0||te.y||te.y===0)&&(ie.viewBox=r.rectangle(te)));var se=Gt.create("svg",ie,r),he=se;X&&!X.isIdentity()&&(he=se.appendChild(Gt.create("g",u(X),r)));for(var ne=0,ce=A.length;ne<ce;ne++)he.appendChild(H(A[ne],U,!0));return z(se,U)}})},new function(){var r={},u;function f(A,V,q,J,X,te){var ie=Gt.get(A,V)||te,se=ie==null?J?null:q?"":0:q?ie:parseFloat(ie);return/%\s*$/.test(ie)?se/100*(X?1:u[/x|^width/.test(V)?"width":"height"]):se}function g(A,V,q,J,X,te,ie){return V=f(A,V||"x",!1,J,X,te),q=f(A,q||"y",!1,J,X,ie),J&&(V==null||q==null)?null:new O(V,q)}function v(A,V,q,J,X){return V=f(A,V||"width",!1,J,X),q=f(A,q||"height",!1,J,X),J&&(V==null||q==null)?null:new W(V,q)}function w(A,V,q){return A==="none"?null:V==="number"?parseFloat(A):V==="array"?A?A.split(/[\s,]+/g).map(parseFloat):[]:V==="color"?H(A)||A:V==="lookup"?q[A]:A}function S(A,V,q,J){var X=A.childNodes,te=V==="clippath",ie=V==="defs",se=new Ne,he=se._project,ne=he._currentStyle,ce=[];if(!te&&!ie&&(se=z(se,A,J),he._currentStyle=se._style.clone()),J)for(var fe=A.querySelectorAll("defs"),ye=0,we=fe.length;ye<we;ye++)D(fe[ye],q,!1);for(var ye=0,we=X.length;ye<we;ye++){var Ee=X[ye],Be;Ee.nodeType===1&&!/^defs$/i.test(Ee.nodeName)&&(Be=D(Ee,q,!1))&&!(Be instanceof Ze)&&ce.push(Be)}return se.addChildren(ce),te&&(se=z(se.reduce(),A,J)),he._currentStyle=ne,(te||ie)&&(se.remove(),se=null),se}function C(A,V){for(var q=A.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),J=[],X=0,te=q.length;X<te;X+=2)J.push(new O(parseFloat(q[X]),parseFloat(q[X+1])));var ie=new Xe(J);return V==="polygon"&&ie.closePath(),ie}function T(A){return ze.create(A.getAttribute("d"))}function P(A,V){var q=(f(A,"href",!0)||"").substring(1),J=V==="radialgradient",X;if(q)X=r[q].getGradient(),X._radial^J&&(X=X.clone(),X._radial=J);else{for(var te=A.childNodes,ie=[],se=0,he=te.length;se<he;se++){var ne=te[se];ne.nodeType===1&&ie.push(z(new zt,ne))}X=new Mt(ie,J)}var ce,fe,ye,we=f(A,"gradientUnits",!0)!=="userSpaceOnUse";J?(ce=g(A,"cx","cy",!1,we,"50%","50%"),fe=ce.add(f(A,"r",!1,!1,we,"50%"),0),ye=g(A,"fx","fy",!0,we)):(ce=g(A,"x1","y1",!1,we,"0%","0%"),fe=g(A,"x2","y2",!1,we,"100%","0%"));var Ee=z(new pt(X,ce,fe,ye),A);return Ee._scaleToBounds=we,null}var N={"#document":function(A,V,q,J){for(var X=A.childNodes,te=0,ie=X.length;te<ie;te++){var se=X[te];if(se.nodeType===1)return D(se,q,J)}},g:S,svg:S,clippath:S,polygon:C,polyline:C,path:T,lineargradient:P,radialgradient:P,image:function(A){var V=new ot(f(A,"href",!0));return V.on("load",function(){var q=v(A);this.setSize(q);var J=g(A).add(q.divide(2));this._matrix.append(new le().translate(J))}),V},symbol:function(A,V,q,J){return new Ze(S(A,V,q,J),!0)},defs:S,use:function(A){var V=(f(A,"href",!0)||"").substring(1),q=r[V],J=g(A);return q?q instanceof Ze?q.place(J):q.clone().translate(J):null},circle:function(A){return new qe.Circle(g(A,"cx","cy"),f(A,"r"))},ellipse:function(A){return new qe.Ellipse({center:g(A,"cx","cy"),radius:v(A,"rx","ry")})},rect:function(A){return new qe.Rectangle(new K(g(A),v(A)),v(A,"rx","ry"))},line:function(A){return new Xe.Line(g(A,"x1","y1"),g(A,"x2","y2"))},text:function(A){var V=new Ct(g(A).add(g(A,"dx","dy")));return V.setContent(A.textContent.trim()||""),V},switch:S};function B(A,V,q,J){if(A.transform){for(var X=(J.getAttribute(q)||"").split(/\)\s*/g),te=new le,ie=0,se=X.length;ie<se;ie++){var he=X[ie];if(!he)break;for(var ne=he.split(/\(\s*/),ce=ne[0].trim(),fe=ne[1].split(/[\s,]+/g),ye=0,we=fe.length;ye<we;ye++)fe[ye]=parseFloat(fe[ye]);switch(ce){case"matrix":te.append(new le(fe[0],fe[1],fe[2],fe[3],fe[4],fe[5]));break;case"rotate":te.rotate(fe[0],fe[1]||0,fe[2]||0);break;case"translate":te.translate(fe[0],fe[1]||0);break;case"scale":te.scale(fe);break;case"skewX":te.skew(fe[0],0);break;case"skewY":te.skew(0,fe[0]);break}}A.transform(te)}}function L(A,V,q){var J=q==="fill-opacity"?"getFillColor":"getStrokeColor",X=A[J]&&A[J]();X&&X.setAlpha(parseFloat(V))}var j=a.set(a.each(Ps,function(A){this[A.attribute]=function(V,q){if(V[A.set]&&(V[A.set](w(q,A.type,A.fromSVG)),A.type==="color")){var J=V[A.get]();if(J&&J._scaleToBounds){var X=V.getBounds();J.transform(new le().translate(X.getPoint()).scale(X.getSize()))}}}},{}),{id:function(A,V){r[V]=A,A.setName&&A.setName(V)},"clip-path":function(A,V){var q=H(V);if(q)if(q=q.clone(),q.setClipMask(!0),A instanceof Ne)A.insertChild(0,q);else return new Ne(q,A)},gradientTransform:B,transform:B,"fill-opacity":L,"stroke-opacity":L,visibility:function(A,V){A.setVisible&&A.setVisible(V==="visible")},display:function(A,V){A.setVisible&&A.setVisible(V!==null)},"stop-color":function(A,V){A.setColor&&A.setColor(V)},"stop-opacity":function(A,V){A._color&&A._color.setAlpha(parseFloat(V))},offset:function(A,V){if(A.setOffset){var q=V.match(/(.*)%$/);A.setOffset(q?q[1]/100:parseFloat(V))}},viewBox:function(A,V,q,J,X){var te=new K(w(V,"array")),ie=v(J,null,null,!0),se,he;if(A instanceof Ne){var ne=ie?ie.divide(te.getSize()):1,he=new le().scale(ne).translate(te.getPoint().negate());se=A}else A instanceof Ze&&(ie&&te.setSize(ie),se=A._item);if(se){if(Y(J,"overflow",X)!=="visible"){var ce=new qe.Rectangle(te);ce.setClipMask(!0),se.addChild(ce)}he&&se.transform(he)}}});function Y(A,V,q){var J=A.attributes[V],X=J&&J.value;if(!X&&A.style){var te=a.camelize(V);X=A.style[te],!X&&q.node[te]!==q.parent[te]&&(X=q.node[te])}return X?X==="none"?null:X:t}function z(A,V,q){var J=V.parentNode,X={node:_t.getStyles(V)||{},parent:!q&&!/^defs$/i.test(J.tagName)&&_t.getStyles(J)||{}};return a.each(j,function(te,ie){var se=Y(V,ie,X);A=se!==t&&te(A,se,ie,V,X)||A}),A}function H(A){var V=A&&A.match(/\((?:["'#]*)([^"')]+)/),q=V&&V[1],J=q&&r[n?q.replace(n.location.href.split("#")[0]+"#",""):q];return J&&J._scaleToBounds&&(J=J.clone(),J._scaleToBounds=!0),J}function D(A,V,q){var J=A.nodeName.toLowerCase(),X=J!=="#document",te=i.body,ie,se,he;q&&X&&(u=Nt.getView().getSize(),u=v(A,null,null,!0)||u,ie=Gt.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),se=A.parentNode,he=A.nextSibling,ie.appendChild(A),te.appendChild(ie));var ne=Nt.settings,ce=ne.applyMatrix,fe=ne.insertItems;ne.applyMatrix=!1,ne.insertItems=!1;var ye=N[J],we=ye&&ye(A,J,V,q)||null;if(ne.insertItems=fe,ne.applyMatrix=ce,we){X&&!(we instanceof Ne)&&(we=z(we,A,q));var Ee=V.onImport,Be=X&&A.getAttribute("data-paper-data");Ee&&(we=Ee(A,we,V)||we),V.expandShapes&&we instanceof qe&&(we.remove(),we=we.toPath()),Be&&(we._data=JSON.parse(Be))}return ie&&(te.removeChild(ie),se&&(he?se.insertBefore(A,he):se.appendChild(A))),q&&(r={},we&&a.pick(V.applyMatrix,ce)&&we.matrix.apply(!0,!0)),we}function U(A,V,q){if(!A)return null;V=typeof V=="function"?{onLoad:V}:V||{};var J=Nt,X=null;function te(ne){try{var ce=typeof ne=="object"?ne:new e.DOMParser().parseFromString(ne.trim(),"image/svg+xml");if(!ce.nodeName)throw ce=null,new Error("Unsupported SVG source: "+A);Nt=J,X=D(ce,V,!0),(!V||V.insert!==!1)&&q._insertItem(t,X);var fe=V.onLoad;fe&&fe(X,ne)}catch(ye){ie(ye)}}function ie(ne,ce){var fe=V.onError;if(fe)fe(ne,ce);else throw new Error(ne)}if(typeof A=="string"&&!/^[\s\S]*</.test(A)){var se=i.getElementById(A);se?te(se):qr.request({url:A,async:!0,onLoad:te,onError:ie})}else if(typeof File<"u"&&A instanceof File){var he=new FileReader;return he.onload=function(){te(he.result)},he.onerror=function(){ie(he.error)},he.readAsText(A)}else te(A);return X}F.inject({importSVG:function(A,V){return U(A,V,this)}}),xe.inject({importSVG:function(A,V){return this.activate(),U(A,V,this)}})},a.exports.PaperScript=(function(){var r=this,u=r.acorn;if(!u&&typeof Q2<"u")try{u=tS()}catch{}if(!u){var f,g;u=f=g={},(function(z,H){if(typeof f=="object"&&typeof g=="object")return H(f);if(typeof t=="function"&&t.amd)return t(["exports"],H);H(z.acorn||(z.acorn={}))})(this,function(z){z.version="0.5.0";var H,D,U,A;z.parse=function(oe,pe){return D=String(oe),U=D.length,q(pe),du(),xu(H.program)};var V=z.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function q(oe){H=oe||{};for(var pe in V)Object.prototype.hasOwnProperty.call(H,pe)||(H[pe]=V[pe]);A=H.sourceFile||null}var J=z.getLineInfo=function(oe,pe){for(var Me=1,Re=0;;){jn.lastIndex=Re;var St=jn.exec(oe);if(St&&St.index<pe)++Me,Re=St.index+St[0].length;else break}return{line:Me,column:pe-Re}};z.tokenize=function(oe,pe){D=String(oe),U=D.length,q(pe),du();var Me={};function Re(St){return Be=ie,ls(St),Me.start=te,Me.end=ie,Me.startLoc=se,Me.endLoc=he,Me.type=ne,Me.value=ce,Me}return Re.jumpTo=function(St,kt){if(X=St,H.locations){ye=1,we=jn.lastIndex=0;for(var It;(It=jn.exec(D))&&It.index<St;)++ye,we=It.index+It[0].length}fe=kt,yi()},Re};var X,te,ie,se,he,ne,ce,fe,ye,we,Ee,Be,Ue,et,it,Ie;function De(oe,pe){var Me=J(D,oe);pe+=" ("+Me.line+":"+Me.column+")";var Re=new SyntaxError(pe);throw Re.pos=oe,Re.loc=Me,Re.raisedAt=X,Re}var tt=[],at={type:"num"},st={type:"regexp"},xt={type:"string"},vt={type:"name"},lt={type:"eof"},Lt={keyword:"break"},bt={keyword:"case",beforeExpr:!0},pn={keyword:"catch"},sn={keyword:"continue"},Sn={keyword:"debugger"},ln={keyword:"default"},Ke={keyword:"do",isLoop:!0},Ht={keyword:"else",beforeExpr:!0},an={keyword:"finally"},qt={keyword:"for",isLoop:!0},tr={keyword:"function"},Fr={keyword:"if"},fr={keyword:"return",beforeExpr:!0},Wn={keyword:"switch"},Cn={keyword:"throw",beforeExpr:!0},On={keyword:"try"},nr={keyword:"var"},vn={keyword:"while",isLoop:!0},Fn={keyword:"with"},As={keyword:"new",beforeExpr:!0},Ms={keyword:"this"},js={keyword:"null",atomValue:null},Fi={keyword:"true",atomValue:!0},Za={keyword:"false",atomValue:!1},Bi={keyword:"in",binop:7,beforeExpr:!0},Vt={break:Lt,case:bt,catch:pn,continue:sn,debugger:Sn,default:ln,do:Ke,else:Ht,finally:an,for:qt,function:tr,if:Fr,return:fr,switch:Wn,throw:Cn,try:On,var:nr,while:vn,with:Fn,null:js,true:Fi,false:Za,new:As,in:Bi,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Ms,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},zi={type:"[",beforeExpr:!0},Vi={type:"]"},Br={type:"{",beforeExpr:!0},dr={type:"}"},Pt={type:"(",beforeExpr:!0},rr={type:")"},ir={type:",",beforeExpr:!0},Un={type:";",beforeExpr:!0},Hn={type:":",beforeExpr:!0},Sr={type:"."},Cr={type:"?",beforeExpr:!0},gi={binop:10,beforeExpr:!0},c={isAssign:!0,beforeExpr:!0},x={isAssign:!0,beforeExpr:!0},R={postfix:!0,prefix:!0,isUpdate:!0},G={prefix:!0,beforeExpr:!0},re={binop:1,beforeExpr:!0},Se={binop:2,beforeExpr:!0},Oe={binop:3,beforeExpr:!0},Ge={binop:4,beforeExpr:!0},rt={binop:5,beforeExpr:!0},Ot={binop:6,beforeExpr:!0},jt={binop:7,beforeExpr:!0},Kt={binop:8,beforeExpr:!0},cn={binop:9,prefix:!0,beforeExpr:!0},Kr={binop:10,beforeExpr:!0};z.tokTypes={bracketL:zi,bracketR:Vi,braceL:Br,braceR:dr,parenL:Pt,parenR:rr,comma:ir,semi:Un,colon:Hn,dot:Sr,question:Cr,slash:gi,eq:c,name:vt,eof:lt,num:at,regexp:st,string:xt};for(var mi in Vt)z.tokTypes["_"+mi]=Vt[mi];function Zr(oe){oe=oe.split(" ");var pe="",Me=[];e:for(var Re=0;Re<oe.length;++Re){for(var St=0;St<Me.length;++St)if(Me[St][0].length==oe[Re].length){Me[St].push(oe[Re]);continue e}Me.push([oe[Re]])}function kt(Zt){if(Zt.length==1)return pe+="return str === "+JSON.stringify(Zt[0])+";";pe+="switch(str){";for(var Gn=0;Gn<Zt.length;++Gn)pe+="case "+JSON.stringify(Zt[Gn])+":";pe+="return true}return false;"}if(Me.length>3){Me.sort(function(Zt,Gn){return Gn.length-Zt.length}),pe+="switch(str.length){";for(var Re=0;Re<Me.length;++Re){var It=Me[Re];pe+="case "+It[0].length+":",kt(It)}pe+="}"}else kt(oe);return new Function("str",pe)}var Qr=Zr("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),zr=Zr("class enum extends super const export import"),Qa=Zr("implements interface let package private protected public static yield"),ca=Zr("eval arguments"),Wi=Zr("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Xo=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ha="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",fu="------------------------------------------------------------------------------------------------------------------------------------------",fa=new RegExp("["+ha+"]"),Ja=new RegExp("["+ha+fu+"]"),da=/[\n\r\u2028\u2029]/,jn=/\r\n|[\n\r\u2028\u2029]/g,vi=z.isIdentifierStart=function(oe){return oe<65?oe===36:oe<91?!0:oe<97?oe===95:oe<123?!0:oe>=170&&fa.test(String.fromCharCode(oe))},$a=z.isIdentifierChar=function(oe){return oe<48?oe===36:oe<58?!0:oe<65?!1:oe<91?!0:oe<97?oe===95:oe<123?!0:oe>=170&&Ja.test(String.fromCharCode(oe))};function Vr(){this.line=ye,this.column=X-we}function du(){ye=1,X=we=0,fe=!0,yi()}function kn(oe,pe){ie=X,H.locations&&(he=new Vr),ne=oe,yi(),ce=pe,fe=oe.beforeExpr}function Go(){var oe=H.onComment&&H.locations&&new Vr,pe=X,Me=D.indexOf("*/",X+=2);if(Me===-1&&De(X-2,"Unterminated comment"),X=Me+2,H.locations){jn.lastIndex=pe;for(var Re;(Re=jn.exec(D))&&Re.index<X;)++ye,we=Re.index+Re[0].length}H.onComment&&H.onComment(!0,D.slice(pe+2,Me),pe,X,oe,H.locations&&new Vr)}function os(){for(var oe=X,pe=H.onComment&&H.locations&&new Vr,Me=D.charCodeAt(X+=2);X<U&&Me!==10&&Me!==13&&Me!==8232&&Me!==8233;)++X,Me=D.charCodeAt(X);H.onComment&&H.onComment(!1,D.slice(oe+2,X),oe,X,pe,H.locations&&new Vr)}function yi(){for(;X<U;){var oe=D.charCodeAt(X);if(oe===32)++X;else if(oe===13){++X;var pe=D.charCodeAt(X);pe===10&&++X,H.locations&&(++ye,we=X)}else if(oe===10||oe===8232||oe===8233)++X,H.locations&&(++ye,we=X);else if(oe>8&&oe<14)++X;else if(oe===47){var pe=D.charCodeAt(X+1);if(pe===42)Go();else if(pe===47)os();else break}else if(oe===160)++X;else if(oe>=5760&&Xo.test(String.fromCharCode(oe)))++X;else break}}function pu(){var oe=D.charCodeAt(X+1);return oe>=48&&oe<=57?mu(!0):(++X,kn(Sr))}function wh(){var oe=D.charCodeAt(X+1);return fe?(++X,gu()):oe===61?Pn(x,2):Pn(gi,1)}function bh(){var oe=D.charCodeAt(X+1);return oe===61?Pn(x,2):Pn(Kr,1)}function Sh(oe){var pe=D.charCodeAt(X+1);return pe===oe?Pn(oe===124?re:Se,2):pe===61?Pn(x,2):Pn(oe===124?Oe:rt,1)}function Yo(){var oe=D.charCodeAt(X+1);return oe===61?Pn(x,2):Pn(Ge,1)}function Ch(oe){var pe=D.charCodeAt(X+1);return pe===oe?pe==45&&D.charCodeAt(X+2)==62&&da.test(D.slice(Be,X))?(X+=3,os(),yi(),ls()):Pn(R,2):pe===61?Pn(x,2):Pn(cn,1)}function kh(oe){var pe=D.charCodeAt(X+1),Me=1;return pe===oe?(Me=oe===62&&D.charCodeAt(X+2)===62?3:2,D.charCodeAt(X+Me)===61?Pn(x,Me+1):Pn(Kt,Me)):pe==33&&oe==60&&D.charCodeAt(X+2)==45&&D.charCodeAt(X+3)==45?(X+=4,os(),yi(),ls()):(pe===61&&(Me=D.charCodeAt(X+2)===61?3:2),Pn(jt,Me))}function Th(oe){var pe=D.charCodeAt(X+1);return pe===61?Pn(Ot,D.charCodeAt(X+2)===61?3:2):Pn(oe===61?c:G,1)}function Eh(oe){switch(oe){case 46:return pu();case 40:return++X,kn(Pt);case 41:return++X,kn(rr);case 59:return++X,kn(Un);case 44:return++X,kn(ir);case 91:return++X,kn(zi);case 93:return++X,kn(Vi);case 123:return++X,kn(Br);case 125:return++X,kn(dr);case 58:return++X,kn(Hn);case 63:return++X,kn(Cr);case 48:var pe=D.charCodeAt(X+1);if(pe===120||pe===88)return Oh();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return mu(!1);case 34:case 39:return qo(oe);case 47:return wh();case 37:case 42:return bh();case 124:case 38:return Sh(oe);case 94:return Yo();case 43:case 45:return Ch(oe);case 60:case 62:return kh(oe);case 61:case 33:return Th(oe);case 126:return Pn(G,1)}return!1}function ls(oe){if(oe?X=te+1:te=X,H.locations&&(se=new Vr),oe)return gu();if(X>=U)return kn(lt);var pe=D.charCodeAt(X);if(vi(pe)||pe===92)return Ko();var Me=Eh(pe);if(Me===!1){var Re=String.fromCharCode(pe);if(Re==="\\"||fa.test(Re))return Ko();De(X,"Unexpected character '"+Re+"'")}return Me}function Pn(oe,pe){var Me=D.slice(X,X+pe);X+=pe,kn(oe,Me)}function gu(){for(var St="",oe,pe,Me=X;;){X>=U&&De(Me,"Unterminated regular expression");var Re=D.charAt(X);if(da.test(Re)&&De(Me,"Unterminated regular expression"),oe)oe=!1;else{if(Re==="[")pe=!0;else if(Re==="]"&&pe)pe=!1;else if(Re==="/"&&!pe)break;oe=Re==="\\"}++X}var St=D.slice(Me,X);++X;var kt=vu();kt&&!/^[gmsiy]*$/.test(kt)&&De(Me,"Invalid regexp flag");try{var It=new RegExp(St,kt)}catch(Zt){Zt instanceof SyntaxError&&De(Me,Zt.message),De(Zt)}return kn(st,It)}function pa(oe,pe){for(var Me=X,Re=0,St=0,kt=pe??1/0;St<kt;++St){var It=D.charCodeAt(X),Zt;if(It>=97?Zt=It-97+10:It>=65?Zt=It-65+10:It>=48&&It<=57?Zt=It-48:Zt=1/0,Zt>=oe)break;++X,Re=Re*oe+Zt}return X===Me||pe!=null&&X-Me!==pe?null:Re}function Oh(){X+=2;var oe=pa(16);return oe==null&&De(te+2,"Expected hexadecimal number"),vi(D.charCodeAt(X))&&De(X,"Identifier directly after number"),kn(at,oe)}function mu(oe){var pe=X,Me=!1,Re=D.charCodeAt(X)===48;!oe&&pa(10)===null&&De(pe,"Invalid number"),D.charCodeAt(X)===46&&(++X,pa(10),Me=!0);var St=D.charCodeAt(X);(St===69||St===101)&&(St=D.charCodeAt(++X),(St===43||St===45)&&++X,pa(10)===null&&De(pe,"Invalid number"),Me=!0),vi(D.charCodeAt(X))&&De(X,"Identifier directly after number");var kt=D.slice(pe,X),It;return Me?It=parseFloat(kt):!Re||kt.length===1?It=parseInt(kt,10):/[89]/.test(kt)||Ie?De(pe,"Invalid number"):It=parseInt(kt,8),kn(at,It)}function qo(oe){X++;for(var pe="";;){X>=U&&De(te,"Unterminated string constant");var Me=D.charCodeAt(X);if(Me===oe)return++X,kn(xt,pe);if(Me===92){Me=D.charCodeAt(++X);var Re=/^[0-7]+/.exec(D.slice(X,X+3));for(Re&&(Re=Re[0]);Re&&parseInt(Re,8)>255;)Re=Re.slice(0,-1);if(Re==="0"&&(Re=null),++X,Re)Ie&&De(X-2,"Octal literal in strict mode"),pe+=String.fromCharCode(parseInt(Re,8)),X+=Re.length-1;else switch(Me){case 110:pe+=`
`;break;case 114:pe+="\r";break;case 120:pe+=String.fromCharCode(eo(2));break;case 117:pe+=String.fromCharCode(eo(4));break;case 85:pe+=String.fromCharCode(eo(8));break;case 116:pe+="	";break;case 98:pe+="\b";break;case 118:pe+="\v";break;case 102:pe+="\f";break;case 48:pe+="\0";break;case 13:D.charCodeAt(X)===10&&++X;case 10:H.locations&&(we=X,++ye);break;default:pe+=String.fromCharCode(Me);break}}else(Me===13||Me===10||Me===8232||Me===8233)&&De(te,"Unterminated string constant"),pe+=String.fromCharCode(Me),++X}}function eo(oe){var pe=pa(16,oe);return pe===null&&De(te,"Bad character escape sequence"),pe}var Is;function vu(){Is=!1;for(var oe,pe=!0,Me=X;;){var Re=D.charCodeAt(X);if($a(Re))Is&&(oe+=D.charAt(X)),++X;else if(Re===92){Is||(oe=D.slice(Me,X)),Is=!0,D.charCodeAt(++X)!=117&&De(X,"Expecting Unicode escape sequence \\uXXXX"),++X;var St=eo(4),kt=String.fromCharCode(St);kt||De(X-1,"Invalid Unicode escape"),(pe?vi(St):$a(St))||De(X-4,"Invalid Unicode escape"),oe+=kt}else break;pe=!1}return Is?oe:D.slice(Me,X)}function Ko(){var oe=vu(),pe=vt;return!Is&&Wi(oe)&&(pe=Vt[oe]),kn(pe,oe)}function Xt(){Ee=te,Be=ie,Ue=he,ls()}function Zo(oe){if(Ie=oe,X=te,H.locations)for(;X<we;)we=D.lastIndexOf(`
`,we-2)+1,--ye;yi(),ls()}function yu(){this.type=null,this.start=te,this.end=null}function _u(){this.start=se,this.end=null,A!==null&&(this.source=A)}function Bn(){var oe=new yu;return H.locations&&(oe.loc=new _u),H.directSourceFile&&(oe.sourceFile=H.directSourceFile),H.ranges&&(oe.range=[te,0]),oe}function Ui(oe){var pe=new yu;return pe.start=oe.start,H.locations&&(pe.loc=new _u,pe.loc.start=oe.loc.start),H.ranges&&(pe.range=[oe.range[0],0]),pe}function Ft(oe,pe){return oe.type=pe,oe.end=Be,H.locations&&(oe.loc.end=Ue),H.ranges&&(oe.range[1]=Be),oe}function ga(oe){return H.ecmaVersion>=5&&oe.type==="ExpressionStatement"&&oe.expression.type==="Literal"&&oe.expression.value==="use strict"}function rn(oe){if(ne===oe)return Xt(),!0}function to(){return!H.strictSemicolons&&(ne===lt||ne===dr||da.test(D.slice(Be,te)))}function Hi(){!rn(Un)&&!to()&&Jr()}function yn(oe){ne===oe?Xt():Jr()}function Jr(){De(te,"Unexpected token")}function ma(oe){oe.type!=="Identifier"&&oe.type!=="MemberExpression"&&De(oe.start,"Assigning to rvalue"),Ie&&oe.type==="Identifier"&&ca(oe.name)&&De(oe.start,"Assigning to "+oe.name+" in strict mode")}function xu(oe){Ee=Be=X,H.locations&&(Ue=new Vr),et=Ie=null,it=[],ls();var pe=oe||Bn(),Me=!0;for(oe||(pe.body=[]);ne!==lt;){var Re=Wr();pe.body.push(Re),Me&&ga(Re)&&Zo(!0),Me=!1}return Ft(pe,"Program")}var Xi={kind:"loop"},Ph={kind:"switch"};function Wr(){(ne===gi||ne===x&&ce=="/=")&&ls(!0);var oe=ne,pe=Bn();switch(oe){case Lt:case sn:Xt();var Me=oe===Lt;rn(Un)||to()?pe.label=null:ne!==vt?Jr():(pe.label=In(),Hi());for(var Re=0;Re<it.length;++Re){var St=it[Re];if((pe.label==null||St.name===pe.label.name)&&(St.kind!=null&&(Me||St.kind==="loop")||pe.label&&Me))break}return Re===it.length&&De(pe.start,"Unsyntactic "+oe.keyword),Ft(pe,Me?"BreakStatement":"ContinueStatement");case Sn:return Xt(),Hi(),Ft(pe,"DebuggerStatement");case Ke:return Xt(),it.push(Xi),pe.body=Wr(),it.pop(),yn(vn),pe.test=va(),Hi(),Ft(pe,"DoWhileStatement");case qt:if(Xt(),it.push(Xi),yn(Pt),ne===Un)return no(pe,null);if(ne===nr){var kt=Bn();return Xt(),Rs(kt,!0),Ft(kt,"VariableDeclaration"),kt.declarations.length===1&&rn(Bi)?Ds(pe,kt):no(pe,kt)}var kt=Xn(!1,!0);return rn(Bi)?(ma(kt),Ds(pe,kt)):no(pe,kt);case tr:return Xt(),Qo(pe,!0);case Fr:return Xt(),pe.test=va(),pe.consequent=Wr(),pe.alternate=rn(Ht)?Wr():null,Ft(pe,"IfStatement");case fr:return!et&&!H.allowReturnOutsideFunction&&De(te,"'return' outside of function"),Xt(),rn(Un)||to()?pe.argument=null:(pe.argument=Xn(),Hi()),Ft(pe,"ReturnStatement");case Wn:Xt(),pe.discriminant=va(),pe.cases=[],yn(Br),it.push(Ph);for(var It,Zt;ne!=dr;)if(ne===bt||ne===ln){var Gn=ne===bt;It&&Ft(It,"SwitchCase"),pe.cases.push(It=Bn()),It.consequent=[],Xt(),Gn?It.test=Xn():(Zt&&De(Ee,"Multiple default clauses"),Zt=!0,It.test=null),yn(Hn)}else It||Jr(),It.consequent.push(Wr());return It&&Ft(It,"SwitchCase"),Xt(),it.pop(),Ft(pe,"SwitchStatement");case Cn:return Xt(),da.test(D.slice(Be,te))&&De(Be,"Illegal newline after throw"),pe.argument=Xn(),Hi(),Ft(pe,"ThrowStatement");case On:if(Xt(),pe.block=Ls(),pe.handler=null,ne===pn){var _i=Bn();Xt(),yn(Pt),_i.param=In(),Ie&&ca(_i.param.name)&&De(_i.param.start,"Binding "+_i.param.name+" in strict mode"),yn(rr),_i.guard=null,_i.body=Ls(),pe.handler=Ft(_i,"CatchClause")}return pe.guardedHandlers=tt,pe.finalizer=rn(an)?Ls():null,!pe.handler&&!pe.finalizer&&De(pe.start,"Missing catch or finally clause"),Ft(pe,"TryStatement");case nr:return Xt(),Rs(pe),Hi(),Ft(pe,"VariableDeclaration");case vn:return Xt(),pe.test=va(),it.push(Xi),pe.body=Wr(),it.pop(),Ft(pe,"WhileStatement");case Fn:return Ie&&De(te,"'with' in strict mode"),Xt(),pe.object=va(),pe.body=Wr(),Ft(pe,"WithStatement");case Br:return Ls();case Un:return Xt(),Ft(pe,"EmptyStatement");default:var us=ce,Bs=Xn();if(oe===vt&&Bs.type==="Identifier"&&rn(Hn)){for(var Re=0;Re<it.length;++Re)it[Re].name===us&&De(Bs.start,"Label '"+us+"' is already declared");var Cu=ne.isLoop?"loop":ne===Wn?"switch":null;return it.push({name:us,kind:Cu}),pe.body=Wr(),it.pop(),pe.label=Bs,Ft(pe,"LabeledStatement")}else return pe.expression=Bs,Hi(),Ft(pe,"ExpressionStatement")}}function va(){yn(Pt);var oe=Xn();return yn(rr),oe}function Ls(oe){var pe=Bn(),Me=!0,Re=!1,St;for(pe.body=[],yn(Br);!rn(dr);){var kt=Wr();pe.body.push(kt),Me&&oe&&ga(kt)&&(St=Re,Zo(Re=!0)),Me=!1}return Re&&!St&&Zo(!1),Ft(pe,"BlockStatement")}function no(oe,pe){return oe.init=pe,yn(Un),oe.test=ne===Un?null:Xn(),yn(Un),oe.update=ne===rr?null:Xn(),yn(rr),oe.body=Wr(),it.pop(),Ft(oe,"ForStatement")}function Ds(oe,pe){return oe.left=pe,oe.right=Xn(),yn(rr),oe.body=Wr(),it.pop(),Ft(oe,"ForInStatement")}function Rs(oe,pe){for(oe.declarations=[],oe.kind="var";;){var Me=Bn();if(Me.id=In(),Ie&&ca(Me.id.name)&&De(Me.id.start,"Binding "+Me.id.name+" in strict mode"),Me.init=rn(c)?Xn(!0,pe):null,oe.declarations.push(Ft(Me,"VariableDeclarator")),!rn(ir))break}return oe}function Xn(oe,pe){var Me=Ns(pe);if(!oe&&ne===ir){var Re=Ui(Me);for(Re.expressions=[Me];rn(ir);)Re.expressions.push(Ns(pe));return Ft(Re,"SequenceExpression")}return Me}function Ns(oe){var pe=Ah(oe);if(ne.isAssign){var Me=Ui(pe);return Me.operator=ce,Me.left=pe,Xt(),Me.right=Ns(oe),ma(pe),Ft(Me,"AssignmentExpression")}return pe}function Ah(oe){var pe=wu(oe);if(rn(Cr)){var Me=Ui(pe);return Me.test=pe,Me.consequent=Xn(!0),yn(Hn),Me.alternate=Xn(!0,oe),Ft(Me,"ConditionalExpression")}return pe}function wu(oe){return ya(_a(),-1,oe)}function ya(oe,pe,Me){var Re=ne.binop;if(Re!=null&&(!Me||ne!==Bi)&&Re>pe){var St=Ui(oe);St.left=oe,St.operator=ce;var kt=ne;Xt(),St.right=ya(_a(),Re,Me);var It=Ft(St,kt===re||kt===Se?"LogicalExpression":"BinaryExpression");return ya(It,pe,Me)}return oe}function _a(){if(ne.prefix){var oe=Bn(),pe=ne.isUpdate;return oe.operator=ce,oe.prefix=!0,fe=!0,Xt(),oe.argument=_a(),pe?ma(oe.argument):Ie&&oe.operator==="delete"&&oe.argument.type==="Identifier"&&De(oe.start,"Deleting local variable in strict mode"),Ft(oe,pe?"UpdateExpression":"UnaryExpression")}for(var Me=bu();ne.postfix&&!to();){var oe=Ui(Me);oe.operator=ce,oe.prefix=!1,oe.argument=Me,ma(Me),Xt(),Me=Ft(oe,"UpdateExpression")}return Me}function bu(){return Fs(ro())}function Fs(oe,pe){if(rn(Sr)){var Me=Ui(oe);return Me.object=oe,Me.property=In(!0),Me.computed=!1,Fs(Ft(Me,"MemberExpression"),pe)}else if(rn(zi)){var Me=Ui(oe);return Me.object=oe,Me.property=Xn(),Me.computed=!0,yn(Vi),Fs(Ft(Me,"MemberExpression"),pe)}else if(!pe&&rn(Pt)){var Me=Ui(oe);return Me.callee=oe,Me.arguments=Jo(rr,!1),Fs(Ft(Me,"CallExpression"),pe)}else return oe}function ro(){switch(ne){case Ms:var Re=Bn();return Xt(),Ft(Re,"ThisExpression");case vt:return In();case at:case xt:case st:var Re=Bn();return Re.value=ce,Re.raw=D.slice(te,ie),Xt(),Ft(Re,"Literal");case js:case Fi:case Za:var Re=Bn();return Re.value=ne.atomValue,Re.raw=ne.keyword,Xt(),Ft(Re,"Literal");case Pt:var oe=se,pe=te;Xt();var Me=Xn();return Me.start=pe,Me.end=ie,H.locations&&(Me.loc.start=oe,Me.loc.end=he),H.ranges&&(Me.range=[pe,ie]),yn(rr),Me;case zi:var Re=Bn();return Xt(),Re.elements=Jo(Vi,!0,!0),Ft(Re,"ArrayExpression");case Br:return jh();case tr:var Re=Bn();return Xt(),Qo(Re,!1);case As:return Mh();default:Jr()}}function Mh(){var oe=Bn();return Xt(),oe.callee=Fs(ro(),!0),rn(Pt)?oe.arguments=Jo(rr,!1):oe.arguments=tt,Ft(oe,"NewExpression")}function jh(){var oe=Bn(),pe=!0,Me=!1;for(oe.properties=[],Xt();!rn(dr);){if(pe)pe=!1;else if(yn(ir),H.allowTrailingCommas&&rn(dr))break;var Re={key:Su()},St=!1,kt;if(rn(Hn)?(Re.value=Xn(!0),kt=Re.kind="init"):H.ecmaVersion>=5&&Re.key.type==="Identifier"&&(Re.key.name==="get"||Re.key.name==="set")?(St=Me=!0,kt=Re.kind=Re.key.name,Re.key=Su(),ne!==Pt&&Jr(),Re.value=Qo(Bn(),!1)):Jr(),Re.key.type==="Identifier"&&(Ie||Me))for(var It=0;It<oe.properties.length;++It){var Zt=oe.properties[It];if(Zt.key.name===Re.key.name){var Gn=kt==Zt.kind||St&&Zt.kind==="init"||kt==="init"&&(Zt.kind==="get"||Zt.kind==="set");Gn&&!Ie&&kt==="init"&&Zt.kind==="init"&&(Gn=!1),Gn&&De(Re.key.start,"Redefinition of property")}}oe.properties.push(Re)}return Ft(oe,"ObjectExpression")}function Su(){return ne===at||ne===xt?ro():In(!0)}function Qo(oe,pe){ne===vt?oe.id=In():pe?Jr():oe.id=null,oe.params=[];var Me=!0;for(yn(Pt);!rn(rr);)Me?Me=!1:yn(ir),oe.params.push(In());var Re=et,St=it;if(et=!0,it=[],oe.body=Ls(!0),et=Re,it=St,Ie||oe.body.body.length&&ga(oe.body.body[0]))for(var kt=oe.id?-1:0;kt<oe.params.length;++kt){var It=kt<0?oe.id:oe.params[kt];if((Qa(It.name)||ca(It.name))&&De(It.start,"Defining '"+It.name+"' in strict mode"),kt>=0)for(var Zt=0;Zt<kt;++Zt)It.name===oe.params[Zt].name&&De(It.start,"Argument name clash in strict mode")}return Ft(oe,pe?"FunctionDeclaration":"FunctionExpression")}function Jo(oe,pe,Me){for(var Re=[],St=!0;!rn(oe);){if(St)St=!1;else if(yn(ir),pe&&H.allowTrailingCommas&&rn(oe))break;Me&&ne===ir?Re.push(null):Re.push(Xn(!0))}return Re}function In(oe){var pe=Bn();return oe&&H.forbidReserved=="everywhere"&&(oe=!1),ne===vt?(!oe&&(H.forbidReserved&&(H.ecmaVersion===3?Qr:zr)(ce)||Ie&&Qa(ce))&&D.slice(te,ie).indexOf("\\")==-1&&De(te,"The keyword '"+ce+"' is reserved"),pe.name=ce):oe&&ne.keyword?pe.name=ne.keyword:Jr(),fe=!1,Xt(),Ft(pe,"Identifier")}}),u.version||(u=null)}function v(z,H){return(r.acorn||u).parse(z,H)}var w={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},S={"-":"__negate","+":"__self"},C=a.each(["add","subtract","multiply","divide","modulo","equals","negate"],function(z){this["__"+z]="#"+z},{__self:function(){return this}});O.inject(C),W.inject(C),pt.inject(C);function T(z,H,D){var U=w[H];if(z&&z[U]){var A=z[U](D);return H==="!="?!A:A}switch(H){case"+":return z+D;case"-":return z-D;case"*":return z*D;case"/":return z/D;case"%":return z%D;case"==":return z==D;case"!=":return z!=D}}function P(z,H){var D=S[z];if(H&&H[D])return H[D]();switch(z){case"+":return+H;case"-":return-H}}function N(z,H){if(!z)return"";H=H||{};var D=[];function U(Ie){for(var De=0,tt=D.length;De<tt;De++){var at=D[De];if(at[0]>=Ie)break;Ie+=at[1]}return Ie}function A(Ie){return z.substring(U(Ie.range[0]),U(Ie.range[1]))}function V(Ie,De){return z.substring(U(Ie.range[1]),U(De.range[0]))}function q(Ie,De){for(var tt=U(Ie.range[0]),at=U(Ie.range[1]),st=0,xt=D.length-1;xt>=0;xt--)if(tt>D[xt][0]){st=xt+1;break}D.splice(st,0,[tt,De.length-at+tt]),z=z.substring(0,tt)+De+z.substring(at)}function J(Ie,De){switch(Ie.type){case"UnaryExpression":if(Ie.operator in S&&Ie.argument.type!=="Literal"){var tt=A(Ie.argument);q(Ie,'$__("'+Ie.operator+'", '+tt+")")}break;case"BinaryExpression":if(Ie.operator in w&&Ie.left.type!=="Literal"){var at=A(Ie.left),st=A(Ie.right),xt=V(Ie.left,Ie.right),vt=Ie.operator;q(Ie,"__$__("+at+","+xt.replace(new RegExp("\\"+vt),'"'+vt+'"')+", "+st+")")}break;case"UpdateExpression":case"AssignmentExpression":var lt=De&&De.type;if(!(lt==="ForStatement"||lt==="BinaryExpression"&&/^[=!<>]/.test(De.operator)||lt==="MemberExpression"&&De.computed)){if(Ie.type==="UpdateExpression"){var tt=A(Ie.argument),Lt="__$__("+tt+', "'+Ie.operator[0]+'", 1)',bt=tt+" = "+Lt;Ie.prefix?bt="("+bt+")":(lt==="AssignmentExpression"||lt==="VariableDeclarator"||lt==="BinaryExpression")&&(A(De.left||De.id)===tt&&(bt=Lt),bt=tt+"; "+bt),q(Ie,bt)}else if(/^.=$/.test(Ie.operator)&&Ie.left.type!=="Literal"){var at=A(Ie.left),st=A(Ie.right),Lt=at+" = __$__("+at+', "'+Ie.operator[0]+'", '+st+")";q(Ie,/^\(.*\)$/.test(A(Ie))?"("+Lt+")":Lt)}}break}}function X(Ie){switch(Ie.type){case"ExportDefaultDeclaration":q({range:[Ie.start,Ie.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var De=Ie.declaration,tt=Ie.specifiers;if(De){var at=De.declarations;at&&(at.forEach(function(xt){q(xt,"module.exports."+A(xt))}),q({range:[Ie.start,De.start+De.kind.length]},""))}else if(tt){var st=tt.map(function(xt){var vt=A(xt);return"module.exports."+vt+" = "+vt+"; "}).join("");st&&q(Ie,st)}break}}function te(Ie,De,tt){if(Ie){for(var at in Ie)if(at!=="range"&&at!=="loc"){var st=Ie[at];if(Array.isArray(st))for(var xt=0,vt=st.length;xt<vt;xt++)te(st[xt],Ie,tt);else st&&typeof st=="object"&&te(st,Ie,tt)}tt.operatorOverloading!==!1&&J(Ie,De),tt.moduleExports!==!1&&X(Ie)}}function ie(Ie){var De="",tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Ie=(Math.abs(Ie)<<1)+(Ie<0?1:0);Ie||!De;){var at=Ie&31;Ie>>=5,Ie&&(at|=32),De+=tt[at]}return De}var se=H.url||"",he=H.sourceMaps,ne=H.paperFeatures||{},ce=H.source||z,fe=H.offset||0,ye=Nt.agent,we=ye.versionNumber,Ee=!1,Be=/\r\n|\n|\r/mg,Ue;if(he&&(ye.chrome&&we>=30||ye.webkit&&we>=537.76||ye.firefox&&we>=23||ye.node)){if(ye.node)fe-=2;else if(n&&se&&!n.location.href.indexOf(se)){var et=i.getElementsByTagName("html")[0].innerHTML;fe=et.substr(0,et.indexOf(z)+1).match(Be).length+1}Ee=fe>0&&!(ye.chrome&&we>=36||ye.safari&&we>=600||ye.firefox&&we>=40||ye.node);var it=["AA"+ie(Ee?0:fe)+"A"];it.length=(z.match(Be)||[]).length+1+(Ee?fe:0),Ue={version:3,file:se,names:[],mappings:it.join(";AACA"),sourceRoot:"",sources:[se],sourcesContent:[ce]}}return(ne.operatorOverloading!==!1||ne.moduleExports!==!1)&&te(v(z,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,ne),Ue&&(Ee&&(z=new Array(fe+1).join(`
`)+z),/^(inline|both)$/.test(he)&&(z+=`
//# sourceMappingURL=data:application/json;base64,`+e.btoa(unescape(encodeURIComponent(JSON.stringify(Ue))))),z+=`
//# sourceURL=`+(se||"paperscript")),{url:se,source:ce,code:z,map:Ue}}function B(z,H,D){Nt=H;var U=H.getView(),A=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(z)&&!/\bnew\s+Tool\b/.test(z)?new Ri:null,V=A?A._events:[],q=["onFrame","onResize"].concat(V),J=[],X=[],te,ie=typeof z=="object"?z:N(z,D);z=ie.code;function se(we,Ee){for(var Be in we)(Ee||!/^_/.test(Be))&&new RegExp("([\\b\\s\\W]|^)"+Be.replace(/\$/g,"\\$")+"\\b").test(z)&&(J.push(Be),X.push(we[Be]))}se({__$__:T,$__:P,paper:H,tool:A},!0),se(H),z="var module = { exports: {} }; "+z;var fe=a.each(q,function(we){new RegExp("\\s+"+we+"\\b").test(z)&&(J.push(we),this.push("module.exports."+we+" = "+we+";"))},[]).join(`
`);fe&&(z+=`
`+fe),z+=`
return module.exports;`;var he=Nt.agent;if(i&&(he.chrome||he.firefox&&he.versionNumber<40)){var ne=i.createElement("script"),ce=i.head||i.getElementsByTagName("head")[0];he.firefox&&(z=`
`+z),ne.appendChild(i.createTextNode("document.__paperscript__ = function("+J+") {"+z+`
}`)),ce.appendChild(ne),te=i.__paperscript__,delete i.__paperscript__,ce.removeChild(ne)}else te=Function(J,z);var fe=te&&te.apply(H,X),ye=fe||{};return a.each(V,function(we){var Ee=ye[we];Ee&&(A[we]=Ee)}),U&&(ye.onResize&&U.setOnResize(ye.onResize),U.emit("resize",{size:U.size,delta:new O}),ye.onFrame&&U.setOnFrame(ye.onFrame),U.requestUpdate()),fe}function L(z){if(/^text\/(?:x-|)paperscript$/.test(z.type)&&p.getAttribute(z,"ignore")!=="true"){var H=p.getAttribute(z,"canvas"),D=i.getElementById(H),U=z.src||z.getAttribute("data-src"),A=p.hasAttribute(z,"async"),V="data-paper-scope";if(!D)throw new Error('Unable to find canvas with id "'+H+'"');var q=p.get(D.getAttribute(V))||new p().setup(D);return D.setAttribute(V,q._id),U?qr.request({url:U,async:A,mimeType:"text/plain",onLoad:function(J){B(J,q,U)}}):B(z.innerHTML,q,z.baseURI),z.setAttribute("data-paper-ignore","true"),q}}function j(){a.each(i&&i.getElementsByTagName("script"),L)}function Y(z){return z?L(z):j()}return n&&(i.readyState==="complete"?setTimeout(j):At.add(n,{load:j})),{compile:N,execute:B,load:Y,parse:v,calculateBinary:T,calculateUnary:P}}).call(this);var Nt=new(p.inject(a.exports,{Base:a,Numerical:E,Key:Di,DomEvent:At,DomElement:_t,document:i,window:n,Symbol:Ze,PlacedSymbol:je}));return Nt.agent.node&&Sm(Nt),typeof t=="function"&&t.amd?t("paper",Nt):o&&(o.exports=Nt),Nt}).call(nS,typeof self=="object"?self:null)})(Fc)),Fc.exports}var iS=rS();const kc=Mm(iS),ys={cleanup(...o){o.forEach(e=>e&&!e.removed&&e.remove())},reorientSafe(o){return o&&o.closed&&o.reorient(),o},intersects(o,e){return o&&e&&o.intersects(e)},cloneSafe(o){return o?o.clone():null},simplifySafe(o,e=.5){return o&&o.simplify&&o.simplify(e),o},union(o,e){if(!o||!e)return null;const t=o.unite(e);return this.cleanup(o,e),this.reorientSafe(t)},intersect(o,e){if(!o||!e)return null;const t=o.intersect(e);return this.cleanup(o,e),this.reorientSafe(t)},subtract(o,e){if(!o||!e)return null;const t=o.subtract(e);return this.cleanup(o,e),this.reorientSafe(t)},exclude(o,e){if(!o||!e)return null;const t=o.exclude(e);return this.cleanup(o,e),this.reorientSafe(t)},divide(o,e){if(!o||!e)return[];const t=o.divide(e);return this.cleanup(o,e),t||[]},cut(o,e){if(!o||!e)return[];const t=o.divide(e);return this.cleanup(o,e),t||[]},punch(o,e){if(!o||!e)return null;const t=o.subtract(e);return this.cleanup(o,e),this.reorientSafe(t)},crop(o,e){if(!o||!e)return null;const t=o.intersect(e);return this.cleanup(o),this.reorientSafe(t)},xorSplit(o,e){if(!o||!e)return[];const t=o.exclude(e);return this.cleanup(o,e),t.children&&t.children.length?t.children.map(n=>this.reorientSafe(n)):[this.reorientSafe(t)]},smartUnion(o,e){return!o||!e||!this.intersects(o,e)?null:this.union(o,e)},keepLargest(o){return!o||!o.length?null:o.reduce((e,t)=>t.area>e.area?t:e,o[0])},keepSmallest(o){return!o||!o.length?null:o.reduce((e,t)=>t.area<e.area?t:e,o[0])},filterInside(o,e){return!o||!e?[]:o.filter(t=>e.contains(t.bounds.center))},filterOutside(o,e){return!o||!e?[]:o.filter(t=>!e.contains(t.bounds.center))},combine(o){return!o||o.length===0?null:o.reduce((e,t)=>e.unite(t))},snapToGrid(o,e=10){return o?(o.forEach(t=>{t.position.x=Math.round(t.position.x/e)*e,t.position.y=Math.round(t.position.y/e)*e}),o):[]}};function Tc(o){return{fill:o.fill,stroke:o.stroke,strokeWidth:o.strokeWidth,strokeDashArray:o.strokeDashArray,strokeLineCap:o.strokeLineCap,strokeLineJoin:o.strokeLineJoin,opacity:o.opacity}}function sS(o,e,t){let n=null;return e.forEach((i,a)=>{const h=o.project.importSVG(i.toSVG(),{expandShapes:!0,insert:!1}),p=aS(h.children?.[0]??h);a===0?n=p:n=ys[t](n,p)}),n}function aS(o){return o.strokeWidth&&(o.strokeColor=null,o.strokeWidth=0,o.fill="black",o.closed=!0),o}function oS(o,e,t){if(!e)return null;if(!Array.isArray(e))return e.exportSVG({asString:!0,bounds:"content",precision:3});if(t==="divide"||t==="cut")return e.map(a=>a.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`);const n=new o.CompoundPath({children:e});n.reorient();const i=n.exportSVG({asString:!0,bounds:"content",precision:3});return n.remove(),i}function Tm(o){const[,e,t]=o.split("-");return qy[e]?.[t]}function lS(o){const e=document.createElement("canvas").getContext("2d");return e?(e.fillStyle="#000",e.fillStyle=o,e.fillStyle||null):null}let bl=null;const uS={soft:{blur:12,offsetX:0,offsetY:6,color:"rgba(0,0,0,0.2)"},medium:{blur:20,offsetX:0,offsetY:10,color:"rgba(0,0,0,0.25)"},strong:{blur:40,offsetX:0,offsetY:20,color:"rgba(0,0,0,0.3)"}},cS={union:"unite",intersect:"intersect",subtract:"subtract",exclude:"exclude",divide:"divide",cut:"cut",punch:"punch",crop:"crop",xorSplit:"xorSplit",smartUnion:"smartUnion"};function hS(o){const e=o*Math.PI/180;return{x1:.5-Math.cos(e)/2,y1:.5-Math.sin(e)/2,x2:.5+Math.cos(e)/2,y2:.5+Math.sin(e)/2}}function fS(o){if(o.type==="linear"){const{x1:e,y1:t,x2:n,y2:i}=hS(o.angle);return new Ai({type:"linear",gradientUnits:"objectBoundingBox",coords:{x1:e,y1:t,x2:n,y2:i},colorStops:o.stops})}return new Ai({type:"radial",gradientUnits:"objectBoundingBox",coords:{x1:.5,y1:.5,r1:0,x2:.5,y2:.5,r2:.5},colorStops:o.stops})}const dS=(o,e,t)=>({activePaint:"fill",fill:"#FFFFFF",stroke:"#000000",strokeWidth:1,strokeStyle:"solid",opacity:1,gradient:{type:"linear",angle:90,stops:[{offset:0,color:"#ff0000"},{offset:1,color:"#0000ff"}]},setGradient:n=>{o(i=>({gradient:{...i.gradient,...n}}))},applyFillGradient:()=>{const n=e().canvas,i=n?.getActiveObject();if(!n||!i)return;const a=fS(e().gradient);i.set("fill",a),n.requestRenderAll()},strokeStyleList:[{value:"solid",label:"Solid",dash:null,supported:!0},{value:"dashed",label:"Dashed",dash:[6,4],supported:!0},{value:"dotted",label:"Dotted",dash:[2,2],supported:!0},{value:"double",label:"Double",dash:null,supported:!1},{value:"groove",label:"Groove",dash:null,supported:!1},{value:"ridge",label:"Ridge",dash:null,supported:!1},{value:"inset",label:"Inset",dash:null,supported:!1},{value:"outset",label:"Outset",dash:null,supported:!1}],strokeStyleMap:{solid:{dashArray:null,lineCap:"butt"},dashed:{dashArray:[10,5],lineCap:"butt"},dotted:{dashArray:[2,5],lineCap:"round"},double:{dashArray:[1,3,1,3],lineCap:"butt"},groove:{dashArray:[4,2,1,2],lineCap:"butt"},ridge:{dashArray:[1,2,4,2],lineCap:"butt"},inset:{dashArray:[1,1],lineCap:"butt"},outset:{dashArray:[2,1],lineCap:"butt"}},setActivePaint:n=>o({activePaint:n}),setFill:n=>{const i=e().canvas;if(!i||typeof n=="string"&&n.startsWith("bg-")&&(n=Tm(n),!n))return;i.getActiveObjects().forEach(h=>h.set({fill:n})),i.requestRenderAll(),o({fill:n})},setStroke:n=>{const i=e().canvas;if(!i)return;i.getActiveObjects().forEach(h=>h.set({stroke:n})),i.requestRenderAll(),o({stroke:n})},setStrokeWidthN:n=>{const i=e().canvas;if(!i)return;i.getActiveObjects().forEach(h=>h.set({strokeWidth:n})),i.requestRenderAll(),o({strokeWidth:n})},setStrokeStyle:n=>{const i=e().canvas;if(!i)return;const a=i.getActiveObjects(),h=e().strokeStyleMap[n]||e().strokeStyleMap.solid;a.forEach(p=>{p.set({strokeDashArray:h.dashArray,strokeLineCap:h.lineCap})}),i.requestRenderAll(),o({strokeStyle:n})},setOpacity1:n=>{const i=e().canvas,a=i?.getActiveObject();if(!a)return;const h=n/100;a.set("opacity",h),i.requestRenderAll(),o({opacity:n})},setOpacity:n=>{const i=e().canvas,a=i?.getActiveObject();if(!a)return;const h=Math.min(1,Math.max(.05,n));a.set("opacity",h),i.requestRenderAll(),o({opacity:h})},previewOpacity:n=>{const i=e().canvas?.getActiveObject();i&&(bl===null&&(bl=i.opacity??1),i.set("opacity",n/100),e().canvas?.requestRenderAll())},endOpacityPreview:()=>{const n=e().canvas?.getActiveObject();!n||bl===null||(n.set("opacity",bl),bl=null,e().canvas?.requestRenderAll())},handleColorChange:n=>{const i=e().canvas,a=e().geditor;if(!i)return;if(n.startsWith("bg-")){const m=Tm(n);if(!m)return;n=m}const h=lS(n);if(!h)return;const p=i.getActiveObjects();if(a&&a.activeStop&&e().activePaint==="fill"){a.updateActiveColor(h),o({fill:h}),i.requestRenderAll();return}if(p.length===0){e().activePaint==="stroke"?o({stroke:h}):o({fill:h});return}p.forEach(m=>{if(e().activePaint==="stroke")m.set({stroke:h});else{if(m.fill instanceof Ai)return;m.set({fill:h})}}),e().activePaint==="stroke"?o({stroke:h}):o({fill:h}),i.requestRenderAll()},addShadow:n=>{const i=e().canvas,a=i?.getActiveObject();a&&(a.set("shadow",new wr(n)),i.requestRenderAll())},applyShadowPreset:n=>{const i=e().canvas,a=i?.getActiveObject();if(!a)return;const h=uS[n];if(!h)return;const p=new wr({...h});a.set("shadow",p),i.requestRenderAll(),o({activeObjectShadow:p})},removeShadow:()=>{const n=e().canvas,i=n?.getActiveObject();i&&(i.set("shadow",null),n.requestRenderAll(),o({activeObjectShadow:null}))},toFabricPath(n){if(n.type==="path")return n;const a=n.toSVG().match(/d="([^"]+)"/);return a?new Ji(a[1],{fill:n.fill,stroke:n.stroke,strokeWidth:n.strokeWidth,scaleX:n.scaleX,scaleY:n.scaleY,angle:n.angle}):null},booleanOperation:async(n="union")=>{try{const i=e().canvas,a=i.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}const h=a.getObjects();if(h.length<2)return;if(!ys[n]){console.error("Invalid boolean operation:",n);return}const p=[],m=[];if(h.forEach(K=>{K.type==="textbox"||K.type==="text"||K.type==="i-text"?m.push(K):p.push(K)}),p.length+m.length<2){alert("Select at least 2 objects for boolean operation.");return}i.discardActiveObject();const _=a.getBoundingRect(!0),b={x:_.left+_.width/2,y:_.top+_.height/2},E=Tc(p[0]),I=new kc.PaperScope;I.setup(new I.Size(5e3,5e3)),I.activate();let O=[];const Q=[...p,...m];for(const K of Q){const ae=K.toSVG(),le=I.project.importSVG(ae,{expandShapes:!0,insert:!1}),ge=gd(le.children?.[0]??le),xe=Array.isArray(ge)?ge.filter(F=>F&&typeof F.subtract=="function"):ge&&typeof ge.subtract=="function"?[ge]:[];for(const F of xe)if(!(!F||typeof F.divide!="function")){if(O.length===0){O.push(F);continue}if(["divide","cut","xorSplit"].includes(n)){const Ne=[];O.forEach(Ve=>{let qe=ys[n](Ve,F);qe&&(Array.isArray(qe)||(qe=[qe]),qe.forEach(ot=>{ot&&typeof ot.divide=="function"&&Ne.push(ot)}))}),O=Ne;continue}if(["union","subtract","intersect","exclude","smartUnion","punch","crop"].includes(n)){const Ne=ys[n](O[0],F);Ne&&(O=[Ne])}}}const W=[];if(O.length>0){const ae=`<svg xmlns="http://www.w3.org/2000/svg">${O.map(ge=>ge.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`)}</svg>`;(await Ao(ae)).objects.forEach(ge=>{ge.set({...E,strokeUniform:!0,originX:"center",originY:"center"}),ge.setPositionByOrigin(new Ce(b.x,b.y),"center","center"),W.push(ge)})}i.remove(...h),W.forEach(K=>i.add(K)),m.forEach(K=>i.add(K));const ee=[...W,...m];if(ee.length>1){const K=new ui(ee,{canvas:i});i.setActiveObject(K)}else ee.length===1&&i.setActiveObject(ee[0]);i.requestRenderAll()}catch(i){console.error("Boolean operation error:",i),alert("Boolean operation failed. Check console for details.")}},booleanOperationcd:async(n="union")=>{try{const i=e().canvas,a=i.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}const h=a.getObjects();if(h.length<2)return;if(!ys[n]){console.error("Invalid boolean operation:",n);return}const p=a.getBoundingRect(!0),m={x:p.left+p.width/2,y:p.top+p.height/2},_=Tc(h[0]);i.discardActiveObject();const b=new kc.PaperScope;b.setup(new b.Size(5e3,5e3));let E=[];if(h.forEach(W=>{let ee=W;(W.type==="text"||W.type==="i-text")&&(ee=W.toPath());const K=b.project.importSVG(ee.toSVG(),{expandShapes:!0,insert:!1}),ae=gd(K.children?.[0]??K);(Array.isArray(ae)?ae:ae?[ae]:[]).forEach(ge=>{if(!(!ge||typeof ge.divide!="function")){if(E.length===0){E.push(ge);return}if(["divide","cut","xorSplit"].includes(n)){const xe=[];E.forEach(F=>{let Ne=ys[n](F,ge);Ne&&(Array.isArray(Ne)||(Ne=[Ne]),Ne.forEach(Ve=>{Ve&&typeof Ve.divide=="function"&&xe.push(Ve)}))}),E=xe;return}if(["union","subtract","intersect","exclude","smartUnion","punch","crop"].includes(n)){const xe=ys[n](E[0],ge);E=xe?[xe]:[E[0]]}}})}),!E||E.length===0)return;const O=`<svg xmlns="http://www.w3.org/2000/svg">${E.map(W=>W.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`)}</svg>`,{objects:Q}=await Ao(O);if(!Q||Q.length===0)return;if(i.remove(...h),Q.forEach(W=>{W.set({..._,strokeUniform:!0}),i.add(W)}),Q.length>1){const W=new ui(Q,{canvas:i});i.setActiveObject(W)}else i.setActiveObject(Q[0]);i.requestRenderAll()}catch(i){console.error("Boolean operation error:",i),alert("Boolean operation failed. Check console for details.")}},booleanOperationfinal:async(n="union")=>{try{const i=e().canvas,a=i.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}const h=a.getObjects();if(h.length<2)return;if(!ys[n]){console.error("Invalid boolean operation:",n);return}const p=a.getBoundingRect(!0),m={x:p.left+p.width/2,y:p.top+p.height/2},_=Tc(h[0]);i.discardActiveObject();const b=new kc.PaperScope;b.setup(new b.Size(5e3,5e3));let E=[];if(h.forEach((ee,K)=>{const ae=b.project.importSVG(ee.toSVG(),{expandShapes:!0,insert:!1}),le=gd(ae.children?.[0]??ae);(Array.isArray(le)?le:[le]).forEach(xe=>{if(!xe)return;if(E.length===0){E.push(xe);return}const F=ys[n](E[0],xe);F&&(Array.isArray(F)?E=F:E=[F])})}),!E||E.length===0)return;const O=`<svg xmlns="http://www.w3.org/2000/svg">${E.map(ee=>ee.exportSVG({asString:!0,bounds:"content",precision:3})).join(`
`)}</svg>`,{objects:Q}=await Ao(O);if(!Q||Q.length===0)return;i.remove(...h),Q.forEach(ee=>{ee.set({..._,strokeUniform:!0}),i.add(ee)});const W=new ui(Q,{canvas:i});i.setActiveObject(W),i.requestRenderAll()}catch(i){console.error("Boolean operation failed:",i),alert("Boolean operation failed. See console for details.")}},booleanOperation1:async(n="union")=>{const i=e().canvas,a=i.getActiveObject();if(!a||a.type!=="activeselection"){alert("Select at least 2 objects");return}if(!cS[n]){console.error("Invalid boolean operation:",n);return}const h=a.getObjects();if(h.length<2)return;const p=a.getBoundingRect(!0);p.left+p.width/2,p.top+p.height/2;const m=h[0],_=Tc(m);i.discardActiveObject();const b=new kc.PaperScope;b.setup(new b.Size(5e3,5e3));const E=sS(b,h,n);if(!E||E.length===0)return;const I=oS(b,E,n);if(!I)return;const{objects:O}=await Ao(`<svg xmlns="http://www.w3.org/2000/svg">${I}</svg>`);if(!O||O.length===0)return;O.forEach(W=>W.set({..._,strokeUniform:!0})),i.remove(...h),O.forEach(W=>i.add(W));const Q=new ui(O,{canvas:i});i.setActiveObject(Q),i.requestRenderAll()},unionSelected(n){return e().booleanOperation("union",n)},intersectSelected(n){return e().booleanOperation("intersect",n)},subtractSelected(n){return e().booleanOperation("subtract",n)},excludeSelected(n){return e().booleanOperation("exclude",n)},divideSelected(n){return e().booleanOperation("divide",n)},cutSelected(n){return e().booleanOperation("cut",n)},punchSelected(n){return e().booleanOperation("punch",n)},cropSelected(n){return e().booleanOperation("crop",n)},smartUnionSelected(n){return e().booleanOperation("smartUnion",n)},xorSplitSelected(n){return e().booleanOperation("xorSplit",n)}});function gd(o){return o.strokeWidth&&(o.strokeColor=null,o.strokeWidth=0,o.fill="black",o.closed=!0),o}const pS=(o,e,t)=>({MAX_HISTORY:20,_isRestoring:!1,undoStack:[],redoStack:[],saveState:()=>{const{canvas:n,_isRestoring:i,undoStack:a}=e();if(!n||i)return;const h=JSON.stringify(n.toJSON()),p=[...a,h];o({undoStack:p,redoStack:[]})},undo:()=>{const{canvas:n,undoStack:i,redoStack:a}=e();if(!n||i.length<=1)return;const h=JSON.stringify(n.toJSON()),p=i[i.length-1],m=i.slice(0,-1);o({_isRestoring:!0}),n.loadFromJSON(p,()=>{o({undoStack:m,redoStack:[h,...a],_isRestoring:!1}),n.requestRenderAll()})},redo:()=>{const{canvas:n,undoStack:i,redoStack:a}=e();if(!n||a.length===0)return;const h=JSON.stringify(n.toJSON()),p=a[0],m=a.slice(1);o({_isRestoring:!0}),n.loadFromJSON(p,()=>{o({undoStack:[...i,h],redoStack:m,_isRestoring:!1}),n.requestRenderAll()})},clearHistory:()=>o({undoStack:[],redoStack:[]})});function gS(o,e,t){return e&&!t?-o:!e&&t?180-o:o}function Sl(o){return Math.round(o??0)}const mS=(o,e,t)=>({transform:{x:0,y:0,width:100,height:100,rotation:0,flipX:!1,flipY:!1,originX:"center",centerY:"center",id:"c"},hasSelection:!1,_isSyncing:!1,updateFromFabric:n=>{if(!n){o({hasSelection:!1});return}if(e()._isSyncing)return;const i={x:Sl(n.left),y:Sl(n.top),width:Sl(n.getScaledWidth?.()??(n.width||0)*(n.scaleX||1)),height:Sl(n.getScaledHeight?.()??(n.height||0)*(n.scaleY||1)),rotation:Sl(n.angle||0),flipX:n.scaleX<0,flipY:n.scaleY<0},a=e().transform;(a.x!==i.x||a.y!==i.y||a.width!==i.width||a.height!==i.height||a.rotation!==i.rotation||a.flipX!==i.flipX||a.flipY!==i.flipY)&&o({transform:i,hasSelection:!0})},updateFabricFromStore1:()=>{const{transform:n,canvas:i}=e(),a=i?.getActiveObject();if(!a)return;o({_isSyncing:!0}),a.set({originX:"center",originY:"center",objectCaching:!1});const h=a._originalWidth||a.width||1,p=a._originalHeight||a.height||1;a._originalWidth||(a._originalWidth=h,a._originalHeight=p);const m=n.width/h,_=n.height/p;a.set({angle:n.rotation||0,scaleX:n.flipX?-Math.abs(m):Math.abs(m),scaleY:n.flipY?-Math.abs(_):Math.abs(_)}),a.setPositionByOrigin(new Ce(n.x,n.y),"center","center"),a.setCoords(),i.requestRenderAll(),o({_isSyncing:!1})},updateFabricFromStore:()=>{const{transform:n,canvas:i}=e(),a=i?.getActiveObject();if(!a||e()._isSyncing)return;o({_isSyncing:!0});const h=Number(n.x)||0,p=Number(n.y)||0,m=Math.max(1,Number(n.width)||1),_=Math.max(1,Number(n.height)||1),b=Number(n.rotation)||0,E=!!n.flipX,I=!!n.flipY;if(a.type==="image"){const O=a.width||1,Q=a.height||1;a.set({left:h,top:p,scaleX:m/O,scaleY:_/Q,angle:b,flipX:E,flipY:I})}else a.set({left:h,top:p,width:m,height:_,angle:b,flipX:E,flipY:I});a.setCoords(),i.requestRenderAll(),o({_isSyncing:!1})},updateFabricFromStore1:()=>{console.log(".......");const{transform:n,canvas:i}=e(),a=i?.getActiveObject();if(!a||e()._isSyncing)return;o({_isSyncing:!0});const h=Number(n.x)||0,p=Number(n.y)||0,m=Math.max(1,Number(n.width)||1),_=Math.max(1,Number(n.height)||1),b=Number(n.rotation)||0,E=!!n.flipX,I=!!n.flipY,O=gS(b,E,I);a.set({left:h,top:p,width:m,height:_,angle:O,flipX:E,flipY:I}),a.setCoords(),i.requestRenderAll(),o({_isSyncing:!1})},updateFabricFromStore11:()=>{const{transform:n,canvas:i}=e(),a=i?.getActiveObject();if(!a||e()._isSyncing)return;o({_isSyncing:!0});const h=Number(n.x)||0,p=Number(n.y)||0,m=Number(n.width)||1,_=Number(n.height)||1;let b=Number(n.rotation)||0;const E=!!n.flipX,I=!!n.flipY;console.log(h,p),E&&!I?b=-b:!E&&I&&(b=180-b);const O=a.getCenterPoint();a.set({originX:"center",originY:"center",left:O.x,top:O.y,width:m,height:_,angle:b,flipX:E,flipY:I}),a.setCoords(),i.renderAll(),o({_isSyncing:!1})},setTransform:(n,i)=>{o(a=>({transform:{...a.transform,[n]:i}})),requestAnimationFrame(()=>e().updateFabricFromStore())},flipX:()=>{o(n=>({transform:{...n.transform,flipX:!n.transform.flipX}})),requestAnimationFrame(()=>e().updateFabricFromStore())},flipY:()=>{o(n=>({transform:{...n.transform,flipY:!n.transform.flipY}})),requestAnimationFrame(()=>e().updateFabricFromStore())},setOrigin:n=>{o(i=>({transform:{...i.transform,originX:n.originX,originY:n.originY,id:n.id}})),requestAnimationFrame(()=>e().updateFabricFromStore())}}),vS=(o,e,t)=>({addShape:(n,i={})=>{const a=e().canvas;if(!a)return;const{pageWidth:h,pageHeight:p,scale:m}=e(),_=h/2*m,b=p/2*m;i={...{left:_,top:b,originX:"center",originY:"center",selection:!0,hasControls:!0,customType:"shape"},...i},console.log({pageWidth:h,pageHeight:p,scale:m,options:i});let I;switch(n){case"rect":I=new yr({width:80,height:80,fill:"transparent",stroke:"black",...i});break;case"circle":I=new jr({radius:48,fill:"transparent",stroke:"black",...i});break;case"capsule":I=new yr({radius:48,fill:"transparent",stroke:"black",...i});break;case"ellipse":I=new Ti({rx:70,ry:45,fill:"transparent",stroke:"black",...i});break;case"triangle":I=new es({width:100,height:100,fill:"transparent",stroke:"black",...i});break;case"line":I=new li([50,50,200,50],{stroke:"black",strokeWidth:2,selectable:!0,hasControls:!0,hasBorders:!1,...i});break;case"polygon":case"pentagon":I=new na(i.points||[{x:0,y:0},{x:50,y:0},{x:25,y:50}],{fill:"transparent",stroke:"black",...i});break;case"diamond":I=new na([{x:0,y:i.height/2||40},{x:i.width/2||40,y:0},{x:i.width||80,y:i.height/2||40},{x:i.width/2||40,y:i.height||80}],{fill:"transparent",stroke:"black",...i});break;case"star":I=new na(e().generateStarPoints(i.numPoints||5,i.outerRadius||50,i.innerRadius||20),{fill:"transparent",stroke:"black",...i});break;case"arrow":I=e().createArrowShape({...i});break;case"paper":{const O=new yr({width:300,height:80,fill:"#FFFFFF",originX:"center",originY:"center",stroke:1,fontFamily:"Bubblegum Sans"}),Q=new ns("Type to enter text",{fontSize:20,width:200,textAlign:"center",originX:"center",originY:"center",fontFamily:"Bubblegum Sans"});I=new er([O,Q],i),I.__text=Q,I.__box=O,Q.__group=I}break;default:console.warn("Shape not supported:",n);return}a.add(I),a.setActiveObject(I),a.renderAll(),e().setToolbar({target:I}),e().updateFromFabric(I),e().saveState(),e().addLayer(I,n)},generateStarPoints:(n=5,i=50,a=20)=>{const h=[],p=Math.PI/n;for(let m=0;m<2*n;m++){const _=m%2===0?i:a,b=m*p-Math.PI/2;h.push({x:_*Math.cos(b),y:_*Math.sin(b)})}return h},createArrowShape:({width:n=120,stroke:i="black",strokeWidth:a=2,headLength:h=12,headWidth:p=12,left:m=0,top:_=0})=>{const b=new li([0,0,n,0],{stroke:i,strokeWidth:a,originX:"left",originY:"center"}),E=new es({width:h,height:p,fill:i,left:n,top:0,angle:90,originX:"center",originY:"center"});return new er([b,E],{left:m,top:_,originX:"center",originY:"center"})}}),yS=["Arial","Bubblegum Sans","Comic Neue","Consolas","Courier New","Fredoka One","Georgia","Helvetica","Monaco","Palatino","Patrick Hand","Tahoma","Times New Roman","Trebuchet MS","Verdana"],_S=(o,e,t)=>({fonts:yS,fontSize:16,bgColor:"#000000",setBgColor:n=>o({bgColor:n}),setFontSize:n=>o({fontSize:n}),color:"#000000",hasShadow:!1,setHasShadow:n=>o({hasShadow:n}),shadowColor:"",setShadowColor:n=>o({shadowColor:n}),setColor:n=>o({color:n}),fontFamily:"Arial",setFontFamily:n=>o({fontFamily:n}),isBold:!1,setIsBold:n=>o({isBold:n}),isItalic:!1,setIsItalic:n=>o({isItalic:n}),isUnderline:!1,setIsUnderline:n=>o({isUnderline:n}),charSpacing:0,setCharSpacing:n=>o({charSpacing:n}),lineHeight:1.2,setLineHeight:n=>o({lineHeight:n}),strokeColor:"#000000",setStrokeColor:n=>o({strokeColor:n}),strokeWidth:1,setStrokeWidth:n=>o({strokeWidth:n}),fillColor:"#000000",setFillColor:n=>o({fillColor:n}),addText:(n={})=>{const i=e().canvas;if(!i)return;const{text:a="Enter text",fontSize:h=36,bold:p=!1,italic:m=!1,underline:_=!1,fontFamily:b="Bubblegum Sans",width:E=300,textColor:I="#000000",placeholderColor:O="#9ca3af"}=n,{pageWidth:Q,pageHeight:W,scale:ee}=e(),K=Q/2*ee,ae=W/2*ee,le=new ns(a,{left:K,top:ae,originX:"center",originY:"center",fontSize:h,fontWeight:p?"bold":"normal",fontStyle:m?"italic":"normal",underline:_,fill:O,fontFamily:b,width:E,editable:!0,objectCaching:!1,padding:6,splitByGrapheme:!0});le.on("editing:entered",()=>{le.fill===O&&(le.selectAll(),le.set("fill",I),i.requestRenderAll())}),le.on("editing:exited",()=>{le.text.trim()?le.set("fill",I):(le.text=a,le.set("fill",O)),i.requestRenderAll()}),i.add(le),i.setActiveObject(le),le.enterEditing(),setTimeout(()=>{le.hiddenTextarea?.focus(),le.selectAll()},0),o({showTextToolbar:!0,selectedObject:le}),e().saveState(),i.requestRenderAll()}});function xS(o){const[,e,t]=o.split("-");return qy[e]?.[t]}const wS=(o,e,t)=>({backgroundColor:"#ff0000",borderColor:"#000000",borderWidth:"1",borderStyle:"solid",setBackgroundColor:n=>{const i=e().canvas;if(!i)return;const a=xS(n);if(!a)return;const h=i.getActiveObject();h&&(h.set("fill",a),i.requestRenderAll(),o({backgroundColor:n}))}}),bS=(o,e,t)=>({visible:!1,x:0,y:0,items:[],openMenu:(n,i,a)=>{const p=a.length*36,m=Math.min(n,window.innerWidth-220),_=Math.min(i,window.innerHeight-p);o({visible:!0,x:m,y:_,items:a})},closeMenu:()=>o({visible:!1})}),SS=(o,e,t)=>({...F2(o,e),...Z2(o,e),...B2(o,e),...z2(o,e),...V2(o,e),...Y2(o,e),...K2(o,e),...dS(o,e),...pS(o,e),...mS(o,e),...vS(o,e),..._S(o,e),...wS(o,e),...bS(o)}),$e=O2(SS);function CS(){const o=$e(t=>t.commands),e=$e(t=>t.runCommand);ke.useEffect(()=>{const t=n=>{const i=n.target;if(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||i.isContentEditable)return;const a=[n.metaKey?"Meta":"",n.ctrlKey?"Ctrl":"",n.shiftKey?"Shift":"",n.altKey?"Alt":"",n.key.length===1?n.key.toLowerCase():n.key].filter(Boolean).join("+"),h=o.find(p=>p.shortcut?.some(m=>m.toLowerCase()===a.toLowerCase()));h&&(n.preventDefault(),e(h.id))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[o,e])}function Ky(o){var e,t,n="";if(typeof o=="string"||typeof o=="number")n+=o;else if(typeof o=="object")if(Array.isArray(o)){var i=o.length;for(e=0;e<i;e++)o[e]&&(t=Ky(o[e]))&&(n&&(n+=" "),n+=t)}else for(t in o)o[t]&&(n&&(n+=" "),n+=t);return n}function fi(){for(var o,e,t=0,n="",i=arguments.length;t<i;t++)(o=arguments[t])&&(e=Ky(o))&&(n&&(n+=" "),n+=e);return n}const Zy=({options:o,value:e,onChange:t,className:n=""})=>Z.jsxs("div",{className:fi("relative inline-block",n),children:[Z.jsx("select",{value:e,onChange:i=>t(i.target.value),className:fi("w-full appearance-none rounded-md border border-gray-300 bg-white px-3 py-1 pr-8 text-sm shadow-sm","focus:border-blue-500 focus:ring-2 focus:ring-blue-400 focus:outline-none hover:border-gray-400 transition"),children:o.map(i=>Z.jsx("option",{value:i,style:{fontFamily:i},children:i},i))}),Z.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-500",children:""})]}),Ec=8,kS=300,Bo=({content:o,position:e="top",children:t})=>{const n=ke.useRef(null),i=ke.useRef(null),a=ke.useRef(null),[h,p]=ke.useState(!1),[m,_]=ke.useState({top:0,left:0}),[b,E]=ke.useState(e);ke.useEffect(()=>()=>{a.current&&window.clearTimeout(a.current)},[]);const I=()=>{a.current&&window.clearTimeout(a.current),a.current=window.setTimeout(()=>{a.current=null,p(!0)},kS)},O=()=>{a.current&&(window.clearTimeout(a.current),a.current=null),p(!1)};ke.useLayoutEffect(()=>{if(!h||!n.current||!i.current)return;const K=n.current.getBoundingClientRect(),ae=i.current.getBoundingClientRect(),le=Ne=>{switch(Ne){case"bottom":return{top:K.bottom+Ec,left:K.left+K.width/2-ae.width/2};case"left":return{top:K.top+K.height/2-ae.height/2,left:K.left-ae.width-Ec};case"right":return{top:K.top+K.height/2-ae.height/2,left:K.right+Ec};default:return{top:K.top-ae.height-Ec,left:K.left+K.width/2-ae.width/2}}};let ge=e,{top:xe,left:F}=le(ge);xe<4&&ge==="top"&&(ge="bottom"),xe+ae.height>window.innerHeight&&ge==="bottom"&&(ge="top"),F<4&&ge==="left"&&(ge="right"),F+ae.width>window.innerWidth&&ge==="right"&&(ge="left"),{top:xe,left:F}=le(ge),E(ge),_({top:Math.max(6,Math.round(xe)),left:Math.max(6,Math.round(F))})},[h,e]);const Q=K=>{K.key==="Escape"&&O()},W=ke.useRef(`tooltip-${Math.random().toString(36).slice(2)}`),ee=typeof document<"u"?document.body:null;return Z.jsxs(Z.Fragment,{children:[Z.jsx("span",{ref:n,className:"inline-flex",onMouseEnter:I,onMouseLeave:O,onClick:O,onFocus:I,onBlur:O,onKeyDown:Q,tabIndex:0,"aria-describedby":o?W.current:void 0,children:t}),h&&ee?$m.createPortal(Z.jsxs("div",{id:W.current,ref:i,role:"tooltip","aria-hidden":!h,style:{position:"fixed",top:m.top,left:m.left},className:"animate-tooltip z-[9999] rounded-md bg-white px-3 py-1.5 text-[11px] font-medium text-gray-900 shadow-[0_8px_24px_rgba(0,0,0,0.18)] whitespace-nowrap pointer-events-none animate-tooltip-min",children:[o,Z.jsx("div",{className:`absolute w-1.5 h-1.5 bg-white rotate-45 ${b==="top"?"bottom-[-3px] left-1/2 -translate-x-1/2":b==="bottom"?"top-[-3px] left-1/2 -translate-x-1/2":b==="left"?"right-[-3px] top-1/2 -translate-y-1/2":"left-[-3px] top-1/2 -translate-y-1/2"}`})]}),ee):null]})},_s=({options:o,value:e={},onChange:t,single:n=!1})=>{const[i,a]=ke.useState(e),h=20,p=_=>{let b;n?b=Object.fromEntries(o.map(E=>[E.key,E.key===_])):b={...i,[_]:!i[_]},a(b),t?.(b)},m=_=>typeof _=="string"?Z.jsx("i",{className:_,style:{fontSize:h*.55}}):_;return Z.jsx("div",{className:`
        inline-flex overflow-hidden
        rounded-lg
        border border-gray-200
        bg-white
        shadow-[0_1px_2px_rgba(0,0,0,0.03)]
      `,children:o.map(({key:_,icon:b,label:E,tooltip:I})=>{const O=i[_];return Z.jsx(Bo,{content:I,position:"bottom",children:Z.jsxs("button",{type:"button",onClick:()=>p(_),className:`
              flex items-center gap-1.5
              px-2.5 py-1.5
              text-[11px] font-medium
              transition-colors
              border-r border-gray-100 last:border-r-0

              ${O?"bg-gray-900 text-white":"text-gray-600 hover:bg-gray-50"}
            `,children:[m(b),E&&Z.jsx("span",{children:E})]},_)},_)})})},Wl=({label:o,value:e,onChange:t,min:n=0,max:i=100,step:a=1,className:h=""})=>{const p=()=>t(Math.min(i,e+a)),m=()=>t(Math.max(n,e-a));return Z.jsxs("div",{className:fi("inline-flex items-center gap-2",h),children:[o&&Z.jsxs("label",{className:"text-xs",children:[o,":"]}),Z.jsxs("div",{className:"relative inline-flex w-18 rounded-md shadow-sm",children:[Z.jsx("input",{type:"number",value:Number(e).toString(),onChange:_=>t(Number(_.target.value)),min:n,max:i,step:a,className:"w-full rounded-full border border-gray-300 bg-white px-3 py-[2px] text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-400 focus:outline-none hover:border-gray-400 transition appearance-textfield"}),Z.jsxs("div",{className:"absolute inset-y-1 right-1 flex flex-col divide-y border-l divide-gray-300 border-gray-300 bg-white rounded-r-md overflow-hidden",children:[Z.jsx("button",{type:"button",onClick:p,className:"flex-1 flex items-center justify-center px-1 text-gray-600 hover:bg-gray-100",children:Z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",stroke:"currentColor",children:Z.jsx("path",{d:"M2 5L4 3L6 5",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),Z.jsx("button",{type:"button",onClick:m,className:"flex-1 flex items-center justify-center px-1 text-gray-600 hover:bg-gray-100",children:Z.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 8 8",fill:"none",stroke:"currentColor",children:Z.jsx("path",{d:"M2 3L4 5L6 3",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})]})};function TS({target:o,canvas:e,onChange:t}){const n=$e(Q=>Q.fontSize),i=$e(Q=>Q.setFontSize),a=$e(Q=>Q.color),h=$e(Q=>Q.setColor),p=$e(Q=>Q.fontFamily),m=$e(Q=>Q.setFontFamily);$e(Q=>Q.isBold);const _=$e(Q=>Q.setIsBold);$e(Q=>Q.isItalic);const b=$e(Q=>Q.setIsItalic);$e(Q=>Q.isUnderline);const E=$e(Q=>Q.setIsUnderline),I=$e(Q=>Q.fonts),O=ke.useRef(null);return ke.useEffect(()=>{o&&(i(o.fontSize||16),h(o.fill||"#000000"),_(o.fontWeight==="bold"))},[o]),ke.useLayoutEffect(()=>{if(!o||!e||!O.current)return;const Q=O.current,W=()=>{if(!o||!Q)return;o.setCoords();const{tl:le,tr:ge,bl:xe,br:F}=o.aCoords,Ne=(le.x+ge.x)/2,Ve=(xe.y+F.y)/2,qe=e.viewportTransform||[1,0,0,1,0,0],ot=qe[0]*Ne+qe[2]*Ve+qe[4],je=qe[1]*Ne+qe[3]*Ve+qe[5],Ze=e.getElement().getBoundingClientRect(),dt=8,We=Ze.left+ot,Bt=Ze.top+je+dt,Le=Q.getBoundingClientRect();Q.style.position="fixed",Q.style.left=`${We-Le.width/2}px`,Q.style.top=`${Bt}px`,Q.style.zIndex="500"};let ee=null;const K=()=>{ee==null&&(ee=requestAnimationFrame(()=>{ee=null,W()}))};W();const ae=["object:moving","object:scaling","object:rotating","object:modified","mouse:wheel","after:render"];return ae.forEach(le=>e.on(le,K)),window.addEventListener("resize",W),window.addEventListener("scroll",W,!0),()=>{ae.forEach(le=>e.off(le,K)),window.removeEventListener("resize",W),window.removeEventListener("scroll",W,!0),ee!=null&&cancelAnimationFrame(ee)}},[o,e]),o?Z.jsxs("div",{ref:O,className:"absolute z-50 flex items-center gap-2 bg-white shadow-lg rounded-full px-4 py-2",children:[Z.jsxs("label",{className:"relative cursor-pointer",children:[Z.jsx("input",{type:"color",value:a,onChange:Q=>{const W=Q.target.value;h(W),t?.({fill:W})},className:"absolute inset-0 opacity-0 cursor-pointer"}),Z.jsx("div",{className:"h-6 w-6 rounded-full border shadow-sm",style:{backgroundColor:a}})]}),Z.jsx(Zy,{onChange:Q=>{console.log(Q),m(Q),t?.({fontFamily:Q})},options:I,value:p}),Z.jsx(Wl,{value:n,onChange:Q=>{const W=parseInt(String(Q),10);i(W),t?.({fontSize:W})}}),Z.jsx(_s,{options:[{key:"bold",icon:"fa-solid fa-bold"},{key:"italic",icon:"fa-solid fa-italic"},{key:"underline",icon:"fa-solid fa-underline"}],onChange:Q=>{console.log("formats:",Q);const{bold:W,italic:ee,underline:K}=Q;_(W),b(ee),E(K),t?.({fontWeight:W?"bold":"normal",fontStyle:ee?"italic":"normal",underline:K})}})]}):null}const ES=typeof navigator<"u"&&/Mac|iPhone|iPad/i.test(navigator.platform),ko=(o,e)=>ES?o:e;function OS(){const o=ke.useRef(null),e=ke.useRef(null),{init:t,selectedObject:n,canvas:i,openMenu:a,fill:h}=$e(),p=$e();CS(),ke.useEffect(()=>(o.current&&(t(o.current),e.current=new Gy(i,()=>h)),()=>{i&&(i.dispose(),e.current?.disable(),e.current=null)}),[t]);const m=_=>{_.preventDefault(),a(_.clientX,_.clientY,[{label:"Copy",icon:Z.jsx("i",{className:"fa-solid fa-copy"}),shortcut:ko("C","Ctrl+C"),when:()=>p.hasSelection,onClick:()=>p.copy()},{label:"Paste",icon:Z.jsx("i",{className:"fa-solid fa-paste"}),shortcut:ko("V","Ctrl+V"),when:()=>p.canPaste(),onClick:()=>p.paste()},{label:"Duplicate",icon:Z.jsx("i",{className:"fa-solid fa-clone"}),shortcut:ko("D","Ctrl+D"),when:()=>p.hasSelection,onClick:()=>p.duplicate()},{type:"divider"},{label:"Group",icon:Z.jsx("i",{className:"fa-solid fa-object-group"}),shortcut:ko("G","Ctrl+G"),when:()=>p.hasMultipleSelection(),onClick:()=>p.groupLayers()},{label:"Ungroup",icon:Z.jsx("i",{className:"fa-solid fa-object-ungroup"}),shortcut:ko("G","Ctrl+Shift+G"),when:()=>p.isGroupSelected(),onClick:()=>p.ungroupSelected()},{type:"divider"},{label:"Delete",icon:Z.jsx("i",{className:"fa-solid fa-trash"}),shortcut:ko("","Del"),when:()=>p.hasSelection,onClick:()=>p.removeLayer()}])};return Z.jsxs("main",{className:"bg-red-500 shadow-lg relative",onContextMenu:m,children:[Z.jsx("canvas",{ref:o}),n?.type==="textbox"&&i&&Z.jsx(TS,{target:n,canvas:i,onChange:_=>{n&&(n.set(_),i.requestRenderAll())}})]})}const Em={tl:{x:"left",y:"top",left:"12%",top:"12%"},tr:{x:"right",y:"top",left:"88%",top:"12%"},c:{x:"center",y:"center",left:"50%",top:"50%"},bl:{x:"left",y:"bottom",left:"12%",top:"88%"},br:{x:"right",y:"bottom",left:"88%",top:"88%"}};function PS({size:o=24,value:e="c",onChange:t}){const n=Em[e],i=o*.34;return Z.jsxs("div",{style:{width:o,height:o,position:"relative",cursor:"pointer"},children:[Z.jsx("div",{style:{position:"absolute",inset:2,borderRadius:3,border:"1px solid #cbd5e1",background:"linear-gradient(#ffffff, #f8fafc)"}}),Z.jsx("div",{style:{position:"absolute",inset:"50% 4px auto 4px",height:1,background:"#e2e8f0"}}),Z.jsx("div",{style:{position:"absolute",inset:"4px auto 4px 50%",width:1,background:"#e2e8f0"}}),Object.entries(Em).map(([a,h])=>Z.jsx("div",{onClick:()=>t?.({originX:h.x,originY:h.y,id:a}),style:{position:"absolute",left:h.left,top:h.top,width:o*.45,height:o*.45,transform:"translate(-50%,-50%)"}},a)),e==="c"?Z.jsx("div",{style:{position:"absolute",left:n.left,top:n.top,width:i,height:i,borderRadius:"50%",background:"#ffffff",border:"2px solid #3b82f6",boxShadow:`
              0 1px 2px rgba(0,0,0,0.15),
              0 0 0 3px rgba(59,130,246,0.15)
            `,transform:"translate(-50%,-50%)",transition:"all 140ms ease"}}):Z.jsx("div",{style:{position:"absolute",left:n.left,top:n.top,width:i,height:i,borderRadius:"50%",background:"#3b82f6",boxShadow:`
              0 2px 4px rgba(0,0,0,0.2),
              0 0 0 3px rgba(59,130,246,0.25)
            `,transform:"translate(-50%,-50%)",transition:"all 140ms ease"}})]})}const Oc=o=>Z.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o,children:[Z.jsx("path",{d:"M10 5L3.5 19H10V5Z",className:"fill-current opacity-50"}),Z.jsx("path",{d:"M14 5L20.5 19H14V5Z",className:"fill-current"}),Z.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"21","stroke-width":"2","stroke-dasharray":"3 2","stroke-linecap":"round",className:"stroke-current"})]});function ql({action:o,toggleType:e="switch",iconOn:t,iconOff:n,tooltipOn:i="",tooltipOff:a="",initial:h=!1,size:p=26,onChange:m}){const[_,b]=ke.useState(h),E=()=>{let O=_;e==="switch"&&(O=!_),e==="exclusive"&&(O=!0),b(O),m?.({action:o,value:O})},I=O=>typeof O=="string"?Z.jsx("i",{className:O,style:{fontSize:p*.55}}):O;return Z.jsx(Bo,{content:_?i:a,position:"bottom",children:Z.jsx("button",{onClick:E,style:{width:p,height:p,borderRadius:6,background:_?"linear-gradient(#3b82f6, #2563eb)":"linear-gradient(#ffffff, #f1f5f9)",border:"1px solid #cbd5e1",boxShadow:_?"0 2px 4px rgba(37,99,235,0.4)":"0 1px 2px rgba(0,0,0,0.12)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 140ms ease",color:_?"#fff":"#334155"},children:Z.jsx("div",{style:{width:p*.6,height:p*.6,display:"flex",alignItems:"center",justifyContent:"center"},children:I(_?t:n)})})})}const AS=({label:o,value:e=0,min:t=0,max:n,step:i=1,onChange:a,onKeyDown:h,unit:p,disabled:m,className:_=""})=>Z.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-500",children:[Z.jsxs("span",{children:[o,":"]}),Z.jsxs("div",{className:"flex items-center gap-0.5",children:[Z.jsx("input",{type:"number",min:t,max:n,step:i,value:e,disabled:m,onChange:b=>a?.(Number(b.target.value)),onKeyDown:h,className:`w-14 h-6 px-1.5 text-[11px] text-gray-500 border border-gray-200
            rounded bg-transparent focus:outline-none focus:border-gray-300`}),p&&Z.jsx("span",{className:"text-[10px] text-gray-400",children:p})]})]}),Qy=({label:o,value:e,disabled:t,onChange:n,max:i})=>{const a=p=>{const m=p;if(m===""){n(0);return}let _=parseInt(String(m),10);isNaN(_)&&(_=0),n(_==0?"":_)},h=p=>{(p.key==="."||p.key==="e")&&p.preventDefault()};return Z.jsx(AS,{label:o,value:e??0,onChange:a,disabled:t,onKeyDown:h,max:i})},MS=[{key:"x",label:"X"},{key:"y",label:"Y"},{key:"width",label:"W"},{key:"height",label:"H"},{key:"rotation",label:"R"}],jS=()=>{const o=$e(K=>K.transform),e=$e(K=>K.setTransform),t=$e(K=>K.groupLayers),n=$e(K=>K.ungroupSelected),i=$e(K=>K.bringForward),a=$e(K=>K.sendBackward),h=$e(K=>K.bringToFront),p=$e(K=>K.sendToBack),m=$e(K=>K.toggleActiveObjectLock),_=$e(K=>K.alignObjects),b=$e(K=>K.hasSelection),E=$e(K=>K.removeLayer),I=$e(K=>K.setOrigin);$e(K=>K.canvas);const[O,Q]=ke.useState(!1),W=(K,ae)=>{K==="group"?t():K==="ungroup"?n():K==="bringforward"?i():K==="sendbackward"?a():K==="sendtoback"?p():K==="bringtofront"?h():K==="lock"||K==="unlock"?m():K==="delete"&&E()},ee=(K,ae)=>{_(K)};return Z.jsx("div",{className:"px-5 py-2 overflow-x-auto shadow-sm bg-white",children:Z.jsxs("div",{className:"flex items-center justify-between whitespace-nowrap text-sm",children:[Z.jsxs("div",{className:"flex items-center gap-4",children:[Z.jsx(PS,{size:24,value:o.id,onChange:K=>{console.log(K),I(K)}}),Z.jsx("div",{className:"flex items-center gap-2",children:MS.map(K=>Z.jsx(Qy,{label:K.label,value:o[K.key],disabled:!b,onChange:ae=>e(K.key,ae)},K.key))}),Z.jsx("div",{className:"border-l h-6 border-gray-300"}),Z.jsx(ql,{action:"flipX",toggleType:"switch",iconOn:Z.jsx(Oc,{className:"cursor-pointer"}),iconOff:Z.jsx(Oc,{className:"cursor-pointer"}),tooltipOn:"Flipped horizontally",tooltipOff:"Flip horizontally",initial:!1,onChange:K=>{const{action:ae,value:le}=K;console.log(ae,le),e(ae,le)}}),Z.jsx(ql,{action:"flipY",toggleType:"switch",iconOn:Z.jsx(Oc,{className:"rotate-90 cursor-pointer"}),iconOff:Z.jsx(Oc,{className:"rotate-90 cursor-pointer"}),tooltipOn:"Flipped vertically",tooltipOff:"Flip vertically",initial:!1,onChange:K=>{console.log(K);const{action:ae,value:le}=K;e(ae,le)}})]}),Z.jsxs("div",{className:"flex items-center gap-4",children:[Z.jsx(_s,{single:!0,options:[{key:"group",icon:"fa-solid fa-object-group",tooltip:"Group"},{key:"ungroup",icon:"fa-solid fa-object-ungroup",tooltip:"Ungroup"}],onChange:K=>{const{group:ae,ungroup:le}=K,ge=Object.entries(K).find(([xe,F])=>F);if(console.log("Group:",ge),ge){const[xe,F]=ge;W(xe)}}}),Z.jsx("div",{className:"border-l h-6 border-gray-300"}),Z.jsx(ql,{action:"lock",toggleType:"switch",iconOn:"fa-solid fa-lock",iconOff:"fa-solid fa-unlock",tooltipOn:"Locked",tooltipOff:"Unlocked",initial:!1,onChange:K=>{const{action:ae,value:le}=K;console.log(ae,le),W(ae)}}),Z.jsx(_s,{single:!0,options:[{key:"sendbackward",icon:"fa-solid fa-angle-down",tooltip:"Send backward"},{key:"bringforward",icon:"fa-solid fa-angle-up",tooltip:"Bring forward"}],onChange:K=>{const{sendtoback:ae,bringtofront:le}=K,ge=Object.entries(K).find(([xe,F])=>F);if(console.log("Back:",ge),ge){const[xe,F]=ge;W(xe)}}}),Z.jsx(_s,{single:!0,options:[{key:"sendtoback",icon:"fa-solid fa-angles-down",tooltip:"Send to back"},{key:"bringtofront",icon:"fa-solid fa-angles-up",tooltip:"Bring to front"}],onChange:K=>{const{sendtoback:ae,bringtofront:le}=K,ge=Object.entries(K).find(([xe,F])=>F);if(console.log("Back:",ge),ge){const[xe,F]=ge;W(xe)}}}),Z.jsx(_s,{single:!0,options:[{key:"left",icon:"fa-solid fa-align-left",tooltip:"Align Left"},{key:"center",icon:"fa-solid fa-align-center",tooltip:"Align Center"},{key:"right",icon:"fa-solid fa-align-right",tooltip:"Align Right"}],onChange:K=>{console.log("align:",K);const{left:ae,center:le,right:ge,justify:xe}=K;let F="align-left";le?F="align-hcenter":ge&&(F="align-right"),ee(F)}}),Z.jsx("div",{className:"border-l h-6 border-gray-300"}),Z.jsx(_s,{single:!0,options:[{key:"top",icon:"fa-solid fa-align-left rotate-90",tooltip:"Align Top"},{key:"middle",icon:"fa-solid fa-align-center -rotate-90",tooltip:"Align Middle"},{key:"bottom",icon:"fa-solid fa-align-right rotate-90",tooltip:"Align Bottom"}],onChange:K=>{console.log("align:",K);const{top:ae,middle:le,bottom:ge}=K;let xe="align-left";ae?xe="align-top":le?xe="align-vcenter":ge&&(xe="align-bottom"),ee(xe)}}),Z.jsx(_s,{single:!0,options:[{key:"distribute-h",icon:"fa-solid fa-align-left rotate-90",tooltip:"Distribute horizontally"},{key:"distribute-v",icon:"fa-solid fa-align-center -rotate-90",tooltip:"Distribute vertically"}],onChange:K=>{console.log("align:",K);const{"distribute-v":ae,"distribute-h":le}=K;let ge="align-left";le?ge="distribute-h":ae&&(ge="distribute-v"),ee(ge)}})]})]})})};function ru({icon:o,active:e,className:t,...n}){return Z.jsx("button",{...n,className:fi("flex items-center justify-center cursor-pointer transition h-8 w-8 p-2 rounded-sm",e?"bg-blue-500 text-white hover:bg-blue-600":"hover:bg-stone-200",t),children:o})}const Fd=({src:o,...e})=>Z.jsx(Z.Fragment,{children:Z.jsx("img",{src:o,...e})});function Pc({label:o,value:e,onChange:t,className:n=""}){return Z.jsxs("label",{className:"inline-flex items-center gap-1.5 text-[11px] text-gray-600",children:[o?Z.jsxs("span",{className:"font-medium",children:[o,":"]}):null,Z.jsx("div",{className:"w-5 h-5 rounded-full p-[2px] border border-gray-200 shadow-sm",style:{backgroundColor:e},children:Z.jsx("input",{type:"color",value:e,onChange:i=>t?.(i.target.value),className:`w-full h-full rounded-full opacity-0 cursor-pointer ${n}`})})]})}const IS=()=>{const{canvas:o}=$e(),e=$e(je=>je.fontSize),t=$e(je=>je.setFontSize),n=$e(je=>je.bgColor),i=$e(je=>je.setBgColor),a=$e(je=>je.color);$e(je=>je.setColor);const h=$e(je=>je.hasShadow),p=$e(je=>je.setHasShadow),m=$e(je=>je.shadowColor),_=$e(je=>je.setShadowColor),b=$e(je=>je.fontFamily),E=$e(je=>je.setFontFamily);$e(je=>je.align),$e(je=>je.setAlign),$e(je=>je.isBold);const I=$e(je=>je.setIsBold);$e(je=>je.isItalic);const O=$e(je=>je.setIsItalic);$e(je=>je.isUnderline);const Q=$e(je=>je.setIsUnderline),W=$e(je=>je.charSpacing),ee=$e(je=>je.setCharSpacing),K=$e(je=>je.lineHeight),ae=$e(je=>je.setLineHeight),le=$e(je=>je.strokeWidth),ge=$e(je=>je.setStrokeWidth),xe=$e(je=>je.strokeColor),F=$e(je=>je.setStrokeColor),Ne=$e(je=>je.fillColor),Ve=$e(je=>je.setFillColor),qe=$e(je=>je.fonts),ot=je=>{const Ze=o?.getActiveObject();Ze&&Ze.type.includes("text")&&(Ze.set(je),o.requestRenderAll())};return ke.useEffect(()=>{if(!o)return;const je=()=>{const Ze=o.getActiveObject();Ze&&Ze.type.includes("text")&&(t(Ze.fontSize||24),E(Ze.fontFamily||"Arial"))};return o.on("selection:created",je),o.on("selection:updated",je),()=>{o.off("selection:created",je),o.off("selection:updated",je)}},[o]),Z.jsx("div",{className:"px-5 py-2 flex flex-wrap gap-3 overflow-x-auto items-center bg-white shadow-sm text-sm",children:Z.jsxs("div",{className:"flex items-center justify-between whitespace-nowrap text-sm gap-4",children:[Z.jsx(Pc,{label:"BG",value:n,onChange:je=>{i(a),ot({backgroundColor:je})}}),Z.jsx(Pc,{label:"TXT",value:Ne,onChange:je=>{Ve(je),ot({fill:je})}}),Z.jsx(Zy,{onChange:je=>{console.log(je),E(je),ot({fontFamily:je})},options:qe,value:b}),Z.jsx(Wl,{value:e,onChange:je=>{const Ze=parseInt(String(je),10);t(Ze),ot({fontSize:Ze})}}),Z.jsx(_s,{options:[{key:"bold",icon:"fa-solid fa-bold",tooltip:"Bold"},{key:"italic",icon:"fa-solid fa-italic",tooltip:"Italic"},{key:"underline",icon:"fa-solid fa-underline",tooltip:"Underline"}],onChange:je=>{console.log("formats:",je);const{bold:Ze,italic:dt,underline:We}=je;I(Ze),O(dt),Q(We),ot({fontWeight:Ze?"bold":"normal"}),ot({fontStyle:dt?"italic":"normal"}),ot({underline:We})}}),Z.jsx(_s,{single:!0,options:[{key:"left",icon:"fa-solid fa-align-left",tooltip:"Left Align"},{key:"center",icon:"fa-solid fa-align-center",tooltip:"Center Align"},{key:"right",icon:"fa-solid fa-align-right",tooltip:"Right Align"},{key:"justify",icon:"fa-solid fa-align-justify",tooltip:"Justify"}],onChange:je=>{console.log("align:",je);const{left:Ze,center:dt,right:We,justify:Bt}=je;let Le="left";dt?Le="center":We?Le="right":Bt&&(Le="justify"),ot({textAlign:Le})}}),Z.jsxs("div",{className:"flex items-center gap-2",children:[Z.jsx(Pc,{label:"Stroke",value:xe,onChange:je=>{F(je),ot({stroke:je})}}),Z.jsx(Wl,{label:"STR",max:10,value:le,onChange:je=>{const Ze=parseInt(String(je),10);ge(Ze),ot({strokeWidth:Ze})}})]}),Z.jsxs("div",{className:"flex items-center gap-2",children:[Z.jsx(Wl,{label:"LH",step:.1,value:K,onChange:je=>{const Ze=parseFloat(String(je));ae(Ze),ot({lineHeight:Ze})}}),Z.jsx(Wl,{label:"LS",value:W,onChange:je=>{const Ze=parseInt(String(je),10);ee(Ze),ot({charSpacing:Ze})}})]}),Z.jsx(ru,{icon:Z.jsx("i",{className:"fa-solid fa-square text-xs"}),onClick:()=>{const je=!h;p(je),ot({shadow:je?{color:m,blur:5,offsetX:2,offsetY:2}:null})},active:h,title:"Shadow"}),h&&Z.jsx(Pc,{label:"Shadow",value:m,onChange:je=>{_(je),ot({shadow:{color:je,blur:5,offsetX:2,offsetY:2}})}})]})})},ja=({children:o,onClick:e,position:t="middle"})=>{const n=t==="top"?"hover:rounded-t-lg":t==="bottom"?"hover:rounded-b-lg":"";return Z.jsx("button",{onClick:e,className:`w-full text-left px-4 py-2 text-sm hover:bg-stone-200 hover:text-stone-900
        ${n}`,children:o})},LS=({trigger:o,children:e})=>{const[t,n]=ke.useState(!1),i=ke.useRef(null);return ke.useEffect(()=>{const a=h=>{i.current&&!i.current.contains(h.target)&&n(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),Z.jsxs("div",{className:"relative inline-block",ref:i,children:[Z.jsx(ru,{icon:o,onClick:()=>n(!t),title:"Menu"}),t&&Z.jsx("div",{className:"z-1000 absolute right-0 mt-2 w-40 rounded-lg bg-white shadow-lg ring-1 ring-black/10 bg-white text-gray-500",children:e})]})};function DS(o){o.set({selectable:!0,evented:!0,hasControls:!0,hasBorders:!0,lockMovementX:!1,lockMovementY:!1,lockScalingX:!1,lockScalingY:!1,lockRotation:!1,perPixelTargetFind:!1,objectCaching:!1}),o.setCoords()}async function RS(o,e){if(!o||!e)return;const{pageWidth:t,pageHeight:n,scale:i}=$e.getState(),a=URL.createObjectURL(e);try{const h=await cr.fromURL(a),p=t/2*i,m=n/2*i;h.set({left:p,top:m,originX:"center",originY:"center"});const _=o.getWidth();h.scaleToWidth(Math.min(400,_*.7)),DS(h),o.add(h),o.setActiveObject(h),o.requestRenderAll(),$e.getState().setToolbar({target:h}),$e.getState().syncFromObject(h)}catch(h){console.error("Image load failed",h)}finally{setTimeout(()=>URL.revokeObjectURL(a),1e3)}}async function NS(o,e){if(!o||!e)return;const t=await e.text();try{const n=await Ao(t);let i=[];if(Array.isArray(n)?i=n:n?.type?i=[n]:n?.objects&&(i=n.objects),!i.length){console.error("No SVG objects found",n);return}const a=i.length===1?i[0]:new er(i),h=o.getWidth(),p=o.getHeight();a.set({left:h/2,top:p/2,originX:"center",originY:"center",selectable:!0,evented:!0}),a.width&&a.height?a.scaleToWidth(Math.min(400,h*.7)):a.scale(1),a.setCoords(),o.add(a),o.setActiveObject(a),o.requestRenderAll()}catch(n){console.error("SVG import failed",n)}}async function FS(o,e){if(!(!o||!e))try{const t=await e.text(),n=JSON.parse(t);o.loadFromJSON(n,()=>{o.requestRenderAll()})}catch(t){console.error("Failed to load Fabric JSON",t)}}function BS(o){const e=o.name.split(".").pop()?.toLowerCase();return e==="svg"?"svg":e==="fateboard"||e==="json"?"fabric-json":["png","jpg","jpeg","webp"].includes(e)?"image":"unknown"}async function zS(o,e){switch(BS(e)){case"image":return RS(o,e);case"svg":return NS(o,e);case"fabric-json":return FS(o,e);default:alert("Unsupported file type")}}function VS(){const o=Vd(),e=$e(I=>I.canvas),t=$e(I=>I.toggleGrid),n=$e(I=>I.clearBoard),[i,a]=ke.useState(!1),h=ke.useRef(null),{selectedObject:p}=$e();R2.info("Clicked",{selectedObject:p});const m=()=>{if(!e)return;const I=JSON.stringify(e.toJSON(["backgroundColor","customId"])),O=new Blob([I],{type:"application/json"}),Q=document.createElement("a");Q.href=URL.createObjectURL(O),Q.download="drawing.fateboard",Q.click(),URL.revokeObjectURL(Q.href)},_=()=>{h.current?.click()},b=I=>{if(!I)return;const O=I.getActiveObject();if(!O)return alert("Select something first");const Q=O.toSVG(),W=new Blob([Q],{type:"image/svg+xml"}),ee=URL.createObjectURL(W),K=document.createElement("a");K.href=ee,K.download="selection.svg",K.click(),URL.revokeObjectURL(ee)},E=(I,O="whiteboard.svg")=>{if(!I)return;const Q=I.toSVG(),W=new Blob([Q],{type:"image/svg+xml;charset=utf-8"}),ee=URL.createObjectURL(W),K=document.createElement("a");K.href=ee,K.download=O,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(ee)};return Z.jsx("header",{className:"relative bg-stone-100 flex flex-row justify-between items-center z-50",children:Z.jsxs("div",{className:"flex flex-col w-full",children:[Z.jsxs("div",{className:"flex items-center justify-between w-full shadow-xs px-2",children:[Z.jsx(Fd,{src:"fate.svg",className:"h-10 cursor-pointer hidden md:block"}),Z.jsx(Fd,{src:"fateicon.svg",className:"h-8 cursor-pointer md:hidden"}),Z.jsxs("div",{className:"flex gap-4 p-2",children:[Z.jsx("input",{ref:h,type:"file",accept:".png,.jpg,.jpeg,.webp,.svg,.fateboard",hidden:!0,onChange:async I=>{if(!e)return;const O=I.target.files?.[0];O&&(await zS(e,O),I.target.value="")}}),Z.jsx(Bo,{position:"bottom",content:"Grid View",children:Z.jsx(ru,{active:i,icon:Z.jsx("i",{className:"fa-solid fa-table-cells-large"}),onClick:()=>{a(!i),t()},title:"Grid View"})}),Z.jsx(Bo,{position:"bottom",content:"Create New Board",children:Z.jsx(ru,{icon:Z.jsx("img",{src:"/edit.svg",alt:"New Draw",height:"16"}),onClick:n,title:"Grid View"})}),Z.jsx("div",{className:"flex items-center justify-center cursor-pointer hover:bg-stone-200 h-8 w-8 rounded-sm",children:Z.jsxs(LS,{trigger:Z.jsx("i",{className:"fa-solid fa-ellipsis-vertical cursor-pointer"}),children:[Z.jsx(ja,{position:"top",onClick:n,children:"Create"}),Z.jsx(ja,{onClick:m,children:"Save"}),Z.jsx(ja,{onClick:()=>E(e),children:"Download Svg"}),Z.jsx(ja,{onClick:()=>b(e),children:"Download Selected"}),Z.jsx(ja,{onClick:_,children:"Load"}),Z.jsx(ja,{onClick:()=>o("/command-palette"),children:"Command Palette"}),Z.jsx(ja,{position:"bottom",onClick:()=>o("/setting"),children:"Settings"})]})})]})]}),p==="shape"&&Z.jsx(jS,{}),p&&p?.type==="textbox"&&Z.jsx(IS,{})]})})}function WS(o,e,t){switch(o){case"left":return{top:e.top-10,left:e.right+18};case"right":return{top:e.top,left:e.left-t.width-18};case"top":return{top:e.bottom+18,left:e.left};case"bottom":return{top:e.top-t.height-18,left:e.left};default:return{top:e.top,left:e.right+18}}}function US({tools:o,activeTool:e,onToolClick:t,position:n}){const i=$e(h=>h.isActiveObjectLocked()),a={left:"fixed top-1/2 left-2 -translate-y-1/2 flex-col",right:"fixed top-1/2 right-2 -translate-y-1/2 flex-col",top:"fixed top-0 left-1/2 -translate-x-1/2 flex-row",bottom:"fixed bottom-0 left-1/2 -translate-x-1/2 flex-row"};return Z.jsx("div",{className:`flex justify-center items-center bg-white border border-stone-200 shadow rounded-md gap-2 z-50 p-2 ${a[n]}`,children:o.map(h=>{const p=h.id==="lock"?i?"fa-solid fa-lock":"fa-solid fa-unlock":h.icon;return Z.jsx(Bo,{content:h.tooltip,position:h.position,children:Z.jsx("button",{onClick:m=>t(h.id,m),className:fi("flex justify-center items-center cursor-pointer h-8 w-8 p-2 rounded-md",e===h.id?"bg-blue-500 text-white hover:bg-blue-600":"hover:bg-stone-200"),children:Z.jsx("i",{className:p})},h.id)},h.id)})})}function HS({isOpen:o,position:e,from:t="left",children:n}){return e?$m.createPortal(Z.jsx("aside",{style:{position:"fixed",top:"50%",left:`${e.left}px`},className:fi("bg-stone-100 border border-stone-200 rounded-md shadow-lg w-70 p-4 z-50 transform -translate-y-1/2 transition-all duration-300 ease-out",o?"opacity-100 translate-x-0 pointer-events-auto":t==="left"?"-translate-x-4 opacity-0 pointer-events-none":"translate-x-4 opacity-0 pointer-events-none"),children:n}),document.body):null}const XS=(o,e)=>({select:()=>o.setActiveTool("select"),pan:()=>o.setActiveTool("pan"),draw:()=>o.setActiveTool("draw"),shapes:()=>{},text:()=>o.addText({}),delete:()=>e(),undo:()=>o.undo(),redo:()=>o.redo(),group:()=>o.groupLayers(),ungroup:()=>o.ungroupSelected(),forward:()=>o.bringForward(),backward:()=>o.sendBackward(),forwards:()=>o.bringToFront(),backwards:()=>o.sendToBack(),lock:()=>o.toggleActiveObjectLock(),fullscreen:()=>o.toggleFullscreen(),zoomIn:()=>o.zoomIn(),zoomOut:()=>o.zoomOut(),zoomFit:()=>o.zoomFit(),copy:()=>o.copy(),paste:()=>o.paste(),duplicate:()=>o.duplicate()}),GS=(o,e,t)=>{if(!o?.component)return null;const n=e.currentTarget.getBoundingClientRect(),i=o.panelSize||{width:288,height:300};return WS(t,n,i)};function YS({config:o,toolbarPosition:e="left"}){const[t,n]=ke.useState(null),[i,a]=ke.useState(null),h=$e(),p=h.removeLayer,m=XS(h,p),_=(E,I)=>{const O=o.find(Q=>Q.id===E);if(O){if(O.type==="momentary"){h.setActiveTool(E),setTimeout(()=>h.setActiveTool(null),400),m[E]?.();return}if(O.type==="exclusive"){h.activeTool===E?(h.setActiveTool("select"),n(null)):(h.setActiveTool(E),n(null),m[E]?.());return}if(O.type==="panel"){t===E?(n(null),h.setActiveTool("select")):(n(E),a(GS(O,I,e)),h.setActiveTool(E),m[E]?.());return}}},b=E=>{const I=o.find(O=>O.id===E);I&&(n(null),I.id!=="draw"&&h.setActiveTool("select"))};return Z.jsxs(Z.Fragment,{children:[Z.jsx(US,{tools:o,activeTool:h.activeTool,onToolClick:_,position:e}),o.map(E=>t===E.id&&E.component&&Z.jsx(HS,{isOpen:!0,position:i,from:e,children:typeof E.component=="function"?Z.jsx(E.component,{closePanel:()=>b(E.id)}):E.component},E.id))]})}const qS=({onClick:o,size:e=24,className:t="",title:n="Close"})=>Z.jsx("button",{onClick:o,title:n,"aria-label":n,className:fi("flex items-center justify-center rounded-full hover:bg-gray-200 cursor-pointer",t),style:{width:e,height:e},children:""});function Jy({title:o,onClose:e}){return Z.jsxs("div",{className:"flex items-center justify-between pb-3",children:[Z.jsx("h3",{className:"text-lg font-bold text-gray-800",children:o}),Z.jsx(qS,{onClick:e})]})}function KS({closePanel:o}){$e(m=>m.canvas);const e=$e(m=>m.color),t=$e(m=>m.setBrushColor),n=$e(m=>m.width),i=$e(m=>m.setBrushWidth),a=$e(m=>m.brush),h=$e(m=>m.setBrush),p=["pencil","circle","spray","pattern","eraser"];return Z.jsxs("div",{className:"bg-gray-100 w-60 p-3 flex flex-col gap-4",children:[Z.jsx(Jy,{title:"Draw",onClose:o}),Z.jsxs("div",{className:"grid grid-cols-[8%_92%] grid-rows-[auto_auto_auto] w-full",children:[Z.jsx("div",{className:"row-span-4 flex flex-col items-center justify-center gap-4 h-48",children:Z.jsx("input",{type:"range",min:"1",max:"50",value:n,onChange:m=>i({width:Number(m.target.value)}),className:"rotate-[-90deg] w-48 cursor-pointer"})}),Z.jsxs("div",{className:"flex items-center justify-between pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Color:"}),Z.jsx("input",{type:"color",value:e,onChange:m=>t({color:m.target.value}),className:"w-6 h-6 p-0 rounded border"})]}),Z.jsxs("div",{className:"flex items-center justify-between pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Brush:"}),Z.jsx("select",{value:a,onChange:m=>h({color:e,width:n,brush:m.target.value}),className:"ml-2 border rounded p-1 flex-1",children:p.map(m=>Z.jsx("option",{value:m,children:m.charAt(0).toUpperCase()+m.slice(1)},m))})]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Width:"}),[15,10,5,4,2].map(m=>Z.jsx("div",{onClick:()=>i({width:m}),className:`rounded-full border cursor-pointer flex items-center justify-center transition-transform
                        ${n===m?"scale-110 border-blue-500":"border-gray-400"}`,style:{width:`${m*2}px`,height:`${m*2}px`,backgroundColor:e}},m))]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("div",{className:"flex items-center justify-center rounded-full border h-6 w-6",style:{backgroundColor:e,borderColor:"#333"},children:Z.jsx("span",{className:"text-xs text-white select-none",children:a.charAt(0).toUpperCase()})}),Z.jsxs("span",{className:"text-sm",children:[n,"px"]})]})]})]})}const Om=[{type:"rect",icon:"fa-regular fa-square",defaultProps:{width:120,height:80,rx:0,ry:0,fill:"transparent",stroke:"black"}},{type:"circle",icon:"fa-solid fa-circle",defaultProps:{radius:48,fill:"transparent",stroke:"black"}},{type:"paper",icon:"fa-solid fa-square-pen",defaultProps:{with:120,height:80,fill:"transparent",strock:"black"}},{type:"triangle",icon:"fas fa-play rotate-270",defaultProps:{width:100,height:100,fill:"transparent",stroke:"black"}},{type:"ellipse",icon:"fa-solid fa-circle transform scale-x-120",defaultProps:{rx:70,ry:45,fill:"transparent",stroke:"black"}},{type:"line",icon:"fa-solid fa-slash",defaultProps:{strokeWidth:2,stroke:"black"}},{type:"polygon",icon:"fa-solid fa-caret-up",defaultProps:{points:[{x:50,y:0},{x:100,y:50},{x:75,y:100},{x:25,y:100},{x:0,y:50}],fill:"transparent",stroke:"black",strokeWidth:2}},{type:"star",icon:"fa-solid fa-star",defaultProps:{numPoints:5,innerRadius:20,outerRadius:50,fill:"transparent",stroke:"black",strokeWidth:2}},{type:"arrow",icon:"fa-solid fa-arrow-up",defaultProps:{width:120,height:20,fill:"transparent",stroke:"black",strokeWidth:3,headLength:15}},{type:"diamond",icon:"fa-solid fa-gem",defaultProps:{width:80,height:80,fill:"transparent",stroke:"black",strokeWidth:2,angle:45}},{type:"pentagon",icon:"fa-solid fa-star-half-stroke",defaultProps:{points:[{x:50,y:0},{x:95,y:38},{x:78,y:90},{x:22,y:90},{x:5,y:38}],fill:"transparent",stroke:"black",strokeWidth:2}}],ZS=()=>{const o=$e(I=>I.canvas),e=$e(I=>I.addShape),t=$e(I=>I.setActiveTool),n=(I,O={})=>{if(!o)return;const Q=Om.find(W=>W.type===I);Q&&e(I,{...Q.defaultProps,...O})};let i=null,a=!1,h=!1;const p=I=>{if(I.target)return;a=!0;const O=o.getPointer(I.e),Q=[O.x,O.y,O.x,O.y];i=new li(Q,{strokeWidth:2,stroke:"black",selectable:!0,evented:!0}),o.add(i)},m=I=>{if(!a||!i)return;const O=o.getPointer(I.e);i.set({x2:O.x,y2:O.y}),o.renderAll()},_=()=>{a&&(a=!1,i=null,t("select"),E())},b=()=>{!o||h||(o.on("mouse:down",p),o.on("mouse:move",m),o.on("mouse:up",_),h=!0,o.isDrawingMode=!1)},E=()=>{!o||!h||(o.off("mouse:down",p),o.off("mouse:move",m),o.off("mouse:up",_),h=!1)};return{shapesList:Om,add:n,enableLineDrawing:b,disableLineDrawing:E}};function QS({closePanel:o}){const{fill:e,stroke:t,strokeWidth:n,strokeStyle:i,strokeStyleList:a,setFill:h,setStroke:p,setStrokeWidth:m,setStrokeStyle:_}=$e(),{shapesList:b,add:E,enableLineDrawing:I}=ZS(),O={fill:e,stroke:t,strokeWidth:n};function Q(W){W==="line"?I():E(W,O),o?.(W)}return Z.jsxs("div",{className:"bg-gray-100 w-60 p-3 flex flex-col gap-4",children:[Z.jsx(Jy,{title:"Shapes",onClose:o}),Z.jsxs("div",{className:"grid grid-cols-[8%_92%] grid-rows-[auto_auto_auto] w-full",children:[Z.jsx("div",{className:"row-span-4 flex flex-col items-center justify-center gap-4 h-48",children:Z.jsx("input",{type:"range",min:"0",max:"16",value:n,onChange:W=>m(Number(W.target.value)),className:"rotate-[-90deg] w-48 cursor-pointer"})}),Z.jsx("div",{className:"flex items-center justify-between pl-4 flex-wrap py-4",children:b.map(W=>Z.jsx("button",{className:"rounded-sm hover:bg-gray-200 h-8 w-8 cursor-pointer",onClick:()=>Q(W.type),title:W.type,children:Z.jsx("i",{className:W.icon})},W.type))}),Z.jsxs("div",{className:"flex items-center justify-between pl-4 py-2",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Stork:"}),Z.jsx("input",{type:"color",value:t,onChange:W=>p(W.target.value),className:"w-6 h-6 p-0 rounded border"}),Z.jsx("span",{className:"text-sm font-medium",children:"Fill:"}),Z.jsx("input",{type:"color",value:e,onChange:W=>h(W.target.value),className:"w-6 h-6 p-0 rounded border"})]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("span",{className:"text-sm font-medium",children:"Width:"}),Z.jsx("select",{value:i,onChange:W=>_(W.target.value),className:"ml-2 border rounded p-1 flex-1",children:a.map(W=>Z.jsx("option",{value:W.value,children:W.label},W.label))})]}),Z.jsxs("div",{className:"flex flex-row items-center justify-start gap-2 pl-4",children:[Z.jsx("div",{className:"flex items-center justify-center rounded-full border h-6 w-6",style:{backgroundColor:e,borderColor:"#333"},children:Z.jsx("span",{className:"text-xs text-white select-none",children:"A"})}),Z.jsxs("span",{className:"text-sm",children:[e,"px"]})]})]})]})}const JS=[{id:"select",type:"exclusive",icon:"fa-solid fa-location-arrow rotate-280",position:"left",component:null,tooltip:"Selector Tool"},{id:"pan",type:"exclusive",icon:"fa-solid fa-hand",position:"left",component:null,tooltip:"Hand Tool"},{id:"draw",type:"panel",icon:"fa-solid fa-pencil",position:"left",component:KS,panelSize:{width:300,height:250},tooltip:"Pencil Tool"},{id:"shapes",type:"panel",icon:"fa-solid fa-shapes",position:"left",component:o=>Z.jsx(QS,{...o,panelId:"shapes"}),tooltip:"Shape Builder Tool"},{id:"text",type:"momentary",icon:"fa-solid fa-font",position:"left",component:null,tooltip:"Text Tool"}],$S=()=>{const o=$e(t=>t.toggleFullscreen),e=$e(t=>t.isFullScreen);return Z.jsx(Bo,{position:"bottom",content:"Fullscreen",children:Z.jsx(ru,{active:e,icon:Z.jsx("i",{className:`fa-solid ${e?"fa-compress":"fa-expand"}`}),onClick:o,title:"Toggle Fullscreen",className:"border border-stone-200"})})},eC=({colorTool:o,zoomTool:e,strokeTool:t})=>Z.jsxs("div",{className:"flex bg-white flex-col items-start px-2 py-1",children:[o&&Z.jsx("div",{className:"flex-1 flex justify-center",children:o}),Z.jsxs("div",{className:"flex items-center gap-2",children:[e&&Z.jsx("div",{className:"flex py-1",children:e}),t&&Z.jsx("div",{className:"flex py-1",children:t})]})]}),tC=({bgColor:o,isActive:e=!1,onClick:t,className:n=""})=>Z.jsx("div",{onClick:t,role:"button",tabIndex:0,className:fi("relative w-5 h-5 ml-px mb-px border border-stone-300 cursor-pointer",o,n),children:e&&Z.jsx("span",{className:"absolute inset-0 m-auto w-2 h-2 rounded-full bg-white",style:{boxShadow:"0 0 0 1px #000"}})}),nC=({fill:o,bgColors:e,onClick:t})=>Z.jsx(Z.Fragment,{children:[...e].reverse().map((n,i)=>Z.jsx(tC,{bgColor:n,isActive:n===o,onClick:()=>t(n,o)},i))}),rC=({scrollRef:o,fill:e,bgColors:t,colorsMap:n,onClick:i})=>Z.jsx(Z.Fragment,{children:Z.jsx("div",{ref:o,className:"bg-white w-full flex flex-wrap gap-0.01 overflow-y-auto",style:{height:"calc(100vh - 56px - 40px - 90px)"},children:t.flatMap((a,h)=>Z.jsx(nC,{fill:e,bgColors:n[a],onClick:i},`${a}-${h}`))})}),iC=({scrollRef:o,className:e=""})=>{const[t,n]=ke.useState(!1),[i,a]=ke.useState(!1),h=()=>{const m=o.current;m&&(n(m.scrollTop>0),a(m.scrollTop<m.scrollHeight-m.clientHeight))};ke.useEffect(()=>{const m=o.current;if(m)return h(),m.addEventListener("scroll",h),()=>m.removeEventListener("scroll",h)},[o]);const p=m=>{const _=o.current;if(!_)return;const b=_.scrollHeight-_.clientHeight;let E=_.scrollTop+m;E<0&&(E=0),E>b&&(E=b),_.scrollTop=E,requestAnimationFrame(()=>{_.scrollTop=E,h()})};return Z.jsxs("div",{className:fi("flex flex-col items-center",e),children:[Z.jsx("button",{className:"h-5 w-5 flex items-center justify-center hover:bg-stone-200 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",disabled:!t,onClick:()=>p(-20),children:Z.jsx("i",{className:"fa-solid fa-chevron-up"})}),Z.jsx("button",{className:"h-5 w-5 flex items-center justify-center hover:bg-stone-200 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",disabled:!i,onClick:()=>p(20),children:Z.jsx("i",{className:"fa-solid fa-chevron-down"})})]})},sC={red:["bg-red-50","bg-red-100","bg-red-200","bg-red-300","bg-red-400","bg-red-500","bg-red-600","bg-red-700","bg-red-800","bg-red-900"],orange:["bg-orange-50","bg-orange-100","bg-orange-200","bg-orange-300","bg-orange-400","bg-orange-500","bg-orange-600","bg-orange-700","bg-orange-800","bg-orange-900"],amber:["bg-amber-50","bg-amber-100","bg-amber-200","bg-amber-300","bg-amber-400","bg-amber-500","bg-amber-600","bg-amber-700","bg-amber-800","bg-amber-900"],yellow:["bg-yellow-50","bg-yellow-100","bg-yellow-200","bg-yellow-300","bg-yellow-400","bg-yellow-500","bg-yellow-600","bg-yellow-700","bg-yellow-800","bg-yellow-900"],lime:["bg-lime-50","bg-lime-100","bg-lime-200","bg-lime-300","bg-lime-400","bg-lime-500","bg-lime-600","bg-lime-700","bg-lime-800","bg-lime-900"],green:["bg-green-50","bg-green-100","bg-green-200","bg-green-300","bg-green-400","bg-green-500","bg-green-600","bg-green-700","bg-green-800","bg-green-900"],emerald:["bg-emerald-50","bg-emerald-100","bg-emerald-200","bg-emerald-300","bg-emerald-400","bg-emerald-500","bg-emerald-600","bg-emerald-700","bg-emerald-800","bg-emerald-900"],teal:["bg-teal-50","bg-teal-100","bg-teal-200","bg-teal-300","bg-teal-400","bg-teal-500","bg-teal-600","bg-teal-700","bg-teal-800","bg-teal-900"],cyan:["bg-cyan-50","bg-cyan-100","bg-cyan-200","bg-cyan-300","bg-cyan-400","bg-cyan-500","bg-cyan-600","bg-cyan-700","bg-cyan-800","bg-cyan-900"],sky:["bg-sky-50","bg-sky-100","bg-sky-200","bg-sky-300","bg-sky-400","bg-sky-500","bg-sky-600","bg-sky-700","bg-sky-800","bg-sky-900"],blue:["bg-blue-50","bg-blue-100","bg-blue-200","bg-blue-300","bg-blue-400","bg-blue-500","bg-blue-600","bg-blue-700","bg-blue-800","bg-blue-900"],indigo:["bg-indigo-50","bg-indigo-100","bg-indigo-200","bg-indigo-300","bg-indigo-400","bg-indigo-500","bg-indigo-600","bg-indigo-700","bg-indigo-800","bg-indigo-900"],violet:["bg-violet-50","bg-violet-100","bg-violet-200","bg-violet-300","bg-violet-400","bg-violet-500","bg-violet-600","bg-violet-700","bg-violet-800","bg-violet-900"],purple:["bg-purple-50","bg-purple-100","bg-purple-200","bg-purple-300","bg-purple-400","bg-purple-500","bg-purple-600","bg-purple-700","bg-purple-800","bg-purple-900"],fuchsia:["bg-fuchsia-50","bg-fuchsia-100","bg-fuchsia-200","bg-fuchsia-300","bg-fuchsia-400","bg-fuchsia-500","bg-fuchsia-600","bg-fuchsia-700","bg-fuchsia-800","bg-fuchsia-900"],pink:["bg-pink-50","bg-pink-100","bg-pink-200","bg-pink-300","bg-pink-400","bg-pink-500","bg-pink-600","bg-pink-700","bg-pink-800","bg-pink-900"],rose:["bg-rose-50","bg-rose-100","bg-rose-200","bg-rose-300","bg-rose-400","bg-rose-500","bg-rose-600","bg-rose-700","bg-rose-800","bg-rose-900"],slate:["bg-slate-50","bg-slate-100","bg-slate-200","bg-slate-300","bg-slate-400","bg-slate-500","bg-slate-600","bg-slate-700","bg-slate-800","bg-slate-900"],gray:["bg-gray-50","bg-gray-100","bg-gray-200","bg-gray-300","bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800","bg-gray-900"],zinc:["bg-zinc-50","bg-zinc-100","bg-zinc-200","bg-zinc-300","bg-zinc-400","bg-zinc-500","bg-zinc-600","bg-zinc-700","bg-zinc-800","bg-zinc-900"],neutral:["bg-neutral-50","bg-neutral-100","bg-neutral-200","bg-neutral-300","bg-neutral-400","bg-neutral-500","bg-neutral-600","bg-neutral-700","bg-neutral-800","bg-neutral-900"],stone:["bg-stone-50","bg-stone-100","bg-stone-200","bg-stone-300","bg-stone-400","bg-stone-500","bg-stone-600","bg-stone-700","bg-stone-800","bg-stone-900"]};function aC({onClick:o}){return Z.jsx("div",{role:"button",tabIndex:0,onClick:o,title:"Remove stroke",className:`
        relative w-5 h-5 ml-px mb-px
        border border-dashed border-stone-400
        cursor-pointer
        group
        hover:border-red-500
        hover:bg-red-50
        focus:outline-none
      `,children:Z.jsx("span",{className:`
          absolute inset-0
          before:absolute before:top-1/2 before:left-1/2
          before:w-[120%] before:h-px
          before:bg-stone-500
          before:-translate-x-1/2 before:-translate-y-1/2
          before:-rotate-45
          group-hover:before:bg-red-500
        `})})}const oC=()=>{const[o,e]=ke.useState(["red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia","pink","rose","slate","gray","zinc","neutral","stone"]),t=ke.useRef(null),{handleColorChange:n,fill:i,setStrokeWidthN:a}=$e();return Z.jsxs("div",{className:"flex flex-col items-start bg-white w-6 flex-wrap",children:[Z.jsx(aC,{onClick:()=>a(0)}),Z.jsx(rC,{scrollRef:t,fill:i,bgColors:o,colorsMap:sC,onClick:n}),Z.jsx(iC,{scrollRef:t})]})};function Cp({options:o=[],value:e,onChange:t,className:n="",label:i,preview:a,disabled:h}){return Z.jsxs("div",{className:fi("flex items-center gap-1",n),children:[i&&Z.jsx("span",{className:"text-xs text-gray-600",children:i}),a&&Z.jsx("div",{children:a}),Z.jsx("select",{value:e,onChange:p=>t?.(p.target.value),disabled:h,className:"p-1 text-xs border border-gray-300 rounded cursor-pointer",children:o.map(p=>Z.jsx("option",{value:p.value,children:p.label},p.value))})]})}const Pm=({label:o,hasActiveShape:e,isTileActive:t,setActiveTile:n,color:i})=>Z.jsxs("div",{className:"flex items-center h-4",children:[Z.jsx("label",{className:"text-[11px] font-medium text-gray-500 w-10 leading-none select-none",children:o}),e?Z.jsx("div",{onClick:()=>n("fill"),title:"Edit fill color",className:fi("ml-2 h-4 w-10 rounded border cursor-pointer",t?"ring-1 ring-blue-500 border-blue-500":"border-gray-300 hover:border-gray-400"),style:{backgroundColor:i}}):Z.jsx("span",{className:"ml-2 w-8 text-center text-[10px] text-gray-400",children:"N/A"})]}),lC=({label:o,strokeStyleList:e,strokeStyle:t,setStrokeStyle:n,disabled:i})=>Z.jsxs("div",{className:"flex items-center justify-center h-8 gap-2",children:[Z.jsx("span",{className:"text-[11px] font-medium text-gray-500 leading-none select-none",children:o}),Z.jsx(Cp,{disabled:i,options:e,value:t,onChange:n})]}),uC=({value:o,min:e=0,max:t=100,step:n=1,unit:i,onChange:a,disabled:h=!1})=>{const p=m=>Math.min(t,Math.max(e,m));return Z.jsxs("div",{className:fi("inline-flex items-center rounded-lg border border-gray-300 bg-white shadow-sm",h&&"opacity-40 pointer-events-none"),children:[Z.jsx("button",{onClick:()=>a(p(o-n)),className:`cursor-pointer w-8 h-8 flex items-center justify-center rounded-l-lg text-gray-600
                   hover:bg-gray-100 active:bg-gray-200 transition-colors`,title:"Decrease",children:Z.jsx("i",{className:"fa-solid fa-minus"})}),Z.jsxs("div",{className:`px-3 text-sm font-semibold text-gray-800 bg-gray-50 border-x border-gray-300
                   min-w-[44px] text-center`,title:"Value",children:[o,i]}),Z.jsx("button",{onClick:()=>a(p(o+n)),className:`cursor-pointer w-8 h-8 flex items-center justify-center rounded-r-lg text-gray-600
                   hover:bg-gray-100 active:bg-gray-200 transition-colors`,title:"Increase",children:Z.jsx("i",{className:"fa-solid fa-plus"})})]})},cC=({value:o=1,onChange:e,disabled:t})=>{const n=Math.round(o*100);return Z.jsx(uC,{value:n,min:0,max:100,step:5,unit:"%",disabled:t,onChange:i=>e(i/100)})},hC=({size:o=20})=>Z.jsxs("svg",{width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[Z.jsx("defs",{children:Z.jsxs("linearGradient",{id:"g1",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[Z.jsx("stop",{offset:"0%",stopColor:"currentColor",stopOpacity:"0.15"}),Z.jsx("stop",{offset:"100%",stopColor:"currentColor"})]})}),Z.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",fill:"url(#g1)"})]}),fC=({size:o=20})=>Z.jsxs("svg",{width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[Z.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"5"}),Z.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"22"}),Z.jsx("line",{x1:"2",y1:"12",x2:"5",y2:"12"}),Z.jsx("line",{x1:"19",y1:"12",x2:"22",y2:"12"}),Z.jsx("line",{x1:"4.93",y1:"4.93",x2:"7.07",y2:"7.07"}),Z.jsx("line",{x1:"16.93",y1:"16.93",x2:"19.07",y2:"19.07"}),Z.jsx("line",{x1:"4.93",y1:"19.07",x2:"7.07",y2:"16.93"}),Z.jsx("line",{x1:"16.93",y1:"7.07",x2:"19.07",y2:"4.93"}),Z.jsx("circle",{cx:"12",cy:"12",r:"5",fill:"currentColor",opacity:"0.3"})]}),Am=({size:o=20})=>Z.jsxs("svg",{width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[Z.jsx("line",{x1:"5",y1:"19",x2:"19",y2:"5"}),Z.jsx("circle",{cx:"5",cy:"19",r:"2",fill:"currentColor"}),Z.jsx("circle",{cx:"19",cy:"5",r:"2",fill:"currentColor"})]}),dC=[{label:"Select Operation",value:""},{label:"Union",value:"union"},{label:"Intersect",value:"intersect"},{label:"Subtract",value:"subtract"},{label:"Exclude",value:"exclude"},{label:"Divide",value:"divide"},{label:"Cut",value:"cut"},{label:"Punch",value:"punch"},{label:"Crop",value:"crop"},{label:"Smart Union",value:"smartUnion"},{label:"Xor Split",value:"xorSplit"}],pC=()=>{const[o,e]=ke.useState(""),t=$e(),n=i=>{switch(i){case"union":t.unionSelected({fill:"green"});break;case"intersect":t.intersectSelected({fill:"orange"});break;case"subtract":t.subtractSelected({fill:"pink"});break;case"exclude":t.excludeSelected({fill:"purple"});break;case"divide":t.divideSelected({fill:"purple"});break;case"cut":t.cutSelected({fill:"purple"});break;case"punch":t.punchSelected({fill:"purple"});break;case"crop":t.cropSelected({fill:"purple"});break;case"smartUnion":t.smartUnionSelected({fill:"purple"});break;case"xorSplit":t.xorSplitSelected({fill:"purple"});break}};return Z.jsx("div",{className:"flex items-center space-x-2",children:Z.jsx(Cp,{value:o,options:dC,onChange:i=>{e(i),n(i)}})})},nh={soft:{blur:12,offsetX:0,offsetY:6,color:"rgba(0,0,0,0.2)"},medium:{blur:20,offsetX:0,offsetY:10,color:"rgba(0,0,0,0.25)"},strong:{blur:40,offsetX:0,offsetY:20,color:"rgba(0,0,0,0.3)"}},gC=({disabled:o})=>{const e=$e(a=>a.activeObjectShadow),t=$e(a=>a.applyShadowPreset),n=$e(a=>a.removeShadow),i=e?Object.entries(nh).find(([,a])=>a.blur===e.blur&&a.offsetX===e.offsetX&&a.offsetY===e.offsetY&&a.color===e.color)?.[0]??"custom":"none";return Z.jsx(Cp,{value:i,disabled:o,options:[{label:"None",value:"none"},...Object.keys(nh).map(a=>({label:a.charAt(0).toUpperCase()+a.slice(1),value:a}))],onChange:a=>{if(a==="none")return n();t(a)}})};function mC(){const{fill:o,stroke:e,strokeWidth:t,activePaint:n,setActivePaint:i,setStroke:a,setStrokeWidthN:h,opacity:p,setOpacity:m,hasActiveShape:_,strokeStyleList:b,strokeStyle:E,setStrokeStyle:I,addShadow:O,applyShadowPreset:Q,geditor:W}=$e(),[ee,K]=ke.useState(!1),ge=$e(Ve=>Ve.canvas)?.getActiveObject()?.shadow?.blur,xe=n==="fill",F=n==="stroke",Ne=Ve=>{const qe=Math.max(0,Number(Ve)||0);h(qe)};return[...Object.keys(nh).map(Ve=>({label:Ve.charAt(0).toUpperCase()+Ve.slice(1),value:Ve}))],Object.entries(nh).find(([,Ve])=>Ve.blur===ge)?.[0],Z.jsxs("div",{className:"flex flex-row justify-center items-center gap-5 bg-white",children:[Z.jsxs("div",{className:"flex flex-col gap-2",children:[Z.jsx(Pm,{label:"Fill",hasActiveShape:_,isTileActive:xe,setActiveTile:()=>i("fill"),color:o}),Z.jsx(Pm,{label:"Stroke",hasActiveShape:_,isTileActive:F,setActiveTile:()=>i("stroke"),color:e})]}),Z.jsxs("div",{className:"flex gap-2 items-center",children:[Z.jsx(Qy,{disabled:!_,label:"Width",value:t,onChange:Ne,max:"16"}),Z.jsx(lC,{label:"Style",strokeStyleList:b,strokeStyle:E,setStrokeStyle:I,disabled:!_})]}),Z.jsx("div",{className:"flex gap-2 items-center",children:Z.jsx(cC,{value:p,onChange:m,disabled:!_})}),Z.jsx("div",{className:"flex",children:Z.jsx(gC,{disabled:!_})}),Z.jsxs("div",{className:"flex items-center gap-1 bg-stone-100 p-1 rounded-lg",children:[Z.jsx(ql,{action:"gradient",toggleType:"switch",iconOn:Z.jsx(Am,{}),iconOff:Z.jsx(Am,{}),tooltipOn:"Gradient",tooltipOff:"Normal",initial:!1,onChange:Ve=>{Ve.value?W.enable():W.disable()}}),Z.jsx(ql,{action:"gradienttype",toggleType:"switch",iconOn:Z.jsx(hC,{}),iconOff:Z.jsx(fC,{}),tooltipOn:"Linear Gradient",tooltipOff:"Radial Graient",initial:!1,onChange:Ve=>{W.toggleGradientType()}})]}),Z.jsx("div",{className:"flex",children:Z.jsx(pC,{})})]})}function vC(){return Z.jsx("footer",{className:"flex flex-col",children:Z.jsx(eC,{zoomTool:Z.jsx($S,{}),strokeTool:Z.jsx(mC,{})})})}const yC=()=>{const{visible:o,x:e,y:t,items:n,closeMenu:i}=$e();if(!o)return null;const a=n.filter(p=>typeof p.when=="function"?p.when():!0),h=a.filter((p,m)=>{if(p.type!=="divider")return!0;const _=a[m-1],b=a[m+1];return _&&b&&_.type!=="divider"&&b.type!=="divider"});return h.length===0?null:Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"fixed inset-0 z-40",onClick:i}),Z.jsx("div",{className:`fixed z-50 min-w-[220px] rounded-lg
                   bg-white shadow-lg border border-stone-200 p-1`,style:{top:t,left:e},children:h.map((p,m)=>p.type==="divider"?Z.jsx("div",{className:"my-1 h-px bg-stone-200"},p.id??m):Z.jsxs("button",{disabled:p.disabled,onClick:()=>{p.onClick(),i()},className:`
                flex w-full items-center justify-between
                rounded-lg px-3 py-2 text-sm
                hover:bg-gray-100
                disabled:opacity-40
              `,children:[Z.jsxs("span",{className:"flex items-center gap-2",children:[p.icon,p.label]}),p.shortcut&&Z.jsx("span",{className:"text-xs text-gray-400",children:p.shortcut})]},p.id??m))})]})};function $y(o){ke.useEffect(()=>{document.title=o},[o])}const _C=({open:o,width:e=280,onToggle:t,scrollRef:n,onScrollSave:i,children:a})=>Z.jsx("div",{className:"relative flex h-full",children:Z.jsx("button",{onClick:t,className:"w-2 border border-stone-400 cursor-ew-resize flex items-center justify-center bg-stone-100 hover:bg-stone-200",children:Z.jsx("i",{className:"fa-solid fa-ellipsis-vertical"})})}),xC=()=>{const[o,e]=ke.useState(!1),[t,n]=ke.useState("props"),i=ke.useRef({props:{scrollTop:0},layers:{scrollTop:0},assets:{scrollTop:0}}),a=ke.useRef(null);return ke.useEffect(()=>{if(!o)return;const h=i.current[t];a.current&&h&&(a.current.scrollTop=h.scrollTop)},[t,o]),Z.jsxs("aside",{className:"flex",style:{height:"calc(100vh - 56px - 40px)"},children:[Z.jsxs(_C,{open:o,onToggle:()=>e(h=>!h),scrollRef:a,onScrollSave:h=>{i.current[t].scrollTop=h},children:[t==="props"&&Z.jsx("h1",{children:"sda"}),t==="layers"&&Z.jsx("h1",{children:"sda"}),t==="assets"&&Z.jsx("h1",{children:"sda"})]}),Z.jsx(oC,{})]})},wC=()=>($y("Draw | Fateboard"),Z.jsxs("div",{children:[Z.jsx(Ax,{header:Z.jsx(VS,{}),leftSidebar:Z.jsx(YS,{config:JS,toolbarPosition:"left"}),rightPanel:Z.jsx(xC,{}),canvasBoard:Z.jsx(OS,{}),footer:Z.jsx(vC,{})}),Z.jsx(yC,{})]}));function bC(){const o=ke.useRef(null),[e,t]=ke.useState(0),[n,i]=ke.useState(!1),[a,h]=ke.useState(0),p=ke.useRef(0);return ke.useEffect(()=>{const m=o.current,_=m?.getContext("2d");if(!m||!_)return;const b=20,E=[{x:8*b,y:10*b},{x:7*b,y:10*b},{x:6*b,y:10*b}];let I=Q(),O="RIGHT";function Q(){return{x:Math.floor(Math.random()*(m.width/b))*b,y:Math.floor(Math.random()*(m.height/b))*b}}const W=le=>{le.key==="ArrowLeft"&&O!=="RIGHT"&&(O="LEFT"),le.key==="ArrowUp"&&O!=="DOWN"&&(O="UP"),le.key==="ArrowRight"&&O!=="LEFT"&&(O="RIGHT"),le.key==="ArrowDown"&&O!=="UP"&&(O="DOWN")};document.addEventListener("keydown",W);const ee=()=>{_.fillStyle="#fdfdfd",_.fillRect(0,0,m.width,m.height);for(let Ne=0;Ne<E.length;Ne++)_.fillStyle=Ne===0?"#2ecc71":"#27ae60",_.fillRect(E[Ne].x,E[Ne].y,b,b),_.strokeStyle="#ecf0f1",_.strokeRect(E[Ne].x,E[Ne].y,b,b);_.fillStyle="#e74c3c",_.fillRect(I.x,I.y,b,b);let le=E[0].x,ge=E[0].y;O==="LEFT"&&(le-=b),O==="UP"&&(ge-=b),O==="RIGHT"&&(le+=b),O==="DOWN"&&(ge+=b),le===I.x&&ge===I.y?(p.current+=1,t(p.current),I=Q()):E.pop();const F={x:le,y:ge};(le<0||ge<0||le>=m.width||ge>=m.height||K(F,E))&&(i(!0),clearInterval(ae),document.removeEventListener("keydown",W)),E.unshift(F),_.fillStyle="#2c3e50",_.font="18px Arial",_.fillText("Score: "+p.current,b,b)},K=(le,ge)=>{for(let xe=0;xe<ge.length;xe++)if(le.x===ge[xe].x&&le.y===ge[xe].y)return!0;return!1},ae=setInterval(ee,100);return()=>{clearInterval(ae),document.removeEventListener("keydown",W)}},[a]),Z.jsxs("div",{className:"flex flex-col items-center p-6 font-sans m-4",children:[Z.jsx("h1",{className:"text-7xl font-bold text-red-600",children:"404"}),Z.jsx("p",{className:"m-4 text-lg text-gray-700",children:"Oops! Page not found."}),n?Z.jsxs("div",{className:"flex flex-col items-center",children:[Z.jsxs("p",{className:"text-xl text-red-600 font-semibold m-4",children:[" Game Over! Final Score: ",e]}),Z.jsx("button",{onClick:()=>{t(0),p.current=0,i(!1),h(m=>m+1)},className:"mt-4 px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-800",children:" Restart Game"})]}):Z.jsx("canvas",{ref:o,width:600,height:400,className:"border border-gray-400 rounded shadow"},a),Z.jsx(Gd,{to:"/",className:"mt-6 px-6 py-3 bg-blue-600 text-white rounded-md font-semibold hover:bg-blue-800 transition",children:"Go Back Home"})]})}function SC({checked:o,onCheckedChange:e}){return Z.jsx("button",{type:"button",role:"switch","aria-checked":o,onClick:()=>e(!o),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${o?"bg-blue-600":"bg-gray-300"}`,children:Z.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${o?"translate-x-6":"translate-x-1"}`})})}function CC(){const[o,e]=ke.useState(!1);return ke.useEffect(()=>{o?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[o]),Z.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6 transition-colors",children:[Z.jsx("h1",{className:"text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100",children:" Settings"}),Z.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Z.jsxs("div",{className:"rounded-2xl shadow p-4 bg-white dark:bg-gray-800 transition-colors",children:[Z.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Appearance"}),Z.jsxs("div",{className:"flex items-center justify-between mt-3",children:[Z.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Dark Mode"}),Z.jsx(SC,{checked:o,onCheckedChange:e})]})]})})]})}function xh(...o){return o.filter(Boolean).join(" ")}function kC({className:o,...e}){return Z.jsx("div",{className:xh("rounded-2xl border bg-white shadow-md dark:bg-gray-100 dark:border-gray-800",o),...e})}function TC({className:o,...e}){return Z.jsx("div",{className:xh("p-4 border-b dark:border-gray-800",o),...e})}function EC({className:o,...e}){return Z.jsx("h3",{className:xh("text-lg font-semibold leading-none tracking-tight",o),...e})}function OC({className:o,...e}){return Z.jsx("div",{className:xh("p-4",o),...e})}const PC=[{id:1,name:"New File",mac:"N",win:"Ctrl+N"},{id:2,name:"Open Settings",mac:",",win:"Ctrl+,"},{id:3,name:"Copy",mac:"C",win:"Ctrl+C"},{id:4,name:"Paste",mac:"V",win:"Ctrl+V"},{id:5,name:"Group",mac:"G",win:"Ctrl+G"},{id:6,name:"Ungroup",mac:"U",win:"Ctrl+Shift+U"}];function AC(){const[o,e]=ke.useState(""),[t,n]=ke.useState("win");ke.useEffect(()=>{navigator.platform.toLowerCase().includes("mac")&&n("mac")},[]);const i=PC.filter(a=>a.name.toLowerCase().includes(o.toLowerCase()));return Z.jsx("div",{className:"flex justify-center items-start pt-20",children:Z.jsxs(kC,{className:"w-full max-w-lg shadow-xl rounded-2xl",children:[Z.jsx(TC,{children:Z.jsx(EC,{className:"text-xl",children:"Command Palette"})}),Z.jsxs(OC,{children:[Z.jsx("input",{placeholder:"Type a command...",value:o,onChange:a=>e(a.target.value),className:"mb-4"}),Z.jsxs("ul",{className:"space-y-2",children:[i.map(a=>Z.jsxs("li",{className:"flex justify-between items-center p-2 rounded-lg hover:bg-gray-100 cursor-pointer",children:[Z.jsx("span",{children:a.name}),Z.jsx("span",{className:"text-sm text-gray-500",children:t==="mac"?a.mac:a.win})]},a.id)),i.length===0&&Z.jsx("li",{className:"text-gray-500 text-sm",children:"No results found"})]})]})]})})}function MC({images:o}){const[e,t]=Eo.useState(0);return Eo.useEffect(()=>{const n=setInterval(()=>{t(i=>(i+1)%o.length)},2500);return()=>clearInterval(n)},[o.length]),Z.jsxs("div",{className:"relative bg-white rounded-2xl shadow overflow-hidden",children:[Z.jsx("img",{src:o[e],alt:"Fateboard glimpse",className:"w-full h-64 object-cover transition-all"}),Z.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-2",children:o.map((n,i)=>Z.jsx("span",{className:`h-2 w-2 rounded-full ${i===e?"bg-blue-600":"bg-gray-300"}`},i))})]})}function jC(){$y("Online Whiteboard | Fateboard");const o=Vd(),e=()=>{o("/draw")};return Z.jsxs("div",{className:"min-h-screen bg-gray-50 text-gray-800",children:[Z.jsx("header",{className:"bg-white shadow-sm",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4 flex justify-between items-center",children:[Z.jsx(Fd,{src:"fate.svg",className:"h-10 cursor-pointer"}),Z.jsxs("nav",{className:"space-x-6 text-sm",children:[Z.jsx("a",{href:"#features",className:"hover:text-blue-600",children:"Features"}),Z.jsx("a",{href:"#process",className:"hover:text-blue-600",children:"Action"})]})]})}),Z.jsx("section",{className:"bg-gradient-to-br from-blue-600 to-indigo-600 text-white",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-24 text-center",children:[Z.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Draw the Fate"}),Z.jsx("p",{className:"max-w-2xl mx-auto text-lg mb-8 opacity-90",children:"Just start with a blank canvas and the freedom to move the draw fate."}),Z.jsx("button",{className:"bg-white text-blue-600 px-8 py-3 rounded-full font-semibold shadow hover:scale-105 transition",onClick:e,children:"Start Now"})]})}),Z.jsx("section",{id:"features",className:"py-20",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[Z.jsx("h3",{className:"text-3xl font-bold text-center mb-12",children:"Key Features"}),Z.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{title:"Shape Creation",desc:"Draw rectangles, circles, arrows, and freehand shapes just like on a real whiteboard."},{title:"Easy to Use",desc:"No learning curve. Pick a tool, draw, and your idea comes to life instantly."},{title:"Color Options",desc:"Choose colors that feel right  soft, bold, or playful  to match your story."}].map(t=>Z.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow hover:shadow-lg transition",children:[Z.jsx("h4",{className:"text-xl font-semibold mb-3",children:t.title}),Z.jsx("p",{className:"text-sm text-gray-600",children:t.desc})]},t.title))})]})}),Z.jsx("section",{id:"process",className:"bg-gray-100 py-20",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6",children:[Z.jsx("h3",{className:"text-3xl font-bold text-center mb-6",children:"See It In Action"}),Z.jsx("p",{className:"text-center text-gray-600 mb-12 max-w-2xl mx-auto",children:"A quick look at how ideas turn into visuals  simple, smooth, and human."}),Z.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[Z.jsxs("div",{className:"space-y-6",children:[Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Draw Naturally"}),Z.jsx("p",{className:"text-sm text-gray-600",children:"Pick a shape or pen and draw freely, just like on a real whiteboard."})]}),Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Adjust as You Go"}),Z.jsx("p",{className:"text-sm text-gray-600",children:"Resize, recolor, and tweak elements until it feels right."})]}),Z.jsxs("div",{children:[Z.jsx("h4",{className:"text-xl font-semibold mb-2",children:"Bring It to Life"}),Z.jsx("p",{className:"text-sm text-gray-600",children:"Watch your board come alive with smooth visual flow."})]})]}),Z.jsx(MC,{images:["./demo.png","./shape.png","./draw.png","./text.png"]})]})]})}),Z.jsx("footer",{className:"bg-white border-t",children:Z.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-6 text-sm text-center text-gray-500",children:[" ",new Date().getFullYear()," fateboard. All rights reserved."]})})]})}function IC(){return Z.jsx(xx,{basename:"/",children:Z.jsxs(Z1,{children:[Z.jsx(To,{path:"/",element:Z.jsx(jC,{})}),Z.jsx(To,{path:"/draw",element:Z.jsx(wC,{})}),Z.jsx(To,{path:"/setting",element:Z.jsx(CC,{})}),Z.jsx(To,{path:"/command-palette",element:Z.jsx(AC,{})}),Z.jsx(To,{path:"*",element:Z.jsx(bC,{})})]})})}function LC(){return Z.jsx(IC,{})}$_.createRoot(document.getElementById("fateboard")).render(Z.jsx(ke.StrictMode,{children:Z.jsx(LC,{})}));
